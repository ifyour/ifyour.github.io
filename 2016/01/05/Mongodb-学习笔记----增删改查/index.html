<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#ffffff"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Ifyour's Blog"><meta name="msapplication-TileImage" content="/img/webAppIcon-256x256.png"><meta name="msapplication-TileColor" content="#000"><meta property="algolia:search" data-application-id="3XQ5CPDDMK" data-api-key="abe9e26eebcac723f34ade5cf6b97441" data-index-name="prod_blog"><title>Mongodb å­¦ä¹ ç¬”è®° -- å¢åˆ æ”¹æŸ¥ Â· Ifyour's Blog</title><meta name="description" content="Mongodb å­¦ä¹ ç¬”è®° -- å¢åˆ æ”¹æŸ¥ - Ifyour"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="manifest" href="/manifest.json"><link rel="icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="apple-touch-icon" size="256x256" href="/img/webAppIcon-256x256.png"><link rel="apple-touch-icon" size="512x512" href="/img/webAppIcon-512x512.png"><link rel="apple-touch-startup-image" href="/img/apple-launch-750x1334.png"><link rel="preload" href="/css/apollo.css" as="style"><link rel="preload" href="/js/main.js" as="script"><link rel="search" type="application/opensearchdescription+xml" href="http://ifyour.github.io/atom.xml" title="Ifyour's Blog"></head><body><div class="search"><a href="javascript:;" target="_self" class="close"><svg id="icon-close" viewbox="0 0 16 16" width="24" height="24" fill="#A4A9AC"><path d="M8,15 C4.13400675,15 1,11.8659932 1,8 C1,4.13400675 4.13400675,1 8,1 C11.8659932,1 15,4.13400675 15,8 C15,11.8659932 11.8659932,15 8,15 Z M10.44352,10.7233105 L10.4528296,10.7326201 L10.7326201,10.4528296 C11.0310632,10.1543865 11.0314986,9.66985171 10.7335912,9.37194437 L9.36507937,8.0034325 L10.7360526,6.63245928 C11.0344957,6.33401613 11.0349311,5.84948135 10.7370237,5.55157401 L10.448426,5.26297627 C10.1505186,4.96506892 9.66598387,4.96550426 9.36754072,5.26394741 L8.00589385,6.62559428 L6.63738198,5.25708241 C6.33947464,4.95917507 5.85493986,4.95961041 5.55649671,5.25805356 L5.26737991,5.54717036 C4.96893676,5.84561351 4.96850142,6.33014829 5.26640876,6.62805563 L6.62561103,7.9872579 L5.25463781,9.35823112 C4.95619466,9.65667427 4.95575932,10.141209 5.25366666,10.4391164 L5.5422644,10.7277141 C5.84017175,11.0256215 6.32470652,11.0251861 6.62314967,10.726743 L7.99412289,9.35576976 L9.36263476,10.7242816 C9.66054211,11.022189 10.1450769,11.0217536 10.44352,10.7233105 Z"/></svg></a><div class="container"><input id="search-input" autocomplete="off" type="text" placeholder="Type to search" class="search-input"><div class="search-by">Search by<a href="https://www.algolia.com/" target="_blank"> algolia</a></div><div class="search-results"><div id="search-articles" class="search-item"></div></div></div><script id="search-tmp" type="text/html">{{if list.length}}
    <h3>ARTICLES</h3>
    <ul>
        {{each list item}}
        <li>
            <div class="search-item-title">
                <a href="{{item.permalink}}">{{@item.title}}</a>
            </div>
            <div class="search-item-summary" style="-webkit-box-orient: vertical;">
                {{@item.summary}}
            </div>
        </li>
        {{/each}}
    </ul>
{{else if list}}
    <h2>
        Oops! no result,
        Try it on <a target="_blank" style="color: #2c3e50; border-bottom: 2px solid #42b983; font-size: 19px;" href="https://www.google.com/search?q=site%3Aifyour.github.io+{{keywords}}">Google: {{keywords}}</a>~ ğŸ˜±
    </h2>
{{/if}}</script></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/docs/" target="_self" class="nav-list-link">DOCS</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="javascript:;" target="_self" id="search" class="nav-list-link">SEARCH</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Mongodb å­¦ä¹ ç¬”è®° -- å¢åˆ æ”¹æŸ¥</h1><div class="post-info">Jan 5, 2016</div><div class="sidebar-toc"><span>Catalog</span><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongodb-ä»‹ç»"><span class="toc-text">Mongodb ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongodb-å®‰è£…"><span class="toc-text">Mongodb å®‰è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongodb-ä½¿ç”¨"><span class="toc-text">Mongodb ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#åŸºç¡€å‘½ä»¤"><span class="toc-text">åŸºç¡€å‘½ä»¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GUI-å·¥å…·"><span class="toc-text">GUI å·¥å…·</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongoose-ä»‹ç»"><span class="toc-text">Mongoose ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é…ç½®"><span class="toc-text">é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–°å¢æ•°æ®"><span class="toc-text">æ–°å¢æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#åˆ é™¤æ•°æ®"><span class="toc-text">åˆ é™¤æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æŸ¥è¯¢æ•°æ®"><span class="toc-text">æŸ¥è¯¢æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä¿®æ”¹æ•°æ®"><span class="toc-text">ä¿®æ”¹æ•°æ®</span></a></li></ol></li></ol></div><div class="post-content"><p>è®°å½• Mongodb çš„å­¦ä¹ ä¹‹æ—…ï¼Œä»ç¯å¢ƒé…ç½®ï¼Œåˆ°åŸºç¡€å‘½ä»¤è¡Œä½¿ç”¨ï¼Œç®—æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨æ•™ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å­¦ä¹ æ€»ç»“ï¼Œè¿˜æœ‰æŠŠè¸©åˆ°çš„å‘éƒ½è®°å½•ä¸‹æ¥ï¼Œä»¥åé‡åˆ°åŒæ ·çš„é—®é¢˜ä¸è‡³äºåœ¨åŒä¸€ä¸ªåœ°æ–¹ç»§ç»­è¸©å‘ã€‚<br><a id="more"></a></p>
<h3 id="Mongodb-ä»‹ç»"><a href="#Mongodb-ä»‹ç»" class="headerlink" title="Mongodb ä»‹ç»"></a>Mongodb ä»‹ç»</h3><blockquote>
<p>MongoDB æ˜¯ä¸€ç§æ–‡æ¡£å¯¼å‘<strong><em>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</em></strong>ï¼Œç”± C++æ’°å†™è€Œæˆï¼Œæ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚2007 å¹´ 10 æœˆï¼ŒMongoDB ç”± 10gen å›¢é˜Ÿæ‰€å‘å±•ã€‚2009 å¹´ 2 æœˆé¦–åº¦æ¨å‡ºã€‚ â€” <strong><em>ç»´åŸºç™¾ç§‘</em></strong></p>
</blockquote>
<p>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å¬ç€å¾ˆé¥¶ï¼Œå…¶å®å°±æ˜¯éå…³ç³»æ•°æ®åº“ã€‚é‚£ä»€ä¹ˆåˆæ˜¯ <strong><em>å…³ç³»å‹æ•°æ®åº“</em></strong> å‘¢ï¼Ÿå…³ç³»å‹æ•°æ®åº“ä»¥è¡Œå’Œåˆ—çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œè¿™ä¸€ç³»åˆ—çš„è¡Œå’Œåˆ—è¢«ç§°ä¸ºè¡¨ï¼Œä¸€ç»„è¡¨ç»„æˆäº†æ•°æ®åº“ã€‚è¡¨ä¸è¡¨ä¹‹é—´çš„æ•°æ®è®°å½•æœ‰å…³ç³»ã€‚</p>
<h3 id="Mongodb-å®‰è£…"><a href="#Mongodb-å®‰è£…" class="headerlink" title="Mongodb å®‰è£…"></a>Mongodb å®‰è£…</h3><p>æœ¬äººçš„æ“ä½œç³»ç»Ÿæ˜¯ï¼šMacOSï¼Œä¸”å·²ç»å®‰è£…äº† <a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="noopener">brew</a> ï¼Œæ‰€ä»¥å›¾çœäº‹ï¼Œæˆ‘å°±ä½¿ç”¨ brew ä¸€é”®å®‰è£…äº†ã€‚æ²¡ç”¨è¿‡ brew çš„åŒå­¦å¯ä»¥å»<a href="http://www.cnblogs.com/TankXiao/p/3247113.html" target="_blank" rel="noopener">è¿™é‡Œçœ‹çœ‹</a>ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install mongodb</span><br></pre></td></tr></table></figure>
<p>å®‰è£…é€Ÿåº¦å–å†³äºä½ çš„ç½‘ç»œæƒ…å†µï¼Œè¿™é‡Œç¨ç­‰ç‰‡åˆ»ã€‚brew é»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ <code>/usr/local/Cellar/</code> ä¸€ä¼šçš„åŠŸå¤«ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨è¿™é‡Œçœ‹åˆ°ï¼ŒMongodb ä¹–ä¹–çš„èººåœ¨è¿™äº†ã€‚å› ä¸º Mongodb ä¼šé»˜è®¤è¯»å– <code>/data/db</code> ç›®å½•ä¸‹çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æ–¹ä¾¿çœäº‹ï¼Œæˆ‘ä»¬æŠŠé»˜è®¤çš„æ•°æ®åº“å°±åˆ›å»ºåœ¨è¿™ä¸ªä½ç½®ï¼Œå¹¶ä¸”ç»™ <code>/data</code> æ‰§è¡Œæƒé™ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /data/db         <span class="comment"># sudo è¡¨ç¤ºä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œ-p è¡¨ç¤ºåˆ›å»ºå¤šå±‚ç›®å½•</span></span><br><span class="line">sudo chown -R  UserName /data  <span class="comment"># UserName è¡¨ç¤ºä½ å½“å‰çš„ç³»ç»Ÿç”¨æˆ·å</span></span><br></pre></td></tr></table></figure>
<p>å®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨ Mongodb çš„å®‰è£…ç›®å½•ä¸‹ æ‰¾åˆ° <code>bin</code> ç›®å½•äº†ï¼Œè¿™é‡Œé¢æ”¾ç€æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„å‘½ä»¤ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/Cellar/mongodb/3.4.0/bin</span><br><span class="line">./mongod   <span class="comment"># æ‰§è¡Œ Mongodb è¿›ç¨‹åï¼Œæµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:27017/</span></span><br></pre></td></tr></table></figure></p>
<p>æµè§ˆå™¨æ˜¾ç¤ºä¸‹é¢çš„å†…å®¹ï¼Œå°±è¡¨ç¤ºå®‰è£…æˆåŠŸå•¦ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It looks like you are trying to access MongoDB over HTTP on the native driver port.</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒéªŒè¯æˆ‘ä»¬ç¡®å®å®‰è£…æˆåŠŸäº†ã€‚åœ¨ Mongodb çš„æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥æ‰§è¡Œå¾ˆå¤šå‘½ä»¤æ¥æ“ä½œæ•°æ®åº“ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/Cellar/mongodb/3.4.0/bin</span><br><span class="line">./mongo</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥ MongoDB shell åï¼Œå…‰æ ‡ä¼šå˜æˆä¸‹é¢è¿‡çš„çŠ¶æ€ï¼Œæ‰§è¡Œ show dbs åï¼Œæ˜¾ç¤ºå¦‚ä¸‹åˆ™å¤§åŠŸå‘Šæˆï¼</span></span><br><span class="line">&gt; show dbs</span><br><span class="line">admin  0.000GB</span><br><span class="line"><span class="built_in">local</span>  0.000GB</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹æ¬¡æ‰§è¡Œ Mongodb ï¼Œæˆ‘ä»¬æŠŠ <code>bin</code> ç›®å½•æ”¾åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä¸‹æ¬¡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ <code>mongod</code> å³å¯å¯ç”¨æœåŠ¡ï¼Œè¾“å…¥å‘½ä»¤ <code>mongo</code> å³å¯è¿›å…¥ shell æ§åˆ¶å°ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè¯­æ³•ï¼šecho "export PATH=xxxxxx:$PATH" &gt;&gt; ~/.bash_profile</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'export PATH=/usr/local/Cellar/mongodb/3.4.0/bin:$PATH'</span>&gt;&gt;~/.bash_profile</span><br></pre></td></tr></table></figure>
<h3 id="Mongodb-ä½¿ç”¨"><a href="#Mongodb-ä½¿ç”¨" class="headerlink" title="Mongodb ä½¿ç”¨"></a>Mongodb ä½¿ç”¨</h3><p>ä½¿ç”¨ä¹‹å‰ï¼Œåœ¨æ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼Œç›¸æ¯”å…³ç³»å‹æ•°æ®åº“ï¼Œéå…³ç³»æ•°æ®åº“é‡‡ç”¨äº† <strong><em>æ•°æ®åº“</em></strong>ã€<strong><em>é›†åˆ</em></strong>ã€<strong><em>æ–‡æ¡£</em></strong>ã€çš„æ¦‚å¿µã€‚å…¶å®å¯¹æ¯” SQL æ•°æ®åº“ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ï¼Œé›†åˆå°±å¥½æ¯”æ˜¯ä¸€å¼ è¡¨ï¼Œæ–‡æ¡£å¥½æ¯”å°±æ˜¯ä¸€æ•´è¡Œæ•°æ®ã€‚åº“çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚å°±è¿™ç‚¹åŒºåˆ«ã€‚åœ¨ç»ˆç«¯è¾“å…¥ <code>mongo</code> è¿›å…¥ shell æ§åˆ¶å°ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo</span><br></pre></td></tr></table></figure></p>
<h4 id="åŸºç¡€å‘½ä»¤"><a href="#åŸºç¡€å‘½ä»¤" class="headerlink" title="åŸºç¡€å‘½ä»¤"></a>åŸºç¡€å‘½ä»¤</h4><p>æ–°å¢æ•°æ®</p>
<ul>
<li>æ˜¾ç¤ºæ•°æ®åº“ï¼š<code>show dbs</code></li>
<li>ä½¿ç”¨/åˆ›å»ºæ•°æ®åº“ï¼š<code>use æ•°æ®åº“å</code></li>
<li>æ˜¾ç¤ºé›†åˆï¼š<code>show collections</code></li>
<li>ä¿å­˜æ•°æ®ï¼š<code>db.collection.save({&quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;})</code></li>
<li>æ’å…¥æ•°æ®ï¼š<code>db.collection.insert({&quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;})</code></li>
</ul>
<div class="tip"><br>è‹¥æ–°å¢çš„æ•°æ®ä¸»é”®å·²ç»å­˜åœ¨ï¼Œinsert()ä¼šä¸åšæ“ä½œå¹¶æç¤ºé”™è¯¯ï¼Œè€Œsave()åˆ™æ›´æ”¹åŸæ¥çš„å†…å®¹ä¸ºæ–°å†…å®¹ã€‚<br></div>

<p>åˆ é™¤æ•°æ®</p>
<ul>
<li>åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼š<code>db.collection.remove({})</code></li>
<li>åˆ é™¤æŒ‡å®šæ–‡æ¡£ï¼š<code>db.collection.remove({&quot;key&quot;:&quot;value&quot;})</code></li>
<li>åˆ é™¤é›†åˆï¼š<code>db.collection.drop()</code> æˆ–è€… <code>db.runCommand({&quot;drop&quot;:&quot;collection&quot;})</code></li>
<li>åˆ é™¤æ•°æ®åº“ï¼š<code>db.runCommand({&quot;dropDatabase&quot;: 1})</code> æ³¨æ„ï¼š1 æ²¡æœ‰å¼•å·</li>
</ul>
<p>æŸ¥æ‰¾æ•°æ®</p>
<ul>
<li>æŸ¥æ‰¾æ‰€æœ‰æ•°æ®ï¼š <code>db.collection.find({})</code></li>
<li>æŸ¥åˆ°å•æ¡æ•°æ®ï¼š<code>db.collection.findOne({})</code></li>
<li>æ¡ä»¶æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:&quot;value&quot;})</code></li>
<li>æ¡ä»¶æŸ¥æ‰¾ key &lt; valueï¼š<code>db.collection.find({&quot;key&quot;:{$lt:value}})</code></li>
<li>æ¡ä»¶æŸ¥æ‰¾ key &gt; valueï¼š<code>db.collection.find({&quot;key&quot;:{$gt:value}})</code></li>
<li>æ¡ä»¶æŸ¥æ‰¾ key &gt;= valueï¼š<code>db.collection.find({&quot;key&quot;:{$gte:value}})</code></li>
<li>èŒƒå›´æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$gt:value1,$lt:value2 } })</code></li>
<li>æ¨¡è¿ç®—æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$mod:[10,1]}})</code></li>
<li>èŒƒå›´åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$in:[1,2,3]}})</code></li>
<li>èŒƒå›´ä¸åœ¨åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$nin:[1,2,3]}})</code></li>
<li>æ•°ç»„é•¿åº¦æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$size:1}})</code> key å¿…é¡»æ˜¯æ•°ç»„</li>
<li>å­—æ®µå­˜åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$exists:true|false}})</code></li>
<li>å¤šæ¡ä»¶æŸ¥æ‰¾ï¼š<code>db.collection.find({$or:[{a:1},{b:2}]})</code></li>
<li>å†…åµŒå¯¹è±¡ä¸­çš„å€¼æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key.subkey&quot;:value})</code></li>
<li>æ’åºï¼š<code>db.collection.find({}).sort({&quot;key1&quot;:1,&quot;key2&quot;:-1})</code> 1 å‡åº -1 é™åº</li>
<li>å¯¹å­—æ®µå»ºç«‹ç´¢å¼•ï¼š<code>db.collection.find({})ensureIndex({&quot;key&quot;:1})</code> 1 å‡åº -1 é™åº</li>
<li>èŒƒå›´æ§åˆ¶æŸ¥æ‰¾ï¼š<code>db.collection.find().skip(5).limit(5)</code> è·³è¿‡ 5 æ¡ï¼Œè¯»å– 5 æ¡</li>
<li>æŸ¥è¯¢ç»“æœé›†ç»Ÿè®¡ï¼š<code>db.collection.find().count()</code></li>
<li>æ¨¡ç³ŠæŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:/ab/})</code> æ­£åˆ™</li>
</ul>
<p>æ›´æ”¹æ•°æ®</p>
<ul>
<li><code>db.collection.update({&quot;targetKey&quot;:&quot;targetValue&quot;},{&quot;newKey&quot;:&quot;newVlue&quot;})</code></li>
</ul>
<h4 id="GUI-å·¥å…·"><a href="#GUI-å·¥å…·" class="headerlink" title="GUI å·¥å…·"></a>GUI å·¥å…·</h4><p><img src="http://ww1.sinaimg.cn/large/6057861cgw1fbfwwdbu8qj20zq0dbqah.jpg" alt><br><strong><em>Robomongo</em></strong> å¯è§†åŒ– Mongodb æ•°æ®åº“ç®¡ç†å·¥å…· ï¼Œç‚¹å‡»<a href="https://robomongo.org/download" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½ï¼Œå®˜æ–¹ç½‘ç«™ï¼š<a href="https://robomongo.org/" target="_blank" rel="noopener">https://robomongo.org/</a> ã€‚</p>
<h3 id="Mongoose-ä»‹ç»"><a href="#Mongoose-ä»‹ç»" class="headerlink" title="Mongoose ä»‹ç»"></a>Mongoose ä»‹ç»</h3><p><a href="http://mongoosejs.com/" target="_blank" rel="noopener">Mongoose</a> ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ Node ç¯å¢ƒä¸­æ“ä½œ MongoDB æ•°æ®åº“çš„ä¸€ç§å¯¹è±¡æ¨¡å‹å·¥å…·ï¼ŒMongoose å°†æ•°æ®åº“ä¸­çš„æ•°æ®è½¬æ¢ä¸º JavaScript å¯¹è±¡ä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚</p>
<h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><p>å®‰è£… Mongoose<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongoose --save</span><br></pre></td></tr></table></figure></p>
<p>å¼•å…¥åˆ°é¡¹ç›®æ–‡ä»¶ä¸­å¹¶åˆ›å»ºé“¾æ¥<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line">mongoose.connect(<span class="string">'mongodb://localhost/my_database'</span>);</span><br></pre></td></tr></table></figure></p>
<h4 id="æ–°å¢æ•°æ®"><a href="#æ–°å¢æ•°æ®" class="headerlink" title="æ–°å¢æ•°æ®"></a>æ–°å¢æ•°æ®</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥æ¨¡å—</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.createConnection(<span class="string">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class="line"><span class="comment">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> monSchema = <span class="keyword">new</span> mongooose.Schema(&#123;</span><br><span class="line">    name:&#123;<span class="attr">type</span>:<span class="built_in">String</span>,<span class="attr">default</span>:<span class="string">"username"</span>&#125;,</span><br><span class="line">    ageï¼š&#123;<span class="attr">type</span>:<span class="built_in">Number</span>&#125;,</span><br><span class="line">    sex:&#123;<span class="attr">type</span>:<span class="built_in">String</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é€‰æ‹©é›†åˆ</span></span><br><span class="line"><span class="keyword">var</span> monModel = db.model(<span class="string">'user'</span>,monSchema);</span><br><span class="line"><span class="comment">// æ•°æ®é›†</span></span><br><span class="line"><span class="keyword">var</span> content = &#123;<span class="attr">name</span>:<span class="string">"Nick"</span>,<span class="attr">age</span>:<span class="number">23</span>,<span class="attr">sex</span>:<span class="string">'ç”·'</span>&#125;;</span><br><span class="line"><span class="comment">// å®ä¾‹åŒ–å¯¹è±¡å¹¶æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">var</span> monInsert = <span class="keyword">new</span> monModel(content);</span><br><span class="line">monInsert.save(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æˆåŠŸæ’å…¥æ•°æ®'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  db.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥æ¨¡å—</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.createConnection(<span class="string">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class="line"><span class="comment">// cosole.log(db);</span></span><br><span class="line"><span class="comment">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> monSchema = <span class="keyword">new</span> mongooose.Schema(&#123;</span><br><span class="line">    name:&#123;<span class="attr">type</span>:<span class="built_in">String</span>,<span class="attr">default</span>:<span class="string">"name"</span>&#125;,</span><br><span class="line">    ageï¼š&#123;<span class="attr">type</span>:<span class="built_in">Number</span>&#125;,</span><br><span class="line">    sex:&#123;<span class="attr">type</span>:<span class="built_in">String</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é€‰æ‹©é›†åˆ</span></span><br><span class="line"><span class="keyword">var</span> monModel = db.model(<span class="string">'user'</span>,monSchema);</span><br><span class="line"><span class="comment">// åŸæ•°æ®å­—æ®µå€¼</span></span><br><span class="line"><span class="keyword">var</span> oldValue  = &#123;<span class="attr">name</span>:<span class="string">"Nick"</span>&#125;;</span><br><span class="line"><span class="comment">// å•æ¡ä»¶æ›´æ–°</span></span><br><span class="line"><span class="keyword">var</span> newData1 = &#123;<span class="attr">$set</span>:&#123;<span class="attr">name</span>:<span class="string">"å†…å®¹"</span>&#125;&#125;;</span><br><span class="line"><span class="comment">// å¤šæ¡ä»¶æ›´æ–°</span></span><br><span class="line"><span class="keyword">var</span> newData2 = &#123;<span class="attr">$set</span>:&#123;<span class="attr">name</span>:<span class="string">"å†…å®¹"</span>,<span class="attr">age</span>:<span class="number">2</span>&#125;&#125;;</span><br><span class="line">monModel.update(oldValue,newData,<span class="function"><span class="keyword">function</span>(<span class="params">err,result</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"update"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  db.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥æ¨¡å—</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.createConnection(<span class="string">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class="line"><span class="comment">// cosole.log(db);</span></span><br><span class="line"><span class="comment">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> monSchema = <span class="keyword">new</span> mongooose.Schema(&#123;</span><br><span class="line">    name:&#123;<span class="attr">type</span>:<span class="built_in">String</span>,<span class="attr">default</span>:<span class="string">"name"</span>&#125;,</span><br><span class="line">    ageï¼š&#123;<span class="attr">type</span>:<span class="built_in">Number</span>&#125;,</span><br><span class="line">    sex:&#123;<span class="attr">type</span>:<span class="built_in">String</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é€‰æ‹©é›†åˆ</span></span><br><span class="line"><span class="keyword">var</span> monModel = db.model(<span class="string">'user'</span>,monSchema);</span><br><span class="line"><span class="keyword">var</span> content = &#123;<span class="attr">name</span>:<span class="string">"å§“å2"</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> field = &#123;<span class="attr">name</span>:<span class="number">1</span>,<span class="attr">age</span>:<span class="number">1</span>,<span class="attr">sex</span>:<span class="number">1</span>&#125;;</span><br><span class="line">monModel.find(content,field,<span class="function"><span class="keyword">function</span>(<span class="params">err,result</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">  &#125;</span><br><span class="line">  db.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="ä¿®æ”¹æ•°æ®"><a href="#ä¿®æ”¹æ•°æ®" class="headerlink" title="ä¿®æ”¹æ•°æ®"></a>ä¿®æ”¹æ•°æ®</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥æ¨¡å—</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.createConnection(<span class="string">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class="line"><span class="comment">// cosole.log(db);</span></span><br><span class="line"><span class="comment">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> monSchema = <span class="keyword">new</span> mongooose.Schema(&#123;</span><br><span class="line">    name:&#123;<span class="attr">type</span>:<span class="built_in">String</span>,<span class="attr">default</span>:<span class="string">"name"</span>&#125;,</span><br><span class="line">    ageï¼š&#123;<span class="attr">type</span>:<span class="built_in">Number</span>&#125;,</span><br><span class="line">    sex:&#123;<span class="attr">type</span>:<span class="built_in">String</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é€‰æ‹©é›†åˆ</span></span><br><span class="line"><span class="keyword">var</span> monModel = db.model(<span class="string">'user'</span>,monSchema);</span><br><span class="line"><span class="comment">// åŸæ•°æ®å­—æ®µå€¼</span></span><br><span class="line"><span class="keyword">var</span> oldValue  = &#123;<span class="attr">name</span>:<span class="string">"Nick"</span>&#125;;</span><br><span class="line"><span class="comment">// å•æ¡ä»¶æ›´æ–°</span></span><br><span class="line"><span class="keyword">var</span> newData1 = &#123;<span class="attr">$set</span>:&#123;<span class="attr">name</span>:<span class="string">"å†…å®¹"</span>&#125;&#125;;</span><br><span class="line"><span class="comment">// å¤šæ¡ä»¶æ›´æ–°</span></span><br><span class="line"><span class="keyword">var</span> newData2 = &#123;<span class="attr">$set</span>:&#123;<span class="attr">name</span>:<span class="string">"å†…å®¹"</span>,<span class="attr">age</span>:<span class="number">2</span>&#125;&#125;;</span><br><span class="line">monModel.update(oldValue,newData,<span class="function"><span class="keyword">function</span>(<span class="params">err,result</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"update"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  db.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2016/01/06/7æ‹›è½»æ¾æå®š-JavaScript-å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥/" class="prev">PREV</a><a href="/2015/01/06/Node.JS-å­¦ä¹ ç¬”è®°-[05]----Express/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2015 - 2019 Made with <span>â¤</span> by <a href="https://github.com/ifyour/ifyour.github.io">Ifyour</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.4.0/lib/darkmode-js.min.js"></script><script>new Darkmode({
    bottom: '1rem',
    right: '1rem',
    left: 'unset',
    time: '0.5s',
    mixColor: '#fff',
    backgroundColor: '#fff',
    buttonColorDark: '#100f2c',
    buttonColorLight: '#fff',
    saveInCookies: true,
    label: 'ğŸŒ“',
    autoMatchOsTheme: true
}).showWidget();
</script><script src="/js/algoliasearch.min.js"></script><script src="/js/template-web.min.js"></script><script src="/js/main.js"></script><script src="https://unpkg.com/medium-zoom@0/dist/medium-zoom.min.js"></script><script>mediumZoom('article img', {margin: 24});
(function(win, targetElem) {
    if (!targetElem) return;
    win.onscroll = (function() {
        if (isElementInViewport(targetElem)) {
            win.onscroll = null;
            return mediumZoom('.gitment-comment-main img', {margin: 24});
        }
        return arguments.callee;
    })();
    function isElementInViewport(el) {
        var rect = el.getBoundingClientRect();
        var winH = win.innerHeight || document.documentElement.clientHeight;
        return rect.top <= winH && rect.bottom >= winH;
    };
})(this, document.querySelector('#gc_container'));
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-120929321-1",'auto');ga('send','pageview');</script></footer></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>