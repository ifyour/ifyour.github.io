<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Node.JS 学习笔记 [05] · Ifyour's Blog</title><meta name="description" content="Node.JS 学习笔记 [05] - Ifyour"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://ifyour.github.io/atom.xml" title="Ifyour's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://twitter.com/JohnWmm/" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="https://github.com/ifyour/" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Node.JS 学习笔记 [05]</h1><div class="post-info">Jan 2, 2017</div><div class="post-content"><p><strong><em>Express</em></strong> 是一个基于 Node.js 平台的极简、灵活的 Web 应用开发框架，它提供一系列强大的特性，帮助你创建各种 Web 和移动设备应用。Express的核心特性可以概括以下三点。<br><a id="more"></a></p>
<ul>
<li>可以设置中间件来响应 HTTP 请求。</li>
<li>定义了路由表用于执行不同的 HTTP 请求动作。</li>
<li>可以通过向模板传递参数来动态渲染 HTML 页面。</li>
</ul>
<p>下面学习的知识点，都会围绕这几个特性展开。</p>
<h3 id="Express-安装"><a href="#Express-安装" class="headerlink" title="Express 安装"></a>Express 安装</h3><h4 id="在项目中引入-Express"><a href="#在项目中引入-Express" class="headerlink" title="在项目中引入 Express"></a>在项目中引入 Express</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> projectName              <span class="comment"># 进入新建的 Node.js 项目</span></div><div class="line">npm init                    <span class="comment"># 初始化项目配置文件</span></div><div class="line">npm install express --save  <span class="comment"># 安装 Express 模块到项目配置文件中</span></div></pre></td></tr></table></figure>
<p>通过上门的命令，就可以完成 Express 的安装，下面在 <code>app.js</code> 中使用 Express 吧！<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.send(<span class="string">'Hello,Express!'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Express running at http://127.0.0.1:8080/'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="使用-Express-generator"><a href="#使用-Express-generator" class="headerlink" title="使用 Express-generator"></a>使用 Express-generator</h4><p>为了方便开发者，更便捷的使用 Express 生成项目，官方提供的快速的生成工具 <code>Express-generator</code>，虽然生成非常快速方便，但是作为初学者，还是要弄清楚里面每条命令所代表的含义，最后再使用官方提供的工具快速生成。打开终端，因为我是 MacOS，所以安装的时候要加上 <code>sudo</code> 否则会报错提示权限不够。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo npm install express-generator -g  <span class="comment"># 全局安装</span></div><div class="line">express mywebapp                       <span class="comment"># 创建 mywebapp 项目</span></div><div class="line"><span class="built_in">cd</span> mywebapp &amp;&amp; npm install             <span class="comment"># 安装依赖文件</span></div><div class="line">npm start                              <span class="comment"># 启动项目</span></div></pre></td></tr></table></figure></p>
<p>启动项目后，就可以在浏览器中预览了，访问地址：<a href="http://127.0.0.1:3000/" target="_blank" rel="external">http://127.0.0.1:3000/</a> 。</p>
<div class="tip"><br>启动前需要关闭其它已经启用的 Web 服务，否则可能会导致端口占用启动不成功。<br></div>

<h3 id="Express-路由"><a href="#Express-路由" class="headerlink" title="Express 路由"></a>Express 路由</h3><blockquote>
<p>路由是指如何定义应用的端点（URLs）以及如何响应客户端的请求。</p>
</blockquote>
<h4 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h4><p>简单理解，其实就是根据不同的请求，来响应与之对应的页面。比如，当用户访问 <a href="http://localhost/images/" target="_blank" rel="external">http://localhost/images/</a> 时，根据 URL 可以看出，请求的是 <code>/images</code> 这个目录，那么通过路由，找到这个页面并返回给请求的用户，这个过程就叫路由。来看一个简单的例子。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="comment">// 当用户请求访问 / 时，响应一个 Hello,Express! 字符串，这就是一个简单路由</span></div><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.send(<span class="string">'Hello,Express!'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>这里需要注意 <code>app.all()</code> ,它是一个特殊的路由方法，没有任何 HTTP 方法与其对应，它的作用是对于一个路径上的所有请求加载中间件。 all 相当于既可以处理 <code>GET</code>，也可以处理 <code>POST</code> 。</p>
<h4 id="Router-方法"><a href="#Router-方法" class="headerlink" title="Router 方法"></a>Router 方法</h4><p>通过 <code>express.Router</code> 类可以创建独立模块的路由模块，它是一个可以挂载的路由对象，把路由模块分离出项目，让整个项目结构清晰、方便管理，这里光说还是挺抽象，举个例子。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 目录结构</span></div><div class="line">.</div><div class="line">├── app.js</div><div class="line">├── index.js</div><div class="line">├── node_modules</div><div class="line">│   ├── body-parser</div><div class="line">│   └── express</div><div class="line">├── package.json</div><div class="line">├── router</div><div class="line">│   ├── admin.js</div><div class="line">│   └── home.js</div><div class="line">└── views</div><div class="line">    ├── admin</div><div class="line">    └── home</div></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> bodyparser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</div><div class="line"><span class="comment">// 引入外部路由模块</span></div><div class="line"><span class="keyword">var</span> home = <span class="built_in">require</span>(<span class="string">'./router/home'</span>);</div><div class="line"><span class="keyword">var</span> admin = <span class="built_in">require</span>(<span class="string">'./router/admin'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="comment">// 使用中间件 bodyparser ，后面可以在 req.body 中分析出 POST 请求体的内容</span></div><div class="line">app.use(bodyparser.urlencoded(&#123;<span class="attr">extended</span>:<span class="literal">false</span>&#125;));</div><div class="line"></div><div class="line"><span class="comment">// 使用外部路由模块</span></div><div class="line">app.use(<span class="string">'/'</span>,home);</div><div class="line">app.use(<span class="string">'/admin'</span>,admin);</div><div class="line"></div><div class="line">app.listen(<span class="number">8080</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">'visit http://127.0.0.1:8080/'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// admin.js</span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> router = express.Router();<span class="comment">// 用 Router 构造函数实例化 router 对象</span></div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line">router.get(<span class="string">'/login.html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.sendFile(path.resolve(__dirname + <span class="string">'/../views/admin/'</span> + <span class="string">'login.html'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">router.get(<span class="string">'/user.html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.sendFile(path.resolve(__dirname + <span class="string">'/../views/admin/'</span> + <span class="string">'user.html'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">router.post(<span class="string">'/login.html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;<span class="comment">// /admin/login.html</span></div><div class="line">    res.sendFile(path.resolve(__dirname + <span class="string">'/../views/admin/'</span> + <span class="string">'login.html'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = router;<span class="comment">// 暴露给外部调用该路由</span></div></pre></td></tr></table></figure>
<h3 id="Express-响应对象"><a href="#Express-响应对象" class="headerlink" title="Express 响应对象"></a>Express 响应对象</h3><p>通过响应（Response）对象，服务器可以返回一个来自客户端（浏览器）的 <code>Request</code> ,最终返回给用户的其实就是一个经过业务逻辑层处理的 <code>res</code> 对象。来了解下 Express 的响应对象吧。</p>
<h4 id="send"><a href="#send" class="headerlink" title="send()"></a>send()</h4><p>Express 已经封装过了原生 Node.js 的响应方法，在原生 Node.js 中，通过 <code>res.write()</code> 方法可以返回字符串和 Buffer。而 Express 中的 <code>send()</code> 可以返回任意数据类型，如流、数据、普通文本等，来看个例子。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">res.send(<span class="keyword">new</span> Buffer(<span class="string">'ifyour'</span>)); <span class="comment">// Buffer</span></div><div class="line">res.send(&#123;<span class="string">"name"</span>: <span class="string">"ifyour"</span>&#125;);   <span class="comment">// JSON</span></div><div class="line">res.send(<span class="string">'&lt;p&gt;some html&lt;/p&gt;'</span>);   <span class="comment">// HTML</span></div><div class="line">res.status(<span class="number">404</span>).send(<span class="string">'404 Not Find'</span>); <span class="comment">// 设置状态码并返回提示</span></div><div class="line"><span class="comment">//...</span></div></pre></td></tr></table></figure></p>
<h4 id="json"><a href="#json" class="headerlink" title="json()"></a>json()</h4><p>通过 <code>json()</code> 方法可以返回一个 <code>JSON</code> 对象，用于 Ajax 等。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">res.json(<span class="literal">null</span>);</div><div class="line">res.json(&#123;<span class="string">"user"</span>: <span class="string">"ifyour"</span>&#125;);</div><div class="line">res.status(<span class="number">500</span>).json(&#123;<span class="string">"error"</span>: <span class="string">"message"</span>&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="render"><a href="#render" class="headerlink" title="render()"></a>render()</h4><p><code>render</code> 用于渲染模板引擎，比如在使用 <a href="https://github.com/tj/ejs" target="_blank" rel="external">ejs</a> 模板引擎时，响应用户请求就可以使用 <code>res.render()</code> 返回给用户一个渲染好的页面。这个用的比较多，我来举个例子。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 目录结构</span></div><div class="line">.</div><div class="line">├── index.js</div><div class="line">├── node_modules</div><div class="line">│   ├── ejs</div><div class="line">│   └── express</div><div class="line">├── package.json</div><div class="line">└── views</div><div class="line">    └── login.html</div></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- ejs 模板引擎，定义了 /login.html --&gt;</span></div><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 注意 ejs 模板中变量的写法 --&gt;</span>    </div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>欢迎你，<span class="tag">&lt;<span class="name">%=name%</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> ejs = <span class="built_in">require</span>(<span class="string">'ejs'</span>); <span class="comment">// 引入 ejs 模板引擎</span></div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line"><span class="keyword">var</span> viewsPath = path.join(__dirname, <span class="string">'views'</span>);<span class="comment">// views 是模板目录</span></div><div class="line"><span class="comment">// 设置 express views 层，模板根路径</span></div><div class="line">app.set(<span class="string">'views'</span>, viewsPath);</div><div class="line"></div><div class="line"><span class="comment">// 设置 express 实例的模板语言</span></div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'html'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 把 express 实例的模板引擎和 ejs 模板引擎关联</span></div><div class="line">app.engine(<span class="string">'html'</span>, ejs.__express);</div><div class="line"></div><div class="line">app.get(<span class="string">'/login.html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.render(<span class="string">'login'</span>, &#123;<span class="attr">name</span>: <span class="string">"ifyour"</span>&#125;);<span class="comment">// 替换到模板变量中的 name 为 ifyour</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'visit http://127.0.0.1:8080/'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<div class="tip"><br><code>__dirname</code> 是 Node.js 中定义的 <code>global</code> 全局变量，获取当前文件的绝对路径，返回 <code>string</code> 类型。<br></div>

<h4 id="download"><a href="#download" class="headerlink" title="download()"></a>download()</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res.download(<span class="string">'./123.doc'</span>); <span class="comment">// 下载当前目录下面的123.doc文件。</span></div><div class="line">res.download(<span class="string">'./123.doc'</span>,<span class="string">'books.doc'</span>); <span class="comment">// 下载当前目录下面的123.doc文件，重命名为 books.doc</span></div></pre></td></tr></table></figure>
<h4 id="redirect"><a href="#redirect" class="headerlink" title="redirect()"></a>redirect()</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 重定向到指定的 URL 路径</span></div><div class="line">res.redirect(<span class="string">'/404.html'</span>);</div><div class="line">res.redirect(<span class="string">'https://www.google.com/'</span>);</div></pre></td></tr></table></figure>
<p>更多响应对象的方法，参考 <a href="http://www.expressjs.com.cn/4x/api.html#res" target="_blank" rel="external">Express 官方API</a>。</p>
<h3 id="Express-请求对象"><a href="#Express-请求对象" class="headerlink" title="Express 请求对象"></a>Express 请求对象</h3><p>Express 中的 <code>Request</code> 对象，包含了一次请求中的所有数据，比如请求头、路径、Cookies 等，获取请求头中的信息，服务器根据这些信息处理业务逻辑层，最终将处理过后的数据返回给用户。这里总结了常用的请求对象方法。</p>
<h4 id="URL-中的参数"><a href="#URL-中的参数" class="headerlink" title="URL 中的参数"></a>URL 中的参数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 语法： req.query.参数名</span></div><div class="line"><span class="comment">// e.g.  http://localhost:3000/user?name=ifyour</span></div><div class="line"><span class="built_in">console</span>.log(req.query.name);</div><div class="line"><span class="comment">// =&gt; ifyour</span></div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 语法：req.params.参数名</span></div><div class="line"><span class="comment">//e.g.  http://localhost/post/123123</span></div><div class="line">router.get(<span class="string">'/post/:id'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(req.params.id);</div><div class="line">    <span class="comment">// =&gt; 123123</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="表单中的参数"><a href="#表单中的参数" class="headerlink" title="表单中的参数"></a>表单中的参数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 语法：req.params.参数名</span></div><div class="line"><span class="comment">// e.g. &lt;input type="text" name="user"&gt;</span></div><div class="line"><span class="built_in">console</span>.log(req.param(<span class="string">'user'</span>));</div></pre></td></tr></table></figure>
<h3 id="Express-中间件"><a href="#Express-中间件" class="headerlink" title="Express 中间件"></a>Express 中间件</h3><p>Express 是一个自身功能极简，完全是由路由和中间件构成一个的 Web 开发框架：从本质上来说，一个 Express 应用就是在调用各种中间件。<br><img src="http://ww3.sinaimg.cn/large/6057861cgw1fbcrpk71zxj20sg03kaaa.jpg" alt=""><br>如图，中间件（Middleware）位于客户端和路由之间，它好比是一个漏斗，经过这个漏斗的 <code>Request</code> 对象和 <code>Response</code> 对象以及循环流程中的 <code>Next</code> 会被处理，比如正确性校验、业务逻辑处理等。</p>
<ul>
<li>执行任何代码</li>
<li>修改请求和响应对象</li>
<li>终结请求-响应循环</li>
<li>调用堆栈中的下一个中间件</li>
</ul>
<div class="tip"><br>如果当前中间件没有终结请求-响应循环，则必须调用 next() 方法将控制权交给下一个中间件，否则请求就会挂起。<br></div>

<p>.. 未完待续 2017-01-03 ..</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/01/01/Node-js-note-04/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ifyour';
var disqus_identifier = '2017/01/02/Node-js-note-05/';
var disqus_title = 'Node.JS 学习笔记 [05]';
var disqus_url = 'http://ifyour.github.io/2017/01/02/Node-js-note-05/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ifyour.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2017 <a href="http://ifyour.github.io">Ifyour</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>