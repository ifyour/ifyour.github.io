<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#ffffff"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Ifyour's Blog"><meta name="msapplication-TileImage" content="/img/webAppIcon-256x256.png"><meta name="msapplication-TileColor" content="#000"><meta property="algolia:search" data-application-id="3XQ5CPDDMK" data-api-key="abe9e26eebcac723f34ade5cf6b97441" data-index-name="prod_blog"><title>ES6 Promise ç®€æ˜æŒ‡å— Â· Ifyour's Blog</title><meta name="description" content="ES6 Promise ç®€æ˜æŒ‡å— - Ifyour"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="manifest" href="/manifest.json"><link rel="icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="apple-touch-icon" size="256x256" href="/img/webAppIcon-256x256.png"><link rel="apple-touch-icon" size="512x512" href="/img/webAppIcon-512x512.png"><link rel="apple-touch-startup-image" href="/img/apple-launch-750x1334.png"><link rel="preload" href="/css/apollo.css" as="style"><link rel="preload" href="/js/main.js" as="script"><link rel="search" type="application/opensearchdescription+xml" href="http://ifyour.github.io/atom.xml" title="Ifyour's Blog"></head><body><div class="search"><a href="javascript:;" target="_self" class="close"><svg id="icon-close" viewbox="0 0 16 16" width="24" height="24" fill="#A4A9AC"><path d="M8,15 C4.13400675,15 1,11.8659932 1,8 C1,4.13400675 4.13400675,1 8,1 C11.8659932,1 15,4.13400675 15,8 C15,11.8659932 11.8659932,15 8,15 Z M10.44352,10.7233105 L10.4528296,10.7326201 L10.7326201,10.4528296 C11.0310632,10.1543865 11.0314986,9.66985171 10.7335912,9.37194437 L9.36507937,8.0034325 L10.7360526,6.63245928 C11.0344957,6.33401613 11.0349311,5.84948135 10.7370237,5.55157401 L10.448426,5.26297627 C10.1505186,4.96506892 9.66598387,4.96550426 9.36754072,5.26394741 L8.00589385,6.62559428 L6.63738198,5.25708241 C6.33947464,4.95917507 5.85493986,4.95961041 5.55649671,5.25805356 L5.26737991,5.54717036 C4.96893676,5.84561351 4.96850142,6.33014829 5.26640876,6.62805563 L6.62561103,7.9872579 L5.25463781,9.35823112 C4.95619466,9.65667427 4.95575932,10.141209 5.25366666,10.4391164 L5.5422644,10.7277141 C5.84017175,11.0256215 6.32470652,11.0251861 6.62314967,10.726743 L7.99412289,9.35576976 L9.36263476,10.7242816 C9.66054211,11.022189 10.1450769,11.0217536 10.44352,10.7233105 Z"/></svg></a><div class="container"><input id="search-input" autocomplete="off" type="text" placeholder="Type to search" class="search-input"><div class="search-by">Search by<a href="https://www.algolia.com/" target="_blank"> algolia</a></div><div class="search-results"><div id="search-articles" class="search-item"></div></div></div><script id="search-tmp" type="text/html">{{if list.length}}
    <h3>ARTICLES</h3>
    <ul>
        {{each list item}}
        <li>
            <div class="search-item-title">
                <a href="{{item.permalink}}">{{@item.title}}</a>
            </div>
            <div class="search-item-summary" style="-webkit-box-orient: vertical;">
                {{@item.summary}}
            </div>
        </li>
        {{/each}}
    </ul>
{{else if list}}
    <h2>
        Oops! no result,
        Try it on <a target="_blank" style="color: #2c3e50; border-bottom: 2px solid #42b983; font-size: 19px;" href="https://www.google.com/search?q=site%3Aifyour.github.io+{{keywords}}">Google: {{keywords}}</a>~ ğŸ˜±
    </h2>
{{/if}}</script></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/docs/" target="_self" class="nav-list-link">DOCS</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="javascript:;" target="_self" id="search" class="nav-list-link">SEARCH</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ES6 Promise ç®€æ˜æŒ‡å—</h1><div class="post-info">May 29, 2018<a href="https://codeburst.io/a-simple-guide-to-es6-promises-d71bacd2e13a" target="_blank" title="https://codeburst.io/a-simple-guide-to-es6-promises-d71bacd2e13a" class="post-from">Translation Â· Original Link</a></div><div class="sidebar-toc"><span>Catalog</span><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä»€ä¹ˆæ˜¯-Promise"><span class="toc-text">ä»€ä¹ˆæ˜¯ Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç”Ÿæˆä¸€ä¸ª-Promise"><span class="toc-text">ç”Ÿæˆä¸€ä¸ª Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¦‚ä½•ä½¿ç”¨-Promises"><span class="toc-text">å¦‚ä½•ä½¿ç”¨ Promises</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ•è·-Promise"><span class="toc-text">æ•è· Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é“¾å¼-Promise"><span class="toc-text">é“¾å¼ Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ€»ç»“"><span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‚è€ƒ"><span class="toc-text">å‚è€ƒ</span></a></li></ol></div><div class="post-content"><p>Promise æ˜¯ JavaScriptES6 ä¸­æœ€ä»¤äººå…´å¥‹çš„æ–°å¢åŠŸèƒ½ä¹‹ä¸€. ES5 ä¸­ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œ. è¿‡åº¦ä½¿ç”¨å›è°ƒåˆ™ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±å’Œå¤šçº§åµŒå¥—ç¼©å¸¦æ¥çš„é—®é¢˜. Promise é€šè¿‡å°†å¼‚æ­¥ä»£ç è½¬åŒ–æˆåŒæ­¥æ‰§è¡Œçš„æ–¹å¼, å¤§å¤§ç®€åŒ–äº†å¼‚æ­¥ç¼–ç¨‹æ–¹å¼.</p>
<a id="more"></a>
<p>è¿™ç¯‡æ–‡ç« ä¸­, æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Promise ä»¥åŠåœ¨å¼€å‘ä¸­çš„å®è·µ.</p>
<h3 id="ä»€ä¹ˆæ˜¯-Promise"><a href="#ä»€ä¹ˆæ˜¯-Promise" class="headerlink" title="ä»€ä¹ˆæ˜¯ Promise"></a>ä»€ä¹ˆæ˜¯ Promise</h3><p>ç®€å•æ¥è¯´ Promise å°±æ˜¯ä¸€ä¸ªå­˜æ”¾ç€æœªæ¥æ‰ä¼šæœ‰è®¡ç®—ç»“æœçš„å ä½ç¬¦. ç¨å¾®æƒ³æƒ³, ä½ ä¼šå‘ç°, è¿™å’Œæˆ‘ä»¬å¹³å¸¸åœ¨è°ˆè¯è¿‡ç¨‹ä¸­è¯´çš„æ‰¿è¯ºå¾ˆåƒ. ä¸¾ä¸ªä¾‹å­: ä½ å‡†å¤‡å»å°åº¦æ—…è¡Œ, ä½ è®¢äº†ä¸€å¼ å»å°åº¦çš„æœºç¥¨. è¿™ä¸ªæœºç¥¨ä¸Šå†™ç€å¤šå°‘å·, åº§ä½å·æ˜¯å¤šå°‘. è¿™ä¸ªåœºæ™¯ä¸‹, æœºç¥¨å°±æ˜¯èˆªç©ºå…¬å¸ç»™ä½ è®¸ä¸‹çš„æ‰¿è¯º: åœ¨ä½ å‡†å¤‡å‡ºå‘é‚£å¤©ç»™ä½ é¢„ç•™äº†ä¸€ä¸ªå¤´ç­‰èˆ±ï¼ğŸ˜</p>
<p>è¿˜æœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­, ä½ æ‰¿è¯ºä½ çš„æœ‹å‹, å½“ä½ è¯»å®Œã€Šè®¡ç®—æœºç¼–ç¨‹è‰ºæœ¯ã€‹è¿™æœ¬ä¹¦å, ä½ å°±æŠŠè¿™æœ¬ä¹¦è¿˜å›å». åœ¨è¿™é‡Œ, ä½ æ‰€è¯´çš„è¯å°±å¥½æ¯”æ˜¯ä¸€ä¸ªå ä½ç¬¦, éœ€è¦è¿”å›çš„å€¼å°±æ˜¯è¿™æœ¬ä¹¦.</p>
<p>ä½ è¿˜å¯ä»¥æƒ³åˆ°å…¶ä»–ä¸€äº›ç±»ä¼¼æ‰¿è¯ºçš„ä¾‹å­, æ¯”å¦‚åœ¨åŒ»ç”ŸåŠå…¬å®¤ç­‰ç€ã€åœ¨é¤é¦†ç‚¹é¤ã€åœ¨å›¾ä¹¦é¦†å†™ä¹¦ç­‰ç­‰. éƒ½æ¶‰åŠæŸç§å½¢å¼çš„æ‰¿è¯º.</p>
<h3 id="ç”Ÿæˆä¸€ä¸ª-Promise"><a href="#ç”Ÿæˆä¸€ä¸ª-Promise" class="headerlink" title="ç”Ÿæˆä¸€ä¸ª Promise"></a>ç”Ÿæˆä¸€ä¸ª Promise</h3><p>å½“æŸé¡¹ä»»åŠ¡çš„å®Œæˆæ—¶é—´ä¸ç¡®å®šæˆ–å¤ªé•¿æ—¶, å°±å¯ä»¥ä½¿ç”¨ Promise. ä¾‹å¦‚, ç½‘ç»œè¯·æ±‚å¯èƒ½éœ€è¦ 10ms åˆ° 200msï¼ˆæˆ–æ›´é•¿ï¼‰çš„æ—¶é—´, å…·ä½“å–å†³äºç½‘é€Ÿ. æˆ‘ä»¬ä¸æƒ³åœ¨è·å–æ•°æ®æ—¶ç­‰å¾…. 200 æ¯«ç§’å¯¹ä½ æ¥è¯´å¯èƒ½ä¸å¤ªé‡è¦, ä½†å¯¹äºä¸€å°ç”µè„‘æ¥è¯´, è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ—¶é—´. Promise å°±æ˜¯è¦è®©è¿™ç§å¼‚æ­¥å˜å¾—ç®€å•ã€è½»æ¾. ä½¿ç”¨ Promise æ„é€ å‡½æ•°, æ¥å®ä¾‹åŒ–ä¸€ä¸ª myPromise å®ä¾‹, åƒè¿™æ ·:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Math</span>.random() * <span class="number">100</span> &lt;= <span class="number">90</span>) &#123;</span><br><span class="line">    resolve(<span class="string">'Hello, Promises!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'In 10% of the cases, I fail. Miserably.'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°. <code>new Promise()</code> è¢«ç§°ä¸ºæ‰§è¡Œå™¨å‡½æ•°, å®ƒæè¿°äº†è¦å®Œæˆçš„è®¡ç®—. å®ƒçš„è¿™ä¸¤ä¸ªå‚æ•°é€šå¸¸è¢«å«åš <code>resolve</code> å’Œ <code>reject</code>, å¯ä»¥ç†è§£ä¸º <strong>æ‰§è¡Œ</strong> å’Œ <strong>æ‹’ç»</strong>, å®ƒä»¬ç”¨æ¥æ ‡è®°æ‰§è¡Œå™¨å‡½æ•°æœ€ç»ˆçš„è®¡ç®—ç»“æœ. <code>resolve</code> å’Œ <code>reject</code> æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒç”¨æ¥è¿”å›ä¸€ä¸ªå€¼ç»™æˆ‘ä»¬çš„ Promise å®ä¾‹.</p>
<p>å½“è¿ç®—ç»“æœæˆåŠŸæ—¶, æˆ–è€…æœªæ¥ç€è¿™ä¸ªå€¼å‡†å¤‡å°±ç»ªæ—¶, æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ª <code>resolve</code> å‡½æ•°æ¥è¿”å›ä¸€ä¸ªå€¼, æˆ‘ä»¬å°±è¯´: æˆ‘è·µè¡Œäº†å½“åˆè®¸ä¸‹çš„è¿™ä¸ªæ‰¿è¯º.</p>
<p>åŒç†, å½“è®¡ç®—ç»“æœå¤±è´¥æ—¶, æˆ–è€…è®¡ç®—è¿‡ç¨‹ä¸­é‡åˆ°äº†é”™è¯¯, æˆ‘ä»¬å°±ä½¿ç”¨ <code>reject</code> å‡½æ•°, æˆ‘ä»¬å°±è¯´: æˆ‘æ‹’ç»å±¥è¡Œè¿™ä¸ªæ‰¿è¯º. <code>reject</code> å‡½æ•°å¯ä»¥æ¥æ”¶ä»»ä½•å€¼æ¥ä½œä¸ºå‚æ•°, ä½†æ˜¯æ¯”è¾ƒæ¨èçš„æ˜¯æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª <code>Error</code> å¯¹è±¡, å³: æŠ›å‡ºä¸€ä¸ªé”™è¯¯, ç”¨æ¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ä»£ç , è¿™æ ·å°±å¯ä»¥æ ¹æ®å…·ä½“çš„æŠ›å‡ºé”™è¯¯ä¿¡æ¯å»è§£å†³é—®é¢˜å•¦.</p>
<p>åœ¨ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ä¸­, <code>Math.random()</code> ç”¨æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°, åœ¨ 90% çš„æƒ…å†µä¸‹, è¿™ä¸ª Promise éƒ½åº”è¯¥è¢«æ‰§è¡Œ (å‡è®¾ç­‰æ¦‚ç‡åˆ†å¸ƒ), å‰©ä½™çš„æƒ…å†µä¸‹éƒ½æ˜¯æ‹’ç»æ‰§è¡Œçš„.</p>
<h3 id="å¦‚ä½•ä½¿ç”¨-Promises"><a href="#å¦‚ä½•ä½¿ç”¨-Promises" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ Promises"></a>å¦‚ä½•ä½¿ç”¨ Promises</h3><p>åœ¨ä¸Šé¢çš„ä»£ç ä¾‹å­ä¸­, æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª Promise å®ä¾‹ <code>myPromise</code>, é‚£ä¹ˆå¦‚ä½•é€šè¿‡ <code>resolve</code> å’Œ <code>reject</code> å‡½æ•°è®¿é—®è®¡ç®—å®Œæˆåçš„å€¼å‘¢? æ‰€æœ‰çš„ <code>Promise</code> å®ä¾‹éƒ½æœ‰ä¸€ä¸ª <code>.then()</code> æ–¹æ³•, æˆ‘ä»¬æ¥ç§ç§:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Math</span>.random() * <span class="number">100</span> &lt; <span class="number">90</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'resolving the promise ...'</span>);</span><br><span class="line">    resolve(<span class="string">'Hello, Promises!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'In 10% of the cases, I fail. Miserably.'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Two functions</span></span><br><span class="line"><span class="keyword">const</span> onResolved = <span class="function"><span class="params">resolvedValue</span> =&gt;</span> <span class="built_in">console</span>.log(resolvedValue);</span><br><span class="line"><span class="keyword">const</span> onRejected = <span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(error);</span><br><span class="line"></span><br><span class="line">myPromise.then(onResolved, onRejected);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Same as above, written concisely</span></span><br><span class="line">myPromise.then(</span><br><span class="line">  resolvedValue =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(resolvedValue);</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output (in 90% of the cases)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// resolving the promise ...</span></span><br><span class="line"><span class="comment">// Hello, Promises!</span></span><br><span class="line"><span class="comment">// Hello, Promises!</span></span><br></pre></td></tr></table></figure>
<p><code>.then()</code> æ–¹æ³•æ¥æ”¶ 2 ä¸ªå›è°ƒå‡½æ•°, ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯å½“æˆ‘ä»¬çš„ Promise å®ä¾‹è¢«æ‰§è¡Œ (resolve) æ—¶è°ƒç”¨, ç¬¬äºŒä¸ªåˆ™æ˜¯è¢«æ‹’ç» (reject) æ—¶è°ƒç”¨. åœ¨ä¸Šé¢çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨ <code>onResolved</code> å’Œ <code>onRejected</code> å®šä¹‰äº†è¿™ä¸¤ä¸ªå‡½æ•°, ç„¶åæŠŠå®ƒæ”¾åˆ° <code>.then</code> å‡½æ•°é‡Œ, å½“ç„¶, ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å¸¸è§„å†™æ³•, ç›´æ¥åœ¨ <code>.then</code> å‡½æ•°é‡Œå†™ä¸¤ä¸ªå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„.</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æœ‰å‡ ç‚¹éå¸¸é‡è¦, æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹:</p>
<ul>
<li>ä¸€ä¸ª <code>promise</code> åªèƒ½æ˜¯æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€ä¸­çš„ä¸€ä¸ª. å®ƒä¸èƒ½æˆåŠŸæˆ–è€…å¤±è´¥å¤šæ¬¡. ä¹Ÿä¸èƒ½ä»æˆåŠŸçŠ¶æ€åˆ‡æ¢åˆ°å¤±è´¥çŠ¶æ€, å¤±è´¥åä¹‹äº¦ç„¶.</li>
<li>ä½ å¯ä»¥åœ¨æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€å, å»å®šä¹‰è¿™æ ·ä¸€ä¸ªå›è°ƒå‡½æ•°. å½“ä»–ä»¬ <code>resolve</code> æˆ–è€… <code>reject</code> ä»ç„¶èƒ½æ­£ç¡®è°ƒç”¨.</li>
</ul>
<p>è¿™å°±è¯´æ˜, <code>Promise</code> æœ€ç»ˆåªæœ‰ä¸€ä¸ªçŠ¶æ€, å³ä½¿ä½ å¤šæ¬¡ä½¿ç”¨ <code>.then</code> å¤„ç†å‡½æ•°, è¿™ä¸ªçŠ¶æ€ä¸èƒ½æ›´æ”¹ (è®¡ç®—ç»“æœä¹Ÿä¸ä¼šé‡å¤æ‰§è¡Œ).</p>
<p>ä¸ºäº†éªŒè¯è¿™ç‚¹, ä½ å¯ä»¥çœ‹åˆ°åœ¨ç¬¬ 3 è¡Œä»£ç ä¸­, <code>console.log</code> è¯­å¥, å½“ä½ å¤šæ¬¡ä½¿ç”¨ <code>.then</code> å¤„ç†ç¨‹åºè¿è¡Œä¸Šè¿°ä»£ç æ—¶, <code>console.log</code> çš„è¯­å¥åªä¼šè¢«æ‰“å°ä¸€æ¬¡. è¿™å°±è¯´æ˜äº† Promise ä¼šç¼“å­˜è®¡ç®—ç»“æœçš„, å½“æœ‰ä¸€äº›ç›¸åŒçš„ç»“æœæ—¶, ç¼“å­˜ç»“æœä¼šè¢«è¿”å›.</p>
<p>å¦ä¸€ä¸ªé‡è¦çš„è¦æ³¨æ„çš„æ˜¯, Promise æ˜¯ <a href="https://zh.wikipedia.org/wiki/%E5%8F%8A%E6%97%A9%E6%B1%82%E5%80%BC" target="_blank" rel="noopener">åŠæ—©æ±‚å€¼ (evaluated eagerly)</a> çš„: åªè¦å£°æ˜å¹¶å°†å…¶èµ‹å€¼åˆ°å˜é‡ä¸Š, å®ƒå·²ç»å¼€å§‹åœ¨å†…å­˜ä¸­æ‰§è¡Œäº†. æ²¡æœ‰ <code>.start</code> æˆ– <code>.begin</code> æ–¹æ³•. å°±åƒå®ƒåœ¨å‰é¢çš„ä¾‹å­ä¸­å¼€å§‹çš„é‚£æ ·.</p>
<p>ä¸ºäº†ç¡®ä¿ Promise èƒ½è¢«å»¶è¿Ÿè°ƒç”¨, æˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦åœ¨å®ƒçš„å¤–å±‚åŒ…è£¹ä¸€ä¸ªå‡½æ•°, ç¨åçš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šè§£é‡Šè¿™ä¸ª.</p>
<h3 id="æ•è·-Promise"><a href="#æ•è·-Promise" class="headerlink" title="æ•è· Promise"></a>æ•è· Promise</h3><p>åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† <code>resolve</code> çš„åœºæ™¯, é‚£ä¹ˆå½“æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯æ—¶, ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢? åœ¨ <code>.then()</code> å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°, å°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ <code>onRejected</code> ä¼šè¢«æ‰§è¡Œ, æ¥çœ‹ä¸€ä¸ªä¾‹å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Math</span>.random() * <span class="number">100</span> &lt; <span class="number">90</span>) &#123;</span><br><span class="line">    reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'The promise was rejected by using reject function.'</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'The promise was rejected by throwing an error'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">myPromise.then(</span><br><span class="line">  () =&gt; <span class="built_in">console</span>.log(<span class="string">'resolved'</span>),</span><br><span class="line">  error =&gt; <span class="built_in">console</span>.log(error.message)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output (in 90% of cases)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The promise was rejected by using reject function.</span></span><br></pre></td></tr></table></figure>
<p>å’Œç¬¬ä¸€ä¸ªä¾‹å­ä¸€æ ·çš„, ä½†æ˜¯ç°åœ¨ 90% çš„æƒ…å†µæ˜¯è¢« <code>reject</code> çš„, å¦å¤– 10% çš„æƒ…å†µåˆ™æ˜¯æŠ›å‡ºä¸€ä¸ªé”™è¯¯è¯­å¥.</p>
<p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† <code>onResolved</code> å’Œ <code>onRejected</code> æ–¹æ³•, <code>onRejected</code> æ–¹æ³•å°†åœ¨é”™è¯¯å‘ç”Ÿæ—¶è¢«è°ƒç”¨, å¯ä»¥çœ‹åˆ° <code>reject</code> å‡½æ•°çš„å‚æ•°å¯ä»¥ç›´æ¥æ˜¯é”™è¯¯æç¤º, æ²¡å¿…è¦å¿…é¡» <code>new Error</code>, ä¸¤ä¸ªå†™æ³•éƒ½ä¸€æ ·.</p>
<p>å¥å£®çš„ç¨‹åºä»£ç ç¦»ä¸å¼€é”™è¯¯å¤„ç†, <code>.then</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ç»™äº†æˆ‘ä»¬è¿™æ ·ä¸€ä¸ªæ·å¾„. å½“éœ€è¦å¤„ç†ä¸€ä¸ªé”™è¯¯æ—¶, å¯ä»¥ç”¨ <code>.catch(onRejected)</code> æ¥ä»£æ›¿ <code>.then(null, () =&gt; {...})</code>, <code>catch</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•° <code>onRejected</code>, å› æ­¤, ä¸Šé¢çš„ä»£ç , å¯ä»¥ä½¿ç”¨ <code>catch</code> æ¥ç®€åŒ–å†™æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myPromise.catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(error.message));</span><br></pre></td></tr></table></figure>
<p>è®°ä½: <code>.catch</code> æ–¹æ³•ä»…ä»…æ˜¯ <code>.then(undefined, onRejected)</code> çš„è¯­æ³•ç³–è€Œå·².</p>
<h3 id="é“¾å¼-Promise"><a href="#é“¾å¼-Promise" class="headerlink" title="é“¾å¼ Promise"></a>é“¾å¼ Promise</h3><p><code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æ°¸è¿œä¼šè¿”å›ä¸€ä¸ª Promise å®ä¾‹, æ‰€ä»¥ä½ å¯ä»¥é“¾å¼ä½¿ç”¨å¤šä¸ª <code>.then</code> ä¸€èµ·æ¥è°ƒç”¨. è®©æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£å®ƒ.</p>
<p>é¦–å…ˆ, æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°, æ¥å»¶è¿Ÿè¿”å›ä¸€ä¸ª Promise å®ä¾‹. è¿™ä¸ªè¿”å›çš„ Promise å°†åœ¨ç¨åçš„æ—¶é—´å†… <code>resolve</code>. è¿™é‡Œæ˜¯å®ç°æ–¹æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> delay = <span class="function"><span class="params">ms</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥åŒ…è£¹æˆ‘ä»¬çš„ Promise å®ä¾‹, æ‰€ä»¥å®ƒå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ. è¿™ä¸ª <code>delay</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ—¶é—´æ¥ä½œä¸ºå‚æ•°. è¿™ä¸ªæ‰§è¡Œå‡½æ•°å°†æ¥æ”¶ <code>ms</code> ä½œä¸ºä»–çš„å‚æ•°, å®ƒè¿˜åŒ…å«ä¸€ä¸ª <code>setTimeout</code> , å®ƒåœ¨ <code>ms</code> æ¯«ç§’åè°ƒç”¨ <code>resolve</code> å‡½æ•°, ä»è€Œæ­£ç¡®æ‰§è¡Œ. çœ‹è¿™ä¸ªä¾‹å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delay(<span class="number">5000</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'Resolved after 5 seconds'</span>));</span><br></pre></td></tr></table></figure>
<p><code>.then</code> ä¸­çš„å›è°ƒè¯­å¥å°†åœ¨ <code>delay(5000)</code> åæ‰§è¡Œ. å½“ä½ æ‰§è¡Œä¸Šé¢çš„ä»£ç  5 ç§’å, ä½ å°±å¯ä»¥åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°è¾“å‡ºç»“æœäº†.</p>
<p>è¿™é‡Œ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ª <code>.then()</code> æ–¹æ³•æ¥é“¾å¼è°ƒç”¨:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> delay = <span class="function"><span class="params">ms</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br><span class="line"></span><br><span class="line">delay(<span class="number">2000</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Resolved after 2 seconds'</span>);</span><br><span class="line">    <span class="keyword">return</span> delay(<span class="number">1500</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Resolved after 1.5 seconds'</span>);</span><br><span class="line">    <span class="keyword">return</span> delay(<span class="number">3000</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Resolved after 3 seconds'</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Caught an error.'</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Done.'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Resolved after 2 seconds</span></span><br><span class="line"><span class="comment">// Resolved after 1.5 seconds</span></span><br><span class="line"><span class="comment">// Resolved after 3 seconds</span></span><br><span class="line"><span class="comment">// Caught an error.</span></span><br><span class="line"><span class="comment">// Done.</span></span><br></pre></td></tr></table></figure>
<p>ä»ç¬¬ 3 è¡Œå¼€å§‹, å®ƒçš„æ‰§è¡Œæ­¥éª¤æ˜¯è¿™æ ·çš„:</p>
<ul>
<li><code>delay(2000)</code> å‡½æ•°æ‰§è¡Œ, å®ƒè¿”å›ä¸€ä¸ªç¨å 2 ç§’å³å°†æ‰§è¡Œçš„ Promise å®ä¾‹.</li>
<li>ç¬¬ 1 ä¸ª <code>.then()</code> æ‰§è¡Œ, å®ƒè¾“å‡ºè¯­å¥ <code>Resolved after 2 seconds</code>, ç„¶åå®ƒæ‰§è¡Œ <code>delay(1500)</code> åˆè¿”å›ä¸€ä¸ª Promise å®ä¾‹, å¦‚æœä¸€ä¸ª <code>.then()</code> è¿”å›äº†ä¸€ä¸ª Promise å®ä¾‹, é‚£ä¹ˆå®ƒçš„ <code>resolve</code> å°†è¢«è½¬å‘ç»™ä¸‹ä¸€ä¸ª <code>.then</code> æ–¹æ³•è°ƒç”¨, æŠ€æœ¯ä¸Šå«: æ²‰é™ (settlement).</li>
<li>åªè¦åƒè¿™æ ·ç»§ç»­ä¸²è”ä¸‹å», å®ƒä¼šç»§ç»­æ‰§è¡Œ.</li>
</ul>
<p>æ³¨æ„åœ¨ç¬¬ä¸‰ä¸ª <code>.then()</code> æ–¹æ³•æ—¶, æˆ‘ä»¬åœ¨ <code>.then</code> ä¸­æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯. è¿™æ„å‘³ç€å½“å‰çš„ Promise è¢«æ‹’ç». ç„¶åå®ƒä¼šåœ¨ä¸‹ä¸€ä¸ª <code>.catch</code> è¯­å¥ä¸­è¢«æ•è·, <code>Caught an error</code> å°†ä¼šè¢«è¾“å‡º. ç„¶è€Œä¸€ä¸ª <code>.catch</code> è¯­å¥å®ƒè‡ªå·±æ°¸è¿œæ˜¯è¢« <code>resolve</code> çš„, æ‰€ä»¥ä¸éœ€è¦åœ¨è¯­å¥é‡Œå†å†™ <code>reject</code> (é™¤éä½ æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯), è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ <code>.catch</code> è¯­å¥åè¿˜å¯ä»¥ç»§ç»­å†™ <code>.then</code> çš„åŸå› .</p>
<p>æ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯åœ¨ <code>.then</code> æ–¹æ³•åæ‰§è¡Œ <code>.catch</code> è€Œä¸æ˜¯ä½¿ç”¨ <code>onResolved</code> å’Œ <code>onRejected</code>, æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promiseThatResolves = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Leads to UnhandledPromiseRejection</span></span><br><span class="line">promiseThatResolves().then(</span><br><span class="line">  () =&gt; &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  err =&gt; <span class="built_in">console</span>.log(err)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Proper error handling</span></span><br><span class="line">promiseThatResolves()</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err));</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åˆ›é€ ä¸€ä¸ªæ°¸è¿œèƒ½è¢« <code>resolve</code> çš„ Promise å®ä¾‹, å½“ä½ æ‰§è¡Œ <code>.then</code> æ—¶, å¯ä»¥å¸¦ä¸¤ä¸ªå›è°ƒå‡½æ•°: <code>onResolved</code> å’Œ <code>onRejected</code>, ç¬¬ä¸€ç§å†™æ³•, åœ¨ <code>then</code> ç§æ”¾å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°, ä½†æ˜¯: å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ç»§ç»­æŠ›å‡ºé”™è¯¯, é‚£ä¹ˆè¿™ä¸ªé”™è¯¯æ˜¯ä¸èƒ½è¢«æ•è·çš„. ğŸ˜…</p>
<p>ç¬¬äºŒç§å†™æ³•, åœ¨ <code>.then</code> è¯­å¥çš„åé¢ä½¿ç”¨ <code>.catch</code> æ•è·, ä¸å…‰èƒ½æ•è·åˆ°æ‰§è¡Œå‡½æ•° <code>promiseThatResolves</code> çš„é”™è¯¯, è€Œä¸”åœ¨ <code>.then()</code> ä¸­çš„é”™è¯¯ä¹Ÿæ˜¯èƒ½è¢«æ•è·åˆ°. çŸ¥é“è¿™æ ·å†™çš„å¥½å¤„äº†å§!ğŸ˜</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä½ å¯ä»¥æ‰§è¡Œä¸Šé¢çš„æ‰€æœ‰ä»£ç ç‰‡æ®µæ¥æ›´æ·±å…¥çš„å­¦ä¹ . ä¸€ç§æ¯”è¾ƒå¥½çš„å®è·µå°±æ˜¯, æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å‡½æ•°éƒ½ç”¨ Promise æ¥é‡æ–°å®ç°. å¦‚æœä½ å†™ Node.js çš„è¯, ä½ ä¼šå‘ç° <code>fs</code> è¿˜æœ‰å…¶ä»–æ¨¡å—éƒ½æ˜¯åŸºäºå›è°ƒå‡½æ•°æ¥å®ç°çš„. æ‰€ä»¥ä¼šå­˜åœ¨ä¸€äº›å·¥å…·åº“, å®ƒä»¬æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å®ç°æ–¹å¼ä½¿ç”¨ Promise æ¥å®ç°äº†. æ¯”å¦‚ Node.js çš„ <a href="https://nodejs.org/api/util.html#util_util_promisify_original" target="_blank" rel="noopener">util.promisify</a> å’Œ <a href="https://github.com/sindresorhus/pify" target="_blank" rel="noopener">pify</a>. å¦‚æœä½ åœ¨å­¦ä¹ çš„è¯, é‚£ä¹ˆå°½å¯èƒ½çš„å°è¯•è‡ªå·±å»å®ç°. æˆ–è€…è¯´å»è¯»è¿™äº› Promise å®ç°åº“çš„æºä»£ç . ç„¶åä½ å°±å¯ä»¥æŠŠè¿™äº›æœ€ä½³å®è·µç”¨äºä½ çš„äº§å“ä¸­å•¦!</p>
<p>è¿˜æœ‰ä¸€äº›å…³äº Promise çš„ä¸œè¥¿æ²¡æœ‰å®Œå…¨è®²åˆ°, æ¯”å¦‚ <code>Promise.all</code> å’Œ <code>Promise.race</code> æ–¹æ³•, å¤„ç† Promise ä¸­çš„é”™è¯¯, ä»¥åŠä¸€äº›å¸¸è§çš„åæ¨¡å¼å’Œç»†èŠ‚ç­‰. ä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥æ¥å­¦ä¹ æ›´å¤šå…³äº Promise çš„çŸ¥è¯†.</p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects" target="_blank" rel="noopener">ECMA Promise Specification</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">Mozilla Docs</a></li>
<li><a href="https://developers.google.com/web/fundamentals/primers/promises#promise-api-reference" target="_blank" rel="noopener">Googleâ€™s Developerâ€™s Guide on Promises written by Jake Archibald</a></li>
<li><a href="http://exploringjs.com/es6/ch_promises.html#sec_first-example-promises" target="_blank" rel="noopener">Exploring JSâ€™s Chapter on Promises</a></li>
<li><a href="http://jamesknelson.com/grokking-es6-promises-the-four-functions-you-need-to-avoid-callback-hell/" target="_blank" rel="noopener">Introduction to Promises</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/06/09/ç»™å°ç™½è¯»çš„-WEB-æ‰˜ç®¡æœåŠ¡è¿›åŒ–å²/" class="prev">PREV</a><a href="/2018/05/20/å¦‚ä½•é¿å…-async-await-åœ°ç‹±/" class="next">NEXT</a></div><div id="gc_container"></div><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><script>(new Gitment({
    id: 'aid' + (new Date('Tue May 29 2018 22:28:41 GMT+0800')).getTime()/1000,
    title: 'ES6 Promise ç®€æ˜æŒ‡å—' + ' Â· è¯„è®º',
    link: decodeURI(location.protocol + '//' + location.hostname + location.pathname),
    repo: 'ifyour.github.io',
    owner: 'ifyour',
    oauth: {
        client_id: '576e98d38d4bd19f8a02',
        client_secret: 'ba3616bf2f20c5da947a1fd5c7ef0edff4ffab99',
    }
})).render('gc_container');</script><div class="copyright"><p>Â© 2015 - 2019 Made with <span>â¤</span> by <a href="https://github.com/ifyour/ifyour.github.io">Ifyour</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.4.0/lib/darkmode-js.min.js"></script><script>new Darkmode({
    bottom: '1rem',
    right: '1rem',
    left: 'unset',
    time: '0.5s',
    mixColor: '#fff',
    backgroundColor: '#fff',
    buttonColorDark: '#100f2c',
    buttonColorLight: '#fff',
    saveInCookies: true,
    label: 'ğŸŒ“',
    autoMatchOsTheme: true
}).showWidget();
</script><script src="/js/algoliasearch.min.js"></script><script src="/js/template-web.min.js"></script><script src="/js/main.js"></script><script src="https://unpkg.com/medium-zoom@0/dist/medium-zoom.min.js"></script><script>mediumZoom('article img', {margin: 24});
(function(win, targetElem) {
    if (!targetElem) return;
    win.onscroll = (function() {
        if (isElementInViewport(targetElem)) {
            win.onscroll = null;
            return mediumZoom('.gitment-comment-main img', {margin: 24});
        }
        return arguments.callee;
    })();
    function isElementInViewport(el) {
        var rect = el.getBoundingClientRect();
        var winH = win.innerHeight || document.documentElement.clientHeight;
        return rect.top <= winH && rect.bottom >= winH;
    };
})(this, document.querySelector('#gc_container'));
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-120929321-1",'auto');ga('send','pageview');</script></footer></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>