<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#ffffff"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Ifyour's Blog"><meta name="msapplication-TileImage" content="/img/webAppIcon-256x256.png"><meta name="msapplication-TileColor" content="#000"><meta property="algolia:search" data-application-id="3XQ5CPDDMK" data-api-key="abe9e26eebcac723f34ade5cf6b97441" data-index-name="prod_blog"><title>Webpack 4 å®šåˆ¶å‰ç«¯å¼€å‘ç¯å¢ƒ Â· Ifyour's Blog</title><meta name="description" content="Webpack 4 å®šåˆ¶å‰ç«¯å¼€å‘ç¯å¢ƒ - Ifyour"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="manifest" href="/manifest.json"><link rel="icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="apple-touch-icon" size="256x256" href="/img/webAppIcon-256x256.png"><link rel="apple-touch-icon" size="512x512" href="/img/webAppIcon-512x512.png"><link rel="apple-touch-startup-image" href="/img/apple-launch-750x1334.png"><link rel="preload" href="/css/apollo.css" as="style"><link rel="preload" href="/js/main.js" as="script"><link rel="search" type="application/opensearchdescription+xml" href="http://ifyour.github.io/atom.xml" title="Ifyour's Blog"></head><body><div class="search"><a href="javascript:;" target="_self" class="close"><svg id="icon-close" viewbox="0 0 16 16" width="24" height="24" fill="#A4A9AC"><path d="M8,15 C4.13400675,15 1,11.8659932 1,8 C1,4.13400675 4.13400675,1 8,1 C11.8659932,1 15,4.13400675 15,8 C15,11.8659932 11.8659932,15 8,15 Z M10.44352,10.7233105 L10.4528296,10.7326201 L10.7326201,10.4528296 C11.0310632,10.1543865 11.0314986,9.66985171 10.7335912,9.37194437 L9.36507937,8.0034325 L10.7360526,6.63245928 C11.0344957,6.33401613 11.0349311,5.84948135 10.7370237,5.55157401 L10.448426,5.26297627 C10.1505186,4.96506892 9.66598387,4.96550426 9.36754072,5.26394741 L8.00589385,6.62559428 L6.63738198,5.25708241 C6.33947464,4.95917507 5.85493986,4.95961041 5.55649671,5.25805356 L5.26737991,5.54717036 C4.96893676,5.84561351 4.96850142,6.33014829 5.26640876,6.62805563 L6.62561103,7.9872579 L5.25463781,9.35823112 C4.95619466,9.65667427 4.95575932,10.141209 5.25366666,10.4391164 L5.5422644,10.7277141 C5.84017175,11.0256215 6.32470652,11.0251861 6.62314967,10.726743 L7.99412289,9.35576976 L9.36263476,10.7242816 C9.66054211,11.022189 10.1450769,11.0217536 10.44352,10.7233105 Z"/></svg></a><div class="container"><input id="search-input" autocomplete="off" type="text" placeholder="Type to search" class="search-input"><div class="search-by">Search by<a href="https://www.algolia.com/" target="_blank"> algolia</a></div><div class="search-results"><div id="search-articles" class="search-item"></div></div></div><script id="search-tmp" type="text/html">{{if list.length}}
    <h3>ARTICLES</h3>
    <ul>
        {{each list item}}
        <li>
            <div class="search-item-title">
                <a href="{{item.permalink}}">{{@item.title}}</a>
            </div>
            <div class="search-item-summary" style="-webkit-box-orient: vertical;">
                {{@item.summary}}
            </div>
        </li>
        {{/each}}
    </ul>
{{else if list}}
    <h2>
        Oops! no result,
        Try it on <a target="_blank" style="color: #2c3e50; border-bottom: 2px solid #42b983; font-size: 19px;" href="https://www.google.com/search?q=site%3Aifyour.github.io+{{keywords}}">Google: {{keywords}}</a>~ ğŸ˜±
    </h2>
{{/if}}</script></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/docs/" target="_self" class="nav-list-link">DOCS</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="javascript:;" target="_self" id="search" class="nav-list-link">SEARCH</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Webpack 4 å®šåˆ¶å‰ç«¯å¼€å‘ç¯å¢ƒ</h1><div class="post-info">Sep 11, 2018</div><div class="sidebar-toc"><span>Catalog</span><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#webpack-æ¦‚å¿µå’ŒåŸºç¡€ä½¿ç”¨"><span class="toc-text">webpack æ¦‚å¿µå’ŒåŸºç¡€ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å®‰è£…å’Œä½¿ç”¨"><span class="toc-text">å®‰è£…å’Œä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack-çš„åŸºæœ¬æ¦‚å¿µ"><span class="toc-text">webpack çš„åŸºæœ¬æ¦‚å¿µ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ­å»ºåŸºç¡€çš„å‰ç«¯å¼€å‘ç¯å¢ƒ"><span class="toc-text">æ­å»ºåŸºç¡€çš„å‰ç«¯å¼€å‘ç¯å¢ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å…³è”-HTML"><span class="toc-text">å…³è” HTML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ„å»º-CSS"><span class="toc-text">æ„å»º CSS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS-é¢„å¤„ç†å™¨"><span class="toc-text">CSS é¢„å¤„ç†å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¤„ç†å›¾ç‰‡æ–‡ä»¶"><span class="toc-text">å¤„ç†å›¾ç‰‡æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä½¿ç”¨-Babel"><span class="toc-text">ä½¿ç”¨ Babel</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¯åŠ¨é™æ€æœåŠ¡"><span class="toc-text">å¯åŠ¨é™æ€æœåŠ¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®Œæ•´ç¤ºä¾‹ä»£ç "><span class="toc-text">å®Œæ•´ç¤ºä¾‹ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webpack-å¦‚ä½•è§£æä»£ç æ¨¡å—è·¯å¾„"><span class="toc-text">webpack å¦‚ä½•è§£æä»£ç æ¨¡å—è·¯å¾„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å¸¸ç”¨çš„ä¸€äº›é…ç½®"><span class="toc-text">å¸¸ç”¨çš„ä¸€äº›é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é…ç½®-loader"><span class="toc-text">é…ç½® loader</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#loader-åŒ¹é…è§„åˆ™"><span class="toc-text">loader åŒ¹é…è§„åˆ™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è§„åˆ™æ¡ä»¶é…ç½®"><span class="toc-text">è§„åˆ™æ¡ä»¶é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä½¿ç”¨-loader-é…ç½®"><span class="toc-text">ä½¿ç”¨ loader é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#loader-åº”ç”¨é¡ºåº"><span class="toc-text">loader åº”ç”¨é¡ºåº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®Œæ•´ä»£ç "><span class="toc-text">å®Œæ•´ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä½¿ç”¨-plugin"><span class="toc-text">ä½¿ç”¨ plugin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DefinePlugin"><span class="toc-text">DefinePlugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#copy-webpack-plugin"><span class="toc-text">copy-webpack-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#extract-text-webpack-plugin"><span class="toc-text">extract-text-webpack-plugin</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ›´å¥½ä½¿ç”¨-webpack-dev-server"><span class="toc-text">æ›´å¥½ä½¿ç”¨ webpack-dev-server</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#åŸºç¡€ä½¿ç”¨"><span class="toc-text">åŸºç¡€ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é…ç½®"><span class="toc-text">é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ„å»ºé…ç½®å·®å¼‚"><span class="toc-text">å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ„å»ºé…ç½®å·®å¼‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#åœ¨é…ç½®æ–‡ä»¶ä¸­åŒºåˆ†-mode"><span class="toc-text">åœ¨é…ç½®æ–‡ä»¶ä¸­åŒºåˆ† mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡"><span class="toc-text">è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¸¸è§çš„ç¯å¢ƒå·®å¼‚é…ç½®"><span class="toc-text">å¸¸è§çš„ç¯å¢ƒå·®å¼‚é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ‹†åˆ†é…ç½®"><span class="toc-text">æ‹†åˆ†é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®Œæ•´ä»£ç -1"><span class="toc-text">å®Œæ•´ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¨¡å—çƒ­æ›¿æ¢æé«˜å¼€å‘æ•ˆç‡"><span class="toc-text">æ¨¡å—çƒ­æ›¿æ¢æé«˜å¼€å‘æ•ˆç‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é…ç½®ä½¿ç”¨-HMR"><span class="toc-text">é…ç½®ä½¿ç”¨ HMR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#module-hot-å¸¸è§çš„-API"><span class="toc-text">module.hot å¸¸è§çš„ API</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å›¾ç‰‡åŠ è½½ä¼˜åŒ–"><span class="toc-text">å›¾ç‰‡åŠ è½½ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS-Sprites"><span class="toc-text">CSS Sprites</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å›¾ç‰‡å‹ç¼©"><span class="toc-text">å›¾ç‰‡å‹ç¼©</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä½¿ç”¨-DataURL"><span class="toc-text">ä½¿ç”¨ DataURL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä»£ç å‹ç¼©"><span class="toc-text">ä»£ç å‹ç¼©</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ†ç¦»ä»£ç æ–‡ä»¶"><span class="toc-text">åˆ†ç¦»ä»£ç æ–‡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack-4-x-çš„-optimization"><span class="toc-text">webpack 4.x çš„ optimization</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack-3-x-çš„-CommonsChunkPlugin"><span class="toc-text">webpack 3.x çš„ CommonsChunkPlugin</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¿›ä¸€æ­¥æ§åˆ¶-JS-å¤§å°"><span class="toc-text">è¿›ä¸€æ­¥æ§åˆ¶ JS å¤§å°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æŒ‰éœ€åŠ è½½æ¨¡å—"><span class="toc-text">æŒ‰éœ€åŠ è½½æ¨¡å—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä»¥ä¸Šå®Œæ•´ç¤ºä¾‹ä»£ç "><span class="toc-text">ä»¥ä¸Šå®Œæ•´ç¤ºä¾‹ä»£ç </span></a></li></ol></li></ol></div><div class="post-content"><p>æœ¬æ–‡æ€»ç»“äº† Webpack 4 çš„ä¸€äº›é…ç½®ç‚¹ï¼Œå¸Œæœ›é€šè¿‡å­¦ä¹ è¿™äº›é…ç½®ç‚¹ï¼Œé™ä½ä½¿ç”¨é—¨æ§›ã€‚çºµè§‚å‰ç«¯çš„æ‰“åŒ…å†å²ï¼Œä¼¼ä¹æ˜¯æ¬ äº†å¤ªå¤šå€ºï¼Œæœ‰å¾ˆå¤šå†å²åŒ…è¢±ï¼Œæ‰€ä»¥å·¥ç¨‹åŒ–è¿™ä¸€å—ä¸€ç›´æ˜¯ä¸€å¤§ç—›ç‚¹ã€‚é…ç½®ç¹çï¼Œå®¹æ˜“å‡ºé”™ï¼Œæœ¬æ–‡æ€»ç»“äº†æœ€æ–°çš„ Webpack 4 åŠŸèƒ½ç‚¹ï¼Œä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹ï¼Œå¯ä»¥ç‚¹å‡»å³ä¾§çš„æ–‡ç« ç›®å½•ç›´è¾¾ã€‚</p>
<a id="more"></a>
<h3 id="webpack-æ¦‚å¿µå’ŒåŸºç¡€ä½¿ç”¨"><a href="#webpack-æ¦‚å¿µå’ŒåŸºç¡€ä½¿ç”¨" class="headerlink" title="webpack æ¦‚å¿µå’ŒåŸºç¡€ä½¿ç”¨"></a>webpack æ¦‚å¿µå’ŒåŸºç¡€ä½¿ç”¨</h3><h4 id="å®‰è£…å’Œä½¿ç”¨"><a href="#å®‰è£…å’Œä½¿ç”¨" class="headerlink" title="å®‰è£…å’Œä½¿ç”¨"></a>å®‰è£…å’Œä½¿ç”¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… webpack</span></span><br><span class="line">$ npm install webpack webpack-cli -g</span><br><span class="line"></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">$ yarn global add webpack webpack-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶åå°±å¯ä»¥å…¨å±€æ‰§è¡Œå‘½ä»¤äº†</span></span><br><span class="line">$ webpack --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>
<h4 id="webpack-çš„åŸºæœ¬æ¦‚å¿µ"><a href="#webpack-çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="webpack çš„åŸºæœ¬æ¦‚å¿µ"></a>webpack çš„åŸºæœ¬æ¦‚å¿µ</h4><blockquote>
<p>webpack æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ‰“åŒ…å·¥å…·ï¼Œå®ƒä¼šæ ¹æ®ä»£ç çš„å†…å®¹è§£ææ¨¡å—ä¾èµ–ï¼Œå¸®åŠ©æˆ‘ä»¬æŠŠå¤šä¸ªæ¨¡å—çš„ä»£ç æ‰“åŒ…</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/15377484/59234564-f1cb0600-8c1f-11e9-8bdf-c6041410225a.png" alt="image"></p>
<blockquote>
<p>webpack ä¼šæŠŠæˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„å¤šä¸ªä»£ç æ¨¡å—ï¼ˆå¯ä»¥æ˜¯ä¸åŒæ–‡ä»¶ç±»å‹ï¼‰ï¼Œæ‰“åŒ…æ„å»ºæˆé¡¹ç›®è¿è¡Œä»…éœ€è¦çš„å‡ ä¸ªé™æ€æ–‡ä»¶</p>
</blockquote>
<p><strong>å…¥å£ï¼ˆentryï¼‰</strong></p>
<blockquote>
<p>å…¥å£å¯ä»¥ä½¿ç”¨ <code>entry</code> å­—æ®µæ¥è¿›è¡Œé…ç½®ï¼Œ<code>webpack</code> æ”¯æŒé…ç½®å¤šä¸ªå…¥å£æ¥è¿›è¡Œæ„å»º</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šè¿°é…ç½®ç­‰åŒäº</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">'./src/index.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…é…ç½®å¤šä¸ªå…¥å£</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    foo: <span class="string">'./src/page-foo.js'</span>,</span><br><span class="line">    bar: <span class="string">'./src/page-bar.js'</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æ•°ç»„æ¥å¯¹å¤šä¸ªæ–‡ä»¶è¿›è¡Œæ‰“åŒ…</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: [<span class="string">'./src/foo.js'</span>, <span class="string">'./src/bar.js'</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>è½¬æ¢å™¨ï¼ˆloaderï¼‰</strong></p>
<blockquote>
<p>å¯ä»¥æŠŠ <code>loader</code> ç†è§£ä¸ºæ˜¯ä¸€ä¸ªè½¬æ¢å™¨ï¼Œè´Ÿè´£æŠŠæŸç§æ–‡ä»¶æ ¼å¼çš„å†…å®¹è½¬æ¢æˆ webpack å¯ä»¥æ”¯æŒæ‰“åŒ…çš„æ¨¡å—</p>
</blockquote>
<ul>
<li>å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒçš„ <code>loader</code> æ¥è§£æå¤„ç†ä¸åŒç±»å‹çš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>module.rules</code> å­—æ®µä¸‹æ¥é…ç½®ç›¸å…³çš„è§„åˆ™ï¼Œä¾‹å¦‚ä½¿ç”¨ <code>Babel</code> æ¥å¤„ç† <code>.js</code> æ–‡ä»¶</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  rules: [</span><br><span class="line">    &#123;</span><br><span class="line">      test: <span class="regexp">/\.jsx?/</span>, <span class="comment">// åŒ¹é…æ–‡ä»¶è·¯å¾„çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯åŒ¹é…æ–‡ä»¶ç±»å‹åç¼€</span></span><br><span class="line">      include: [</span><br><span class="line">        path.resolve(__dirname, <span class="string">'src'</span>) <span class="comment">// æŒ‡å®šå“ªäº›è·¯å¾„ä¸‹çš„æ–‡ä»¶éœ€è¦ç»è¿‡ loader å¤„ç†</span></span><br><span class="line">      ],</span><br><span class="line">      use: <span class="string">'babel-loader'</span>, <span class="comment">// æŒ‡å®šä½¿ç”¨çš„ loader</span></span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ’ä»¶ï¼ˆpluginï¼‰</strong></p>
<blockquote>
<p>æ¨¡å—ä»£ç è½¬æ¢çš„å·¥ä½œç”± <code>loader</code> æ¥å¤„ç†ï¼Œé™¤æ­¤ä¹‹å¤–çš„å…¶ä»–ä»»ä½•å·¥ä½œéƒ½å¯ä»¥äº¤ç”± <code>plugin</code> æ¥å®Œæˆã€‚é€šè¿‡æ·»åŠ æˆ‘ä»¬éœ€è¦çš„ <code>plugin</code>ï¼Œå¯ä»¥æ»¡è¶³æ›´å¤šæ„å»ºä¸­ç‰¹æ®Šçš„éœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨å‹ç¼© <code>JS</code> ä»£ç çš„ <code>uglifyjs-webpack-plugin</code> æ’ä»¶ï¼Œåªéœ€åœ¨é…ç½®ä¸­é€šè¿‡ <code>plugins</code> å­—æ®µæ·»åŠ æ–°çš„ <code>plugin</code> å³å¯â€¦</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UglifyPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [<span class="keyword">new</span> UglifyPlugin()]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>plugin</code> ç†è®ºä¸Šå¯ä»¥å¹²æ¶‰ <code>webpack</code> æ•´ä¸ªæ„å»ºæµç¨‹ï¼Œå¯ä»¥åœ¨æµç¨‹çš„æ¯ä¸€ä¸ªæ­¥éª¤ä¸­å®šåˆ¶è‡ªå·±çš„æ„å»ºéœ€æ±‚</p>
</blockquote>
<p><strong>è¾“å‡ºï¼ˆoutputï¼‰</strong></p>
<blockquote>
<p>æ„å»ºç»“æœçš„æ–‡ä»¶åã€è·¯å¾„ç­‰éƒ½æ˜¯å¯ä»¥é…ç½®çš„ï¼Œä½¿ç”¨ <code>output</code> å­—æ®µ</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…å¤šä¸ªå…¥å£ç”Ÿæˆä¸åŒæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    foo: <span class="string">'./src/foo.js'</span>,</span><br><span class="line">    bar: <span class="string">'./src/bar.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    path: __dirname + <span class="string">'/dist'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯å¾„ä¸­ä½¿ç”¨ hashï¼Œæ¯æ¬¡æ„å»ºæ—¶ä¼šæœ‰ä¸€ä¸ªä¸åŒ hash å€¼ï¼Œé¿å…å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶çº¿ä¸Šä½¿ç”¨æµè§ˆå™¨ç¼“å­˜</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    path: __dirname + <span class="string">'/dist/[hash]'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘ä»¬ä¸€å¼€å§‹ç›´æ¥ä½¿ç”¨ <code>webpack</code> æ„å»ºæ—¶ï¼Œé»˜è®¤åˆ›å»ºçš„è¾“å‡ºå†…å®¹å°±æ˜¯ <code>./dist/main.js</code></p>
</blockquote>
<p><strong>ä¸€ä¸ªç®€å•çš„ webpack é…ç½®</strong></p>
<blockquote>
<p>æˆ‘ä»¬æŠŠä¸Šè¿°æ¶‰åŠçš„å‡ éƒ¨åˆ†é…ç½®å†…å®¹åˆåˆ°ä¸€èµ·ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„ <code>webpack</code> é…ç½®äº†ï¼Œ<code>webpack</code> è¿è¡Œæ—¶é»˜è®¤è¯»å–é¡¹ç›®ä¸‹çš„ <code>webpack.config.js</code> æ–‡ä»¶ä½œä¸ºé…ç½®ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ª <code>webpack.config.js</code> æ–‡ä»¶</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> UglifyPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line"></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        use: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä»£ç æ¨¡å—è·¯å¾„è§£æçš„é…ç½®</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    modules: [<span class="string">'node_modules'</span>, path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line"></span><br><span class="line">    extensions: [<span class="string">'.wasm'</span>, <span class="string">'.mjs'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.jsx'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> UglifyPlugin()</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ uglifyjs-webpack-plugin æ¥å‹ç¼© JS ä»£ç </span></span><br><span class="line">    <span class="comment">// å¦‚æœä½ ç•™æ„äº†æˆ‘ä»¬ä¸€å¼€å§‹ç›´æ¥ä½¿ç”¨ webpack æ„å»ºçš„ç»“æœï¼Œä½ ä¼šå‘ç°é»˜è®¤å·²ç»ä½¿ç”¨äº† JS ä»£ç å‹ç¼©çš„æ’ä»¶</span></span><br><span class="line">    <span class="comment">// è¿™å…¶å®ä¹Ÿæ˜¯æˆ‘ä»¬å‘½ä»¤ä¸­çš„ --mode production çš„æ•ˆæœï¼Œåç»­çš„å°èŠ‚ä¼šä»‹ç» webpack çš„ mode å‚æ•°</span></span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="æ­å»ºåŸºç¡€çš„å‰ç«¯å¼€å‘ç¯å¢ƒ"><a href="#æ­å»ºåŸºç¡€çš„å‰ç«¯å¼€å‘ç¯å¢ƒ" class="headerlink" title="æ­å»ºåŸºç¡€çš„å‰ç«¯å¼€å‘ç¯å¢ƒ"></a>æ­å»ºåŸºç¡€çš„å‰ç«¯å¼€å‘ç¯å¢ƒ</h3><h4 id="å…³è”-HTML"><a href="#å…³è”-HTML" class="headerlink" title="å…³è” HTML"></a>å…³è” HTML</h4><blockquote>
<p><code>webpack</code> é»˜è®¤ä»ä½œä¸ºå…¥å£çš„ <code>.js</code> æ–‡ä»¶è¿›è¡Œæ„å»ºï¼ˆæ›´å¤šæ˜¯åŸºäº <code>SPA</code> å»è€ƒè™‘ï¼‰ï¼Œä½†é€šå¸¸ä¸€ä¸ªå‰ç«¯é¡¹ç›®éƒ½æ˜¯ä»ä¸€ä¸ªé¡µé¢ï¼ˆå³ HTMLï¼‰å‡ºå‘çš„ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ª HTML æ–‡ä»¶ï¼Œä½¿ç”¨ <code>script</code> æ ‡ç­¾ç›´æ¥å¼•ç”¨æ„å»ºå¥½çš„ JS æ–‡ä»¶ï¼Œå¦‚â€¦</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;./dist/bundle.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„æ–‡ä»¶åæˆ–è€…è·¯å¾„ä¼šå˜åŒ–ï¼Œä¾‹å¦‚ä½¿ç”¨ <code>[hash]</code> æ¥è¿›è¡Œå‘½åï¼Œé‚£ä¹ˆæœ€å¥½æ˜¯å°† <code>HTML</code> å¼•ç”¨è·¯å¾„å’Œæˆ‘ä»¬çš„æ„å»ºç»“æœå…³è”èµ·æ¥ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>html-webpack-plugin</code></li>
<li><code>html-webpack-plugin</code> æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ <code>node package</code>ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆå®‰è£…å®ƒï¼ŒæŠŠå®ƒå®‰è£…åˆ°é¡¹ç›®çš„å¼€å‘ä¾èµ–ä¸­</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install html-webpack-plugin -D</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç„¶ååœ¨ <code>webpack</code> é…ç½®ä¸­ï¼Œå°† <code>html-webpack-plugin</code> æ·»åŠ åˆ° <code>plugins</code> åˆ—è¡¨ä¸­</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [<span class="keyword">new</span> HtmlWebpackPlugin()]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·é…ç½®å¥½ä¹‹åï¼Œæ„å»ºæ—¶ <code>html-webpack-plugin</code> ä¼šä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>HTML</code> æ–‡ä»¶ï¼Œå…¶ä¸­ä¼šå¼•ç”¨æ„å»ºå‡ºæ¥çš„ JS æ–‡ä»¶ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œé»˜è®¤åˆ›å»ºçš„ <code>HTML</code> æ–‡ä»¶å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥å†™ <code>HTML</code> æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ <code>html-webpack-plugin</code> çš„é…ç½®ï¼Œä¼ é€’ä¸€ä¸ªå†™å¥½çš„ HTML æ¨¡æ¿â€¦</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>, <span class="comment">// é…ç½®è¾“å‡ºæ–‡ä»¶åå’Œè·¯å¾„</span></span><br><span class="line">      template: <span class="string">'assets/index.html'</span> <span class="comment">// é…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·ï¼Œé€šè¿‡ <code>html-webpack-plugin</code> å°±å¯ä»¥å°†æˆ‘ä»¬çš„é¡µé¢å’Œæ„å»º <code>JS</code> å…³è”èµ·æ¥ï¼Œå›å½’æ—¥å¸¸ï¼Œä»é¡µé¢å¼€å§‹å¼€å‘ã€‚å¦‚æœéœ€è¦æ·»åŠ å¤šä¸ªé¡µé¢å…³è”ï¼Œé‚£ä¹ˆå®ä¾‹åŒ–å¤šä¸ª <code>html-webpack-plugin</code>ï¼Œ å¹¶å°†å®ƒä»¬éƒ½æ”¾åˆ° <code>plugins</code> å­—æ®µæ•°ç»„ä¸­å°±å¯ä»¥äº†â€¦</p>
</blockquote>
<h4 id="æ„å»º-CSS"><a href="#æ„å»º-CSS" class="headerlink" title="æ„å»º CSS"></a>æ„å»º CSS</h4><blockquote>
<p>æˆ‘ä»¬ç¼–å†™ <code>CSS</code>ï¼Œå¹¶ä¸”å¸Œæœ›ä½¿ç”¨ <code>webpack</code> æ¥è¿›è¡Œæ„å»ºï¼Œä¸ºæ­¤ï¼Œéœ€è¦åœ¨é…ç½®ä¸­å¼•å…¥ <code>loader</code> æ¥è§£æå’Œå¤„ç† <code>CSS</code> æ–‡ä»¶</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>css-loader</code> è´Ÿè´£è§£æ <code>CSS</code> ä»£ç ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¤„ç† <code>CSS</code> ä¸­çš„ä¾èµ–ï¼Œä¾‹å¦‚ <code>@import</code> å’Œ <code>url()</code> ç­‰å¼•ç”¨å¤–éƒ¨æ–‡ä»¶çš„å£°æ˜ï¼›</li>
<li><code>style-loader</code> ä¼šå°† <code>css-loader</code> è§£æçš„ç»“æœè½¬å˜æˆ <code>JS</code> ä»£ç ï¼Œè¿è¡Œæ—¶åŠ¨æ€æ’å…¥ <code>style</code> æ ‡ç­¾æ¥è®© <code>CSS</code> ä»£ç ç”Ÿæ•ˆâ€¦</li>
</ul>
<blockquote>
<p>ç»ç”±ä¸Šè¿°ä¸¤ä¸ª <code>loader</code> çš„å¤„ç†åï¼ŒCSS ä»£ç ä¼šè½¬å˜ä¸º JSï¼Œå’Œ <code>index.js</code> ä¸€èµ·æ‰“åŒ…äº†ã€‚å¦‚æœéœ€è¦å•ç‹¬æŠŠ CSS æ–‡ä»¶åˆ†ç¦»å‡ºæ¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>extract-text-webpack-plugin</code> æ’ä»¶</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="comment">// å› ä¸ºè¿™ä¸ªæ’ä»¶éœ€è¦å¹²æ¶‰æ¨¡å—è½¬æ¢çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®ƒå¯¹åº”çš„ loader</span></span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: <span class="string">'css-loader'</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// å¼•å…¥æ’ä»¶ï¼Œé…ç½®æ–‡ä»¶åï¼Œè¿™é‡ŒåŒæ ·å¯ä»¥ä½¿ç”¨ [hash]</span></span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'index.css'</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="CSS-é¢„å¤„ç†å™¨"><a href="#CSS-é¢„å¤„ç†å™¨" class="headerlink" title="CSS é¢„å¤„ç†å™¨"></a>CSS é¢„å¤„ç†å™¨</h4><blockquote>
<p>åœ¨ä¸Šè¿°ä½¿ç”¨ CSS çš„åŸºç¡€ä¸Šï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ <code>Less/Sass</code> ç­‰ CSS é¢„å¤„ç†å™¨ï¼Œwebpack å¯ä»¥é€šè¿‡æ·»åŠ å¯¹åº”çš„ <code>loader</code> æ¥æ”¯æŒï¼Œä»¥ä½¿ç”¨ <code>Less</code> ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ°å¯¹åº”çš„ <code>loader</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        <span class="comment">// å› ä¸ºè¿™ä¸ªæ’ä»¶éœ€è¦å¹²æ¶‰æ¨¡å—è½¬æ¢çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®ƒå¯¹åº”çš„ loader</span></span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: [<span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="å¤„ç†å›¾ç‰‡æ–‡ä»¶"><a href="#å¤„ç†å›¾ç‰‡æ–‡ä»¶" class="headerlink" title="å¤„ç†å›¾ç‰‡æ–‡ä»¶"></a>å¤„ç†å›¾ç‰‡æ–‡ä»¶</h4><blockquote>
<p>åœ¨å‰ç«¯é¡¹ç›®çš„æ ·å¼ä¸­æ€»ä¼šä½¿ç”¨åˆ°å›¾ç‰‡ï¼Œè™½ç„¶æˆ‘ä»¬å·²ç»æåˆ° <code>css-loader</code> ä¼šè§£ææ ·å¼ä¸­ç”¨ <code>url()</code> å¼•ç”¨çš„æ–‡ä»¶è·¯å¾„ï¼Œä½†æ˜¯å›¾ç‰‡å¯¹åº”çš„ <code>jpg/png/gif</code> ç­‰æ–‡ä»¶æ ¼å¼ï¼Œ<code>webpack</code> å¤„ç†ä¸äº†ã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬åªè¦æ·»åŠ ä¸€ä¸ªå¤„ç†å›¾ç‰‡çš„ <code>loader</code> é…ç½®å°±å¯ä»¥äº†ï¼Œç°æœ‰çš„ <code>file-loader</code> å°±æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©â€¦</p>
</blockquote>
<ul>
<li><code>file-loader</code> å¯ä»¥ç”¨äºå¤„ç†å¾ˆå¤šç±»å‹çš„æ–‡ä»¶ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç›´æ¥è¾“å‡ºæ–‡ä»¶ï¼ŒæŠŠæ„å»ºåçš„æ–‡ä»¶è·¯å¾„è¿”å›ã€‚é…ç½®å¾ˆç®€å•ï¼Œåœ¨ <code>rules</code> ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œå¢åŠ å›¾ç‰‡ç±»å‹æ–‡ä»¶çš„è§£æé…ç½®</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'file-loader'</span>,</span><br><span class="line">            options: &#123;&#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨-Babel"><a href="#ä½¿ç”¨-Babel" class="headerlink" title="ä½¿ç”¨ Babel"></a>ä½¿ç”¨ Babel</h4><blockquote>
<p><code>Babel</code> æ˜¯ä¸€ä¸ªè®©æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ <code>ES</code> æ–°ç‰¹æ€§çš„ <code>JS</code> ç¼–è¯‘å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>webpack</code> ä¸­é…ç½® Babelï¼Œä»¥ä¾¿ä½¿ç”¨ <code>ES6</code>ã€<code>ES7</code> æ ‡å‡†æ¥ç¼–å†™ <code>JS</code> ä»£ç </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?/</span>, <span class="comment">// æ”¯æŒ js å’Œ jsx</span></span><br><span class="line">        include: [</span><br><span class="line">          path.resolve(__dirname, <span class="string">'src'</span>) <span class="comment">// src ç›®å½•ä¸‹çš„æ‰éœ€è¦ç»è¿‡ babel-loader å¤„ç†</span></span><br><span class="line">        ],</span><br><span class="line">        loader: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="å¯åŠ¨é™æ€æœåŠ¡"><a href="#å¯åŠ¨é™æ€æœåŠ¡" class="headerlink" title="å¯åŠ¨é™æ€æœåŠ¡"></a>å¯åŠ¨é™æ€æœåŠ¡</h4><blockquote>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å¤„ç†å¤šç§æ–‡ä»¶ç±»å‹çš„ webpack é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>webpack-dev-server</code> åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªç®€å•çš„é™æ€æœåŠ¡æ¥è¿›è¡Œå¼€å‘</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"build"</span>: <span class="string">"webpack --mode production"</span>,</span><br><span class="line">  <span class="string">"start"</span>: <span class="string">"webpack-dev-server --mode development"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å°è¯•ç€è¿è¡Œ <code>npm start</code> æˆ–è€… <code>yarn start</code>ï¼Œç„¶åå°±å¯ä»¥è®¿é—® <code>http://localhost:8080/</code> æ¥æŸ¥çœ‹ä½ çš„é¡µé¢äº†ã€‚é»˜è®¤æ˜¯è®¿é—® <code>index.html</code>ï¼Œå¦‚æœæ˜¯å…¶ä»–é¡µé¢è¦æ³¨æ„è®¿é—®çš„ URL æ˜¯å¦æ­£ç¡®</p>
</blockquote>
<h4 id="å®Œæ•´ç¤ºä¾‹ä»£ç "><a href="#å®Œæ•´ç¤ºä¾‹ä»£ç " class="headerlink" title="å®Œæ•´ç¤ºä¾‹ä»£ç "></a>å®Œæ•´ç¤ºä¾‹ä»£ç </h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line"></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].js'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        use: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        <span class="comment">// å› ä¸ºè¿™ä¸ªæ’ä»¶éœ€è¦å¹²æ¶‰æ¨¡å—è½¬æ¢çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®ƒå¯¹åº”çš„ loader</span></span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: [<span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'file-loader'</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä»£ç æ¨¡å—è·¯å¾„è§£æçš„é…ç½®</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    modules: [<span class="string">'node_modules'</span>, path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line"></span><br><span class="line">    extensions: [<span class="string">'.wasm'</span>, <span class="string">'.mjs'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.jsx'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>, <span class="comment">// é…ç½®è¾“å‡ºæ–‡ä»¶åå’Œè·¯å¾„</span></span><br><span class="line">      template: <span class="string">'src/index.html'</span> <span class="comment">// é…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].css'</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="webpack-å¦‚ä½•è§£æä»£ç æ¨¡å—è·¯å¾„"><a href="#webpack-å¦‚ä½•è§£æä»£ç æ¨¡å—è·¯å¾„" class="headerlink" title="webpack å¦‚ä½•è§£æä»£ç æ¨¡å—è·¯å¾„"></a>webpack å¦‚ä½•è§£æä»£ç æ¨¡å—è·¯å¾„</h3><blockquote>
<p>webpack ä¸­æœ‰ä¸€ä¸ªå¾ˆå…³é”®çš„æ¨¡å— <code>enhanced-resolve</code> å°±æ˜¯å¤„ç†ä¾èµ–æ¨¡å—è·¯å¾„çš„è§£æçš„ï¼Œè¿™ä¸ªæ¨¡å—å¯ä»¥è¯´æ˜¯ Node.js é‚£ä¸€å¥—æ¨¡å—è·¯å¾„è§£æçš„å¢å¼ºç‰ˆæœ¬ï¼Œæœ‰å¾ˆå¤šå¯ä»¥è‡ªå®šä¹‰çš„è§£æé…ç½®</p>
</blockquote>
<ul>
<li>åœ¨ webpack é…ç½®ä¸­ï¼Œå’Œæ¨¡å—è·¯å¾„è§£æç›¸å…³çš„é…ç½®éƒ½åœ¨ <code>resolve</code> å­—æ®µä¸‹</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="å¸¸ç”¨çš„ä¸€äº›é…ç½®"><a href="#å¸¸ç”¨çš„ä¸€äº›é…ç½®" class="headerlink" title="å¸¸ç”¨çš„ä¸€äº›é…ç½®"></a>å¸¸ç”¨çš„ä¸€äº›é…ç½®</h4><p><strong>resolve.alias</strong></p>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸ª <code>utils</code> æ¨¡å—æå…¶å¸¸ç”¨ï¼Œç»å¸¸ç¼–å†™ç›¸å¯¹è·¯å¾„å¾ˆéº»çƒ¦ï¼Œå¸Œæœ›å¯ä»¥ç›´æ¥ <code>import &#39;utils&#39;</code> æ¥å¼•ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é…ç½®æŸä¸ªæ¨¡å—çš„åˆ«åï¼Œå¦‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alias: &#123;</span><br><span class="line">  utils: path.resolve(__dirname, <span class="string">'src/utils'</span>); <span class="comment">// è¿™é‡Œä½¿ç”¨ path.resolve å’Œ __dirname æ¥è·å–ç»å¯¹è·¯å¾„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šè¿°çš„é…ç½®æ˜¯æ¨¡ç³ŠåŒ¹é…ï¼Œæ„å‘³ç€åªè¦æ¨¡å—è·¯å¾„ä¸­æºå¸¦äº† utils å°±å¯ä»¥è¢«æ›¿æ¢æ‰ï¼Œå¦‚ï¼š</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos;utils/query.js&apos; // ç­‰åŒäº import &apos;[é¡¹ç›®ç»å¯¹è·¯å¾„]/src/utils/query.js&apos;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœéœ€è¦è¿›è¡Œç²¾ç¡®åŒ¹é…å¯ä»¥ä½¿ç”¨ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alias: &#123;</span><br><span class="line">  utils$: path.resolve(__dirname, <span class="string">'src/utils'</span>); <span class="comment">// åªä¼šåŒ¹é… import 'utils'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>resolve.extensions</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">extensions: [<span class="string">'.wasm'</span>, <span class="string">'.mjs'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.jsx'</span>],</span><br><span class="line"><span class="comment">// è¿™é‡Œçš„é¡ºåºä»£è¡¨åŒ¹é…åç¼€çš„ä¼˜å…ˆçº§ï¼Œä¾‹å¦‚å¯¹äº index.js å’Œ index.jsxï¼Œä¼šä¼˜å…ˆé€‰æ‹© index.js</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ä¸ªé…ç½®çš„ä½œç”¨æ˜¯å’Œæ–‡ä»¶åç¼€åæœ‰å…³çš„, è¿™ä¸ªé…ç½®å¯ä»¥å®šä¹‰åœ¨è¿›è¡Œæ¨¡å—è·¯å¾„è§£ææ—¶ï¼Œwebpack ä¼šå°è¯•å¸®ä½ è¡¥å…¨é‚£äº›åç¼€åæ¥è¿›è¡ŒæŸ¥æ‰¾</p>
</blockquote>
<h3 id="é…ç½®-loader"><a href="#é…ç½®-loader" class="headerlink" title="é…ç½® loader"></a>é…ç½® loader</h3><h4 id="loader-åŒ¹é…è§„åˆ™"><a href="#loader-åŒ¹é…è§„åˆ™" class="headerlink" title="loader åŒ¹é…è§„åˆ™"></a>loader åŒ¹é…è§„åˆ™</h4><blockquote>
<p>å½“æˆ‘ä»¬éœ€è¦é…ç½® <code>loader</code> æ—¶ï¼Œéƒ½æ˜¯åœ¨ <code>module.rules</code> ä¸­æ·»åŠ æ–°çš„é…ç½®é¡¹ï¼Œåœ¨è¯¥å­—æ®µä¸­ï¼Œæ¯ä¸€é¡¹è¢«è§†ä¸ºä¸€æ¡åŒ¹é…ä½¿ç”¨ <code>loader</code> çš„è§„åˆ™</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?/</span>, <span class="comment">// æ¡ä»¶</span></span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)], <span class="comment">// æ¡ä»¶</span></span><br><span class="line">        use: <span class="string">'babel-loader'</span> <span class="comment">// è§„åˆ™åº”ç”¨ç»“æœ</span></span><br><span class="line">      &#125; <span class="comment">// ä¸€ä¸ª object å³ä¸€æ¡è§„åˆ™</span></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>loader</code> çš„åŒ¹é…è§„åˆ™ä¸­æœ‰ä¸¤ä¸ªæœ€å…³é”®çš„å› ç´ ï¼šä¸€ä¸ªæ˜¯åŒ¹é…æ¡ä»¶ï¼Œä¸€ä¸ªæ˜¯åŒ¹é…è§„åˆ™åçš„åº”ç”¨</p>
</blockquote>
<h4 id="è§„åˆ™æ¡ä»¶é…ç½®"><a href="#è§„åˆ™æ¡ä»¶é…ç½®" class="headerlink" title="è§„åˆ™æ¡ä»¶é…ç½®"></a>è§„åˆ™æ¡ä»¶é…ç½®</h4><blockquote>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé…ç½® <code>loader</code> çš„åŒ¹é…æ¡ä»¶æ—¶ï¼Œåªè¦ä½¿ç”¨ <code>test</code> å­—æ®µå°±å¥½äº†ï¼Œå¾ˆå¤šæ—¶å€™éƒ½åªéœ€è¦åŒ¹é…æ–‡ä»¶åç¼€åæ¥å†³å®šä½¿ç”¨ä»€ä¹ˆ <code>loader</code>ï¼Œä½†ä¹Ÿä¸æ’é™¤åœ¨æŸäº›ç‰¹æ®Šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®æ¯”è¾ƒå¤æ‚çš„åŒ¹é…æ¡ä»¶ã€‚webpack çš„è§„åˆ™æä¾›äº†å¤šç§é…ç½®å½¢å¼â€¦</p>
</blockquote>
<ul>
<li><code>{test: ...}</code> åŒ¹é…ç‰¹å®šæ¡ä»¶</li>
<li><code>{include: ...}</code> åŒ¹é…ç‰¹å®šè·¯å¾„</li>
<li><code>{exclude: ...}</code> æ’é™¤ç‰¹å®šè·¯å¾„</li>
<li><code>{and: [...] }</code> å¿…é¡»åŒ¹é…æ•°ç»„ä¸­æ‰€æœ‰æ¡ä»¶</li>
<li><code>{or: [...] }</code> åŒ¹é…æ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªæ¡ä»¶</li>
<li><code>{not: [...] }</code> æ’é™¤åŒ¹é…æ•°ç»„ä¸­æ‰€æœ‰æ¡ä»¶â€¦</li>
</ul>
<blockquote>
<p>ä¸Šè¿°çš„æ‰€è°“æ¡ä»¶çš„å€¼å¯ä»¥æ˜¯ï¼š</p>
</blockquote>
<ul>
<li>å­—ç¬¦ä¸²ï¼šå¿…é¡»ä»¥æä¾›çš„å­—ç¬¦ä¸²å¼€å§‹ï¼Œæ‰€ä»¥æ˜¯å­—ç¬¦ä¸²çš„è¯ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æä¾›ç»å¯¹è·¯å¾„</li>
<li>æ­£åˆ™è¡¨è¾¾å¼ï¼šè°ƒç”¨æ­£åˆ™çš„ <code>test</code> æ–¹æ³•æ¥åˆ¤æ–­åŒ¹é…</li>
<li>å‡½æ•°ï¼š<code>(path) =&gt; boolean</code>ï¼Œè¿”å› <code>true</code> è¡¨ç¤ºåŒ¹é…</li>
<li>æ•°ç»„ï¼šè‡³å°‘åŒ…å«ä¸€ä¸ªæ¡ä»¶çš„æ•°ç»„</li>
<li>å¯¹è±¡ï¼šåŒ¹é…æ‰€æœ‰å±æ€§å€¼çš„æ¡ä»¶â€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: <span class="regexp">/\.jsx?/</span>, <span class="comment">// æ­£åˆ™</span></span><br><span class="line">    include: [</span><br><span class="line">      path.resolve(__dirname, <span class="string">'src'</span>), <span class="comment">// å­—ç¬¦ä¸²ï¼Œæ³¨æ„æ˜¯ç»å¯¹è·¯å¾„</span></span><br><span class="line">    ], <span class="comment">// æ•°ç»„</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    test: &#123;</span><br><span class="line">      js: <span class="regexp">/\.js/</span>,</span><br><span class="line">      jsx: <span class="regexp">/\.jsx/</span>,</span><br><span class="line">    &#125;, <span class="comment">// å¯¹è±¡ï¼Œä¸å»ºè®®ä½¿ç”¨</span></span><br><span class="line">    not: [</span><br><span class="line">      (value) =&gt; &#123; <span class="comment">/* ... */</span> <span class="keyword">return</span> <span class="literal">true</span>; &#125;, <span class="comment">// å‡½æ•°ï¼Œé€šå¸¸éœ€è¦é«˜åº¦è‡ªå®šä¹‰æ—¶æ‰ä¼šä½¿ç”¨</span></span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨-loader-é…ç½®"><a href="#ä½¿ç”¨-loader-é…ç½®" class="headerlink" title="ä½¿ç”¨ loader é…ç½®"></a>ä½¿ç”¨ loader é…ç½®</h4><blockquote>
<p><code>module.rules</code> çš„åŒ¹é…è§„åˆ™æœ€é‡è¦çš„è¿˜æ˜¯ç”¨äºé…ç½® <code>loader</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>use</code> å­—æ®µ</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: <span class="regexp">/\.less/</span>,</span><br><span class="line">    use: [</span><br><span class="line">      <span class="string">'style-loader'</span>, <span class="comment">// ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²è¡¨ç¤º loader</span></span><br><span class="line">      &#123;</span><br><span class="line">        loader: <span class="string">'css-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          importLoaders: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;, <span class="comment">// ç”¨å¯¹è±¡è¡¨ç¤º loaderï¼Œå¯ä»¥ä¼ é€’ loader é…ç½®ç­‰</span></span><br><span class="line">      &#123;</span><br><span class="line">        loader: <span class="string">'less-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          noIeCompat: <span class="literal">true</span></span><br><span class="line">        &#125;, <span class="comment">// ä¼ é€’ loader é…ç½®</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>use</code> å­—æ®µå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…è¡¨ç¤º <code>loader</code> çš„å¯¹è±¡ã€‚å¦‚æœåªéœ€è¦ä¸€ä¸ª <code>loader</code>ï¼Œä¹Ÿå¯ä»¥è¿™æ ·ï¼š<code>use: {loader: &#39;babel-loader&#39;</code>, <code>options: { ...} }</code></p>
</blockquote>
<h4 id="loader-åº”ç”¨é¡ºåº"><a href="#loader-åº”ç”¨é¡ºåº" class="headerlink" title="loader åº”ç”¨é¡ºåº"></a>loader åº”ç”¨é¡ºåº</h4><ul>
<li>å¯¹äºä¸Šé¢çš„ <code>less</code> è§„åˆ™é…ç½®ï¼Œä¸€ä¸ª <code>style.less</code> æ–‡ä»¶ä¼šé€”å¾„ <code>less-loader</code>ã€<code>css-loader</code>ã€<code>style-loader</code> å¤„ç†ï¼Œæˆä¸ºä¸€ä¸ªå¯ä»¥æ‰“åŒ…çš„æ¨¡å—ã€‚</li>
<li><code>loader</code> çš„åº”ç”¨é¡ºåºåœ¨é…ç½®å¤šä¸ª <code>loader</code> ä¸€èµ·å·¥ä½œæ—¶å¾ˆé‡è¦ï¼Œé€šå¸¸ä¼šä½¿ç”¨åœ¨ CSS é…ç½®ä¸Šï¼Œé™¤äº† <code>style-loader</code> å’Œ <code>css-loader</code>ï¼Œä½ å¯èƒ½è¿˜è¦é…ç½® <code>less-loader</code> ç„¶åå†åŠ ä¸ª <code>postcss</code> çš„ <code>autoprefixer</code> ç­‰ã€‚</li>
<li>ä¸Šè¿°ä»ååˆ°å‰çš„é¡ºåºæ˜¯åœ¨åŒä¸€ä¸ª <code>rule</code> ä¸­è¿›è¡Œçš„ï¼Œé‚£å¦‚æœå¤šä¸ª <code>rule</code> åŒ¹é…äº†åŒä¸€ä¸ªæ¨¡å—æ–‡ä»¶ï¼Œ<code>loader</code> çš„åº”ç”¨é¡ºåºåˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿçœ‹ä¸€ä»½è¿™æ ·çš„é…ç½®â€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">    loader: <span class="string">"eslint-loader"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">    loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·æ— æ³•æ³•ä¿è¯ <code>eslint-loader</code> åœ¨ <code>babel-loader</code> åº”ç”¨å‰æ‰§è¡Œã€‚<code>webpack</code> åœ¨ <code>rules</code> ä¸­æä¾›äº†ä¸€ä¸ª <code>enforce</code> çš„å­—æ®µæ¥é…ç½®å½“å‰ <code>rule</code> çš„ <code>loader</code> ç±»å‹ï¼Œæ²¡é…ç½®çš„è¯æ˜¯æ™®é€šç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½® <code>pre</code> æˆ– <code>post</code>ï¼Œåˆ†åˆ«å¯¹åº”å‰ç½®ç±»å‹æˆ–åç½®ç±»å‹çš„ <code>loader</code>â€¦</p>
</blockquote>
<ul>
<li>æ‰€æœ‰çš„ <code>loader</code> æŒ‰ç…§ <strong>å‰ç½®</strong> -&gt; <strong>è¡Œå†…</strong> -&gt; <strong>æ™®é€š</strong> -&gt; <strong>åç½®</strong> çš„é¡ºåºæ‰§è¡Œã€‚æ‰€ä»¥å½“æˆ‘ä»¬è¦ç¡®ä¿ <code>eslint-loader</code> åœ¨ <code>babel-loader</code> ä¹‹å‰æ‰§è¡Œæ—¶ï¼Œå¯ä»¥å¦‚ä¸‹æ·»åŠ  <code>enforce</code> é…ç½®</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    enforce: <span class="string">'pre'</span>, <span class="comment">// æŒ‡å®šä¸ºå‰ç½®ç±»å‹</span></span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">    loader: <span class="string">"eslint-loader"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“é¡¹ç›®æ–‡ä»¶ç±»å‹å’Œåº”ç”¨çš„ <code>loader</code> ä¸æ˜¯ç‰¹åˆ«å¤æ‚çš„æ—¶å€™ï¼Œé€šå¸¸å»ºè®®æŠŠè¦åº”ç”¨çš„åŒä¸€ç±»å‹ <code>loader</code> éƒ½å†™åœ¨åŒä¸€ä¸ªåŒ¹é…è§„åˆ™ä¸­ï¼Œè¿™æ ·æ›´å¥½ç»´æŠ¤å’Œæ§åˆ¶</p>
</blockquote>
<h4 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index'</span>,</span><br><span class="line"></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].js'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        enforce: <span class="string">'pre'</span>, <span class="comment">// æŒ‡å®šä¸ºå‰ç½®ç±»å‹</span></span><br><span class="line">        test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="string">'eslint-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        use: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: [<span class="string">'css-loader'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: [<span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'file-loader'</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      utils: path.resolve(__dirname, <span class="string">'src/utils'</span>), <span class="comment">// è¿™é‡Œä½¿ç”¨ path.resolve å’Œ __dirname æ¥è·å–ç»å¯¹è·¯å¾„</span></span><br><span class="line">      log$: path.resolve(__dirname, <span class="string">'src/utils/log.js'</span>) <span class="comment">// åªåŒ¹é… log</span></span><br><span class="line">    &#125;,</span><br><span class="line">    extensions: [<span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.jsx'</span>, <span class="string">'.css'</span>, <span class="string">'.less'</span>],</span><br><span class="line">    modules: [</span><br><span class="line">      path.resolve(__dirname, <span class="string">'node_modules'</span>) <span class="comment">// æŒ‡å®šå½“å‰ç›®å½•ä¸‹çš„ node_modules ä¼˜å…ˆæŸ¥æ‰¾</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>, <span class="comment">// é…ç½®è¾“å‡ºæ–‡ä»¶åå’Œè·¯å¾„</span></span><br><span class="line">      template: <span class="string">'src/index.html'</span> <span class="comment">// é…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].css'</span>),</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      TWO: <span class="string">'1+1'</span>,</span><br><span class="line">      CONSTANTS: &#123;</span><br><span class="line">        APP_VERSION: <span class="built_in">JSON</span>.stringify(<span class="string">'1.1.2'</span>) <span class="comment">// const CONSTANTS = &#123; APP_VERSION: '1.1.2' &#125;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'src/assets/favicon.ico'</span>, <span class="attr">to</span>: <span class="string">'favicon.ico'</span> &#125; <span class="comment">// é¡¾åæ€ä¹‰ï¼Œfrom é…ç½®æ¥æºï¼Œto é…ç½®ç›®æ ‡è·¯å¾„</span></span><br><span class="line">    ]),</span><br><span class="line">    <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">      _: <span class="string">'lodash'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    port: <span class="string">'1234'</span>,</span><br><span class="line">    before(app) &#123;</span><br><span class="line">      app.get(<span class="string">'/api/test.json'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// å½“è®¿é—® /some/path è·¯å¾„æ—¶ï¼Œè¿”å›è‡ªå®šä¹‰çš„ json æ•°æ®</span></span><br><span class="line">        res.json(&#123; <span class="attr">code</span>: <span class="number">200</span>, <span class="attr">message</span>: <span class="string">'hello world'</span> &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-plugin"><a href="#ä½¿ç”¨-plugin" class="headerlink" title="ä½¿ç”¨ plugin"></a>ä½¿ç”¨ plugin</h3><blockquote>
<p>æ›´å¤šçš„æ’ä»¶å¯ä»¥åœ¨è¿™é‡ŒæŸ¥æ‰¾ï¼š<a href="https://github.com/webpack-contrib/awesome-webpack#webpack-plugins" target="_blank" rel="noopener">plugins in awesome-webpack</a></p>
</blockquote>
<h4 id="DefinePlugin"><a href="#DefinePlugin" class="headerlink" title="DefinePlugin"></a>DefinePlugin</h4><blockquote>
<p><code>DefinePlugin</code> æ˜¯ <code>webpack</code> å†…ç½®çš„æ’ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>webpack.DefinePlugin</code> ç›´æ¥è·å–</p>
</blockquote>
<ul>
<li>è¿™ä¸ªæ’ä»¶ç”¨äºåˆ›å»ºä¸€äº›åœ¨ç¼–è¯‘æ—¶å¯ä»¥é…ç½®çš„å…¨å±€å¸¸é‡ï¼Œè¿™äº›å¸¸é‡çš„å€¼æˆ‘ä»¬å¯ä»¥åœ¨ <code>webpack</code> çš„é…ç½®ä¸­å»æŒ‡å®šï¼Œä¾‹å¦‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      PRODUCTION: <span class="built_in">JSON</span>.stringify(<span class="literal">true</span>), <span class="comment">// const PRODUCTION = true</span></span><br><span class="line">      VERSION: <span class="built_in">JSON</span>.stringify(<span class="string">'5fa3b9'</span>), <span class="comment">// const VERSION = '5fa3b9'</span></span><br><span class="line">      BROWSER_SUPPORTS_HTML5: <span class="literal">true</span>, <span class="comment">// const BROWSER_SUPPORTS_HTML5 = 'true'</span></span><br><span class="line">      TWO: <span class="string">'1+1'</span>, <span class="comment">// const TWO = 1 + 1,</span></span><br><span class="line">      CONSTANTS: &#123;</span><br><span class="line">        APP_VERSION: <span class="built_in">JSON</span>.stringify(<span class="string">'1.1.2'</span>) <span class="comment">// const CONSTANTS = &#123; APP_VERSION: '1.1.2' &#125;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æœ‰äº†ä¸Šé¢çš„é…ç½®ï¼Œå°±å¯ä»¥åœ¨åº”ç”¨ä»£ç æ–‡ä»¶ä¸­ï¼Œè®¿é—®é…ç½®å¥½çš„å˜é‡äº†ï¼Œå¦‚ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'Running App version'</span> + VERSION);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!BROWSER_SUPPORTS_HTML5) <span class="built_in">require</span>(<span class="string">'html5shiv'</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šé¢é…ç½®çš„æ³¨é‡Šå·²ç»ç®€å•è¯´æ˜äº†è¿™äº›é…ç½®çš„æ•ˆæœï¼Œè¿™é‡Œå†ç®€è¿°ä¸€ä¸‹æ•´ä¸ªé…ç½®è§„åˆ™ã€‚</p>
</blockquote>
<ul>
<li>å¦‚æœé…ç½®çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ•´ä¸ªå­—ç¬¦ä¸²ä¼šè¢«å½“æˆä»£ç ç‰‡æ®µæ¥æ‰§è¡Œï¼Œå…¶ç»“æœä½œä¸ºæœ€ç»ˆå˜é‡çš„å€¼ï¼Œå¦‚ä¸Šé¢çš„ <code>&quot;1+1&quot;</code>ï¼Œæœ€åçš„ç»“æœæ˜¯ <code>2</code></li>
<li>å¦‚æœé…ç½®çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡ï¼Œé‚£ä¹ˆè¯¥å€¼ä¼šè¢«è½¬ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ <code>true</code>ï¼Œæœ€åçš„ç»“æœæ˜¯ <code>&#39;true&#39;</code></li>
<li>å¦‚æœé…ç½®çš„æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡çš„æ‰€æœ‰ <code>key</code> ä¼šä»¥åŒæ ·çš„æ–¹å¼å»å®šä¹‰</li>
<li>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ <code>JSON.stringify()</code> äº†ï¼Œå› ä¸º <code>JSON.stringify(true)</code> çš„ç»“æœæ˜¯ <code>&#39;true&#39;</code>ï¼Œ<code>JSON.stringify(&quot;5fa3b9&quot;)</code> çš„ç»“æœæ˜¯ <code>&quot;5fa3b9&quot;</code>ã€‚</li>
</ul>
<blockquote>
<p>ç¤¾åŒºä¸­å…³äº <code>DefinePlugin</code> ä½¿ç”¨å¾—æœ€å¤šçš„æ–¹å¼æ˜¯å®šä¹‰ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ <code>PRODUCTION = true</code> æˆ–è€… <code>__DEV__ = true</code> ç­‰ã€‚éƒ¨åˆ†ç±»åº“åœ¨å¼€å‘ç¯å¢ƒæ—¶ä¾èµ–è¿™æ ·çš„ç¯å¢ƒå˜é‡æ¥ç»™äºˆå¼€å‘è€…æ›´å¤šçš„å¼€å‘è°ƒè¯•åé¦ˆï¼Œä¾‹å¦‚ react ç­‰ã€‚</p>
</blockquote>
<ul>
<li>å»ºè®®ä½¿ç”¨ <code>process.env.NODE_ENV</code>: â€¦ çš„æ–¹å¼æ¥å®šä¹‰ <code>process.env.NODE_ENV</code>ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>process: {env: { NODE_ENV: ...} }</code> çš„æ–¹å¼ï¼Œå› ä¸ºè¿™æ ·ä¼šè¦†ç›–æ‰ <code>process</code> è¿™ä¸ªå¯¹è±¡ï¼Œå¯èƒ½ä¼šå¯¹å…¶ä»–ä»£ç é€ æˆå½±å“â€¦</li>
</ul>
<h4 id="copy-webpack-plugin"><a href="#copy-webpack-plugin" class="headerlink" title="copy-webpack-plugin"></a>copy-webpack-plugin</h4><blockquote>
<p>æˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠå¼€å‘çš„æ‰€æœ‰æºç å’Œèµ„æºæ–‡ä»¶æ”¾åœ¨ <code>src/</code> ç›®å½•ä¸‹ï¼Œæ„å»ºçš„æ—¶å€™äº§å‡ºä¸€ä¸ª <code>build/</code> ç›®å½•ï¼Œé€šå¸¸ä¼šç›´æ¥æ‹¿ <code>build</code> ä¸­çš„æ‰€æœ‰æ–‡ä»¶æ¥å‘å¸ƒã€‚æœ‰äº›æ–‡ä»¶æ²¡ç»è¿‡ <code>webpack</code> å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›å®ƒä»¬ä¹Ÿèƒ½å‡ºç°åœ¨ <code>build</code> ç›®å½•ä¸‹ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ <code>CopyWebpackPlugin</code> æ¥å¤„ç†äº†â€¦</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'src/file.txt'</span>, <span class="attr">to</span>: <span class="string">'build/file.txt'</span> &#125;, <span class="comment">// é¡¾åæ€ä¹‰ï¼Œfrom é…ç½®æ¥æºï¼Œto é…ç½®ç›®æ ‡è·¯å¾„</span></span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'src/*.ico'</span>, <span class="attr">to</span>: <span class="string">'build/*.ico'</span> &#125; <span class="comment">// é…ç½®é¡¹å¯ä»¥ä½¿ç”¨ glob</span></span><br><span class="line">      <span class="comment">// å¯ä»¥é…ç½®å¾ˆå¤šé¡¹å¤åˆ¶è§„åˆ™</span></span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="extract-text-webpack-plugin"><a href="#extract-text-webpack-plugin" class="headerlink" title="extract-text-webpack-plugin"></a>extract-text-webpack-plugin</h4><blockquote>
<p>æˆ‘ä»¬ç”¨å®ƒæ¥æŠŠä¾èµ–çš„ <code>CSS</code> åˆ†ç¦»å‡ºæ¥æˆä¸ºå•ç‹¬çš„æ–‡ä»¶ã€‚è¿™é‡Œå†çœ‹ä¸€ä¸‹ä½¿ç”¨ <code>extract-text-webpack-plugin</code> çš„é…ç½®</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="comment">// å› ä¸ºè¿™ä¸ªæ’ä»¶éœ€è¦å¹²æ¶‰æ¨¡å—è½¬æ¢çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®ƒå¯¹åº”çš„ loader</span></span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: <span class="string">'css-loader'</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// å¼•å…¥æ’ä»¶ï¼Œé…ç½®æ–‡ä»¶åï¼Œè¿™é‡ŒåŒæ ·å¯ä»¥ä½¿ç”¨ [hash]</span></span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'index.css'</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ä¸Šè¿°çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>index.css</code> ä½œä¸ºå•ç‹¬åˆ†ç¦»å‡ºæ¥çš„æ–‡ä»¶åï¼Œä½†æœ‰çš„æ—¶å€™æ„å»ºå…¥å£ä¸æ­¢ä¸€ä¸ªï¼Œ<code>extract-text-webpack-plugin</code> ä¼šä¸ºæ¯ä¸€ä¸ªå…¥å£åˆ›å»ºå•ç‹¬åˆ†ç¦»çš„æ–‡ä»¶ï¼Œå› æ­¤æœ€å¥½è¿™æ ·é…ç½®</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™æ ·ç¡®ä¿åœ¨ä½¿ç”¨å¤šä¸ªæ„å»ºå…¥å£æ—¶ï¼Œç”Ÿæˆä¸åŒåç§°çš„æ–‡ä»¶</span></span><br><span class="line">plugins: [</span><br><span class="line">  <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].css'</span>),</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<h3 id="æ›´å¥½ä½¿ç”¨-webpack-dev-server"><a href="#æ›´å¥½ä½¿ç”¨-webpack-dev-server" class="headerlink" title="æ›´å¥½ä½¿ç”¨ webpack-dev-server"></a>æ›´å¥½ä½¿ç”¨ webpack-dev-server</h3><blockquote>
<p><code>webpack-dev-server</code> æ˜¯ <code>webpack</code> å®˜æ–¹æä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥åŸºäºå½“å‰çš„ <code>webpack</code> æ„å»ºé…ç½®å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªé™æ€æœåŠ¡ã€‚å½“ <code>mode</code> ä¸º <code>development</code> æ—¶ï¼Œä¼šå…·å¤‡ <code>hot reload</code> çš„åŠŸèƒ½ï¼Œå³å½“æºç æ–‡ä»¶å˜åŒ–æ—¶ï¼Œä¼šå³æ—¶æ›´æ–°å½“å‰é¡µé¢ï¼Œä»¥ä¾¿ä½ çœ‹åˆ°æœ€æ–°çš„æ•ˆæœâ€¦</p>
</blockquote>
<h4 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h4><blockquote>
<p><code>webpack-dev-server</code> æ˜¯ä¸€ä¸ª <code>npm package</code>ï¼Œå®‰è£…ååœ¨å·²ç»æœ‰ <code>webpack</code> é…ç½®æ–‡ä»¶çš„é¡¹ç›®ç›®å½•ä¸‹ç›´æ¥å¯åŠ¨å°±å¯ä»¥</p>
</blockquote>
<ul>
<li><code>webpack-dev-server</code> é»˜è®¤ä½¿ç”¨ <code>8080</code> ç«¯å£</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack-dev-server -g</span><br><span class="line">webpack-dev-server --mode development</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>package</code> ä¸­çš„ <code>scripts</code> é…ç½®ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"webpack-dev-server --mode development"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><blockquote>
<p>åœ¨ webpack çš„é…ç½®ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>devServer</code> å­—æ®µæ¥é…ç½® <code>webpack-dev-server</code>ï¼Œå¦‚ç«¯å£è®¾ç½®ã€å¯åŠ¨ <code>gzip</code> å‹ç¼©ç­‰ï¼Œè¿™é‡Œç®€å•è®²è§£å‡ ä¸ªå¸¸ç”¨çš„é…ç½®</p>
</blockquote>
<ul>
<li><code>public</code> å­—æ®µç”¨äºæŒ‡å®šé™æ€æœåŠ¡çš„åŸŸåï¼Œé»˜è®¤æ˜¯ <code>http://localhost:8080/</code> ï¼Œå½“ä½ ä½¿ç”¨ <code>Nginx</code> æ¥åšåå‘ä»£ç†æ—¶ï¼Œåº”è¯¥å°±éœ€è¦ä½¿ç”¨è¯¥é…ç½®æ¥æŒ‡å®š <code>Nginx</code> é…ç½®ä½¿ç”¨çš„æœåŠ¡åŸŸå</li>
<li><code>port</code> å­—æ®µç”¨äºæŒ‡å®šé™æ€æœåŠ¡çš„ç«¯å£ï¼Œå¦‚ä¸Šï¼Œé»˜è®¤æ˜¯ <code>8080</code>ï¼Œé€šå¸¸æƒ…å†µä¸‹éƒ½ä¸éœ€è¦æ”¹åŠ¨</li>
<li><code>publicPath</code> å­—æ®µç”¨äºæŒ‡å®šæ„å»ºå¥½çš„é™æ€æ–‡ä»¶åœ¨æµè§ˆå™¨ä¸­ç”¨ä»€ä¹ˆè·¯å¾„å»è®¿é—®ï¼Œé»˜è®¤æ˜¯ <code>/</code>ï¼Œä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªæ„å»ºå¥½çš„æ–‡ä»¶ <code>bundle.js</code>ï¼Œå®Œæ•´çš„è®¿é—®è·¯å¾„æ˜¯ <code>http://localhost:8080/bundle.js</code>ï¼Œå¦‚æœä½ é…ç½®äº† <code>publicPath: &#39;assets/&#39;</code>ï¼Œé‚£ä¹ˆä¸Šè¿° <code>bundle.js</code> çš„å®Œæ•´è®¿é—®è·¯å¾„å°±æ˜¯ <code>http://localhost:8080/assets/bundle.js</code>ã€‚å¯ä»¥ä½¿ç”¨æ•´ä¸ª <code>URL</code> æ¥ä½œä¸º <code>publicPath</code> çš„å€¼ï¼Œå¦‚ <code>publicPath: &#39;http://localhost:8080/assets/&#39;</code>ã€‚å¦‚æœä½ ä½¿ç”¨äº† <code>HMR</code>ï¼Œé‚£ä¹ˆè¦è®¾ç½® <code>publicPath</code> å°±å¿…é¡»ä½¿ç”¨å®Œæ•´çš„ <code>URL</code></li>
</ul>
<blockquote>
<p>å»ºè®®å°† <code>devServer.publicPath</code> å’Œ <code>output.publicPath</code> çš„å€¼ä¿æŒä¸€è‡´</p>
</blockquote>
<ul>
<li><code>proxy</code> ç”¨äºé…ç½® <code>webpack-dev-server</code> å°†ç‰¹å®š <code>URL</code> çš„è¯·æ±‚ä»£ç†åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨ä¸Šã€‚å½“ä½ æœ‰å•ç‹¬çš„åç«¯å¼€å‘æœåŠ¡å™¨ç”¨äºè¯·æ±‚ API æ—¶ï¼Œè¿™ä¸ªé…ç½®ç›¸å½“æœ‰ç”¨ã€‚ä¾‹å¦‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">proxy: &#123;</span><br><span class="line">  <span class="string">'/api'</span>: &#123;</span><br><span class="line">    target: <span class="string">"http://localhost:3000"</span>, <span class="comment">// å°† URL ä¸­å¸¦æœ‰ /api çš„è¯·æ±‚ä»£ç†åˆ°æœ¬åœ°çš„ 3000 ç«¯å£çš„æœåŠ¡ä¸Š</span></span><br><span class="line">    pathRewrite: &#123;<span class="string">'^/api'</span>: <span class="string">''</span>&#125;, <span class="comment">// æŠŠ URL ä¸­ path éƒ¨åˆ†çš„ `api` ç§»é™¤æ‰</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>before</code> å’Œ <code>after</code> é…ç½®ç”¨äºåœ¨ <code>webpack-dev-server</code> å®šä¹‰é¢å¤–çš„ä¸­é—´ä»¶ï¼Œå¦‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">before(app)&#123;</span><br><span class="line">  app.get(<span class="string">'/some/path'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123; <span class="comment">// å½“è®¿é—® /some/path è·¯å¾„æ—¶ï¼Œè¿”å›è‡ªå®šä¹‰çš„ json æ•°æ®</span></span><br><span class="line">    res.json(&#123;<span class="attr">custom</span>: <span class="string">'response'</span>&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>before</code> åœ¨ <code>webpack-dev-server</code> é™æ€èµ„æºä¸­é—´ä»¶å¤„ç†ä¹‹å‰ï¼Œå¯ä»¥ç”¨äºæ‹¦æˆªéƒ¨åˆ†è¯·æ±‚è¿”å›ç‰¹å®šå†…å®¹ï¼Œæˆ–è€…å®ç°ç®€å•çš„æ•°æ® <code>mock</code>ã€‚</li>
<li><code>after</code> åœ¨ <code>webpack-dev-server</code> é™æ€èµ„æºä¸­é—´ä»¶å¤„ç†ä¹‹åï¼Œæ¯”è¾ƒå°‘ç”¨åˆ°ï¼Œå¯ä»¥ç”¨äºæ‰“å°æ—¥å¿—æˆ–è€…åšä¸€äº›é¢å¤–å¤„ç†â€¦</li>
</ul>
<h3 id="å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ„å»ºé…ç½®å·®å¼‚"><a href="#å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ„å»ºé…ç½®å·®å¼‚" class="headerlink" title="å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ„å»ºé…ç½®å·®å¼‚"></a>å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ„å»ºé…ç½®å·®å¼‚</h3><ul>
<li>æˆ‘ä»¬åœ¨æ—¥å¸¸çš„å‰ç«¯å¼€å‘å·¥ä½œä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šæœ‰ä¸¤å¥—æ„å»ºç¯å¢ƒï¼šä¸€å¥—å¼€å‘æ—¶ä½¿ç”¨ï¼Œæ„å»ºç»“æœç”¨äºæœ¬åœ°å¼€å‘è°ƒè¯•ï¼Œä¸è¿›è¡Œä»£ç å‹ç¼©ï¼Œæ‰“å° <code>debug</code> ä¿¡æ¯ï¼ŒåŒ…å« <code>sourcemap</code> æ–‡ä»¶</li>
<li>å¦å¤–ä¸€å¥—æ„å»ºåçš„ç»“æœæ˜¯ç›´æ¥åº”ç”¨äºçº¿ä¸Šçš„ï¼Œå³ä»£ç éƒ½æ˜¯å‹ç¼©åï¼Œè¿è¡Œæ—¶ä¸æ‰“å° <code>debug</code> ä¿¡æ¯ï¼Œé™æ€æ–‡ä»¶ä¸åŒ…æ‹¬ <code>sourcemap</code> çš„ã€‚æœ‰çš„æ—¶å€™å¯èƒ½è¿˜éœ€è¦å¤šä¸€å¥—æµ‹è¯•ç¯å¢ƒï¼Œåœ¨è¿è¡Œæ—¶ç›´æ¥è¿›è¡Œè¯·æ±‚ <code>mock</code> ç­‰å·¥ä½œ</li>
<li><code>webpack 4.x</code> ç‰ˆæœ¬å¼•å…¥äº† <code>mode</code> çš„æ¦‚å¿µï¼Œåœ¨è¿è¡Œ <code>webpack</code> æ—¶éœ€è¦æŒ‡å®šä½¿ç”¨ <code>production</code> æˆ– <code>development</code> ä¸¤ä¸ª <code>mode</code> å…¶ä¸­ä¸€ä¸ªï¼Œè¿™ä¸ªåŠŸèƒ½ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„è¿è¡Œä¸¤å¥—æ„å»ºç¯å¢ƒçš„èƒ½åŠ›ã€‚</li>
</ul>
<h4 id="åœ¨é…ç½®æ–‡ä»¶ä¸­åŒºåˆ†-mode"><a href="#åœ¨é…ç½®æ–‡ä»¶ä¸­åŒºåˆ†-mode" class="headerlink" title="åœ¨é…ç½®æ–‡ä»¶ä¸­åŒºåˆ† mode"></a>åœ¨é…ç½®æ–‡ä»¶ä¸­åŒºåˆ† mode</h4><blockquote>
<p>ä¹‹å‰æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶éƒ½æ˜¯ç›´æ¥å¯¹å¤–æš´éœ²ä¸€ä¸ª <code>JS</code> å¯¹è±¡ï¼Œè¿™ç§æ–¹å¼æš‚æ—¶æ²¡æœ‰åŠæ³•è·å–åˆ° <code>webpack</code> çš„ <code>mode</code> å‚æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ¢ä¸€ç§æ–¹å¼æ¥å¤„ç†é…ç½®ã€‚æ ¹æ®å®˜æ–¹çš„æ–‡æ¡£å¤šç§é…ç½®ç±»å‹ï¼Œé…ç½®æ–‡ä»¶å¯ä»¥å¯¹å¤–æš´éœ²ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿™æ ·åš</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">env, argv</span>) =&gt;</span> (&#123;</span><br><span class="line">  <span class="comment">// ... å…¶ä»–é…ç½®</span></span><br><span class="line">  optimization: &#123;</span><br><span class="line">    minimize: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ argv æ¥è·å– mode å‚æ•°çš„å€¼</span></span><br><span class="line">    minimizer:</span><br><span class="line">      argv.mode === <span class="string">'production'</span></span><br><span class="line">        ? [</span><br><span class="line">            <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">              <span class="comment">/* ä½ è‡ªå·±çš„é…ç½® */</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">// ä»…åœ¨æˆ‘ä»¬è¦è‡ªå®šä¹‰å‹ç¼©é…ç½®æ—¶æ‰éœ€è¦è¿™ä¹ˆåš</span></span><br><span class="line">            <span class="comment">// mode ä¸º production æ—¶ webpack ä¼šé»˜è®¤ä½¿ç”¨å‹ç¼© JS çš„ plugin</span></span><br><span class="line">          ]</span><br><span class="line">        : []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·è·å– <code>mode</code> ä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¤ŸåŒºåˆ†ä¸åŒçš„æ„å»ºç¯å¢ƒï¼Œç„¶åæ ¹æ®ä¸åŒç¯å¢ƒå†å¯¹ç‰¹æ®Šçš„ <code>loader</code> æˆ– <code>plugin</code> åšé¢å¤–çš„é…ç½®å°±å¯ä»¥äº†</p>
</blockquote>
<ul>
<li>ä»¥ä¸Šæ˜¯ <code>webpack 4.x</code> çš„åšæ³•ï¼Œç”±äºæœ‰äº† <code>mode</code> å‚æ•°ï¼ŒåŒºåˆ†ç¯å¢ƒå˜å¾—ç®€å•äº†ã€‚ä¸è¿‡åœ¨å½“å‰ä¸šç•Œï¼Œä¼°è®¡è¿˜æ˜¯ä½¿ç”¨ <code>webpack 3.x</code> ç‰ˆæœ¬çš„å±…å¤šï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿç®€å•ä»‹ç»ä¸€ä¸‹ <code>3.x</code> å¦‚ä½•åŒºåˆ†ç¯å¢ƒ</li>
</ul>
<blockquote>
<p><code>webpack</code> çš„è¿è¡Œæ—¶ç¯å¢ƒæ˜¯ <code>Node.js</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Node.js</code> æä¾›çš„æœºåˆ¶ç»™è¦è¿è¡Œçš„ <code>webpack</code> ç¨‹åºä¼ é€’ç¯å¢ƒå˜é‡ï¼Œæ¥æ§åˆ¶ä¸åŒç¯å¢ƒä¸‹çš„æ„å»ºè¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ <code>npm</code> ä¸­çš„ <code>scripts</code> å­—æ®µæ·»åŠ ä¸€ä¸ªç”¨äºç”Ÿäº§ç¯å¢ƒçš„æ„å»ºå‘½ä»¤â€¦</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"NODE_ENV=production webpack"</span>,</span><br><span class="line">    <span class="string">"develop"</span>: <span class="string">"NODE_ENV=development webpack-dev-server"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç„¶ååœ¨ <code>webpack.config.js</code> æ–‡ä»¶ä¸­å¯ä»¥é€šè¿‡ <code>process.env.NODE_ENV</code> æ¥è·å–å‘½ä»¤ä¼ å…¥çš„ç¯å¢ƒå˜é‡</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="comment">// ... webpack é…ç½®</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span>) &#123;</span><br><span class="line">  <span class="comment">// ç”Ÿäº§ç¯å¢ƒéœ€è¦åšçš„äº‹æƒ…ï¼Œå¦‚ä½¿ç”¨ä»£ç å‹ç¼©æ’ä»¶ç­‰</span></span><br><span class="line">  config.plugins.push(<span class="keyword">new</span> UglifyJsPlugin());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure>
<h4 id="è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡"><a href="#è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡" class="headerlink" title="è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡"></a>è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡</h4><blockquote>
<p>æˆ‘ä»¬ä½¿ç”¨ webpack æ—¶ä¼ é€’çš„ mode å‚æ•°ï¼Œæ˜¯å¯ä»¥åœ¨æˆ‘ä»¬çš„åº”ç”¨ä»£ç è¿è¡Œæ—¶ï¼Œé€šè¿‡ <code>process.env.NODE_ENV</code> è¿™ä¸ªå˜é‡è·å–çš„ã€‚è¿™æ ·æ–¹ä¾¿æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åˆ¤æ–­å½“å‰æ‰§è¡Œçš„æ„å»ºç¯å¢ƒï¼Œä½¿ç”¨æœ€å¤šçš„åœºæ™¯è«è¿‡äºæ§åˆ¶æ˜¯å¦æ‰“å° <code>debug</code> ä¿¡æ¯â€¦</p>
</blockquote>
<ul>
<li>ä¸‹é¢è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨åº”ç”¨å¼€å‘çš„ä»£ç ä¸­å®ç°ä¸€ä¸ªç®€å•çš„ <code>console</code> æ‰“å°å°è£…</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span> &amp;&amp; <span class="built_in">console</span> &amp;&amp; <span class="built_in">console</span>.log) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log.apply(<span class="built_in">console</span>, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åŒæ ·ï¼Œä»¥ä¸Šæ˜¯ <code>webpack 4.x</code> çš„åšæ³•ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ <code>3.x</code> ç‰ˆæœ¬åº”è¯¥å¦‚ä½•å®ç°ã€‚è¿™é‡Œéœ€è¦ç”¨åˆ° <code>DefinePlugin</code> æ’ä»¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨æ„å»ºæ—¶ç»™è¿è¡Œæ—¶å®šä¹‰å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨å‰é¢ <code>webpack 3.x</code> ç‰ˆæœ¬åŒºåˆ†æ„å»ºç¯å¢ƒçš„ä¾‹å­çš„åŸºç¡€ä¸Šï¼Œå†ä½¿ç”¨ <code>DefinePlugin</code> æ·»åŠ ç¯å¢ƒå˜é‡å³å¯å½±å“åˆ°è¿è¡Œæ—¶çš„ä»£ç â€¦</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// webpack çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="comment">// webpack 3.x çš„ process.env.NODE_ENV æ˜¯é€šè¿‡æ‰‹åŠ¨åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®š NODE_ENV=... çš„æ–¹å¼æ¥ä¼ é€’çš„</span></span><br><span class="line">      <span class="string">'process.env.NODE_ENV'</span>: <span class="built_in">JSON</span>.stringify(process.env.NODE_ENV)</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="å¸¸è§çš„ç¯å¢ƒå·®å¼‚é…ç½®"><a href="#å¸¸è§çš„ç¯å¢ƒå·®å¼‚é…ç½®" class="headerlink" title="å¸¸è§çš„ç¯å¢ƒå·®å¼‚é…ç½®"></a>å¸¸è§çš„ç¯å¢ƒå·®å¼‚é…ç½®</h4><p><strong>å¸¸è§çš„ webpack æ„å»ºå·®å¼‚é…ç½®</strong></p>
<ul>
<li>ç”Ÿäº§ç¯å¢ƒå¯èƒ½éœ€è¦åˆ†ç¦» <code>CSS</code> æˆå•ç‹¬çš„æ–‡ä»¶ï¼Œä»¥ä¾¿å¤šä¸ªé¡µé¢å…±äº«åŒä¸€ä¸ª <code>CSS</code> æ–‡ä»¶</li>
<li>ç”Ÿäº§ç¯å¢ƒéœ€è¦å‹ç¼© <code>HTML/CSS/JS</code> ä»£ç </li>
<li>ç”Ÿäº§ç¯å¢ƒéœ€è¦å‹ç¼©å›¾ç‰‡</li>
<li>å¼€å‘ç¯å¢ƒéœ€è¦ç”Ÿæˆ <code>sourcemap</code> æ–‡ä»¶</li>
<li>å¼€å‘ç¯å¢ƒéœ€è¦æ‰“å° <code>debug</code> ä¿¡æ¯</li>
<li>å¼€å‘ç¯å¢ƒéœ€è¦ <code>live reload</code> æˆ–è€… <code>hot reload</code> çš„åŠŸèƒ½â€¦</li>
</ul>
<blockquote>
<p><code>webpack 4.x</code> çš„ <code>mode</code> å·²ç»æä¾›äº†ä¸Šè¿°å·®å¼‚é…ç½®çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œ<code>mode</code> ä¸º <code>production</code> æ—¶é»˜è®¤ä½¿ç”¨ <code>JS</code> ä»£ç å‹ç¼©ï¼Œè€Œ <code>mode</code> ä¸º <code>development</code> æ—¶é»˜è®¤å¯ç”¨ <code>hot</code> <code>reload</code>ï¼Œç­‰ç­‰ã€‚è¿™æ ·è®©æˆ‘ä»¬çš„é…ç½®æ›´ä¸ºç®€æ´ï¼Œæˆ‘ä»¬åªéœ€è¦é’ˆå¯¹ç‰¹åˆ«ä½¿ç”¨çš„ <code>loader</code> å’Œ <code>plugin</code> åšåŒºåˆ†é…ç½®å°±å¯ä»¥äº†â€¦</p>
</blockquote>
<ul>
<li><code>webpack 3.x</code> ç‰ˆæœ¬è¿˜æ˜¯åªèƒ½è‡ªå·±åŠ¨æ‰‹ä¿®æ”¹é…ç½®æ¥æ»¡è¶³å¤§éƒ¨åˆ†ç¯å¢ƒå·®å¼‚éœ€æ±‚ï¼Œæ‰€ä»¥å¦‚æœä½ è¦å¼€å§‹ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨ <code>webpack 4.x</code> ç‰ˆæœ¬</li>
</ul>
<h4 id="æ‹†åˆ†é…ç½®"><a href="#æ‹†åˆ†é…ç½®" class="headerlink" title="æ‹†åˆ†é…ç½®"></a>æ‹†åˆ†é…ç½®</h4><blockquote>
<p>å‰é¢æˆ‘ä»¬åˆ—å‡ºäº†å‡ ä¸ªç¯å¢ƒå·®å¼‚é…ç½®ï¼Œå¯èƒ½è¿™äº›æ„å»ºéœ€æ±‚å°±å·²ç»æœ‰ç‚¹å¤šäº†ï¼Œä¼šè®©æ•´ä¸ª <code>webpack</code> çš„é…ç½®å˜å¾—å¤æ‚ï¼Œå°¤å…¶æ˜¯æœ‰ç€å¤§é‡ç¯å¢ƒå˜é‡åˆ¤æ–­çš„é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ <code>webpack</code> çš„é…ç½®æŒ‰ç…§ä¸åŒçš„ç¯å¢ƒæ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œè¿è¡Œæ—¶ç›´æ¥æ ¹æ®ç¯å¢ƒå˜é‡åŠ è½½å¯¹åº”çš„é…ç½®å³å¯ã€‚åŸºæœ¬çš„åˆ’åˆ†å¦‚ä¸‹â€¦</p>
</blockquote>
<ul>
<li><code>webpack.base.js</code>ï¼šåŸºç¡€éƒ¨åˆ†ï¼Œå³å¤šä¸ªæ–‡ä»¶ä¸­å…±äº«çš„é…ç½®</li>
<li><code>webpack.development.js</code>ï¼šå¼€å‘ç¯å¢ƒä½¿ç”¨çš„é…ç½®</li>
<li><code>webpack.production.js</code>ï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„é…ç½®</li>
<li><code>webpack.test.js</code>ï¼šæµ‹è¯•ç¯å¢ƒä½¿ç”¨çš„é…ç½®â€¦</li>
</ul>
<p><strong>å¦‚ä½•å¤„ç†è¿™æ ·çš„é…ç½®æ‹†åˆ†</strong></p>
<blockquote>
<p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ï¼Œå¯¹äº <code>webpack</code> çš„é…ç½®ï¼Œå…¶å®æ˜¯å¯¹å¤–æš´éœ²ä¸€ä¸ª <code>JS</code> å¯¹è±¡ï¼Œæ‰€ä»¥å¯¹äºè¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨ <code>JS</code> ä»£ç æ¥ä¿®æ”¹å®ƒï¼Œä¾‹å¦‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="comment">// ... webpack é…ç½®</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¿™ä¸ª config æ¥è°ƒæ•´é…ç½®ï¼Œä¾‹å¦‚æ·»åŠ ä¸€ä¸ªæ–°çš„æ’ä»¶</span></span><br><span class="line">config.plugins.push(<span class="keyword">new</span> YourPlugin());</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å› æ­¤ï¼Œåªè¦æœ‰ä¸€ä¸ªå·¥å…·èƒ½æ¯”è¾ƒæ™ºèƒ½åœ°åˆå¹¶å¤šä¸ªé…ç½®å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆè½»æ¾åœ°æ‹†åˆ† webpack é…ç½®ï¼Œç„¶åé€šè¿‡åˆ¤æ–­ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨å·¥å…·å°†å¯¹åº”ç¯å¢ƒçš„å¤šä¸ªé…ç½®å¯¹è±¡æ•´åˆåæä¾›ç»™ webpack ä½¿ç”¨ã€‚è¿™ä¸ªå·¥å…·å°±æ˜¯ <strong><a href="https://github.com/survivejs/webpack-merge" target="_blank" rel="noopener">webpack-merge</a></strong></p>
</blockquote>
<ul>
<li>æˆ‘ä»¬çš„ webpack é…ç½®åŸºç¡€éƒ¨åˆ†ï¼Œå³ <code>webpack.base.js</code> åº”è¯¥å¤§è‡´æ˜¯è¿™æ ·çš„</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'...'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåé¢ä»‹ç» API æ—¶ä¼šç”¨åˆ°</span></span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: [<span class="string">'babel'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç„¶å <code>webpack.development.js</code> éœ€è¦æ·»åŠ  <code>loader</code> æˆ– <code>plugin</code>ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>webpack-merge</code> çš„ <code>API</code>ï¼Œä¾‹å¦‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;smart&#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> base = <span class="built_in">require</span>(<span class="string">'./webpack.base.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smart(base, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// ç”¨ smart APIï¼Œå½“è¿™é‡Œçš„åŒ¹é…è§„åˆ™ç›¸åŒä¸” use å€¼éƒ½æ˜¯æ•°ç»„æ—¶ï¼Œsmart ä¼šè¯†åˆ«åå¤„ç†</span></span><br><span class="line">      <span class="comment">// å’Œä¸Šè¿° base é…ç½®åˆå¹¶åï¼Œè¿™é‡Œä¼šæ˜¯ &#123;test: /\.js$/, use: ['babel', 'coffee'] &#125;</span></span><br><span class="line">      <span class="comment">// å¦‚æœè¿™é‡Œ use çš„å€¼ç”¨çš„æ˜¯å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡çš„è¯ï¼Œé‚£ä¹ˆä¼šæ›¿æ¢æ‰åŸæœ¬çš„è§„åˆ™ use çš„å€¼</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: [<span class="string">'coffee'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// plugins è¿™é‡Œçš„æ•°ç»„ä¼šå’Œ base ä¸­çš„ plugins æ•°ç»„è¿›è¡Œåˆå¹¶</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">'process.env.NODE_ENV'</span>: <span class="built_in">JSON</span>.stringify(process.env.NODE_ENV),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;)ï¼›</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯è§ <code>webpack-merge</code> æä¾›çš„ <code>smart</code> æ–¹æ³•ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ è½»æ¾åœ°å¤„ç† <code>loader</code> é…ç½®çš„åˆå¹¶ã€‚<code>webpack-merge</code> è¿˜æœ‰å…¶ä»– <code>API</code> å¯ä»¥ç”¨äºè‡ªå®šä¹‰åˆå¹¶è¡Œä¸º</p>
</blockquote>
<h4 id="å®Œæ•´ä»£ç -1"><a href="#å®Œæ•´ä»£ç -1" class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h4><blockquote>
<p><code>webpack.config.js</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">env, argv</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> argv.mode === <span class="string">'production'</span></span><br><span class="line">    ? <span class="built_in">require</span>(<span class="string">'./configs/webpack.production'</span>)</span><br><span class="line">    : <span class="built_in">require</span>(<span class="string">'./configs/webpack.development'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>configs/webpack.base.js</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line"></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].js'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'../src'</span>)],</span><br><span class="line">        use: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'file-loader'</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>, <span class="comment">// é…ç½®è¾“å‡ºæ–‡ä»¶åå’Œè·¯å¾„</span></span><br><span class="line">      template: <span class="string">'src/index.html'</span> <span class="comment">// é…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>configs/webpack.development.js</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./webpack.base'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = merge.smart(baseConfig, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        enforce: <span class="string">'pre'</span>,</span><br><span class="line">        test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="string">'eslint-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    port: <span class="string">'1234'</span>,</span><br><span class="line">    before(app) &#123;</span><br><span class="line">      app.get(<span class="string">'/api/test.json'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        res.json(&#123; <span class="attr">code</span>: <span class="number">200</span>, <span class="attr">message</span>: <span class="string">'hello world'</span> &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">config.plugins.push(</span><br><span class="line">  <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">    __DEV__: <span class="built_in">JSON</span>.stringify(<span class="literal">true</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>configs/webpack.production.js</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>);</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./webpack.base'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = merge.smart(baseConfig, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: [</span><br><span class="line">            &#123;</span><br><span class="line">              loader: <span class="string">'css-loader'</span>,</span><br><span class="line">              options: &#123;</span><br><span class="line">                minimize: <span class="literal">true</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'less-loader'</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">config.plugins.push(<span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].css'</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure>
<h3 id="æ¨¡å—çƒ­æ›¿æ¢æé«˜å¼€å‘æ•ˆç‡"><a href="#æ¨¡å—çƒ­æ›¿æ¢æé«˜å¼€å‘æ•ˆç‡" class="headerlink" title="æ¨¡å—çƒ­æ›¿æ¢æé«˜å¼€å‘æ•ˆç‡"></a>æ¨¡å—çƒ­æ›¿æ¢æé«˜å¼€å‘æ•ˆç‡</h3><blockquote>
<p><code>HMR</code> å…¨ç§°æ˜¯ <code>Hot Module Replacement</code>ï¼Œå³æ¨¡å—çƒ­æ›¿æ¢ã€‚åœ¨è¿™ä¸ªæ¦‚å¿µå‡ºæ¥ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿‡ <code>Hot Reloading</code>ï¼Œå½“ä»£ç å˜æ›´æ—¶é€šçŸ¥æµè§ˆå™¨åˆ·æ–°é¡µé¢ï¼Œä»¥é¿å…é¢‘ç¹æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨é¡µé¢ã€‚HMR å¯ä»¥ç†è§£ä¸ºå¢å¼ºç‰ˆçš„ <code>Hot Reloading</code>ï¼Œä½†ä¸ç”¨æ•´ä¸ªé¡µé¢åˆ·æ–°ï¼Œè€Œæ˜¯å±€éƒ¨æ›¿æ¢æ‰éƒ¨åˆ†æ¨¡å—ä»£ç å¹¶ä¸”ä½¿å…¶ç”Ÿæ•ˆï¼Œå¯ä»¥çœ‹åˆ°ä»£ç å˜æ›´åçš„æ•ˆæœã€‚æ‰€ä»¥ï¼Œ<code>HMR</code> æ—¢é¿å…äº†é¢‘ç¹æ‰‹åŠ¨åˆ·æ–°é¡µé¢ï¼Œä¹Ÿå‡å°‘äº†é¡µé¢åˆ·æ–°æ—¶çš„ç­‰å¾…ï¼Œå¯ä»¥æå¤§åœ°æé«˜å‰ç«¯é¡µé¢å¼€å‘æ•ˆç‡â€¦</p>
</blockquote>
<h4 id="é…ç½®ä½¿ç”¨-HMR"><a href="#é…ç½®ä½¿ç”¨-HMR" class="headerlink" title="é…ç½®ä½¿ç”¨ HMR"></a>é…ç½®ä½¿ç”¨ HMR</h4><blockquote>
<p><code>HMR</code> æ˜¯ <code>webpack</code> æä¾›çš„éå¸¸æœ‰ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œè·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„ä¸€æ ·ï¼Œå®‰è£…å¥½ <code>webpack-dev-server</code>ï¼Œ æ·»åŠ ä¸€äº›ç®€å•çš„é…ç½®ï¼Œå³åœ¨ <code>webpack</code> çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¯ç”¨ <code>HMR</code> éœ€è¦çš„ä¸¤ä¸ªæ’ä»¶</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// dev server çš„é…ç½®è¦å¯åŠ¨ hotï¼Œæˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­å¸¦å‚æ•°å¼€å¯</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(), <span class="comment">// ç”¨äºå¯åŠ¨ HMR æ—¶å¯ä»¥æ˜¾ç¤ºæ¨¡å—çš„ç›¸å¯¹è·¯å¾„</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin() <span class="comment">// Hot Module Replacement çš„æ’ä»¶</span></span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="module-hot-å¸¸è§çš„-API"><a href="#module-hot-å¸¸è§çš„-API" class="headerlink" title="module.hot å¸¸è§çš„ API"></a>module.hot å¸¸è§çš„ API</h4><blockquote>
<p>å‰é¢ <code>HMR</code> å®ç°éƒ¨åˆ†å·²ç»è®²è§£äº†å®ç° HMR æ¥å£çš„é‡è¦æ€§ï¼Œä¸‹é¢æ¥çœ‹çœ‹å¸¸è§çš„ <code>module.hot</code> <code>API</code> æœ‰å“ªäº›ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨</p>
</blockquote>
<ul>
<li><code>module.hot.accept</code> æ–¹æ³•æŒ‡å®šåœ¨åº”ç”¨ç‰¹å®šä»£ç æ¨¡å—æ›´æ–°æ—¶æ‰§è¡Œç›¸åº”çš„ <code>callback</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°ç»„ï¼Œå¦‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="built_in">module</span>.hot.accept([<span class="string">'./bar.js'</span>, <span class="string">'./index.css'</span>], () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ... è¿™æ ·å½“ bar.js æˆ–è€… index.css æ›´æ–°æ—¶éƒ½ä¼šæ‰§è¡Œè¯¥å‡½æ•°</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>module.hot.decline</code> å¯¹äºæŒ‡å®šçš„ä»£ç æ¨¡å—ï¼Œæ‹’ç»è¿›è¡Œæ¨¡å—ä»£ç çš„æ›´æ–°ï¼Œè¿›å…¥æ›´æ–°å¤±è´¥çŠ¶æ€ï¼Œå¦‚ <code>module.hot.decline(&#39;./bar.js&#39;)</code>ã€‚è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒå°‘ç”¨åˆ°</li>
<li><code>module.hot.dispose</code> ç”¨äºæ·»åŠ ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œåœ¨å½“å‰æ¨¡å—ä»£ç è¢«æ›¿æ¢æ—¶è¿è¡Œè¯¥å‡½æ•°ï¼Œä¾‹å¦‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="built_in">module</span>.hot.dispose(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// data ç”¨äºä¼ é€’æ•°æ®ï¼Œå¦‚æœæœ‰éœ€è¦ä¼ é€’çš„æ•°æ®å¯ä»¥æŒ‚åœ¨ data å¯¹è±¡ä¸Šï¼Œç„¶ååœ¨æ¨¡å—ä»£ç æ›´æ–°åå¯ä»¥é€šè¿‡ module.hot.data æ¥è·å–</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>module.hot.accept</code> é€šå¸¸ç”¨äºæŒ‡å®šå½“å‰ä¾èµ–çš„æŸä¸ªæ¨¡å—æ›´æ–°æ—¶éœ€è¦åšçš„å¤„ç†ï¼Œå¦‚æœæ˜¯å½“å‰æ¨¡å—æ›´æ–°æ—¶éœ€è¦å¤„ç†çš„åŠ¨ä½œï¼Œä½¿ç”¨ <code>module.hot.dispose</code> ä¼šæ›´åŠ å®¹æ˜“æ–¹ä¾¿</li>
<li><code>module.hot.removeDisposeHandler</code> ç”¨äºç§»é™¤ <code>dispose</code> æ–¹æ³•æ·»åŠ çš„ <code>callback</code></li>
</ul>
<h3 id="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"><a href="#å›¾ç‰‡åŠ è½½ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"></a>å›¾ç‰‡åŠ è½½ä¼˜åŒ–</h3><h4 id="CSS-Sprites"><a href="#CSS-Sprites" class="headerlink" title="CSS Sprites"></a>CSS Sprites</h4><ul>
<li>å¦‚æœä½ ä½¿ç”¨çš„ <code>webpack 3.x</code> ç‰ˆæœ¬ï¼Œéœ€è¦ <code>CSS Sprites</code> çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>webpack-spritesmith</code> æˆ–è€… <code>sprite-webpack-plugin</code>ã€‚</li>
<li>æˆ‘ä»¬ä»¥ <code>webpack-spritesmith</code> ä¸ºä¾‹ï¼Œå…ˆå®‰è£…ä¾èµ–â€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  loaders: [</span><br><span class="line">    <span class="comment">// ... è¿™é‡Œéœ€è¦æœ‰å¤„ç†å›¾ç‰‡çš„ loaderï¼Œå¦‚ file-loader</span></span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br><span class="line">resolve: &#123;</span><br><span class="line">  modules: [</span><br><span class="line">    <span class="string">'node_modules'</span>,</span><br><span class="line">    <span class="string">'spritesmith-generated'</span>, <span class="comment">// webpack-spritesmith ç”Ÿæˆæ‰€éœ€æ–‡ä»¶çš„ç›®å½•</span></span><br><span class="line">  ],</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">  <span class="keyword">new</span> SpritesmithPlugin(&#123;</span><br><span class="line">    src: &#123;</span><br><span class="line">      cwd: path.resolve(__dirname, <span class="string">'src/ico'</span>), <span class="comment">// å¤šä¸ªå›¾ç‰‡æ‰€åœ¨çš„ç›®å½•</span></span><br><span class="line">      glob: <span class="string">'*.png'</span> <span class="comment">// åŒ¹é…å›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line">    &#125;,</span><br><span class="line">    target: &#123;</span><br><span class="line">      <span class="comment">// ç”Ÿæˆæœ€ç»ˆå›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line">      image: path.resolve(__dirname, <span class="string">'src/spritesmith-generated/sprite.png'</span>),</span><br><span class="line">      <span class="comment">// ç”Ÿæˆæ‰€éœ€ SASS/LESS/Stylus mixins ä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨ Stylus é¢„å¤„ç†å™¨åšä¾‹å­</span></span><br><span class="line">      css: path.resolve(__dirname, <span class="string">'src/spritesmith-generated/sprite.styl'</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    apiOptions: &#123;</span><br><span class="line">      cssImageRef: <span class="string">"~sprite.png"</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;),</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ä½ éœ€è¦çš„æ ·å¼ä»£ç ä¸­å¼•å…¥ <code>sprite.styl</code> åè°ƒç”¨éœ€è¦çš„ <code>mixins</code> å³å¯</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@import &apos;~sprite.styl&apos;</span><br><span class="line"></span><br><span class="line">.close-button</span><br><span class="line">    sprite($close)</span><br><span class="line">.open-button</span><br><span class="line">    sprite($open)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>webpack 4.x</code>ï¼Œä½ éœ€è¦é…åˆä½¿ç”¨ <code>postcss</code> å’Œ <code>postcss-sprites</code>ï¼Œæ‰èƒ½å®ç° <code>CSS Sprites</code> çš„ç›¸å…³æ„å»º</p>
</blockquote>
<h4 id="å›¾ç‰‡å‹ç¼©"><a href="#å›¾ç‰‡å‹ç¼©" class="headerlink" title="å›¾ç‰‡å‹ç¼©"></a>å›¾ç‰‡å‹ç¼©</h4><ul>
<li>åœ¨ä¸€èˆ¬çš„é¡¹ç›®ä¸­ï¼Œå›¾ç‰‡èµ„æºä¼šå å‰ç«¯èµ„æºçš„å¾ˆå¤§ä¸€éƒ¨åˆ†ï¼Œæ—¢ç„¶ä»£ç éƒ½è¿›è¡Œå‹ç¼©äº†ï¼Œå å¤§å¤´çš„å›¾ç‰‡å°±æ›´ä¸ç”¨è¯´äº†</li>
<li>æˆ‘ä»¬ä¹‹å‰æåŠä½¿ç”¨ <code>file-loader</code> æ¥å¤„ç†å›¾ç‰‡æ–‡ä»¶ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å†æ·»åŠ ä¸€ä¸ª <code>image-webpack-loader</code> æ¥å‹ç¼©å›¾ç‰‡æ–‡ä»¶ã€‚ç®€å•çš„é…ç½®å¦‚ä¸‹â€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/.*\.(gif|png|jpe?g|svg|webp)$/i</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'file-loader'</span>,</span><br><span class="line">            options: &#123;&#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'image-webpack-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              mozjpeg: &#123; <span class="comment">// å‹ç¼© jpeg çš„é…ç½®</span></span><br><span class="line">                progressive: <span class="literal">true</span>,</span><br><span class="line">                quality: <span class="number">65</span></span><br><span class="line">              &#125;,</span><br><span class="line">              optipng: &#123; <span class="comment">// ä½¿ç”¨ imagemin-optipng å‹ç¼© pngï¼Œenable: false ä¸ºå…³é—­</span></span><br><span class="line">                enabled: <span class="literal">false</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              pngquant: &#123; <span class="comment">// ä½¿ç”¨ imagemin-pngquant å‹ç¼© png</span></span><br><span class="line">                quality: <span class="string">'65-90'</span>,</span><br><span class="line">                speed: <span class="number">4</span></span><br><span class="line">              &#125;,</span><br><span class="line">              gifsicle: &#123; <span class="comment">// å‹ç¼© gif çš„é…ç½®</span></span><br><span class="line">                interlaced: <span class="literal">false</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              webp: &#123; <span class="comment">// å¼€å¯ webpï¼Œä¼šæŠŠ jpg å’Œ png å›¾ç‰‡å‹ç¼©ä¸º webp æ ¼å¼</span></span><br><span class="line">                quality: <span class="number">75</span></span><br><span class="line">              &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨-DataURL"><a href="#ä½¿ç”¨-DataURL" class="headerlink" title="ä½¿ç”¨ DataURL"></a>ä½¿ç”¨ DataURL</h4><blockquote>
<p>æœ‰çš„æ—¶å€™æˆ‘ä»¬çš„é¡¹ç›®ä¸­ä¼šæœ‰ä¸€äº›å¾ˆå°çš„å›¾ç‰‡ï¼Œå› ä¸ºæŸäº›ç¼˜æ•…å¹¶ä¸æƒ³ä½¿ç”¨ <code>CSS Sprites</code> çš„æ–¹å¼æ¥å¤„ç†ï¼ˆè­¬å¦‚å°å›¾ç‰‡ä¸å¤šï¼Œå› æ­¤å¼•å…¥ CSS Sprites æ„Ÿè§‰éº»çƒ¦ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ webpack ä¸­ä½¿ç”¨ <code>url-loader</code> æ¥å¤„ç†è¿™äº›å¾ˆå°çš„å›¾ç‰‡â€¦</p>
</blockquote>
<ul>
<li><code>url-loader</code> å’Œ <code>file-loader</code> çš„åŠŸèƒ½ç±»ä¼¼ï¼Œä½†æ˜¯åœ¨å¤„ç†æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡é…ç½®æŒ‡å®šä¸€ä¸ªå¤§å°ï¼Œå½“æ–‡ä»¶å°äºè¿™ä¸ªé…ç½®å€¼æ—¶ï¼Œ<code>url-loader</code> ä¼šå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ª <code>base64</code> ç¼–ç çš„ <code>DataURL</code>ï¼Œé…ç½®å¦‚ä¸‹</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: <span class="number">8192</span> <span class="comment">// å•ä½æ˜¯ Byteï¼Œå½“æ–‡ä»¶å°äº 8KB æ—¶ä½œä¸º DataURL å¤„ç†</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç å‹ç¼©"><a href="#ä»£ç å‹ç¼©" class="headerlink" title="ä»£ç å‹ç¼©"></a>ä»£ç å‹ç¼©</h4><ul>
<li><code>webpack 4.x</code> ç‰ˆæœ¬è¿è¡Œæ—¶ï¼Œ<code>mode</code> ä¸º <code>production</code> å³ä¼šå¯åŠ¨å‹ç¼© <code>JS</code> ä»£ç çš„æ’ä»¶ï¼Œè€Œå¯¹äº <code>webpack</code> <code>3.x</code>ï¼Œä½¿ç”¨å‹ç¼© <code>JS</code> ä»£ç æ’ä»¶çš„æ–¹å¼ä¹Ÿå·²ç»ä»‹ç»è¿‡äº†ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå‹ç¼© <code>JS</code> ä»£ç åŸºæœ¬æ˜¯ä¸€ä¸ªå¿…ä¸å¯å°‘çš„æ­¥éª¤ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§å‡å° <code>JavaScript</code> çš„ä½“ç§¯ï¼Œç›¸å…³å†…å®¹è¿™é‡Œä¸å†èµ˜è¿°ã€‚</li>
<li>é™¤äº† JS ä»£ç ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¸€èˆ¬è¿˜éœ€è¦ HTML å’Œ CSS æ–‡ä»¶ï¼Œè¿™ä¸¤ç§æ–‡ä»¶ä¹Ÿéƒ½æ˜¯å¯ä»¥å‹ç¼©çš„ï¼Œè™½ç„¶ä¸åƒ JS çš„å‹ç¼©é‚£ä¹ˆå½»åº•ï¼ˆæ›¿æ¢æ‰é•¿å˜é‡ç­‰ï¼‰ï¼Œåªèƒ½ç§»é™¤ç©ºæ ¼æ¢è¡Œç­‰æ— ç”¨å­—ç¬¦ï¼Œä½†ä¹Ÿèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°æ–‡ä»¶å¤§å°ã€‚åœ¨ webpack ä¸­çš„é…ç½®ä½¿ç”¨ä¹Ÿä¸æ˜¯ç‰¹åˆ«éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¹Ÿä¼šä½¿ç”¨ã€‚</li>
<li>å¯¹äº HTML æ–‡ä»¶ï¼Œä¹‹å‰ä»‹ç»çš„ <code>html-webpack-plugin</code> æ’ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆéœ€è¦çš„ HTML å¹¶å¯¹å…¶è¿›è¡Œå‹ç¼©â€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>, <span class="comment">// é…ç½®è¾“å‡ºæ–‡ä»¶åå’Œè·¯å¾„</span></span><br><span class="line">      template: <span class="string">'assets/index.html'</span>, <span class="comment">// é…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line">      minify: &#123;</span><br><span class="line">        <span class="comment">// å‹ç¼© HTML çš„é…ç½®</span></span><br><span class="line">        minifyCSS: <span class="literal">true</span>, <span class="comment">// å‹ç¼© HTML ä¸­å‡ºç°çš„ CSS ä»£ç </span></span><br><span class="line">        minifyJS: <span class="literal">true</span> <span class="comment">// å‹ç¼© HTML ä¸­å‡ºç°çš„ JS ä»£ç </span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¦‚ä¸Šï¼Œä½¿ç”¨ <code>minify</code> å­—æ®µé…ç½®å°±å¯ä»¥ä½¿ç”¨ <code>HTML</code> å‹ç¼©ï¼Œè¿™ä¸ªæ’ä»¶æ˜¯ä½¿ç”¨ <code>html-minifier</code> æ¥å®ç° <code>HTML</code> ä»£ç å‹ç¼©çš„ï¼Œ<code>minify</code> ä¸‹çš„é…ç½®é¡¹ç›´æ¥é€ä¼ ç»™ <code>html-minifier</code>ï¼Œé…ç½®é¡¹å‚è€ƒ <code>html-minifier</code> æ–‡æ¡£å³å¯ã€‚</li>
<li>å¯¹äº CSS æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡ç”¨æ¥å¤„ç† CSS æ–‡ä»¶çš„ <code>css-loader</code>ï¼Œä¹Ÿæä¾›äº†å‹ç¼© CSS ä»£ç çš„åŠŸèƒ½ï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              minimize: <span class="literal">true</span> <span class="comment">// ä½¿ç”¨ css çš„å‹ç¼©åŠŸèƒ½</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ <code>css-loader</code> çš„é€‰é¡¹ä¸­é…ç½® <code>minimize</code> å­—æ®µä¸º <code>true</code> æ¥ä½¿ç”¨ <code>CSS</code> å‹ç¼©ä»£ç çš„åŠŸèƒ½ã€‚<code>css-loader</code> æ˜¯ä½¿ç”¨ <code>cssnano</code> æ¥å‹ç¼©ä»£ç çš„ï¼Œ<code>minimize</code> å­—æ®µä¹Ÿå¯ä»¥é…ç½®ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ¥å°†ç›¸å…³é…ç½®ä¼ é€’ç»™ <code>cssnano</code></p>
</blockquote>
<h3 id="åˆ†ç¦»ä»£ç æ–‡ä»¶"><a href="#åˆ†ç¦»ä»£ç æ–‡ä»¶" class="headerlink" title="åˆ†ç¦»ä»£ç æ–‡ä»¶"></a>åˆ†ç¦»ä»£ç æ–‡ä»¶</h3><ul>
<li>å…³äºåˆ†ç¦» CSS æ–‡ä»¶è¿™ä¸ªä¸»é¢˜ï¼Œä¹‹å‰åœ¨ä»‹ç»å¦‚ä½•æ­å»ºåŸºæœ¬çš„å‰ç«¯å¼€å‘ç¯å¢ƒæ—¶æœ‰æåŠï¼Œåœ¨ <code>webpack</code> ä¸­ä½¿ç”¨ <code>extract-text-webpack-plugin</code> æ’ä»¶å³å¯ã€‚</li>
<li>å…ˆç®€å•è§£é‡Šä¸€ä¸‹ä¸ºä½•è¦æŠŠ CSS æ–‡ä»¶åˆ†ç¦»å‡ºæ¥ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸€èµ·æ‰“åŒ…åœ¨ JS ä¸­ã€‚æœ€ä¸»è¦çš„åŸå› æ˜¯æˆ‘ä»¬å¸Œæœ›æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜ã€‚</li>
<li>å‡è®¾æˆ‘ä»¬åŸæœ¬é¡µé¢çš„é™æ€èµ„æºéƒ½æ‰“åŒ…æˆä¸€ä¸ª JS æ–‡ä»¶ï¼ŒåŠ è½½é¡µé¢æ—¶è™½ç„¶åªéœ€è¦åŠ è½½ä¸€ä¸ª JS æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ä»£ç ä¸€æ—¦æ”¹å˜äº†ï¼Œç”¨æˆ·è®¿é—®æ–°çš„é¡µé¢æ—¶å°±éœ€è¦é‡æ–°åŠ è½½ä¸€ä¸ªæ–°çš„ JS æ–‡ä»¶ã€‚æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯å•ç‹¬ä¿®æ”¹äº†æ ·å¼ï¼Œè¿™æ ·ä¹Ÿè¦é‡æ–°åŠ è½½æ•´ä¸ªåº”ç”¨çš„ JS æ–‡ä»¶ï¼Œç›¸å½“ä¸åˆ’ç®—ã€‚</li>
<li>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æˆ‘ä»¬æœ‰å¤šä¸ªé¡µé¢ï¼Œå®ƒä»¬éƒ½å¯ä»¥å…±ç”¨ä¸€éƒ¨åˆ†æ ·å¼ï¼ˆè¿™æ˜¯å¾ˆå¸¸è§çš„ï¼ŒCSS Resetã€åŸºç¡€ç»„ä»¶æ ·å¼ç­‰åŸºæœ¬éƒ½æ˜¯è·¨é¡µé¢é€šç”¨ï¼‰ï¼Œå¦‚æœæ¯ä¸ªé¡µé¢éƒ½å•ç‹¬æ‰“åŒ…ä¸€ä¸ª JS æ–‡ä»¶ï¼Œé‚£ä¹ˆæ¯æ¬¡è®¿é—®é¡µé¢éƒ½ä¼šé‡å¤åŠ è½½åŸæœ¬å¯ä»¥å…±äº«çš„é‚£äº› CSS ä»£ç ã€‚å¦‚æœåˆ†ç¦»å¼€æ¥ï¼Œç¬¬äºŒä¸ªé¡µé¢å°±æœ‰äº† CSS æ–‡ä»¶çš„ç¼“å­˜ï¼Œè®¿é—®é€Ÿåº¦è‡ªç„¶ä¼šåŠ å¿«ã€‚è™½ç„¶å¯¹ç¬¬ä¸€ä¸ªé¡µé¢æ¥è¯´å¤šäº†ä¸€ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯å¯¹éšåçš„é¡µé¢æ¥è¯´ï¼Œç¼“å­˜å¸¦æ¥çš„é€Ÿåº¦æå‡ç›¸å¯¹æ›´åŠ å¯è§‚</li>
</ul>
<blockquote>
<p><code>3.x</code> ä»¥å‰çš„ç‰ˆæœ¬æ˜¯ä½¿ç”¨ <code>CommonsChunkPlugin</code> æ¥åšä»£ç åˆ†ç¦»çš„ï¼Œè€Œ <code>webpack 4.x</code> åˆ™æ˜¯æŠŠç›¸å…³çš„åŠŸèƒ½åŒ…åˆ°äº† <code>optimize.splitChunks</code> ä¸­ï¼Œç›´æ¥ä½¿ç”¨è¯¥é…ç½®å°±å¯ä»¥å®ç°ä»£ç åˆ†ç¦»ã€‚</p>
</blockquote>
<h4 id="webpack-4-x-çš„-optimization"><a href="#webpack-4-x-çš„-optimization" class="headerlink" title="webpack 4.x çš„ optimization"></a>webpack 4.x çš„ optimization</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ... webpack é…ç½®</span></span><br><span class="line"></span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      chunks: <span class="string">'all'</span> <span class="comment">// æ‰€æœ‰çš„ chunks ä»£ç å…¬å…±çš„éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥æˆä¸ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘ä»¬éœ€è¦åœ¨ HTML ä¸­å¼•ç”¨ä¸¤ä¸ªæ„å»ºå‡ºæ¥çš„ JS æ–‡ä»¶ï¼Œå¹¶ä¸” <code>commons.js</code> éœ€è¦åœ¨å…¥å£ä»£ç ä¹‹å‰ã€‚ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ä¾‹å­</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"commons.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"entry.bundle.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨äº† <code>html-webpack-plugin</code>ï¼Œé‚£ä¹ˆå¯¹åº”éœ€è¦çš„ JS æ–‡ä»¶éƒ½ä¼šåœ¨ HTML æ–‡ä»¶ä¸­æ­£ç¡®å¼•ç”¨ï¼Œä¸ç”¨æ‹…å¿ƒã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨ï¼Œé‚£ä¹ˆä½ éœ€è¦ä» <code>stats</code> çš„ <code>entrypoints</code> å±æ€§æ¥è·å–å…¥å£åº”è¯¥å¼•ç”¨å“ªäº› JS æ–‡ä»¶ï¼Œå¯ä»¥å‚è€ƒ Node API äº†è§£å¦‚ä½•ä» stats ä¸­è·å–ä¿¡æ¯</p>
</blockquote>
<p><strong>æ˜¾å¼é…ç½®å…±äº«ç±»åº“å¯ä»¥è¿™ä¹ˆæ“ä½œ</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [<span class="string">"react"</span>, <span class="string">"lodash"</span>, <span class="string">"angular"</span>, ...], <span class="comment">// æŒ‡å®šå…¬å…±ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ç±»åº“</span></span><br><span class="line">  &#125;,</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendor: &#123;</span><br><span class="line">          chunks: <span class="string">"initial"</span>,</span><br><span class="line">          test: <span class="string">"vendor"</span>,</span><br><span class="line">          name: <span class="string">"vendor"</span>, <span class="comment">// ä½¿ç”¨ vendor å…¥å£ä½œä¸ºå…¬å…±éƒ¨åˆ†</span></span><br><span class="line">          enforce: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ... å…¶ä»–é…ç½®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendor: &#123;</span><br><span class="line">          test: <span class="regexp">/react|angluar|lodash/</span>, <span class="comment">// ç›´æ¥ä½¿ç”¨ test æ¥åšè·¯å¾„åŒ¹é…</span></span><br><span class="line">          chunks: <span class="string">"initial"</span>,</span><br><span class="line">          name: <span class="string">"vendor"</span>,</span><br><span class="line">          enforce: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendor: &#123;</span><br><span class="line">          chunks: <span class="string">"initial"</span>,</span><br><span class="line">          test: path.resolve(__dirname, <span class="string">"node_modules"</span>) <span class="comment">// è·¯å¾„åœ¨ node_modules ç›®å½•ä¸‹çš„éƒ½ä½œä¸ºå…¬å…±éƒ¨åˆ†</span></span><br><span class="line">          name: <span class="string">"vendor"</span>, <span class="comment">// ä½¿ç”¨ vendor å…¥å£ä½œä¸ºå…¬å…±éƒ¨åˆ†</span></span><br><span class="line">          enforce: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šè¿°ç¬¬ä¸€ç§åšæ³•æ˜¯æ˜¾ç¤ºæŒ‡å®šå“ªäº›ç±»åº“ä½œä¸ºå…¬å…±éƒ¨åˆ†ï¼Œç¬¬äºŒç§åšæ³•å®ç°çš„åŠŸèƒ½å·®ä¸å¤šï¼Œåªæ˜¯åˆ©ç”¨äº† test æ¥åšæ¨¡å—è·¯å¾„çš„åŒ¹é…ï¼Œç¬¬ä¸‰ç§åšæ³•æ˜¯æŠŠæ‰€æœ‰åœ¨ node_modules ä¸‹çš„æ¨¡å—ï¼Œå³ä½œä¸ºä¾èµ–å®‰è£…çš„ï¼Œéƒ½ä½œä¸ºå…¬å…±éƒ¨åˆ†ã€‚ä½ å¯ä»¥é’ˆå¯¹é¡¹ç›®æƒ…å†µï¼Œé€‰æ‹©æœ€åˆé€‚çš„åšæ³•</p>
</blockquote>
<h4 id="webpack-3-x-çš„-CommonsChunkPlugin"><a href="#webpack-3-x-çš„-CommonsChunkPlugin" class="headerlink" title="webpack 3.x çš„ CommonsChunkPlugin"></a>webpack 3.x çš„ CommonsChunkPlugin</h4><blockquote>
<p><code>webpack 3.x</code> ä»¥ä¸‹çš„ç‰ˆæœ¬éœ€è¦ç”¨åˆ° webpack è‡ªèº«æä¾›çš„ <code>CommonsChunkPlugin</code> æ’ä»¶ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">'commons'</span>, <span class="comment">// å…¬å…±ä½¿ç”¨çš„ chunk çš„åç§°</span></span><br><span class="line">      filename: <span class="string">'commons.js'</span>, <span class="comment">// å…¬å…± chunk çš„ç”Ÿæˆæ–‡ä»¶å</span></span><br><span class="line">      minChunks: <span class="number">3</span> <span class="comment">// å…¬å…±çš„éƒ¨åˆ†å¿…é¡»è¢« 3 ä¸ª chunk å…±äº«</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>chunk</code> åœ¨è¿™é‡Œæ˜¯æ„å»ºçš„ä¸»å¹²ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªå…¥å£å¯¹åº”ä¸€ä¸ª <code>chunk</code>ã€‚</li>
<li>ä»¥ä¸Šæ’ä»¶é…ç½®åœ¨æ„å»ºåä¼šç”Ÿæˆä¸€ä¸ª <code>commons.js</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°±æ˜¯ä»£ç ä¸­çš„å…¬å…±éƒ¨åˆ†ã€‚ä¸Šé¢çš„é…ç½®ä¸­ <code>minChunks</code> å­—æ®µä¸º 3ï¼Œè¯¥å­—æ®µçš„æ„æ€æ˜¯å½“ä¸€ä¸ªæ¨¡å—è¢« 3 ä¸ªä»¥ä¸Šçš„ <code>chunk</code> ä¾èµ–æ—¶ï¼Œè¿™ä¸ªæ¨¡å—å°±ä¼šè¢«åˆ’åˆ†åˆ° <code>commons chunk</code> ä¸­å»ã€‚å•ä»è¿™ä¸ªé…ç½®çš„è§’åº¦ä¸Šè®²ï¼Œè¿™ç§æ–¹å¼å¹¶æ²¡æœ‰ <code>4.x</code> çš„ <code>chunks: &quot;all&quot;</code> é‚£ä¹ˆæ–¹ä¾¿ã€‚</li>
</ul>
<p><strong>CommonsChunkPlugin ä¹Ÿæ˜¯æ”¯æŒæ˜¾å¼é…ç½®å…±äº«ç±»åº“çš„</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [<span class="string">'react'</span>, <span class="string">'react-redux'</span>], <span class="comment">// æŒ‡å®šå…¬å…±ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ç±»åº“</span></span><br><span class="line">    app: <span class="string">'./src/entry'</span>,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">'vendor'</span> <span class="comment">// ä½¿ç”¨ vendor å…¥å£ä½œä¸ºå…¬å…±éƒ¨åˆ†</span></span><br><span class="line">      filename: <span class="string">"vendor.js"</span>,</span><br><span class="line">      minChunks: <span class="literal">Infinity</span>, <span class="comment">// è¿™ä¸ªé…ç½®ä¼šè®© webpack ä¸å†è‡ªåŠ¨æŠ½ç¦»å…¬å…±æ¨¡å—</span></span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šè¿°é…ç½®ä¼šç”Ÿæˆä¸€ä¸ªåä¸º <code>vendor.js</code> çš„å…±äº«ä»£ç æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº† <code>React</code> å’Œ <code>React-Redux</code> åº“çš„ä»£ç ï¼Œå¯ä»¥æä¾›ç»™å¤šä¸ªä¸åŒçš„å…¥å£ä»£ç ä½¿ç”¨ã€‚è¿™é‡Œçš„ <code>minChunks</code> å­—æ®µçš„é…ç½®ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>Infinity</code>ï¼Œå¯ä»¥ç†è§£ä¸º <code>webpack</code> ä¸è‡ªåŠ¨æŠ½ç¦»å…¬å…±æ¨¡å—ã€‚å¦‚æœè¿™é‡Œå’Œä¹‹å‰ä¸€æ ·ä¾æ—§è®¾ç½®ä¸º 3ï¼Œé‚£ä¹ˆè¢« 3 ä¸ªä»¥ä¸Šçš„ <code>chunk</code> ä¾èµ–çš„æ¨¡å—ä¼šå’Œ <code>React</code>ã€<code>React-Redux</code> ä¸€åŒæ‰“åŒ…è¿› <code>vendor</code>ï¼Œè¿™æ ·å°±å¤±å»æ˜¾å¼æŒ‡å®šçš„æ„ä¹‰äº†ã€‚</p>
</blockquote>
<blockquote>
<p><code>minChunks</code> å…¶å®è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">minChunks: <span class="function">(<span class="params"><span class="built_in">module</span>, count</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">module</span>, count);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¯¥å‡½æ•°åœ¨åˆ†ææ¯ä¸€ä¸ªä¾èµ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨ï¼Œä¼ å…¥å½“å‰ä¾èµ–æ¨¡å—çš„ä¿¡æ¯ <code>module</code>ï¼Œä»¥åŠå·²ç»è¢«ä½œä¸ºå…¬å…±æ¨¡å—çš„æ•°é‡ <code>count</code>ï¼Œä½ å¯ä»¥åœ¨å‡½æ•°ä¸­é’ˆå¯¹æ¯ä¸€ä¸ªæ¨¡å—åšæ›´åŠ ç²¾ç»†åŒ–çš„æ§åˆ¶ã€‚çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">minChunks: <span class="function">(<span class="params"><span class="built_in">module</span>, count</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.context &amp;&amp; <span class="built_in">module</span>.context.includes(<span class="string">"node_modules"</span>);</span><br><span class="line">  <span class="comment">// node_modules ç›®å½•ä¸‹çš„æ¨¡å—éƒ½ä½œä¸ºå…¬å…±éƒ¨åˆ†ï¼Œæ•ˆæœå°±å¦‚åŒ webpack 4.x ä¸­çš„ test: path.resolve(__dirname, "node_modules")</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ul>
<li>æ›´å¤šä½¿ç”¨ <code>CommonsChunkPlugin</code> çš„é…ç½®å‚è€ƒå®˜æ–¹æ–‡æ¡£ <code>commons-chunk-plugin</code>ã€‚</li>
</ul>
<h3 id="è¿›ä¸€æ­¥æ§åˆ¶-JS-å¤§å°"><a href="#è¿›ä¸€æ­¥æ§åˆ¶-JS-å¤§å°" class="headerlink" title="è¿›ä¸€æ­¥æ§åˆ¶ JS å¤§å°"></a>è¿›ä¸€æ­¥æ§åˆ¶ JS å¤§å°</h3><h4 id="æŒ‰éœ€åŠ è½½æ¨¡å—"><a href="#æŒ‰éœ€åŠ è½½æ¨¡å—" class="headerlink" title="æŒ‰éœ€åŠ è½½æ¨¡å—"></a>æŒ‰éœ€åŠ è½½æ¨¡å—</h4><blockquote>
<p>åœ¨ webpack çš„æ„å»ºç¯å¢ƒä¸­ï¼Œè¦æŒ‰éœ€åŠ è½½ä»£ç æ¨¡å—å¾ˆç®€å•ï¼Œéµå¾ª ES æ ‡å‡†çš„åŠ¨æ€åŠ è½½è¯­æ³• <code>dynamic-import</code> æ¥ç¼–å†™ä»£ç å³å¯ï¼Œ<code>webpack</code> ä¼šè‡ªåŠ¨å¤„ç†ä½¿ç”¨è¯¥è¯­æ³•ç¼–å†™çš„æ¨¡å—</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import ä½œä¸ºä¸€ä¸ªæ–¹æ³•ä½¿ç”¨ï¼Œä¼ å…¥æ¨¡å—åå³å¯ï¼Œè¿”å›ä¸€ä¸ª promise æ¥è·å–æ¨¡å—æš´éœ²çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">// æ³¨é‡Š webpackChunkName: "lodash" å¯ä»¥ç”¨äºæŒ‡å®š chunk çš„åç§°ï¼Œåœ¨è¾“å‡ºæ–‡ä»¶æ—¶æœ‰ç”¨</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: "lodash" */</span> <span class="string">'lodash'</span>).then(<span class="function">(<span class="params">_</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(_.lash([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])) <span class="comment">// æ‰“å° 3</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœä½ ä½¿ç”¨äº† <code>Babel</code> çš„è¯ï¼Œè¿˜éœ€è¦ <code>Syntax Dynamic Import</code> è¿™ä¸ª <code>Babel</code> æ’ä»¶æ¥å¤„ç† <code>import()</code> è¿™ç§è¯­æ³•ã€‚</li>
<li>ç”±äºåŠ¨æ€åŠ è½½ä»£ç æ¨¡å—çš„è¯­æ³•ä¾èµ–äº <code>promise</code>ï¼Œå¯¹äºä½ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œéœ€è¦æ·»åŠ  <code>promise</code> çš„ <code>polyfill</code> åæ‰èƒ½ä½¿ç”¨ã€‚</li>
<li>å¦‚ä¸Šçš„ä»£ç ï¼Œwebpack æ„å»ºæ—¶ä¼šè‡ªåŠ¨æŠŠ <code>lodash</code> æ¨¡å—åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶ä¸”åœ¨ä»£ç å†…éƒ¨å®ç°åŠ¨æ€åŠ è½½ <code>lodash</code> çš„åŠŸèƒ½ã€‚åŠ¨æ€åŠ è½½ä»£ç æ—¶ä¾èµ–äºç½‘ç»œï¼Œå…¶æ¨¡å—å†…å®¹ä¼šå¼‚æ­¥è¿”å›ï¼Œæ‰€ä»¥ import æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ª <code>promise</code> æ¥è·å–åŠ¨æ€åŠ è½½çš„æ¨¡å—å†…å®¹ã€‚</li>
<li><code>import</code> åé¢çš„æ³¨é‡Š <code>webpackChunkName: &quot;lodash&quot;</code> ç”¨äºå‘ŠçŸ¥ <code>webpack</code> æ‰€è¦åŠ¨æ€åŠ è½½æ¨¡å—çš„åç§°ã€‚æˆ‘ä»¬åœ¨ webpack é…ç½®ä¸­æ·»åŠ ä¸€ä¸ª <code>output.chunkFilename</code> çš„é…ç½®â€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">  filename: <span class="string">'[name].[hash:8].js'</span>,</span><br><span class="line">  chunkFilename: <span class="string">'[name].[hash:8].js'</span> <span class="comment">// æŒ‡å®šåˆ†ç¦»å‡ºæ¥çš„ä»£ç æ–‡ä»¶çš„åç§°</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·å°±å¯ä»¥æŠŠåˆ†ç¦»å‡ºæ¥çš„æ–‡ä»¶åç§°ç”¨ lodash æ ‡è¯†äº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/1480597-ae36b6816feed422.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<blockquote>
<p>å¦‚æœæ²¡æœ‰æ·»åŠ æ³¨é‡Š <code>webpackChunkName: &quot;lodash&quot; ä»¥åŠ output.chunkFilename</code> é…ç½®ï¼Œé‚£ä¹ˆåˆ†ç¦»å‡ºæ¥çš„æ–‡ä»¶åç§°ä¼šä»¥ç®€å•æ•°å­—çš„æ–¹å¼æ ‡è¯†ï¼Œä¸ä¾¿äºè¯†åˆ«</p>
</blockquote>
<h4 id="ä»¥ä¸Šå®Œæ•´ç¤ºä¾‹ä»£ç "><a href="#ä»¥ä¸Šå®Œæ•´ç¤ºä¾‹ä»£ç " class="headerlink" title="ä»¥ä¸Šå®Œæ•´ç¤ºä¾‹ä»£ç "></a>ä»¥ä¸Šå®Œæ•´ç¤ºä¾‹ä»£ç </h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line"></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].js'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?/</span>,</span><br><span class="line">        include: [path.resolve(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        use: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">          use: [<span class="string">'css-loader'</span>, <span class="string">'postcss-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: <span class="number">8192</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'image-webpack-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              mozjpeg: &#123;</span><br><span class="line">                <span class="comment">// å‹ç¼© jpeg çš„é…ç½®</span></span><br><span class="line">                progressive: <span class="literal">true</span>,</span><br><span class="line">                quality: <span class="number">65</span></span><br><span class="line">              &#125;,</span><br><span class="line">              optipng: &#123;</span><br><span class="line">                <span class="comment">// ä½¿ç”¨ imagemin-optipng å‹ç¼© pngï¼Œenable: false ä¸ºå…³é—­</span></span><br><span class="line">                enabled: <span class="literal">false</span></span><br><span class="line">              &#125;,</span><br><span class="line">              pngquant: &#123;</span><br><span class="line">                <span class="comment">// ä½¿ç”¨ imagemin-pngquant å‹ç¼© png</span></span><br><span class="line">                quality: <span class="string">'65-90'</span>,</span><br><span class="line">                speed: <span class="number">4</span></span><br><span class="line">              &#125;,</span><br><span class="line">              gifsicle: &#123;</span><br><span class="line">                <span class="comment">// å‹ç¼© gif çš„é…ç½®</span></span><br><span class="line">                interlaced: <span class="literal">false</span></span><br><span class="line">              &#125;,</span><br><span class="line">              webp: &#123;</span><br><span class="line">                <span class="comment">// å¼€å¯ webpï¼Œä¼šæŠŠ jpg å’Œ png å›¾ç‰‡å‹ç¼©ä¸º webp æ ¼å¼</span></span><br><span class="line">                quality: <span class="number">75</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendor: &#123;</span><br><span class="line">          chunks: <span class="string">'initial'</span>,</span><br><span class="line">          test: path.resolve(__dirname, <span class="string">'node_modules'</span>), <span class="comment">// è·¯å¾„åœ¨ node_modules ç›®å½•ä¸‹çš„éƒ½ä½œä¸ºå…¬å…±éƒ¨åˆ†</span></span><br><span class="line">          name: <span class="string">'vendor'</span>, <span class="comment">// ä½¿ç”¨ vendor å…¥å£ä½œä¸ºå…¬å…±éƒ¨åˆ†</span></span><br><span class="line">          enforce: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>, <span class="comment">// é…ç½®è¾“å‡ºæ–‡ä»¶åå’Œè·¯å¾„</span></span><br><span class="line">      template: <span class="string">'src/index.html'</span>, <span class="comment">// é…ç½®æ–‡ä»¶æ¨¡æ¿</span></span><br><span class="line">      minify: &#123;</span><br><span class="line">        <span class="comment">// å‹ç¼© HTML çš„é…ç½®</span></span><br><span class="line">        minifyCSS: <span class="literal">true</span>, <span class="comment">// å‹ç¼© HTML ä¸­å‡ºç°çš„ CSS ä»£ç </span></span><br><span class="line">        minifyJS: <span class="literal">true</span>, <span class="comment">// å‹ç¼© HTML ä¸­å‡ºç°çš„ JS ä»£ç </span></span><br><span class="line">        removeComments: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].css'</span>),</span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2018/09/19/Axios-ä½¿ç”¨å§¿åŠ¿æŒ‡å—/" class="prev">PREV</a><a href="/2018/07/22/Async-await-æŸ¥æ¼è¡¥ç¼º/" class="next">NEXT</a></div><div id="gc_container"></div><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><script>(new Gitment({
    id: 'aid' + (new Date('Tue Sep 11 2018 22:16:37 GMT+0800')).getTime()/1000,
    title: 'Webpack 4 å®šåˆ¶å‰ç«¯å¼€å‘ç¯å¢ƒ' + ' Â· è¯„è®º',
    link: decodeURI(location.protocol + '//' + location.hostname + location.pathname),
    repo: 'ifyour.github.io',
    owner: 'ifyour',
    oauth: {
        client_id: '576e98d38d4bd19f8a02',
        client_secret: 'ba3616bf2f20c5da947a1fd5c7ef0edff4ffab99',
    }
})).render('gc_container');</script><div class="copyright"><p>Â© 2015 - 2019 Made with <span>â¤</span> by <a href="https://github.com/ifyour/ifyour.github.io">Ifyour</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.4.0/lib/darkmode-js.min.js"></script><script>new Darkmode({
    bottom: '1rem',
    right: '1rem',
    left: 'unset',
    time: '0.5s',
    mixColor: '#fff',
    backgroundColor: '#fff',
    buttonColorDark: '#100f2c',
    buttonColorLight: '#fff',
    saveInCookies: true,
    label: 'ğŸŒ“',
    autoMatchOsTheme: true
}).showWidget();
</script><script src="/js/algoliasearch.min.js"></script><script src="/js/template-web.min.js"></script><script src="/js/main.js"></script><script src="https://unpkg.com/medium-zoom@0/dist/medium-zoom.min.js"></script><script>mediumZoom('article img', {margin: 24});
(function(win, targetElem) {
    if (!targetElem) return;
    win.onscroll = (function() {
        if (isElementInViewport(targetElem)) {
            win.onscroll = null;
            return mediumZoom('.gitment-comment-main img', {margin: 24});
        }
        return arguments.callee;
    })();
    function isElementInViewport(el) {
        var rect = el.getBoundingClientRect();
        var winH = win.innerHeight || document.documentElement.clientHeight;
        return rect.top <= winH && rect.bottom >= winH;
    };
})(this, document.querySelector('#gc_container'));
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-120929321-1",'auto');ga('send','pageview');</script></footer></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>