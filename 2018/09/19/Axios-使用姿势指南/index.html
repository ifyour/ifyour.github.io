<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#ffffff"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Ifyour's Blog"><meta name="msapplication-TileImage" content="/img/webAppIcon-256x256.png"><meta name="msapplication-TileColor" content="#000"><meta property="algolia:search" data-application-id="3XQ5CPDDMK" data-api-key="abe9e26eebcac723f34ade5cf6b97441" data-index-name="prod_blog"><title>Axios ä½¿ç”¨å§¿åŠ¿æŒ‡å— Â· Ifyour's Blog</title><meta name="description" content="Axios ä½¿ç”¨å§¿åŠ¿æŒ‡å— - Ifyour"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="manifest" href="/manifest.json"><link rel="icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="apple-touch-icon" size="256x256" href="/img/webAppIcon-256x256.png"><link rel="apple-touch-icon" size="512x512" href="/img/webAppIcon-512x512.png"><link rel="apple-touch-startup-image" href="/img/apple-launch-750x1334.png"><link rel="preload" href="/css/apollo.css" as="style"><link rel="preload" href="/js/main.js" as="script"><link rel="search" type="application/opensearchdescription+xml" href="http://ifyour.github.io/atom.xml" title="Ifyour's Blog"></head><body><div class="search"><a href="javascript:;" target="_self" class="close"><svg id="icon-close" viewbox="0 0 16 16" width="24" height="24" fill="#A4A9AC"><path d="M8,15 C4.13400675,15 1,11.8659932 1,8 C1,4.13400675 4.13400675,1 8,1 C11.8659932,1 15,4.13400675 15,8 C15,11.8659932 11.8659932,15 8,15 Z M10.44352,10.7233105 L10.4528296,10.7326201 L10.7326201,10.4528296 C11.0310632,10.1543865 11.0314986,9.66985171 10.7335912,9.37194437 L9.36507937,8.0034325 L10.7360526,6.63245928 C11.0344957,6.33401613 11.0349311,5.84948135 10.7370237,5.55157401 L10.448426,5.26297627 C10.1505186,4.96506892 9.66598387,4.96550426 9.36754072,5.26394741 L8.00589385,6.62559428 L6.63738198,5.25708241 C6.33947464,4.95917507 5.85493986,4.95961041 5.55649671,5.25805356 L5.26737991,5.54717036 C4.96893676,5.84561351 4.96850142,6.33014829 5.26640876,6.62805563 L6.62561103,7.9872579 L5.25463781,9.35823112 C4.95619466,9.65667427 4.95575932,10.141209 5.25366666,10.4391164 L5.5422644,10.7277141 C5.84017175,11.0256215 6.32470652,11.0251861 6.62314967,10.726743 L7.99412289,9.35576976 L9.36263476,10.7242816 C9.66054211,11.022189 10.1450769,11.0217536 10.44352,10.7233105 Z"/></svg></a><div class="container"><input id="search-input" autocomplete="off" type="text" placeholder="Type to search" class="search-input"><div class="search-by">Search by<a href="https://www.algolia.com/" target="_blank"> algolia</a></div><div class="search-results"><div id="search-articles" class="search-item"></div></div></div><script id="search-tmp" type="text/html">{{if list.length}}
    <h3>ARTICLES</h3>
    <ul>
        {{each list item}}
        <li>
            <div class="search-item-title">
                <a href="{{item.permalink}}">{{@item.title}}</a>
            </div>
            <div class="search-item-summary" style="-webkit-box-orient: vertical;">
                {{@item.summary}}
            </div>
        </li>
        {{/each}}
    </ul>
{{else if list}}
    <h2>
        Oops! no result,
        Try it on <a target="_blank" style="color: #2c3e50; border-bottom: 2px solid #42b983; font-size: 19px;" href="https://www.google.com/search?q=site%3Aifyour.github.io+{{keywords}}">Google: {{keywords}}</a>~ ğŸ˜±
    </h2>
{{/if}}</script></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/docs/" target="_self" class="nav-list-link">DOCS</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="javascript:;" target="_self" id="search" class="nav-list-link">SEARCH</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Axios ä½¿ç”¨å§¿åŠ¿æŒ‡å—</h1><div class="post-info">Sep 19, 2018</div><div class="sidebar-toc"><span>Catalog</span><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Axios-ç®€ä»‹"><span class="toc-text">Axios ç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŸºç¡€-API"><span class="toc-text">åŸºç¡€ API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç”¨æ³•ç¤ºä¾‹"><span class="toc-text">ç”¨æ³•ç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GET"><span class="toc-text">GET</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#POST"><span class="toc-text">POST</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç›´æ¥ä½¿ç”¨-config"><span class="toc-text">ç›´æ¥ä½¿ç”¨ config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¹¶å‘è¯·æ±‚"><span class="toc-text">å¹¶å‘è¯·æ±‚</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¨å±€å°è£…ã€å¼‚å¸¸å¤„ç†"><span class="toc-text">å…¨å±€å°è£…ã€å¼‚å¸¸å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å°è£…"><span class="toc-text">å°è£…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¼‚å¸¸å¤„ç†"><span class="toc-text">å¼‚å¸¸å¤„ç†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¶å®ƒé…ç½®"><span class="toc-text">å…¶å®ƒé…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#baseURL"><span class="toc-text">baseURL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¯·æ±‚è¶…æ—¶"><span class="toc-text">è¯·æ±‚è¶…æ—¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å•ç‹¬è®¾ç½®-POST-çš„è¯·æ±‚å¤´"><span class="toc-text">å•ç‹¬è®¾ç½® POST çš„è¯·æ±‚å¤´</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é™„-å®Œæ•´ä»£ç "><span class="toc-text">é™„: å®Œæ•´ä»£ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é™„-Content-Type"><span class="toc-text">é™„: Content-Type</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#application-x-www-form-urlencoded"><span class="toc-text">application/x-www-form-urlencoded</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#multipart-form-data"><span class="toc-text">multipart/form-data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#application-json"><span class="toc-text">application/json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#application-xml"><span class="toc-text">application/xml</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‚è€ƒ"><span class="toc-text">å‚è€ƒ</span></a></li></ol></div><div class="post-content"><p>æœ€è¿‘å‡ ä¸ªé¡¹ç›®éƒ½ç”¨åˆ°äº† Axiosï¼Œå®ƒæ˜¯ä¸€ä¸ªæ›´ç°ä»£çš„ API è¯·æ±‚åº“ï¼ŒåŸºäº Promiseï¼Œèƒ½è¿è¡Œåœ¨æµè§ˆå™¨å’Œ Node.js é‡Œã€‚åœ¨é¡¹ç›®é‡Œï¼Œä¸€èˆ¬éƒ½æ˜¯éœ€è¦è¿›è¡Œä¸€æ¬¡å°è£…å†æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚å¤„ç†é‰´æƒã€è¿˜æœ‰å…¨å±€çš„è¯·æ±‚ Loading åŠ¨ç”»ç­‰ã€‚ä»Šå¤©æ¥æ€»ç»“ä¸€ä¸‹ã€‚</p>
<a id="more"></a>
<h3 id="Axios-ç®€ä»‹"><a href="#Axios-ç®€ä»‹" class="headerlink" title="Axios ç®€ä»‹"></a>Axios ç®€ä»‹</h3><p><a href="https://github.com/axios/axios" target="_blank" rel="noopener">Axios</a> æ˜¯ä¸€ä¸ªåŸºäº Promise ç”¨äºæµè§ˆå™¨å’Œ nodejs çš„ HTTP å®¢æˆ·ç«¯ã€‚å®ƒæœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>ä»æµè§ˆå™¨ä¸­åˆ›å»º XMLHttpRequest</li>
<li>ä» Node.js å‘å‡º HTTP è¯·æ±‚</li>
<li>æ”¯æŒ Promise API</li>
<li>æ‹¦æˆªè¯·æ±‚å’Œå“åº”</li>
<li>è½¬æ¢è¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ®</li>
<li>è‡ªåŠ¨è½¬æ¢ JSON æ•°æ®</li>
<li>å®¢æˆ·ç«¯é˜²æ­¢ CSRF/XSRF</li>
</ul>
<h3 id="åŸºç¡€-API"><a href="#åŸºç¡€-API" class="headerlink" title="åŸºç¡€ API"></a>åŸºç¡€ API</h3><ul>
<li><code>axios.request(config)</code></li>
<li><code>axios.get(url [,config])</code></li>
<li><code>axios.delete(url [,config])</code></li>
<li><code>axios.head(url [,config])</code></li>
<li><code>axios.options(url [,config])</code></li>
<li><code>axios.post(url [,data [,config]])</code></li>
<li><code>axios.put(url [,data [,config]])</code></li>
<li><code>axios.patch(url [,data [,config]])</code></li>
</ul>
<div class="tip"><br>  HTTP è¯·æ±‚æ–¹æ³•ä¸€èˆ¬ä¼šæŒ‰ç…§å®ƒå…·ä½“çš„å«ä¹‰æ¥æ‰§è¡Œç›¸å…³çš„åŠ¨ä½œï¼Œè¿™é‡Œæœ‰ä¸€ä»½ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods" target="_blank" rel="noopener">HTTP åŠ¨è¯å¯¹åº”è§£é‡Š @MDN</a>ã€‚<br></div>

<h3 id="ç”¨æ³•ç¤ºä¾‹"><a href="#ç”¨æ³•ç¤ºä¾‹" class="headerlink" title="ç”¨æ³•ç¤ºä¾‹"></a>ç”¨æ³•ç¤ºä¾‹</h3><h4 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å…·æœ‰æŒ‡å®š ID çš„ç”¨æˆ·å‘å‡ºè¯·æ±‚ï¼ˆå‚æ•°åœ¨ URL ä¸Šï¼‰</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'/user?ID=12345'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥é€šè¿‡ params å¯¹è±¡ä¼ é€’å‚æ•°</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      ID: <span class="number">12345</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">axios</span><br><span class="line">  .post(</span><br><span class="line">    <span class="string">'/user'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      userId: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      headers: &#123;</span><br><span class="line">        token: <span class="string">'abc'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="ç›´æ¥ä½¿ç”¨-config"><a href="#ç›´æ¥ä½¿ç”¨-config" class="headerlink" title="ç›´æ¥ä½¿ç”¨ config"></a>ç›´æ¥ä½¿ç”¨ config</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GET</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  url: <span class="string">'pakage.json'</span>,</span><br><span class="line">  method: <span class="string">'get'</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    <span class="comment">// get åœ¨ params ä¸­å®šä¹‰</span></span><br><span class="line">    userId: <span class="string">'123'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    token: <span class="string">'http-test'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res.data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  url: <span class="string">'pakage.json'</span>,</span><br><span class="line">  method: <span class="string">'post'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    <span class="comment">// post åœ¨ data ä¸­å®šä¹‰</span></span><br><span class="line">    userId: <span class="string">'123'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    token: <span class="string">'http-test'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res.data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="å¹¶å‘è¯·æ±‚"><a href="#å¹¶å‘è¯·æ±‚" class="headerlink" title="å¹¶å‘è¯·æ±‚"></a>å¹¶å‘è¯·æ±‚</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserAcount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ª promise å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/1234'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserPermissions</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ª promise å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/1234/getUserPermissions'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€æ¬¡æ€§è¿”å›ä¸¤ä¸ªæ¥å£</span></span><br><span class="line">axios.all([getUserAccount(), getUserPerssions()]).then(</span><br><span class="line">  axios.spread(<span class="function">(<span class="params">acct, perms</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// spread å±•å¼€ä¸¤ä¸ªè¿”å›çš„ç»“æœ</span></span><br><span class="line">    <span class="comment">// ä¸¤ä¸ªè¯·æ±‚ç°å·²å®Œæˆ</span></span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="å…¨å±€å°è£…ã€å¼‚å¸¸å¤„ç†"><a href="#å…¨å±€å°è£…ã€å¼‚å¸¸å¤„ç†" class="headerlink" title="å…¨å±€å°è£…ã€å¼‚å¸¸å¤„ç†"></a>å…¨å±€å°è£…ã€å¼‚å¸¸å¤„ç†</h3><p>åœ¨é¡¹ç›®ä¸­ï¼Œå¦‚æœæ¯æ¬¡è¯·æ±‚éƒ½å†™ä¸€å † <code>config</code> ä¼šå­˜åœ¨å¤§é‡é‡å¤ä»£ç ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šå°è£…æˆä¸€ä¸ªæ–¹æ³•ï¼ŒæŠŠä¸€äº›å¿…è¦çš„å‚æ•°é…ç½®å¥½ï¼ŒåŒç†ï¼Œå…¨å±€çš„å¼‚å¸¸è¿˜æœ‰é‰´æƒç­‰éƒ½ç»Ÿä¸€é…ç½®ã€‚å•æ¬¡è¯·æ±‚æ•°æ®åªåšå’Œæ•°æ®ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ã€‚ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ Axios çš„å…¨å±€å°è£…ä¾‹å­ã€‚</p>
<h4 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST æ–¹æ³•å°è£…  (åŸç”Ÿ form æäº¤)</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> postRequest = <span class="function">(<span class="params">url, params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> axios(&#123;</span><br><span class="line">    method: <span class="string">'post'</span>,</span><br><span class="line">    url: url,</span><br><span class="line">    data: params,</span><br><span class="line">    transformRequest: [</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(data);</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST æ–¹æ³•å°è£…  (æ–‡ä»¶ä¸Šä¼ )</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> uploadFileRequest = <span class="function">(<span class="params">url, params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> axios(&#123;</span><br><span class="line">    method: <span class="string">'post'</span>,</span><br><span class="line">    url: url,</span><br><span class="line">    data: params,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'multipart/form-data'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET æ–¹æ³•å°è£…</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getRequest = <span class="function"><span class="params">url</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> axios(&#123;</span><br><span class="line">    method: <span class="string">'get'</span>,</span><br><span class="line">    url: url</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PUT æ–¹æ³•å°è£…</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> putRequest = <span class="function">(<span class="params">url, params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> axios(&#123;</span><br><span class="line">    method: <span class="string">'put'</span>,</span><br><span class="line">    url: url,</span><br><span class="line">    data: params,</span><br><span class="line">    transformRequest: [</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(data);</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DELETE æ–¹æ³•å°è£…</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteRequest = <span class="function"><span class="params">url</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> axios(&#123;</span><br><span class="line">    method: <span class="string">'delete'</span>,</span><br><span class="line">    url: url</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">'element-ui'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  è¯·æ±‚æ‹¦æˆª</span></span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    <span class="comment">// è¯·æ±‚å‰é…ç½® config</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  err =&gt; &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">    Message.error(&#123; <span class="attr">message</span>: <span class="string">'è¯·æ±‚è¶…æ—¶!'</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆª</span></span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">  data =&gt; &#123;</span><br><span class="line">    <span class="comment">// è¯·æ±‚åå¤„ç†å¯¹åº”çš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹å¼ä¸€ï¼šå’Œåç«¯çº¦å®šå“åº”ç  `code`</span></span><br><span class="line">    <span class="keyword">switch</span> (data.code) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'0'</span>:</span><br><span class="line">        <span class="comment">// æ­£å¸¸ç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">      <span class="comment">// éœ€è¦é‡æ–°ç™»å½•</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'-1'</span>:</span><br><span class="line">        <span class="comment">// some code here..</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹å¼äºŒï¼šä»…åˆ¤æ–­ HTTP çŠ¶æ€ç </span></span><br><span class="line">    <span class="keyword">if</span> (data.status &amp;&amp; data.status == <span class="number">200</span> &amp;&amp; data.data.status == <span class="string">'error'</span>) &#123;</span><br><span class="line">      Message.error(&#123; <span class="attr">message</span>: data.data.msg &#125;);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;,</span><br><span class="line">  err =&gt; &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (err &amp;&amp; err.response) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (err.response.status) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">          err.message = <span class="string">'è¯·æ±‚é”™è¯¯ (400)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          err.message = <span class="string">'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½• (401)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">          err.message = <span class="string">'æ‹’ç»è®¿é—® (403)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">          err.message = <span class="string">'è¯·æ±‚å‡ºé”™ (404)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">408</span>:</span><br><span class="line">          err.message = <span class="string">'è¯·æ±‚è¶…æ—¶ (408)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">          err.message = <span class="string">'æœåŠ¡å™¨é”™è¯¯ (500)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">501</span>:</span><br><span class="line">          err.message = <span class="string">'æœåŠ¡æœªå®ç° (501)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">502</span>:</span><br><span class="line">          err.message = <span class="string">'ç½‘ç»œé”™è¯¯ (502)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">503</span>:</span><br><span class="line">          err.message = <span class="string">'æœåŠ¡ä¸å¯ç”¨ (503)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">504</span>:</span><br><span class="line">          err.message = <span class="string">'ç½‘ç»œè¶…æ—¶ (504)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">505</span>:</span><br><span class="line">          err.message = <span class="string">'HTTP ç‰ˆæœ¬ä¸å—æ”¯æŒ (505)'</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          err.message = <span class="string">`è¿æ¥å‡ºé”™ (<span class="subst">$&#123;err.response.status&#125;</span>)!`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      err.message = <span class="string">'è¿æ¥æœåŠ¡å™¨å¤±è´¥!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Message.err(&#123; <span class="attr">message</span>: err.message &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<div class="tip"><br>è¯·æ±‚å‡ºé”™çš„æ—¶å€™æ‰§è¡Œçš„æ˜¯ï¼š<code>Promise.resolve(err)</code>ï¼Œè€Œä¸æ˜¯ <code>Promise.reject(err)</code>ï¼Œè¿™æ ·æ— è®ºè¯·æ±‚æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œåœ¨æˆåŠŸçš„å›è°ƒä¸­éƒ½èƒ½æ”¶åˆ°é€šçŸ¥ã€‚<br></div>

<h3 id="å…¶å®ƒé…ç½®"><a href="#å…¶å®ƒé…ç½®" class="headerlink" title="å…¶å®ƒé…ç½®"></a>å…¶å®ƒé…ç½®</h3><h4 id="baseURL"><a href="#baseURL" class="headerlink" title="baseURL"></a>baseURL</h4><p>é€šè¿‡ <code>axios.defaults.baseURL</code> æ¥è®¾ç½® API çš„æ ¹åŸŸåã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">'development'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'https://dev.server.com/'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">'debug'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'https://debug.server.com/'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">'production'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'https://pro.server.com/'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="tip"><br><code>process.env</code> æ˜¯ Node.js æä¾›çš„å…¨å±€å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ npm scripts é‡Œé€šè¿‡ cross-env è¿™ä¸ªå·¥å…·ç»Ÿä¸€é…ç½®ä¸åŒçš„ç¯å¢ƒï¼Œcross-env åšäº†å„ç§ç³»ç»Ÿå¹³å°çš„å…¼å®¹å¤„ç†ã€‚ä¸€èˆ¬ç”¨è¿™ä¸ªè®¾ç½®ç¯å¢ƒå˜é‡ã€‚<br></div>

<h4 id="è¯·æ±‚è¶…æ—¶"><a href="#è¯·æ±‚è¶…æ—¶" class="headerlink" title="è¯·æ±‚è¶…æ—¶"></a>è¯·æ±‚è¶…æ—¶</h4><p>é€šè¿‡ <code>axios.defaults.timeout</code> è®¾ç½®é»˜è®¤çš„è¯·æ±‚è¶…æ—¶æ—¶é—´ã€‚ä¾‹å¦‚è¶…è¿‡äº† 10sï¼Œå°±ä¼šå‘ŠçŸ¥ç”¨æˆ·å½“å‰è¯·æ±‚è¶…æ—¶ï¼Œè¯·åˆ·æ–°ç­‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.timeout = <span class="number">10000</span>;</span><br></pre></td></tr></table></figure>
<h4 id="å•ç‹¬è®¾ç½®-POST-çš„è¯·æ±‚å¤´"><a href="#å•ç‹¬è®¾ç½®-POST-çš„è¯·æ±‚å¤´" class="headerlink" title="å•ç‹¬è®¾ç½® POST çš„è¯·æ±‚å¤´"></a>å•ç‹¬è®¾ç½® POST çš„è¯·æ±‚å¤´</h4><p>æ¯”å¦‚è®¾ç½® POST æäº¤ï¼ˆåŸç”Ÿ formï¼‰æ—¶å•ç‹¬é…ç½®ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] =</span><br><span class="line">  <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="é™„-å®Œæ•´ä»£ç "><a href="#é™„-å®Œæ•´ä»£ç " class="headerlink" title="é™„: å®Œæ•´ä»£ç "></a>é™„: å®Œæ•´ä»£ç </h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> QS <span class="keyword">from</span> <span class="string">'qs'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Toast &#125; <span class="keyword">from</span> <span class="string">'vant'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¯å¢ƒçš„åˆ‡æ¢</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">'development'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'https://dev.server.com/'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">'debug'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'https://debug.server.com/'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">'production'</span>) &#123;</span><br><span class="line">  axios.defaults.baseURL = <span class="string">'https://pro.server.com/'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚è¶…æ—¶æ—¶é—´</span></span><br><span class="line">axios.defaults.timeout = <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST è¯·æ±‚å¤´</span></span><br><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] =</span><br><span class="line">  <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨</span></span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">  config = &gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> token = store.state.token;</span><br><span class="line">    token &amp;&amp; (config.headers.Authorization = token);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;, error = &gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆªå™¨</span></span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">  response = &gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (response.status === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// æœåŠ¡å™¨çŠ¶æ€ç ä¸æ˜¯ 200 çš„æƒ…å†µ</span></span><br><span class="line">  error = &gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (error.response.status) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (error.response.status) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          router.replace(&#123;</span><br><span class="line">            path: <span class="string">'/login'</span>,</span><br><span class="line">            query: &#123;</span><br><span class="line">              redirect: router.currentRoute.fullPath</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">          Toast(&#123;</span><br><span class="line">            message: <span class="string">'ç™»å½•è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•'</span>,</span><br><span class="line">            duration: <span class="number">1000</span>,</span><br><span class="line">            forbidClick: <span class="literal">true</span></span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">          <span class="comment">// 404 è¯·æ±‚ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">          Toast(&#123;</span><br><span class="line">            message: <span class="string">'ç½‘ç»œè¯·æ±‚ä¸å­˜åœ¨'</span>,</span><br><span class="line">            duration: <span class="number">1500</span>,</span><br><span class="line">            forbidClick: <span class="literal">true</span></span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">          <span class="comment">// å…¶ä»–é”™è¯¯ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯æç¤º</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          Toast(&#123;</span><br><span class="line">            message: error.response.data.message,</span><br><span class="line">            duration: <span class="number">1500</span>,</span><br><span class="line">            forbidClick: <span class="literal">true</span></span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error.response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET è¯·æ±‚</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .get(url, &#123; <span class="attr">params</span>: params &#125;)</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch (<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        reject(err.data)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST è¯·æ±‚</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">post</span>(<span class="params">url, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .post(url, QS.stringify(params))</span><br><span class="line">      .then(res = &gt; &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch (<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        reject(err.data)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é™„-Content-Type"><a href="#é™„-Content-Type" class="headerlink" title="é™„: Content-Type"></a>é™„: Content-Type</h3><p>è¯´åˆ°å’ŒæœåŠ¡ç«¯æ•°æ®äº¤äº’ï¼Œæ€»æ˜¯ç»•ä¸å¼€è¿™ä¸ªï¼Œå¿…é¡»è¦æ‰«ç›²ä¸€ä¸‹äº†ï¼ğŸ˜‚ğŸ˜‚</p>
<blockquote>
<p>Content-Type ç”¨äºæŒ‡å®šå†…å®¹ç±»å‹ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼ŒContent-Type å±æ€§æŒ‡å®šè¯·æ±‚å’Œå“åº”çš„ HTTP å†…å®¹ç±»å‹ã€‚å¦‚æœæœªæŒ‡å®š ContentTypeï¼Œé»˜è®¤ä¸º <code>text/html</code>ã€‚</p>
</blockquote>
<p>å¸¸è§ç±»å‹æœ‰ï¼š</p>
<ul>
<li>text/html</li>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>application/json</li>
<li>application/xml</li>
</ul>
<p><code>application/x-www-form-urlencoded</code>ã€<code>multipart/form-data</code>ã€<code>application/json</code>ã€<code>application/xml</code> è¿™å››ä¸ªåˆ™æ˜¯ ajax è¯·æ±‚éœ€è¦æŒ‡å®šçš„ç±»å‹ï¼Œè¡¨å•æäº¤æˆ–ä¸Šä¼ æ–‡ä»¶å¸¸ç”¨çš„èµ„æºç±»å‹ã€‚</p>
<h4 id="application-x-www-form-urlencoded"><a href="#application-x-www-form-urlencoded" class="headerlink" title="application/x-www-form-urlencoded"></a>application/x-www-form-urlencoded</h4><p>è¿™æ˜¯è¡¨å•é»˜è®¤æäº¤æ–¹å¼ï¼Œæ ¼å¼ä¸º URL ç¼–ç  <code>key=value&amp;key1=value1</code>ã€‚</p>
<div style="max-width: 500px"><img src="https://user-images.githubusercontent.com/9158841/32037816-ade83a36-b9ec-11e7-9f07-4f72a99c6aaa.png" alt="image"></div>

<p>æ³¨ï¼šChrome æµè§ˆå™¨ä¼šè‡ªåŠ¨æ ¼å¼åŒ–æˆæ˜“è¯»çš„æ ¼å¼</p>
<h4 id="multipart-form-data"><a href="#multipart-form-data" class="headerlink" title="multipart/form-data"></a>multipart/form-data</h4><p>ä½¿ç”¨è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå¿…é¡»æŒ‡å®šè¡¨å•çš„ enctype å±æ€§å€¼ä¸º <code>multipart/form-data</code>ã€‚<br>è¯·æ±‚ä½“è¢«åˆ†å‰²æˆå¤šéƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†ä½¿ç”¨ <code>--boundary</code> åˆ†å‰²ï¼Œä½¿ç”¨ <code>--boundary--\r\n</code> ç»“æŸã€‚</p>
<p>è¡¨å•ä¸Šä¼ æ–‡ä»¶ Demo:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/upload"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·å: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">    å¯†ç : <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line">    ä¸Šä¼ æ–‡ä»¶: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<div style="max-width: 500px"><img src="https://user-images.githubusercontent.com/9158841/32038354-1201f94c-b9ef-11e7-8817-fb9031b2b036.png" alt="image"></div>

<h4 id="application-json"><a href="#application-json" class="headerlink" title="application/json"></a>application/json</h4><p>Axios é»˜è®¤ <code>POST</code> æäº¤æ–¹å¼å°±æ˜¯ <code>application/json</code>ï¼Œæ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨ axios æäº¤è¡¨å•æ—¶éœ€è¦æ³¨æ„åç«¯èƒ½ä¸èƒ½è§£æï¼Œä¸èƒ½è§£æéœ€è¦è®¾ç½® <code>POST</code> å¸¸ç”¨æ ¼å¼ <code>application/x-www-form-urlencoded</code>ï¼Œä¸”æäº¤çš„æ•°æ®éœ€è¦ä½¿ç”¨ qs æ¨¡å—åºåˆ—åŒ–æ ¼å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">axios.post(</span><br><span class="line">  <span class="string">'https://jsonplaceholder.typicode.com/posts'</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    userId: <span class="number">1</span>,</span><br><span class="line">    name: <span class="string">'ifyour'</span>,</span><br><span class="line">    arr: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    transformRequest: [</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(data);</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<div style="max-width: 400px"><img src="https://user-images.githubusercontent.com/15377484/45913317-a939a580-be62-11e8-9d96-1a097337da44.png" alt="image"></div>

<h4 id="application-xml"><a href="#application-xml" class="headerlink" title="application/xml"></a>application/xml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST http://www.example.com HTTP/1.1</span><br><span class="line">Content-Type: text/xml</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>123<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">params</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>example<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>21<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">params</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><a href="https://github.com/axios/axios#installing" target="_blank" rel="noopener">Axios å®˜æ–¹æ–‡æ¡£ @GitHub</a></li>
<li><a href="http://tool.oschina.net/commons" target="_blank" rel="noopener">HTTP Content-Type å¯¹ç…§è¡¨ @OSChina</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods" target="_blank" rel="noopener">HTTP è¯·æ±‚æ–¹æ³• @MDN</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/11/25/å‰åç«¯é‰´æƒæ–¹å¼æ€»ç»“/" class="prev">PREV</a><a href="/2018/09/11/webpack4-å®šåˆ¶å‰ç«¯å¼€å‘ç¯å¢ƒ/" class="next">NEXT</a></div><div id="gc_container"></div><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><script>(new Gitment({
    id: 'aid' + (new Date('Wed Sep 19 2018 22:09:48 GMT+0800')).getTime()/1000,
    title: 'Axios ä½¿ç”¨å§¿åŠ¿æŒ‡å—' + ' Â· è¯„è®º',
    link: decodeURI(location.protocol + '//' + location.hostname + location.pathname),
    repo: 'ifyour.github.io',
    owner: 'ifyour',
    oauth: {
        client_id: '576e98d38d4bd19f8a02',
        client_secret: 'ba3616bf2f20c5da947a1fd5c7ef0edff4ffab99',
    }
})).render('gc_container');</script><div class="copyright"><p>Â© 2015 - 2019 Made with <span>â¤</span> by <a href="https://github.com/ifyour/ifyour.github.io">Ifyour</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.4.0/lib/darkmode-js.min.js"></script><script>new Darkmode({
    bottom: '1rem',
    right: '1rem',
    left: 'unset',
    time: '0.5s',
    mixColor: '#fff',
    backgroundColor: '#fff',
    buttonColorDark: '#100f2c',
    buttonColorLight: '#fff',
    saveInCookies: true,
    label: 'ğŸŒ“',
    autoMatchOsTheme: true
}).showWidget();
</script><script src="/js/algoliasearch.min.js"></script><script src="/js/template-web.min.js"></script><script src="/js/main.js"></script><script src="https://unpkg.com/medium-zoom@0/dist/medium-zoom.min.js"></script><script>mediumZoom('article img', {margin: 24});
(function(win, targetElem) {
    if (!targetElem) return;
    win.onscroll = (function() {
        if (isElementInViewport(targetElem)) {
            win.onscroll = null;
            return mediumZoom('.gitment-comment-main img', {margin: 24});
        }
        return arguments.callee;
    })();
    function isElementInViewport(el) {
        var rect = el.getBoundingClientRect();
        var winH = win.innerHeight || document.documentElement.clientHeight;
        return rect.top <= winH && rect.bottom >= winH;
    };
})(this, document.querySelector('#gc_container'));
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-120929321-1",'auto');ga('send','pageview');</script></footer></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>