{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"themes/hexo-theme-apollo/source/favicon.png","path":"favicon.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-apollo/source/css/apollo.css","path":"css/apollo.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-apollo/source/font/sourcesanspro.woff","path":"font/sourcesanspro.woff","modified":0,"renderable":1},{"_id":"themes/hexo-theme-apollo/source/font/sourcesanspro.woff2","path":"font/sourcesanspro.woff2","modified":0,"renderable":1},{"_id":"themes/hexo-theme-apollo/source/scss/apollo.scss","path":"scss/apollo.scss","modified":0,"renderable":1}],"Cache":[{"_id":"themes/hexo-theme-apollo/.gitignore","hash":"a006beea0877a0aa3610ee00e73f62cb1d45125b","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/LICENSE","hash":"6e31ac9076bfc8f09ae47977419eee4edfb63e5b","modified":1529228970000},{"_id":"source/favicon.ico","hash":"10df6f583311f8533e055ab21ad1be9eb3a7d80d","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/README.md","hash":"201c76d030a98578ed5a6ad5c766a7bde91c32d3","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/_config.yml","hash":"6b35d2a1c948621f20298fe60602a90f1e8e8877","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/gulpfile.js","hash":"857a026b6643a2cd52c65d4ae0dc7fe9618206ee","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/package.json","hash":"dee40ba0d89f70bf47d63f0bece41226baa6d592","modified":1529228970000},{"_id":"source/_posts/7æ‹›è½»æ¾æå®š-JavaScript-å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥.md","hash":"9f44011273ddbd72ef37179f84bc77f255941ef3","modified":1529228970000},{"_id":"source/_posts/CentOS-6-x86-Node-js-MongoDB-Express-ç¯å¢ƒé…ç½®ç¬”è®°.md","hash":"0dd99e65f66f722d645a823f910551a567239c72","modified":1529228970000},{"_id":"source/_posts/ES6-Promise-ç®€æ˜æŒ‡å—.md","hash":"1a5b115ff8db5054ba8170c4ac26bf0218ecd1c6","modified":1529228970000},{"_id":"source/_posts/Git-æ“ä½œè¯¦ç»†æ€»ç»“.md","hash":"67100f507fb33044881e49890bc80694e3c31bd1","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/yarn.lock","hash":"8a6b065e679c598c09e61e090d5579499bbdcc3d","modified":1529228970000},{"_id":"source/_posts/JavaScript-ä¸­çš„-this-ç”¨æ³•æ€»ç»“.md","hash":"9aac09ce6e26627426898d9b3039447495777be6","modified":1529228970000},{"_id":"source/_posts/Mongodb-å­¦ä¹ ç¬”è®°----å¢åˆ æ”¹æŸ¥.md","hash":"e30b8c0b1fee1f2388513244c72f6d88f50cdf78","modified":1529228970000},{"_id":"source/_posts/Node.JS-å­¦ä¹ ç¬”è®°-[01]----å…¥é—¨.md","hash":"81d3a168d27f0b0c1aefb67a5e95b331239f1b96","modified":1529228970000},{"_id":"source/_posts/Node.JS-å­¦ä¹ ç¬”è®°-[02]----åŒæ­¥å¼‚æ­¥.md","hash":"af63eb5983f1e82a3f3be435286992ef42ef0b53","modified":1529228970000},{"_id":"source/_posts/Node.JS-å­¦ä¹ ç¬”è®°-[03]----Buffer-fs-path.md","hash":"e82c5de197792c6ee5d9eca5acd34b6f5af4d618","modified":1529228970000},{"_id":"source/_posts/Node.JS-å­¦ä¹ ç¬”è®°-[04]----HTTP.md","hash":"5732c4a6a0b5cfbe98e1f781d6ba713e4f7ba967","modified":1529228970000},{"_id":"source/_posts/Node.JS-å­¦ä¹ ç¬”è®°-[05]----Express.md","hash":"c1db8ab0fc866df9bdc0f2b6d53dd7b6f25a91fe","modified":1529228970000},{"_id":"source/_posts/ProxyChains-NG + ShadowSocks å®ç°ç»ˆç«¯ä»£ç†.md","hash":"605995615e4e36dc1d62569dcfc6ff07eb0e4f3f","modified":1529228970000},{"_id":"source/_posts/React-ç»„ä»¶æ¨¡å¼.md","hash":"66a160679f2dfa79c07bfe7241bd830f6d66660a","modified":1529228970000},{"_id":"source/_posts/Why-Immutable-Data.md","hash":"28f2cda7c0cf672ec2cc5c4cafb8afa05d854b97","modified":1529228970000},{"_id":"source/_posts/ä»£ç é‡æ„.md","hash":"76ebe9c8c0af69549e58db14337d3bc285b943ab","modified":1529239127000},{"_id":"source/_posts/callã€applyã€bind-çš„åŒºåˆ«åŠåº”ç”¨.md","hash":"a94d9ae6eb6a4c1c2f92e0f20600a190882af430","modified":1529228970000},{"_id":"source/_posts/ä¸€æ®µç¥å¥‡çš„-CSS-è°ƒè¯•ä»£ç .md","hash":"af5eb08ecfa0decf557a35fec2ef7d8c7e1f9827","modified":1529228970000},{"_id":"source/_posts/æŒç»­é›†æˆ-CI-åŠç®€å•å®è·µ.md","hash":"bd5c47acf28494bcb96241dfbddb70ef9f79a7e1","modified":1529228970000},{"_id":"source/_posts/å¦‚ä½•é¿å…-async-await-åœ°ç‹±.md","hash":"23f232f0345ceec631edd80a681a690c6a7e3bbb","modified":1529228970000},{"_id":"source/_posts/æµè§ˆå™¨è·¨åŸŸè¯·æ±‚æ•°æ®æ€»ç»“.md","hash":"d7cc336bcbbb988423500c2e429622492e69b826","modified":1529228970000},{"_id":"source/_posts/ç»™å°ç™½è¯»çš„-WEB-æ‰˜ç®¡æœåŠ¡è¿›åŒ–å².md","hash":"681f629a67ee4c4e1b2907296e95fa92592927a8","modified":1529228970000},{"_id":"source/about/index.md","hash":"7cfbcf09b4085801762ba5161589a295961c7703","modified":1529228970000},{"_id":"source/docs/index.md","hash":"97e5e0c56e91f300d6a03276d1fab7f3e5623185","modified":1529228970000},{"_id":"source/categories/index.md","hash":"fe4bebea66d0ac9f7f2b961a0a55b5dbee2eae88","modified":1529228970000},{"_id":"source/upload/fetch.min.js","hash":"36bfa4b7953ddf6db8c9c1471139c0ee775a037b","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/doc/doc-en.md","hash":"fc0a961b1fe5bf40c0347df28eab4205a0fae316","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/doc/doc-zh.md","hash":"e6151b25d3abba657e0c57aab98b95275cfd9355","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/languages/en.yml","hash":"ca168b190932229884db1de755ec2f793c758a16","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/languages/zh-cn.yml","hash":"22a2d16fe8c0dddb016b5325b9b9c182a1b49ae1","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/archive.jade","hash":"62797414355bf4474092bc3a32726c8340820ffb","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/index.jade","hash":"55f2f1b4b5364a0e09cb18e1112664c6415fb881","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/post.jade","hash":"245c26244c075c3632d1545c3b228ee9d112f15d","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/favicon.png","hash":"a9cdcb22d1e74d5480323e19d1983de5a6873b8c","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/mixins/paginator.jade","hash":"f4ee2fb61a32e199b48cf93771749edc8a007391","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/mixins/post.jade","hash":"bdf9595ab8a581862c1344360fe656381f69887c","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/partial/comment.jade","hash":"1cf2ae3fb1d8fb5914280337f1564525f3dd9409","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/partial/copyright.jade","hash":"df74de116edf92d00f3a33914dc8f82b45bcc9ab","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/partial/head.jade","hash":"43d2db73f0247a9a3ed00ecb95b537a872b7201a","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/partial/layout.jade","hash":"529c2ec06cfbc3d5b6d66dd320db50dfab5577a6","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/partial/nav.jade","hash":"1473b86269497af34edc5e3741db2d4c5e4656cf","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/layout/partial/scripts.jade","hash":"6bff591ae3d1ff6750f239c4c933ad61f009f36a","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/css/apollo.css","hash":"4a00f3214073a2c5da7299ee14e2ae169ad86fca","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/font/sourcesanspro.woff","hash":"a6722c9b6439b7a020a9be3d3178970757a9265c","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/font/sourcesanspro.woff2","hash":"da65f527a8da65d5eb6721626d28cfdb46ab104a","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/apollo.scss","hash":"20ed9505718c7365282f0ebc78ef505eea14d2f1","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/archive-post-list.scss","hash":"d2f740a7d48349b7536777c795f82ab740836d0f","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/base.scss","hash":"5f1b5987f8cf1bea0b9430003179a0635e109bd5","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/copyright.scss","hash":"cd0fcc9cf01317eb02fd4b71046ddeb2facb5811","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/footer.scss","hash":"094aca6e52f11b139ac7980ca03fa7b9d8fc7b2f","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/git-comment.scss","hash":"f8a680e4b53209c15a66644fbaceb8543eff8900","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/header.scss","hash":"153bde88bf8ffeae4ffd813d8cc694dd83d33d94","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/mq.scss","hash":"d456417a9f1ded95ff39dab63d4a6d22bb396246","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/home-post-list.scss","hash":"6b5c59f3d2295944f934aee2c1156012a3306d5d","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/post.scss","hash":"33622fad24cc1d21397fd6b24ddd8737feb5fbc1","modified":1529228970000},{"_id":"themes/hexo-theme-apollo/source/scss/_partial/normalize.scss","hash":"fd0b27bed6f103ea95b08f698ea663ff576dbcf1","modified":1529228970000},{"_id":"public/upload/fetch.min.js","hash":"d1d8e61809354e9fc4311032ee422f41a670510c","modified":1529239158652},{"_id":"public/atom.xml","hash":"b186e55bbc5b354cb3350842158c32ddd7e9d887","modified":1529239158658},{"_id":"public/sitemap.xml","hash":"068cfabe5fa570077d7485a2675b9423f1381d79","modified":1529239158659},{"_id":"public/about/index.html","hash":"ef58494a944dae00e4cb6153cac83913162f80da","modified":1529239158663},{"_id":"public/docs/index.html","hash":"c89b161864ad0c5903a8ce492c467b1045b2d9da","modified":1529239158663},{"_id":"public/categories/index.html","hash":"1dfaf62516a8098a97771ad25224afaa577eacb2","modified":1529239158663},{"_id":"public/2018/05/20/å¦‚ä½•é¿å…-async-await-åœ°ç‹±/index.html","hash":"e53ebd266da6c55d8d9400c500feab77f9ceb4b2","modified":1529239158663},{"_id":"public/2018/05/11/Git-æ“ä½œè¯¦ç»†æ€»ç»“/index.html","hash":"6b55f58159b1cd0662dfcb75a3ec3d3d6defa907","modified":1529239158663},{"_id":"public/2018/04/30/æŒç»­é›†æˆ-CI-åŠç®€å•å®è·µ/index.html","hash":"38c472d0fe091106807dc85290cb363f159d63c8","modified":1529239158663},{"_id":"public/2016/03/23/ProxyChains-NG + ShadowSocks å®ç°ç»ˆç«¯ä»£ç†/index.html","hash":"0f364b3adbc3ff3832511aef2ab48362438489fd","modified":1529239158663},{"_id":"public/2016/03/22/ä¸€æ®µç¥å¥‡çš„-CSS-è°ƒè¯•ä»£ç /index.html","hash":"277b476a49530d6bd85e6ce61046b8c8f9228051","modified":1529239158663},{"_id":"public/2016/02/19/JavaScript-ä¸­çš„-this-ç”¨æ³•æ€»ç»“/index.html","hash":"9c8c42af086c6e31ae8c46de37899f206b1e897a","modified":1529239158663},{"_id":"public/2016/01/19/æµè§ˆå™¨è·¨åŸŸè¯·æ±‚æ•°æ®æ€»ç»“/index.html","hash":"e5527c97580f003df40cc5c9413caf139a9acc65","modified":1529239158663},{"_id":"public/2016/01/06/7æ‹›è½»æ¾æå®š-JavaScript-å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥/index.html","hash":"2b8a87699e52b692fbac43160edbeb96cde0a950","modified":1529239158663},{"_id":"public/2015/01/02/Node.JS-å­¦ä¹ ç¬”è®°-[01]----å…¥é—¨/index.html","hash":"35b83a2e50fb6cbd6a40ea1ed1a5af1099498d97","modified":1529239158664},{"_id":"public/2015/01/01/CentOS-6-x86-Node-js-MongoDB-Express-ç¯å¢ƒé…ç½®ç¬”è®°/index.html","hash":"5ff2d001d0a6cf32a5081d6456279bf8e7e17ce3","modified":1529239158664},{"_id":"public/archives/index.html","hash":"cb3cfde2397fb5b3558ed63a58b0d803b169f08f","modified":1529239158664},{"_id":"public/archives/page/2/index.html","hash":"f078968b2ecaf151f032c438c86be29acda61f4b","modified":1529239158664},{"_id":"public/archives/page/3/index.html","hash":"06f4470eef4fc7f64d3878fbc54ea8d895c0b2b6","modified":1529239158664},{"_id":"public/archives/2015/index.html","hash":"401a82b552210212f33c194210adb0be3bfd2917","modified":1529239158664},{"_id":"public/archives/2015/01/index.html","hash":"401a82b552210212f33c194210adb0be3bfd2917","modified":1529239158664},{"_id":"public/archives/2016/index.html","hash":"3c9a12d380169eaf838f4e71a4c689bc69054dc6","modified":1529239158664},{"_id":"public/archives/2016/01/index.html","hash":"36b0ce5388bbaf1fa086799b7d807b6d38cc0825","modified":1529239158664},{"_id":"public/archives/2016/02/index.html","hash":"59e3b6e32ce45fcb8f5d0a57a8cff92466af0d8a","modified":1529239158664},{"_id":"public/archives/2016/03/index.html","hash":"765ee0148c29d52bea31d92dce26c2009916e844","modified":1529239158664},{"_id":"public/archives/2018/index.html","hash":"722d47d8febca3f45c8672c4f26fb64874a78936","modified":1529239158664},{"_id":"public/archives/2018/04/index.html","hash":"767648aacab34f130f7591939580e85fa9e3f745","modified":1529239158665},{"_id":"public/archives/2018/05/index.html","hash":"43622a68438c006eee087975f9f520f8317c911a","modified":1529239158665},{"_id":"public/archives/2018/06/index.html","hash":"642ae6cc6eb2646f86a69d987180c9cdc80bfd3c","modified":1529239158665},{"_id":"public/index.html","hash":"67eb2a814dee4438b787888f0c9a5ee9e4ab7d63","modified":1529239158665},{"_id":"public/page/2/index.html","hash":"c1227da8d019be7a07b5817c96193b6f51bbc3ab","modified":1529239158665},{"_id":"public/page/3/index.html","hash":"f33a9107e5720d36760b8820c3b4e75c24174f4a","modified":1529239158665},{"_id":"public/2018/06/16/ä»£ç é‡æ„/index.html","hash":"017871aaf2fe6e83add1fe9fad1c43fc6135e208","modified":1529239158665},{"_id":"public/2018/06/09/ç»™å°ç™½è¯»çš„-WEB-æ‰˜ç®¡æœåŠ¡è¿›åŒ–å²/index.html","hash":"1a2a47090fbada5f49f7f16d2eb6297ec14902fa","modified":1529239158665},{"_id":"public/2018/05/29/ES6-Promise-ç®€æ˜æŒ‡å—/index.html","hash":"e507c4751b84f87683d1fe61c7b8260abfbf92fd","modified":1529239158665},{"_id":"public/2018/05/16/React-ç»„ä»¶æ¨¡å¼/index.html","hash":"13f1dab5919fe9d57cd93c765c9c4e7b2d3a3d17","modified":1529239158665},{"_id":"public/2018/05/05/Why-Immutable-Data/index.html","hash":"b9c99e0576046a19d78c6bedc11da27435082bef","modified":1529239158665},{"_id":"public/2016/03/26/callã€applyã€bind-çš„åŒºåˆ«åŠåº”ç”¨/index.html","hash":"c99901e61005338ed62b140f44676c873d2279de","modified":1529239158666},{"_id":"public/2016/01/05/Mongodb-å­¦ä¹ ç¬”è®°----å¢åˆ æ”¹æŸ¥/index.html","hash":"9dd76d1ddbb660a51f194339b4fc61b3f74be4fa","modified":1529239158666},{"_id":"public/2015/01/06/Node.JS-å­¦ä¹ ç¬”è®°-[05]----Express/index.html","hash":"f99cae87c296ba8f27bf09bed0a3b935d7a3bcbd","modified":1529239158666},{"_id":"public/2015/01/05/Node.JS-å­¦ä¹ ç¬”è®°-[04]----HTTP/index.html","hash":"1780f5896e27468043f32e80f6b16b5700e14e96","modified":1529239158666},{"_id":"public/2015/01/04/Node.JS-å­¦ä¹ ç¬”è®°-[03]----Buffer-fs-path/index.html","hash":"a7948314c2351578cc1905876920b1946973cd24","modified":1529239158666},{"_id":"public/2015/01/03/Node.JS-å­¦ä¹ ç¬”è®°-[02]----åŒæ­¥å¼‚æ­¥/index.html","hash":"7c91277afe250470b870913b57debf79a9b25687","modified":1529239158666},{"_id":"public/favicon.ico","hash":"10df6f583311f8533e055ab21ad1be9eb3a7d80d","modified":1529239158671},{"_id":"public/favicon.png","hash":"a9cdcb22d1e74d5480323e19d1983de5a6873b8c","modified":1529239158672},{"_id":"public/font/sourcesanspro.woff","hash":"a6722c9b6439b7a020a9be3d3178970757a9265c","modified":1529239158672},{"_id":"public/font/sourcesanspro.woff2","hash":"da65f527a8da65d5eb6721626d28cfdb46ab104a","modified":1529239158673},{"_id":"public/scss/apollo.scss","hash":"20ed9505718c7365282f0ebc78ef505eea14d2f1","modified":1529239158673},{"_id":"public/css/apollo.css","hash":"4a00f3214073a2c5da7299ee14e2ae169ad86fca","modified":1529239158681}],"Category":[],"Data":[],"Page":[{"title":"About Me","date":"2018-04-30T03:14:00.000Z","comments":0,"_content":"\n```js\nlet me = {\n    name    : 'Willard Wong',\n    gender  : 'male',\n    age     :  26,\n    job     : 'Front-end Developer',\n    Hobbies : ['watch movie', 'reading', 'photography', 'write code'],\n    email   : 'ifyour{at}outlook.com'\n};\n```\n\n> *å¿µå¿µä¸å¿˜, å¿…æœ‰å›å“!*\n","source":"about/index.md","raw":"---\ntitle: About Me\ndate: 2018-04-30 11:14:00\ncomments: false\n---\n\n```js\nlet me = {\n    name    : 'Willard Wong',\n    gender  : 'male',\n    age     :  26,\n    job     : 'Front-end Developer',\n    Hobbies : ['watch movie', 'reading', 'photography', 'write code'],\n    email   : 'ifyour{at}outlook.com'\n};\n```\n\n> *å¿µå¿µä¸å¿˜, å¿…æœ‰å›å“!*\n","updated":"2018-06-17T09:49:30.000Z","path":"about/index.html","layout":"page","_id":"cjiitidi00001u4q95xohu3pj","content":"<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> me = &#123;</span><br><span class=\"line\">    name    : <span class=\"string\">'Willard Wong'</span>,</span><br><span class=\"line\">    gender  : <span class=\"string\">'male'</span>,</span><br><span class=\"line\">    age     :  <span class=\"number\">26</span>,</span><br><span class=\"line\">    job     : <span class=\"string\">'Front-end Developer'</span>,</span><br><span class=\"line\">    Hobbies : [<span class=\"string\">'watch movie'</span>, <span class=\"string\">'reading'</span>, <span class=\"string\">'photography'</span>, <span class=\"string\">'write code'</span>],</span><br><span class=\"line\">    email   : <span class=\"string\">'ifyour&#123;at&#125;outlook.com'</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><em>å¿µå¿µä¸å¿˜, å¿…æœ‰å›å“!</em></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> me = &#123;</span><br><span class=\"line\">    name    : <span class=\"string\">'Willard Wong'</span>,</span><br><span class=\"line\">    gender  : <span class=\"string\">'male'</span>,</span><br><span class=\"line\">    age     :  <span class=\"number\">26</span>,</span><br><span class=\"line\">    job     : <span class=\"string\">'Front-end Developer'</span>,</span><br><span class=\"line\">    Hobbies : [<span class=\"string\">'watch movie'</span>, <span class=\"string\">'reading'</span>, <span class=\"string\">'photography'</span>, <span class=\"string\">'write code'</span>],</span><br><span class=\"line\">    email   : <span class=\"string\">'ifyour&#123;at&#125;outlook.com'</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><em>å¿µå¿µä¸å¿˜, å¿…æœ‰å›å“!</em></p>\n</blockquote>\n"},{"title":"å·¥å…·åŠæ–‡æ¡£","date":"2018-05-06T03:56:00.000Z","comments":1,"_content":"\n### Interesting tools\n\n* [Rico's cheatsheets](https://devhints.io/) - è®°å¿†å°æŠ„, é•¿è¯çŸ­è¯´å„ç§å¼€å‘æ–‡æ¡£\n* [Carbon](https://carbon.now.sh/) - å¸¦æ ·å¼åˆ†äº«ä»£ç \n* [Codepan](https://codepan.net/) - åœ¨çº¿æµ‹è¯•å‰ç«¯ä»£ç , å¯ä»¥ç¦»çº¿ä½¿ç”¨\n* [jsFiddle](https://jsfiddle.net/) - åŒä¸Š, æ³¨å†Œè´¦å·åå¯ä»¥ä¿å­˜ä»£ç \n* [Prettier](https://prettier.io/playground/) - åœ¨çº¿æ ¼å¼åŒ– JavaScript ä»£ç \n* [Text-formatter](https://text-formatter.herokuapp.com/) - æ ¼å¼åŒ–æ–‡æœ¬, ä¸­è‹±æ–‡ä¹‹é—´ç•™ç©ºæ ¼ä»¥åŠè‹±æ–‡æ ‡ç‚¹\n* [DevDocs](https://devdocs.io/) - ä¸€ç«™å¼å¼€å‘æ–‡æ¡£é›†åˆ\n* [Grammarly](https://app.grammarly.com/ddocs/261389934) - è‹±æ–‡è¯­æ³•é”™è¯¯æ£€æŸ¥\n* [JSONPlaceholder](http://jsonplaceholder.typicode.com/) - RESTful API å‡æ•°æ®æ¨¡æ‹Ÿ\n* [JSON2YAML](https://www.json2yaml.com/) - JSON å’Œ YAML äº’è½¬\n* [JSON Parser](http://json.parser.online.fr/beta/) - JSON æ ¼å¼åŒ–\n* [RegExr](https://regexr.com/) - åœ¨çº¿æ­£åˆ™æµ‹è¯•åŠè°ƒè¯•\n* [Regulex](https://jex.im/regulex/) - æ­£åˆ™è¡¨è¾¾å¯è§†åŒ–, å¿«é€Ÿç†è§£æ­£åˆ™è¡¨è¾¾å¼\n* [CSSMatic](https://www.cssmatic.com/) - ç”Ÿæˆé•œåƒæ¸å˜, ç›’å­é˜´å½±ç­‰\n* [SassMeister](https://www.sassmeister.com/) - Sass æ¼”ç»ƒåœº, å¯ä»¥è¾“å‡º AutoPrefixer çš„ç»“æœ\n* [KeyframesApp](https://keyframes.app/) - CSS3 åŠ¨ç”»å…³é”®å¸§ç”Ÿæˆå·¥å…·\n* [CSS Sprites Generator](https://www.toptal.com/developers/css/sprite-generator) - CSS ç²¾çµç”Ÿæˆå·¥å…·\n* [JSNice](http://www.jsnice.org/) - åç¼–è¯‘å·²å‹ç¼©çš„ JS ä»£ç , ç†è§£å˜é‡æ˜¯ä»€ä¹ˆæ„æ€\n* [Love2.io](https://love2.io/) - å¼€æºæŠ€æœ¯æ–‡æ¡£åˆ†äº«å¹³å°\n* [WakaTime](https://wakatime.com/) - è®°å½•æ¯å¤©çš„ç¼–ç æƒ…å†µ, ä½¿ç”¨ä»€ä¹ˆè¯­è¨€åŠç»Ÿè®¡æ—¶é•¿\n* [è“æ¹–](https://lanhuapp.com/) - é«˜æ•ˆçš„äº§å“è®¾è®¡åä½œå¹³å°, æ ‡æ³¨åˆ‡å›¾å¾ˆå¥½ç”¨\n\n### Docs\n\n* **React**\n\n  * [React ä¸­æ–‡æ–‡æ¡£](https://doc.react-china.org/docs/hello-world.html)\n  * [Redux ä¸­æ–‡æ–‡æ¡£](https://www.kancloud.cn/allanyu/redux-in-chinese/82399)\n  * [React-saga ä¸­æ–‡æ–‡æ¡£](http://leonshi.com/redux-saga-in-chinese/docs/api/index.html)\n  * [React-router ä¸­æ–‡æ–‡æ¡£](https://react-guide.github.io/react-router-cn)\n  * [Mobx ä¸­æ–‡æ–‡æ¡£](https://suprise.gitbooks.io/mobx-cn/content/fp.html)\n  * [Ant-design æ–‡æ¡£](https://ant.design/docs/react/introduce-cn)\n  * [React-Native æ–‡æ¡£](http://reactnative.cn/docs/0.50/getting-started.html)\n\n* **Vue.js**\n\n  * [Vue.js å®˜ç½‘](https://cn.vuejs.org/v2/guide/)\n  * [Vue-Router](https://router.vuejs.org/zh-cn/)\n  * [Vuex](https://vuex.vuejs.org/zh-cn/)\n  * [Vue-SSR æœåŠ¡å™¨ç«¯æ¸²æŸ“](https://ssr.vuejs.org/zh/)\n  * [Vue-NUXT](https://zh.nuxtjs.org/guide/installation)\n\n* **Node.js**\n\n  * [Node.js API](http://nodejs.cn/api/)\n  * [Express å®˜ç½‘](http://www.expressjs.com.cn/guide/routing.html)\n\n* **Electron**\n\n  * [Electron å®˜æ–¹æ–‡æ¡£](https://electronjs.org/docs/)\n\n* **WeChat**\n\n  * [å°ç¨‹åºå®˜æ–¹æ–‡æ¡£](https://mp.weixin.qq.com/debug/wxadoc/dev/index.html?t=201832)\n\n* **TypeScript**\n\n  * [TypeScript ä¸­æ–‡ç½‘](https://www.tslang.cn/index.html)\n\n* **Vanilla JS**\n\n  * [JavaScript åŸºç¡€è¿›é˜¶ç³»åˆ—](https://segmentfault.com/a/1190000012646488)\n  * [æ·±å…¥ç†è§£ JS å¼‚æ­¥](https://github.com/wangfupeng1988/js-async-tutorial)\n  * [æ·±å…¥ç†è§£ JS (Tom)](https://www.cnblogs.com/tomxu/archive/2011/12/15/2288411.html)\n\n* **Webpack**\n\n  * [Webpack 3.x](http://www.css88.com/doc/webpack/)\n  * [Webpack 2.x](http://www.css88.com/doc/webpack2/api/loaders/#version)\n\n* **Python**\n\n  * [Python 3 æ•™ç¨‹ (å»–é›ªå³°)](https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000)\n  * [Django ä¸­æ–‡æ–‡æ¡£](https://docs.djangoproject.com/zh-hans/2.0/)\n\n* **More...**\n  * [å°è®°ä¸­æ–‡](https://docschina.org/)\n\n### One more thing\n\næ¬¢è¿åœ¨ä¸‹é¢ç•™è¨€æ¿åˆ†äº«ä½ è§‰å¾—æœ‰è¶£çš„æ‰€æœ‰ä¸œè¥¿, æœ¬æ–‡[æºä»£ç åœ°å€](https://raw.githubusercontent.com/ifyour/ifyour.github.io/src/source/docs/index.md). ğŸ˜\n","source":"docs/index.md","raw":"---\ntitle: å·¥å…·åŠæ–‡æ¡£\ndate: 2018-05-06 11:56:00\ncomments: true\n---\n\n### Interesting tools\n\n* [Rico's cheatsheets](https://devhints.io/) - è®°å¿†å°æŠ„, é•¿è¯çŸ­è¯´å„ç§å¼€å‘æ–‡æ¡£\n* [Carbon](https://carbon.now.sh/) - å¸¦æ ·å¼åˆ†äº«ä»£ç \n* [Codepan](https://codepan.net/) - åœ¨çº¿æµ‹è¯•å‰ç«¯ä»£ç , å¯ä»¥ç¦»çº¿ä½¿ç”¨\n* [jsFiddle](https://jsfiddle.net/) - åŒä¸Š, æ³¨å†Œè´¦å·åå¯ä»¥ä¿å­˜ä»£ç \n* [Prettier](https://prettier.io/playground/) - åœ¨çº¿æ ¼å¼åŒ– JavaScript ä»£ç \n* [Text-formatter](https://text-formatter.herokuapp.com/) - æ ¼å¼åŒ–æ–‡æœ¬, ä¸­è‹±æ–‡ä¹‹é—´ç•™ç©ºæ ¼ä»¥åŠè‹±æ–‡æ ‡ç‚¹\n* [DevDocs](https://devdocs.io/) - ä¸€ç«™å¼å¼€å‘æ–‡æ¡£é›†åˆ\n* [Grammarly](https://app.grammarly.com/ddocs/261389934) - è‹±æ–‡è¯­æ³•é”™è¯¯æ£€æŸ¥\n* [JSONPlaceholder](http://jsonplaceholder.typicode.com/) - RESTful API å‡æ•°æ®æ¨¡æ‹Ÿ\n* [JSON2YAML](https://www.json2yaml.com/) - JSON å’Œ YAML äº’è½¬\n* [JSON Parser](http://json.parser.online.fr/beta/) - JSON æ ¼å¼åŒ–\n* [RegExr](https://regexr.com/) - åœ¨çº¿æ­£åˆ™æµ‹è¯•åŠè°ƒè¯•\n* [Regulex](https://jex.im/regulex/) - æ­£åˆ™è¡¨è¾¾å¯è§†åŒ–, å¿«é€Ÿç†è§£æ­£åˆ™è¡¨è¾¾å¼\n* [CSSMatic](https://www.cssmatic.com/) - ç”Ÿæˆé•œåƒæ¸å˜, ç›’å­é˜´å½±ç­‰\n* [SassMeister](https://www.sassmeister.com/) - Sass æ¼”ç»ƒåœº, å¯ä»¥è¾“å‡º AutoPrefixer çš„ç»“æœ\n* [KeyframesApp](https://keyframes.app/) - CSS3 åŠ¨ç”»å…³é”®å¸§ç”Ÿæˆå·¥å…·\n* [CSS Sprites Generator](https://www.toptal.com/developers/css/sprite-generator) - CSS ç²¾çµç”Ÿæˆå·¥å…·\n* [JSNice](http://www.jsnice.org/) - åç¼–è¯‘å·²å‹ç¼©çš„ JS ä»£ç , ç†è§£å˜é‡æ˜¯ä»€ä¹ˆæ„æ€\n* [Love2.io](https://love2.io/) - å¼€æºæŠ€æœ¯æ–‡æ¡£åˆ†äº«å¹³å°\n* [WakaTime](https://wakatime.com/) - è®°å½•æ¯å¤©çš„ç¼–ç æƒ…å†µ, ä½¿ç”¨ä»€ä¹ˆè¯­è¨€åŠç»Ÿè®¡æ—¶é•¿\n* [è“æ¹–](https://lanhuapp.com/) - é«˜æ•ˆçš„äº§å“è®¾è®¡åä½œå¹³å°, æ ‡æ³¨åˆ‡å›¾å¾ˆå¥½ç”¨\n\n### Docs\n\n* **React**\n\n  * [React ä¸­æ–‡æ–‡æ¡£](https://doc.react-china.org/docs/hello-world.html)\n  * [Redux ä¸­æ–‡æ–‡æ¡£](https://www.kancloud.cn/allanyu/redux-in-chinese/82399)\n  * [React-saga ä¸­æ–‡æ–‡æ¡£](http://leonshi.com/redux-saga-in-chinese/docs/api/index.html)\n  * [React-router ä¸­æ–‡æ–‡æ¡£](https://react-guide.github.io/react-router-cn)\n  * [Mobx ä¸­æ–‡æ–‡æ¡£](https://suprise.gitbooks.io/mobx-cn/content/fp.html)\n  * [Ant-design æ–‡æ¡£](https://ant.design/docs/react/introduce-cn)\n  * [React-Native æ–‡æ¡£](http://reactnative.cn/docs/0.50/getting-started.html)\n\n* **Vue.js**\n\n  * [Vue.js å®˜ç½‘](https://cn.vuejs.org/v2/guide/)\n  * [Vue-Router](https://router.vuejs.org/zh-cn/)\n  * [Vuex](https://vuex.vuejs.org/zh-cn/)\n  * [Vue-SSR æœåŠ¡å™¨ç«¯æ¸²æŸ“](https://ssr.vuejs.org/zh/)\n  * [Vue-NUXT](https://zh.nuxtjs.org/guide/installation)\n\n* **Node.js**\n\n  * [Node.js API](http://nodejs.cn/api/)\n  * [Express å®˜ç½‘](http://www.expressjs.com.cn/guide/routing.html)\n\n* **Electron**\n\n  * [Electron å®˜æ–¹æ–‡æ¡£](https://electronjs.org/docs/)\n\n* **WeChat**\n\n  * [å°ç¨‹åºå®˜æ–¹æ–‡æ¡£](https://mp.weixin.qq.com/debug/wxadoc/dev/index.html?t=201832)\n\n* **TypeScript**\n\n  * [TypeScript ä¸­æ–‡ç½‘](https://www.tslang.cn/index.html)\n\n* **Vanilla JS**\n\n  * [JavaScript åŸºç¡€è¿›é˜¶ç³»åˆ—](https://segmentfault.com/a/1190000012646488)\n  * [æ·±å…¥ç†è§£ JS å¼‚æ­¥](https://github.com/wangfupeng1988/js-async-tutorial)\n  * [æ·±å…¥ç†è§£ JS (Tom)](https://www.cnblogs.com/tomxu/archive/2011/12/15/2288411.html)\n\n* **Webpack**\n\n  * [Webpack 3.x](http://www.css88.com/doc/webpack/)\n  * [Webpack 2.x](http://www.css88.com/doc/webpack2/api/loaders/#version)\n\n* **Python**\n\n  * [Python 3 æ•™ç¨‹ (å»–é›ªå³°)](https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000)\n  * [Django ä¸­æ–‡æ–‡æ¡£](https://docs.djangoproject.com/zh-hans/2.0/)\n\n* **More...**\n  * [å°è®°ä¸­æ–‡](https://docschina.org/)\n\n### One more thing\n\næ¬¢è¿åœ¨ä¸‹é¢ç•™è¨€æ¿åˆ†äº«ä½ è§‰å¾—æœ‰è¶£çš„æ‰€æœ‰ä¸œè¥¿, æœ¬æ–‡[æºä»£ç åœ°å€](https://raw.githubusercontent.com/ifyour/ifyour.github.io/src/source/docs/index.md). ğŸ˜\n","updated":"2018-06-17T09:49:30.000Z","path":"docs/index.html","layout":"page","_id":"cjiitidi30003u4q9sv1bzq9f","content":"<h3 id=\"Interesting-tools\"><a href=\"#Interesting-tools\" class=\"headerlink\" title=\"Interesting tools\"></a>Interesting tools</h3><ul>\n<li><a href=\"https://devhints.io/\" target=\"_blank\" rel=\"noopener\">Ricoâ€™s cheatsheets</a> - è®°å¿†å°æŠ„, é•¿è¯çŸ­è¯´å„ç§å¼€å‘æ–‡æ¡£</li>\n<li><a href=\"https://carbon.now.sh/\" target=\"_blank\" rel=\"noopener\">Carbon</a> - å¸¦æ ·å¼åˆ†äº«ä»£ç </li>\n<li><a href=\"https://codepan.net/\" target=\"_blank\" rel=\"noopener\">Codepan</a> - åœ¨çº¿æµ‹è¯•å‰ç«¯ä»£ç , å¯ä»¥ç¦»çº¿ä½¿ç”¨</li>\n<li><a href=\"https://jsfiddle.net/\" target=\"_blank\" rel=\"noopener\">jsFiddle</a> - åŒä¸Š, æ³¨å†Œè´¦å·åå¯ä»¥ä¿å­˜ä»£ç </li>\n<li><a href=\"https://prettier.io/playground/\" target=\"_blank\" rel=\"noopener\">Prettier</a> - åœ¨çº¿æ ¼å¼åŒ– JavaScript ä»£ç </li>\n<li><a href=\"https://text-formatter.herokuapp.com/\" target=\"_blank\" rel=\"noopener\">Text-formatter</a> - æ ¼å¼åŒ–æ–‡æœ¬, ä¸­è‹±æ–‡ä¹‹é—´ç•™ç©ºæ ¼ä»¥åŠè‹±æ–‡æ ‡ç‚¹</li>\n<li><a href=\"https://devdocs.io/\" target=\"_blank\" rel=\"noopener\">DevDocs</a> - ä¸€ç«™å¼å¼€å‘æ–‡æ¡£é›†åˆ</li>\n<li><a href=\"https://app.grammarly.com/ddocs/261389934\" target=\"_blank\" rel=\"noopener\">Grammarly</a> - è‹±æ–‡è¯­æ³•é”™è¯¯æ£€æŸ¥</li>\n<li><a href=\"http://jsonplaceholder.typicode.com/\" target=\"_blank\" rel=\"noopener\">JSONPlaceholder</a> - RESTful API å‡æ•°æ®æ¨¡æ‹Ÿ</li>\n<li><a href=\"https://www.json2yaml.com/\" target=\"_blank\" rel=\"noopener\">JSON2YAML</a> - JSON å’Œ YAML äº’è½¬</li>\n<li><a href=\"http://json.parser.online.fr/beta/\" target=\"_blank\" rel=\"noopener\">JSON Parser</a> - JSON æ ¼å¼åŒ–</li>\n<li><a href=\"https://regexr.com/\" target=\"_blank\" rel=\"noopener\">RegExr</a> - åœ¨çº¿æ­£åˆ™æµ‹è¯•åŠè°ƒè¯•</li>\n<li><a href=\"https://jex.im/regulex/\" target=\"_blank\" rel=\"noopener\">Regulex</a> - æ­£åˆ™è¡¨è¾¾å¯è§†åŒ–, å¿«é€Ÿç†è§£æ­£åˆ™è¡¨è¾¾å¼</li>\n<li><a href=\"https://www.cssmatic.com/\" target=\"_blank\" rel=\"noopener\">CSSMatic</a> - ç”Ÿæˆé•œåƒæ¸å˜, ç›’å­é˜´å½±ç­‰</li>\n<li><a href=\"https://www.sassmeister.com/\" target=\"_blank\" rel=\"noopener\">SassMeister</a> - Sass æ¼”ç»ƒåœº, å¯ä»¥è¾“å‡º AutoPrefixer çš„ç»“æœ</li>\n<li><a href=\"https://keyframes.app/\" target=\"_blank\" rel=\"noopener\">KeyframesApp</a> - CSS3 åŠ¨ç”»å…³é”®å¸§ç”Ÿæˆå·¥å…·</li>\n<li><a href=\"https://www.toptal.com/developers/css/sprite-generator\" target=\"_blank\" rel=\"noopener\">CSS Sprites Generator</a> - CSS ç²¾çµç”Ÿæˆå·¥å…·</li>\n<li><a href=\"http://www.jsnice.org/\" target=\"_blank\" rel=\"noopener\">JSNice</a> - åç¼–è¯‘å·²å‹ç¼©çš„ JS ä»£ç , ç†è§£å˜é‡æ˜¯ä»€ä¹ˆæ„æ€</li>\n<li><a href=\"https://love2.io/\" target=\"_blank\" rel=\"noopener\">Love2.io</a> - å¼€æºæŠ€æœ¯æ–‡æ¡£åˆ†äº«å¹³å°</li>\n<li><a href=\"https://wakatime.com/\" target=\"_blank\" rel=\"noopener\">WakaTime</a> - è®°å½•æ¯å¤©çš„ç¼–ç æƒ…å†µ, ä½¿ç”¨ä»€ä¹ˆè¯­è¨€åŠç»Ÿè®¡æ—¶é•¿</li>\n<li><a href=\"https://lanhuapp.com/\" target=\"_blank\" rel=\"noopener\">è“æ¹–</a> - é«˜æ•ˆçš„äº§å“è®¾è®¡åä½œå¹³å°, æ ‡æ³¨åˆ‡å›¾å¾ˆå¥½ç”¨</li>\n</ul>\n<h3 id=\"Docs\"><a href=\"#Docs\" class=\"headerlink\" title=\"Docs\"></a>Docs</h3><ul>\n<li><p><strong>React</strong></p>\n<ul>\n<li><a href=\"https://doc.react-china.org/docs/hello-world.html\" target=\"_blank\" rel=\"noopener\">React ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://www.kancloud.cn/allanyu/redux-in-chinese/82399\" target=\"_blank\" rel=\"noopener\">Redux ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"http://leonshi.com/redux-saga-in-chinese/docs/api/index.html\" target=\"_blank\" rel=\"noopener\">React-saga ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://react-guide.github.io/react-router-cn\" target=\"_blank\" rel=\"noopener\">React-router ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://suprise.gitbooks.io/mobx-cn/content/fp.html\" target=\"_blank\" rel=\"noopener\">Mobx ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://ant.design/docs/react/introduce-cn\" target=\"_blank\" rel=\"noopener\">Ant-design æ–‡æ¡£</a></li>\n<li><a href=\"http://reactnative.cn/docs/0.50/getting-started.html\" target=\"_blank\" rel=\"noopener\">React-Native æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>Vue.js</strong></p>\n<ul>\n<li><a href=\"https://cn.vuejs.org/v2/guide/\" target=\"_blank\" rel=\"noopener\">Vue.js å®˜ç½‘</a></li>\n<li><a href=\"https://router.vuejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\">Vue-Router</a></li>\n<li><a href=\"https://vuex.vuejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\">Vuex</a></li>\n<li><a href=\"https://ssr.vuejs.org/zh/\" target=\"_blank\" rel=\"noopener\">Vue-SSR æœåŠ¡å™¨ç«¯æ¸²æŸ“</a></li>\n<li><a href=\"https://zh.nuxtjs.org/guide/installation\" target=\"_blank\" rel=\"noopener\">Vue-NUXT</a></li>\n</ul>\n</li>\n<li><p><strong>Node.js</strong></p>\n<ul>\n<li><a href=\"http://nodejs.cn/api/\" target=\"_blank\" rel=\"noopener\">Node.js API</a></li>\n<li><a href=\"http://www.expressjs.com.cn/guide/routing.html\" target=\"_blank\" rel=\"noopener\">Express å®˜ç½‘</a></li>\n</ul>\n</li>\n<li><p><strong>Electron</strong></p>\n<ul>\n<li><a href=\"https://electronjs.org/docs/\" target=\"_blank\" rel=\"noopener\">Electron å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>WeChat</strong></p>\n<ul>\n<li><a href=\"https://mp.weixin.qq.com/debug/wxadoc/dev/index.html?t=201832\" target=\"_blank\" rel=\"noopener\">å°ç¨‹åºå®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>TypeScript</strong></p>\n<ul>\n<li><a href=\"https://www.tslang.cn/index.html\" target=\"_blank\" rel=\"noopener\">TypeScript ä¸­æ–‡ç½‘</a></li>\n</ul>\n</li>\n<li><p><strong>Vanilla JS</strong></p>\n<ul>\n<li><a href=\"https://segmentfault.com/a/1190000012646488\" target=\"_blank\" rel=\"noopener\">JavaScript åŸºç¡€è¿›é˜¶ç³»åˆ—</a></li>\n<li><a href=\"https://github.com/wangfupeng1988/js-async-tutorial\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£ JS å¼‚æ­¥</a></li>\n<li><a href=\"https://www.cnblogs.com/tomxu/archive/2011/12/15/2288411.html\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£ JS (Tom)</a></li>\n</ul>\n</li>\n<li><p><strong>Webpack</strong></p>\n<ul>\n<li><a href=\"http://www.css88.com/doc/webpack/\" target=\"_blank\" rel=\"noopener\">Webpack 3.x</a></li>\n<li><a href=\"http://www.css88.com/doc/webpack2/api/loaders/#version\" target=\"_blank\" rel=\"noopener\">Webpack 2.x</a></li>\n</ul>\n</li>\n<li><p><strong>Python</strong></p>\n<ul>\n<li><a href=\"https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000\" target=\"_blank\" rel=\"noopener\">Python 3 æ•™ç¨‹ (å»–é›ªå³°)</a></li>\n<li><a href=\"https://docs.djangoproject.com/zh-hans/2.0/\" target=\"_blank\" rel=\"noopener\">Django ä¸­æ–‡æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>Moreâ€¦</strong></p>\n<ul>\n<li><a href=\"https://docschina.org/\" target=\"_blank\" rel=\"noopener\">å°è®°ä¸­æ–‡</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"One-more-thing\"><a href=\"#One-more-thing\" class=\"headerlink\" title=\"One more thing\"></a>One more thing</h3><p>æ¬¢è¿åœ¨ä¸‹é¢ç•™è¨€æ¿åˆ†äº«ä½ è§‰å¾—æœ‰è¶£çš„æ‰€æœ‰ä¸œè¥¿, æœ¬æ–‡<a href=\"https://raw.githubusercontent.com/ifyour/ifyour.github.io/src/source/docs/index.md\" target=\"_blank\" rel=\"noopener\">æºä»£ç åœ°å€</a>. ğŸ˜</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Interesting-tools\"><a href=\"#Interesting-tools\" class=\"headerlink\" title=\"Interesting tools\"></a>Interesting tools</h3><ul>\n<li><a href=\"https://devhints.io/\" target=\"_blank\" rel=\"noopener\">Ricoâ€™s cheatsheets</a> - è®°å¿†å°æŠ„, é•¿è¯çŸ­è¯´å„ç§å¼€å‘æ–‡æ¡£</li>\n<li><a href=\"https://carbon.now.sh/\" target=\"_blank\" rel=\"noopener\">Carbon</a> - å¸¦æ ·å¼åˆ†äº«ä»£ç </li>\n<li><a href=\"https://codepan.net/\" target=\"_blank\" rel=\"noopener\">Codepan</a> - åœ¨çº¿æµ‹è¯•å‰ç«¯ä»£ç , å¯ä»¥ç¦»çº¿ä½¿ç”¨</li>\n<li><a href=\"https://jsfiddle.net/\" target=\"_blank\" rel=\"noopener\">jsFiddle</a> - åŒä¸Š, æ³¨å†Œè´¦å·åå¯ä»¥ä¿å­˜ä»£ç </li>\n<li><a href=\"https://prettier.io/playground/\" target=\"_blank\" rel=\"noopener\">Prettier</a> - åœ¨çº¿æ ¼å¼åŒ– JavaScript ä»£ç </li>\n<li><a href=\"https://text-formatter.herokuapp.com/\" target=\"_blank\" rel=\"noopener\">Text-formatter</a> - æ ¼å¼åŒ–æ–‡æœ¬, ä¸­è‹±æ–‡ä¹‹é—´ç•™ç©ºæ ¼ä»¥åŠè‹±æ–‡æ ‡ç‚¹</li>\n<li><a href=\"https://devdocs.io/\" target=\"_blank\" rel=\"noopener\">DevDocs</a> - ä¸€ç«™å¼å¼€å‘æ–‡æ¡£é›†åˆ</li>\n<li><a href=\"https://app.grammarly.com/ddocs/261389934\" target=\"_blank\" rel=\"noopener\">Grammarly</a> - è‹±æ–‡è¯­æ³•é”™è¯¯æ£€æŸ¥</li>\n<li><a href=\"http://jsonplaceholder.typicode.com/\" target=\"_blank\" rel=\"noopener\">JSONPlaceholder</a> - RESTful API å‡æ•°æ®æ¨¡æ‹Ÿ</li>\n<li><a href=\"https://www.json2yaml.com/\" target=\"_blank\" rel=\"noopener\">JSON2YAML</a> - JSON å’Œ YAML äº’è½¬</li>\n<li><a href=\"http://json.parser.online.fr/beta/\" target=\"_blank\" rel=\"noopener\">JSON Parser</a> - JSON æ ¼å¼åŒ–</li>\n<li><a href=\"https://regexr.com/\" target=\"_blank\" rel=\"noopener\">RegExr</a> - åœ¨çº¿æ­£åˆ™æµ‹è¯•åŠè°ƒè¯•</li>\n<li><a href=\"https://jex.im/regulex/\" target=\"_blank\" rel=\"noopener\">Regulex</a> - æ­£åˆ™è¡¨è¾¾å¯è§†åŒ–, å¿«é€Ÿç†è§£æ­£åˆ™è¡¨è¾¾å¼</li>\n<li><a href=\"https://www.cssmatic.com/\" target=\"_blank\" rel=\"noopener\">CSSMatic</a> - ç”Ÿæˆé•œåƒæ¸å˜, ç›’å­é˜´å½±ç­‰</li>\n<li><a href=\"https://www.sassmeister.com/\" target=\"_blank\" rel=\"noopener\">SassMeister</a> - Sass æ¼”ç»ƒåœº, å¯ä»¥è¾“å‡º AutoPrefixer çš„ç»“æœ</li>\n<li><a href=\"https://keyframes.app/\" target=\"_blank\" rel=\"noopener\">KeyframesApp</a> - CSS3 åŠ¨ç”»å…³é”®å¸§ç”Ÿæˆå·¥å…·</li>\n<li><a href=\"https://www.toptal.com/developers/css/sprite-generator\" target=\"_blank\" rel=\"noopener\">CSS Sprites Generator</a> - CSS ç²¾çµç”Ÿæˆå·¥å…·</li>\n<li><a href=\"http://www.jsnice.org/\" target=\"_blank\" rel=\"noopener\">JSNice</a> - åç¼–è¯‘å·²å‹ç¼©çš„ JS ä»£ç , ç†è§£å˜é‡æ˜¯ä»€ä¹ˆæ„æ€</li>\n<li><a href=\"https://love2.io/\" target=\"_blank\" rel=\"noopener\">Love2.io</a> - å¼€æºæŠ€æœ¯æ–‡æ¡£åˆ†äº«å¹³å°</li>\n<li><a href=\"https://wakatime.com/\" target=\"_blank\" rel=\"noopener\">WakaTime</a> - è®°å½•æ¯å¤©çš„ç¼–ç æƒ…å†µ, ä½¿ç”¨ä»€ä¹ˆè¯­è¨€åŠç»Ÿè®¡æ—¶é•¿</li>\n<li><a href=\"https://lanhuapp.com/\" target=\"_blank\" rel=\"noopener\">è“æ¹–</a> - é«˜æ•ˆçš„äº§å“è®¾è®¡åä½œå¹³å°, æ ‡æ³¨åˆ‡å›¾å¾ˆå¥½ç”¨</li>\n</ul>\n<h3 id=\"Docs\"><a href=\"#Docs\" class=\"headerlink\" title=\"Docs\"></a>Docs</h3><ul>\n<li><p><strong>React</strong></p>\n<ul>\n<li><a href=\"https://doc.react-china.org/docs/hello-world.html\" target=\"_blank\" rel=\"noopener\">React ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://www.kancloud.cn/allanyu/redux-in-chinese/82399\" target=\"_blank\" rel=\"noopener\">Redux ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"http://leonshi.com/redux-saga-in-chinese/docs/api/index.html\" target=\"_blank\" rel=\"noopener\">React-saga ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://react-guide.github.io/react-router-cn\" target=\"_blank\" rel=\"noopener\">React-router ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://suprise.gitbooks.io/mobx-cn/content/fp.html\" target=\"_blank\" rel=\"noopener\">Mobx ä¸­æ–‡æ–‡æ¡£</a></li>\n<li><a href=\"https://ant.design/docs/react/introduce-cn\" target=\"_blank\" rel=\"noopener\">Ant-design æ–‡æ¡£</a></li>\n<li><a href=\"http://reactnative.cn/docs/0.50/getting-started.html\" target=\"_blank\" rel=\"noopener\">React-Native æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>Vue.js</strong></p>\n<ul>\n<li><a href=\"https://cn.vuejs.org/v2/guide/\" target=\"_blank\" rel=\"noopener\">Vue.js å®˜ç½‘</a></li>\n<li><a href=\"https://router.vuejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\">Vue-Router</a></li>\n<li><a href=\"https://vuex.vuejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\">Vuex</a></li>\n<li><a href=\"https://ssr.vuejs.org/zh/\" target=\"_blank\" rel=\"noopener\">Vue-SSR æœåŠ¡å™¨ç«¯æ¸²æŸ“</a></li>\n<li><a href=\"https://zh.nuxtjs.org/guide/installation\" target=\"_blank\" rel=\"noopener\">Vue-NUXT</a></li>\n</ul>\n</li>\n<li><p><strong>Node.js</strong></p>\n<ul>\n<li><a href=\"http://nodejs.cn/api/\" target=\"_blank\" rel=\"noopener\">Node.js API</a></li>\n<li><a href=\"http://www.expressjs.com.cn/guide/routing.html\" target=\"_blank\" rel=\"noopener\">Express å®˜ç½‘</a></li>\n</ul>\n</li>\n<li><p><strong>Electron</strong></p>\n<ul>\n<li><a href=\"https://electronjs.org/docs/\" target=\"_blank\" rel=\"noopener\">Electron å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>WeChat</strong></p>\n<ul>\n<li><a href=\"https://mp.weixin.qq.com/debug/wxadoc/dev/index.html?t=201832\" target=\"_blank\" rel=\"noopener\">å°ç¨‹åºå®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>TypeScript</strong></p>\n<ul>\n<li><a href=\"https://www.tslang.cn/index.html\" target=\"_blank\" rel=\"noopener\">TypeScript ä¸­æ–‡ç½‘</a></li>\n</ul>\n</li>\n<li><p><strong>Vanilla JS</strong></p>\n<ul>\n<li><a href=\"https://segmentfault.com/a/1190000012646488\" target=\"_blank\" rel=\"noopener\">JavaScript åŸºç¡€è¿›é˜¶ç³»åˆ—</a></li>\n<li><a href=\"https://github.com/wangfupeng1988/js-async-tutorial\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£ JS å¼‚æ­¥</a></li>\n<li><a href=\"https://www.cnblogs.com/tomxu/archive/2011/12/15/2288411.html\" target=\"_blank\" rel=\"noopener\">æ·±å…¥ç†è§£ JS (Tom)</a></li>\n</ul>\n</li>\n<li><p><strong>Webpack</strong></p>\n<ul>\n<li><a href=\"http://www.css88.com/doc/webpack/\" target=\"_blank\" rel=\"noopener\">Webpack 3.x</a></li>\n<li><a href=\"http://www.css88.com/doc/webpack2/api/loaders/#version\" target=\"_blank\" rel=\"noopener\">Webpack 2.x</a></li>\n</ul>\n</li>\n<li><p><strong>Python</strong></p>\n<ul>\n<li><a href=\"https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000\" target=\"_blank\" rel=\"noopener\">Python 3 æ•™ç¨‹ (å»–é›ªå³°)</a></li>\n<li><a href=\"https://docs.djangoproject.com/zh-hans/2.0/\" target=\"_blank\" rel=\"noopener\">Django ä¸­æ–‡æ–‡æ¡£</a></li>\n</ul>\n</li>\n<li><p><strong>Moreâ€¦</strong></p>\n<ul>\n<li><a href=\"https://docschina.org/\" target=\"_blank\" rel=\"noopener\">å°è®°ä¸­æ–‡</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"One-more-thing\"><a href=\"#One-more-thing\" class=\"headerlink\" title=\"One more thing\"></a>One more thing</h3><p>æ¬¢è¿åœ¨ä¸‹é¢ç•™è¨€æ¿åˆ†äº«ä½ è§‰å¾—æœ‰è¶£çš„æ‰€æœ‰ä¸œè¥¿, æœ¬æ–‡<a href=\"https://raw.githubusercontent.com/ifyour/ifyour.github.io/src/source/docs/index.md\" target=\"_blank\" rel=\"noopener\">æºä»£ç åœ°å€</a>. ğŸ˜</p>\n"},{"title":"categories","date":"2015-12-27T14:33:51.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2015-12-27 22:33:51\ntype: \"categories\"\ncomments: false\n---\n","updated":"2018-06-17T09:49:30.000Z","path":"categories/index.html","layout":"page","_id":"cjiitidi50005u4q9nw2b7ssr","content":"","site":{"data":{}},"excerpt":"","more":""},{"_content":"(function(o){if(o.fetch){return}var l={searchParams:\"URLSearchParams\" in o,iterable:\"Symbol\" in o&&\"iterator\" in Symbol,blob:\"FileReader\" in o&&\"Blob\" in o&&(function(){try{new Blob();return true}catch(x){return false}})(),formData:\"FormData\" in o,arrayBuffer:\"ArrayBuffer\" in o};if(l.arrayBuffer){var m=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\"];var s=function(x){return x&&DataView.prototype.isPrototypeOf(x)};var b=ArrayBuffer.isView||function(x){return x&&m.indexOf(Object.prototype.toString.call(x))>-1}}function i(x){if(typeof x!==\"string\"){x=String(x)}if(/[^a-z0-9-#$%&'*+.^_`|~]/i.test(x)){throw new TypeError(\"Invalid character in header field name\")}return x.toLowerCase()}function j(x){if(typeof x!==\"string\"){x=String(x)}return x}function e(x){var y={next:function(){var z=x.shift();return{done:z===undefined,value:z}}};if(l.iterable){y[Symbol.iterator]=function(){return y}}return y}function p(x){this.map={};if(x instanceof p){x.forEach(function(z,y){this.append(y,z)},this)}else{if(Array.isArray(x)){x.forEach(function(y){this.append(y[0],y[1])},this)}else{if(x){Object.getOwnPropertyNames(x).forEach(function(y){this.append(y,x[y])},this)}}}}p.prototype.append=function(y,z){y=i(y);z=j(z);var x=this.map[y];this.map[y]=x?x+\",\"+z:z};p.prototype[\"delete\"]=function(x){delete this.map[i(x)]};p.prototype.get=function(x){x=i(x);return this.has(x)?this.map[x]:null};p.prototype.has=function(x){return this.map.hasOwnProperty(i(x))};p.prototype.set=function(x,y){this.map[i(x)]=j(y)};p.prototype.forEach=function(z,x){for(var y in this.map){if(this.map.hasOwnProperty(y)){z.call(x,this.map[y],y,this)}}};p.prototype.keys=function(){var x=[];this.forEach(function(z,y){x.push(y)});return e(x)};p.prototype.values=function(){var x=[];this.forEach(function(y){x.push(y)});return e(x)};p.prototype.entries=function(){var x=[];this.forEach(function(z,y){x.push([y,z])});return e(x)};if(l.iterable){p.prototype[Symbol.iterator]=p.prototype.entries}function f(x){if(x.bodyUsed){return Promise.reject(new TypeError(\"Already read\"))}x.bodyUsed=true}function h(x){return new Promise(function(z,y){x.onload=function(){z(x.result)};x.onerror=function(){y(x.error)}})}function c(y){var x=new FileReader();var z=h(x);x.readAsArrayBuffer(y);return z}function d(y){var x=new FileReader();var z=h(x);x.readAsText(y);return z}function u(y){var x=new Uint8Array(y);var A=new Array(x.length);for(var z=0;z<x.length;z++){A[z]=String.fromCharCode(x[z])}return A.join(\"\")}function k(y){if(y.slice){return y.slice(0)}else{var x=new Uint8Array(y.byteLength);x.set(new Uint8Array(y));return x.buffer}}function q(){this.bodyUsed=false;this._initBody=function(x){this._bodyInit=x;if(!x){this._bodyText=\"\"}else{if(typeof x===\"string\"){this._bodyText=x}else{if(l.blob&&Blob.prototype.isPrototypeOf(x)){this._bodyBlob=x}else{if(l.formData&&FormData.prototype.isPrototypeOf(x)){this._bodyFormData=x}else{if(l.searchParams&&URLSearchParams.prototype.isPrototypeOf(x)){this._bodyText=x.toString()}else{if(l.arrayBuffer&&l.blob&&s(x)){this._bodyArrayBuffer=k(x.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(x)||b(x))){this._bodyArrayBuffer=k(x)}else{throw new Error(\"unsupported BodyInit type\")}}}}}}}if(!this.headers.get(\"content-type\")){if(typeof x===\"string\"){this.headers.set(\"content-type\",\"text/plain;charset=UTF-8\")}else{if(this._bodyBlob&&this._bodyBlob.type){this.headers.set(\"content-type\",this._bodyBlob.type)}else{if(l.searchParams&&URLSearchParams.prototype.isPrototypeOf(x)){this.headers.set(\"content-type\",\"application/x-www-form-urlencoded;charset=UTF-8\")}}}}};if(l.blob){this.blob=function(){var x=f(this);if(x){return x}if(this._bodyBlob){return Promise.resolve(this._bodyBlob)}else{if(this._bodyArrayBuffer){return Promise.resolve(new Blob([this._bodyArrayBuffer]))}else{if(this._bodyFormData){throw new Error(\"could not read FormData body as blob\")}else{return Promise.resolve(new Blob([this._bodyText]))}}}};this.arrayBuffer=function(){if(this._bodyArrayBuffer){return f(this)||Promise.resolve(this._bodyArrayBuffer)}else{return this.blob().then(c)}}}this.text=function(){var x=f(this);if(x){return x}if(this._bodyBlob){return d(this._bodyBlob)}else{if(this._bodyArrayBuffer){return Promise.resolve(u(this._bodyArrayBuffer))}else{if(this._bodyFormData){throw new Error(\"could not read FormData body as text\")}else{return Promise.resolve(this._bodyText)}}}};if(l.formData){this.formData=function(){return this.text().then(n)}}this.json=function(){return this.text().then(JSON.parse)};return this}var t=[\"DELETE\",\"GET\",\"HEAD\",\"OPTIONS\",\"POST\",\"PUT\"];function v(y){var x=y.toUpperCase();return(t.indexOf(x)>-1)?x:y}function r(y,z){z=z||{};var x=z.body;if(y instanceof r){if(y.bodyUsed){throw new TypeError(\"Already read\")}this.url=y.url;this.credentials=y.credentials;if(!z.headers){this.headers=new p(y.headers)}this.method=y.method;this.mode=y.mode;if(!x&&y._bodyInit!=null){x=y._bodyInit;y.bodyUsed=true}}else{this.url=String(y)}this.credentials=z.credentials||this.credentials||\"omit\";if(z.headers||!this.headers){this.headers=new p(z.headers)}this.method=v(z.method||this.method||\"GET\");this.mode=z.mode||this.mode||null;this.referrer=null;if((this.method===\"GET\"||this.method===\"HEAD\")&&x){throw new TypeError(\"Body not allowed for GET or HEAD requests\")}this._initBody(x)}r.prototype.clone=function(){return new r(this,{body:this._bodyInit})};function n(x){var y=new FormData();x.trim().split(\"&\").forEach(function(z){if(z){var B=z.split(\"=\");var A=B.shift().replace(/+/g,\" \");var C=B.join(\"=\").replace(/+/g,\" \");y.append(decodeURIComponent(A),decodeURIComponent(C))}});return y}function w(z){var y=new p();var x=z.replace(/r?n[t ]+/g,\" \");x.split(/r?n/).forEach(function(A){var D=A.split(\":\");var B=D.shift().trim();if(B){var C=D.join(\":\").trim();y.append(B,C)}});return y}q.call(r.prototype);function a(y,x){if(!x){x={}}this.type=\"default\";this.status=x.status===undefined?200:x.status;this.ok=this.status>=200&&this.status<300;this.statusText=\"statusText\" in x?x.statusText:\"OK\";this.headers=new p(x.headers);this.url=x.url||\"\";this._initBody(y)}q.call(a.prototype);a.prototype.clone=function(){return new a(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})};a.error=function(){var x=new a(null,{status:0,statusText:\"\"});x.type=\"error\";return x};var g=[301,302,303,307,308];a.redirect=function(y,x){if(g.indexOf(x)===-1){throw new RangeError(\"Invalid status code\")}return new a(null,{status:x,headers:{location:y}})};o.Headers=p;o.Request=r;o.Response=a;o.fetch=function(x,y){return new Promise(function(B,A){var z=new r(x,y);var C=new XMLHttpRequest();C.onload=function(){var E={status:C.status,statusText:C.statusText,headers:w(C.getAllResponseHeaders()||\"\")};E.url=\"responseURL\" in C?C.responseURL:E.headers.get(\"X-Request-URL\");var D=\"response\" in C?C.response:C.responseText;B(new a(D,E))};C.onerror=function(){A(new TypeError(\"Network request failed\"))};C.ontimeout=function(){A(new TypeError(\"Network request failed\"))};C.open(z.method,z.url,true);if(z.credentials===\"include\"){C.withCredentials=true}else{if(z.credentials===\"omit\"){C.withCredentials=false}}if(\"responseType\" in C&&l.blob){C.responseType=\"blob\"}z.headers.forEach(function(E,D){C.setRequestHeader(D,E)});C.send(typeof z._bodyInit===\"undefined\"?null:z._bodyInit)})};o.fetch.polyfill=true})(typeof self!==\"undefined\"?self:this);","source":"upload/fetch.min.js","raw":"(function(o){if(o.fetch){return}var l={searchParams:\"URLSearchParams\" in o,iterable:\"Symbol\" in o&&\"iterator\" in Symbol,blob:\"FileReader\" in o&&\"Blob\" in o&&(function(){try{new Blob();return true}catch(x){return false}})(),formData:\"FormData\" in o,arrayBuffer:\"ArrayBuffer\" in o};if(l.arrayBuffer){var m=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\"];var s=function(x){return x&&DataView.prototype.isPrototypeOf(x)};var b=ArrayBuffer.isView||function(x){return x&&m.indexOf(Object.prototype.toString.call(x))>-1}}function i(x){if(typeof x!==\"string\"){x=String(x)}if(/[^a-z0-9-#$%&'*+.^_`|~]/i.test(x)){throw new TypeError(\"Invalid character in header field name\")}return x.toLowerCase()}function j(x){if(typeof x!==\"string\"){x=String(x)}return x}function e(x){var y={next:function(){var z=x.shift();return{done:z===undefined,value:z}}};if(l.iterable){y[Symbol.iterator]=function(){return y}}return y}function p(x){this.map={};if(x instanceof p){x.forEach(function(z,y){this.append(y,z)},this)}else{if(Array.isArray(x)){x.forEach(function(y){this.append(y[0],y[1])},this)}else{if(x){Object.getOwnPropertyNames(x).forEach(function(y){this.append(y,x[y])},this)}}}}p.prototype.append=function(y,z){y=i(y);z=j(z);var x=this.map[y];this.map[y]=x?x+\",\"+z:z};p.prototype[\"delete\"]=function(x){delete this.map[i(x)]};p.prototype.get=function(x){x=i(x);return this.has(x)?this.map[x]:null};p.prototype.has=function(x){return this.map.hasOwnProperty(i(x))};p.prototype.set=function(x,y){this.map[i(x)]=j(y)};p.prototype.forEach=function(z,x){for(var y in this.map){if(this.map.hasOwnProperty(y)){z.call(x,this.map[y],y,this)}}};p.prototype.keys=function(){var x=[];this.forEach(function(z,y){x.push(y)});return e(x)};p.prototype.values=function(){var x=[];this.forEach(function(y){x.push(y)});return e(x)};p.prototype.entries=function(){var x=[];this.forEach(function(z,y){x.push([y,z])});return e(x)};if(l.iterable){p.prototype[Symbol.iterator]=p.prototype.entries}function f(x){if(x.bodyUsed){return Promise.reject(new TypeError(\"Already read\"))}x.bodyUsed=true}function h(x){return new Promise(function(z,y){x.onload=function(){z(x.result)};x.onerror=function(){y(x.error)}})}function c(y){var x=new FileReader();var z=h(x);x.readAsArrayBuffer(y);return z}function d(y){var x=new FileReader();var z=h(x);x.readAsText(y);return z}function u(y){var x=new Uint8Array(y);var A=new Array(x.length);for(var z=0;z<x.length;z++){A[z]=String.fromCharCode(x[z])}return A.join(\"\")}function k(y){if(y.slice){return y.slice(0)}else{var x=new Uint8Array(y.byteLength);x.set(new Uint8Array(y));return x.buffer}}function q(){this.bodyUsed=false;this._initBody=function(x){this._bodyInit=x;if(!x){this._bodyText=\"\"}else{if(typeof x===\"string\"){this._bodyText=x}else{if(l.blob&&Blob.prototype.isPrototypeOf(x)){this._bodyBlob=x}else{if(l.formData&&FormData.prototype.isPrototypeOf(x)){this._bodyFormData=x}else{if(l.searchParams&&URLSearchParams.prototype.isPrototypeOf(x)){this._bodyText=x.toString()}else{if(l.arrayBuffer&&l.blob&&s(x)){this._bodyArrayBuffer=k(x.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(x)||b(x))){this._bodyArrayBuffer=k(x)}else{throw new Error(\"unsupported BodyInit type\")}}}}}}}if(!this.headers.get(\"content-type\")){if(typeof x===\"string\"){this.headers.set(\"content-type\",\"text/plain;charset=UTF-8\")}else{if(this._bodyBlob&&this._bodyBlob.type){this.headers.set(\"content-type\",this._bodyBlob.type)}else{if(l.searchParams&&URLSearchParams.prototype.isPrototypeOf(x)){this.headers.set(\"content-type\",\"application/x-www-form-urlencoded;charset=UTF-8\")}}}}};if(l.blob){this.blob=function(){var x=f(this);if(x){return x}if(this._bodyBlob){return Promise.resolve(this._bodyBlob)}else{if(this._bodyArrayBuffer){return Promise.resolve(new Blob([this._bodyArrayBuffer]))}else{if(this._bodyFormData){throw new Error(\"could not read FormData body as blob\")}else{return Promise.resolve(new Blob([this._bodyText]))}}}};this.arrayBuffer=function(){if(this._bodyArrayBuffer){return f(this)||Promise.resolve(this._bodyArrayBuffer)}else{return this.blob().then(c)}}}this.text=function(){var x=f(this);if(x){return x}if(this._bodyBlob){return d(this._bodyBlob)}else{if(this._bodyArrayBuffer){return Promise.resolve(u(this._bodyArrayBuffer))}else{if(this._bodyFormData){throw new Error(\"could not read FormData body as text\")}else{return Promise.resolve(this._bodyText)}}}};if(l.formData){this.formData=function(){return this.text().then(n)}}this.json=function(){return this.text().then(JSON.parse)};return this}var t=[\"DELETE\",\"GET\",\"HEAD\",\"OPTIONS\",\"POST\",\"PUT\"];function v(y){var x=y.toUpperCase();return(t.indexOf(x)>-1)?x:y}function r(y,z){z=z||{};var x=z.body;if(y instanceof r){if(y.bodyUsed){throw new TypeError(\"Already read\")}this.url=y.url;this.credentials=y.credentials;if(!z.headers){this.headers=new p(y.headers)}this.method=y.method;this.mode=y.mode;if(!x&&y._bodyInit!=null){x=y._bodyInit;y.bodyUsed=true}}else{this.url=String(y)}this.credentials=z.credentials||this.credentials||\"omit\";if(z.headers||!this.headers){this.headers=new p(z.headers)}this.method=v(z.method||this.method||\"GET\");this.mode=z.mode||this.mode||null;this.referrer=null;if((this.method===\"GET\"||this.method===\"HEAD\")&&x){throw new TypeError(\"Body not allowed for GET or HEAD requests\")}this._initBody(x)}r.prototype.clone=function(){return new r(this,{body:this._bodyInit})};function n(x){var y=new FormData();x.trim().split(\"&\").forEach(function(z){if(z){var B=z.split(\"=\");var A=B.shift().replace(/+/g,\" \");var C=B.join(\"=\").replace(/+/g,\" \");y.append(decodeURIComponent(A),decodeURIComponent(C))}});return y}function w(z){var y=new p();var x=z.replace(/r?n[t ]+/g,\" \");x.split(/r?n/).forEach(function(A){var D=A.split(\":\");var B=D.shift().trim();if(B){var C=D.join(\":\").trim();y.append(B,C)}});return y}q.call(r.prototype);function a(y,x){if(!x){x={}}this.type=\"default\";this.status=x.status===undefined?200:x.status;this.ok=this.status>=200&&this.status<300;this.statusText=\"statusText\" in x?x.statusText:\"OK\";this.headers=new p(x.headers);this.url=x.url||\"\";this._initBody(y)}q.call(a.prototype);a.prototype.clone=function(){return new a(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})};a.error=function(){var x=new a(null,{status:0,statusText:\"\"});x.type=\"error\";return x};var g=[301,302,303,307,308];a.redirect=function(y,x){if(g.indexOf(x)===-1){throw new RangeError(\"Invalid status code\")}return new a(null,{status:x,headers:{location:y}})};o.Headers=p;o.Request=r;o.Response=a;o.fetch=function(x,y){return new Promise(function(B,A){var z=new r(x,y);var C=new XMLHttpRequest();C.onload=function(){var E={status:C.status,statusText:C.statusText,headers:w(C.getAllResponseHeaders()||\"\")};E.url=\"responseURL\" in C?C.responseURL:E.headers.get(\"X-Request-URL\");var D=\"response\" in C?C.response:C.responseText;B(new a(D,E))};C.onerror=function(){A(new TypeError(\"Network request failed\"))};C.ontimeout=function(){A(new TypeError(\"Network request failed\"))};C.open(z.method,z.url,true);if(z.credentials===\"include\"){C.withCredentials=true}else{if(z.credentials===\"omit\"){C.withCredentials=false}}if(\"responseType\" in C&&l.blob){C.responseType=\"blob\"}z.headers.forEach(function(E,D){C.setRequestHeader(D,E)});C.send(typeof z._bodyInit===\"undefined\"?null:z._bodyInit)})};o.fetch.polyfill=true})(typeof self!==\"undefined\"?self:this);","date":"2018-06-17T09:49:30.000Z","updated":"2018-06-17T09:49:30.000Z","path":"upload/fetch.min.js","layout":"false","title":"","comments":1,"_id":"cjiitidi80007u4q9n3iplo8k","content":"(function(o){if(o.fetch){return}var l={searchParams:\"URLSearchParams\" in o,iterable:\"Symbol\" in o&&\"iterator\" in Symbol,blob:\"FileReader\" in o&&\"Blob\" in o&&(function(){try{new Blob();return true}catch(x){return false}})(),formData:\"FormData\" in o,arrayBuffer:\"ArrayBuffer\" in o};if(l.arrayBuffer){var m=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\"];var s=function(x){return x&&DataView.prototype.isPrototypeOf(x)};var b=ArrayBuffer.isView||function(x){return x&&m.indexOf(Object.prototype.toString.call(x))>-1}}function i(x){if(typeof x!==\"string\"){x=String(x)}if(/[^a-z0-9-#$%&'*+.^_`|~]/i.test(x)){throw new TypeError(\"Invalid character in header field name\")}return x.toLowerCase()}function j(x){if(typeof x!==\"string\"){x=String(x)}return x}function e(x){var y={next:function(){var z=x.shift();return{done:z===undefined,value:z}}};if(l.iterable){y[Symbol.iterator]=function(){return y}}return y}function p(x){this.map={};if(x instanceof p){x.forEach(function(z,y){this.append(y,z)},this)}else{if(Array.isArray(x)){x.forEach(function(y){this.append(y[0],y[1])},this)}else{if(x){Object.getOwnPropertyNames(x).forEach(function(y){this.append(y,x[y])},this)}}}}p.prototype.append=function(y,z){y=i(y);z=j(z);var x=this.map[y];this.map[y]=x?x+\",\"+z:z};p.prototype[\"delete\"]=function(x){delete this.map[i(x)]};p.prototype.get=function(x){x=i(x);return this.has(x)?this.map[x]:null};p.prototype.has=function(x){return this.map.hasOwnProperty(i(x))};p.prototype.set=function(x,y){this.map[i(x)]=j(y)};p.prototype.forEach=function(z,x){for(var y in this.map){if(this.map.hasOwnProperty(y)){z.call(x,this.map[y],y,this)}}};p.prototype.keys=function(){var x=[];this.forEach(function(z,y){x.push(y)});return e(x)};p.prototype.values=function(){var x=[];this.forEach(function(y){x.push(y)});return e(x)};p.prototype.entries=function(){var x=[];this.forEach(function(z,y){x.push([y,z])});return e(x)};if(l.iterable){p.prototype[Symbol.iterator]=p.prototype.entries}function f(x){if(x.bodyUsed){return Promise.reject(new TypeError(\"Already read\"))}x.bodyUsed=true}function h(x){return new Promise(function(z,y){x.onload=function(){z(x.result)};x.onerror=function(){y(x.error)}})}function c(y){var x=new FileReader();var z=h(x);x.readAsArrayBuffer(y);return z}function d(y){var x=new FileReader();var z=h(x);x.readAsText(y);return z}function u(y){var x=new Uint8Array(y);var A=new Array(x.length);for(var z=0;z<x.length;z++){a[z]=string.fromcharcode(x[z])}return a.join(\"\")}function=\"\" k(y){if(y.slice){return=\"\" y.slice(0)}else{var=\"\" x=\"new\" uint8array(y.bytelength);x.set(new=\"\" uint8array(y));return=\"\" x.buffer}}function=\"\" q(){this.bodyused=\"false;this._initBody=function(x){this._bodyInit=x;if(!x){this._bodyText=\"\"}else{if(typeof\" blob([this._bodyarraybuffer])}else{if(l.arraybuffer&&(arraybuffer.prototype.isprototypeof(x)||b(x))){this._bodyarraybuffer=\"k(x)}else{throw\" new=\"\" error(\"unsupported=\"\" bodyinit=\"\" type\")}}}}}}}if(!this.headers.get(\"content-type\")){if(typeof=\"\" x}if(this._bodyblob){return=\"\" promise.resolve(this._bodyblob)}else{if(this._bodyarraybuffer){return=\"\" promise.resolve(new=\"\" blob([this._bodyarraybuffer]))}else{if(this._bodyformdata){throw=\"\" error(\"could=\"\" not=\"\" read=\"\" formdata=\"\" body=\"\" as=\"\" blob\")}else{return=\"\" blob([this._bodytext]))}}}};this.arraybuffer=\"function(){if(this._bodyArrayBuffer){return\" f(this)||promise.resolve(this._bodyarraybuffer)}else{return=\"\" this.blob().then(c)}}}this.text=\"function(){var\" d(this._bodyblob)}else{if(this._bodyarraybuffer){return=\"\" promise.resolve(u(this._bodyarraybuffer))}else{if(this._bodyformdata){throw=\"\" text\")}else{return=\"\" promise.resolve(this._bodytext)}}}};if(l.formdata){this.formdata=\"function(){return\" this.text().then(n)}}this.json=\"function(){return\" this.text().then(json.parse)};return=\"\" this}var=\"\" t=\"[\"DELETE\",\"GET\",\"HEAD\",\"OPTIONS\",\"POST\",\"PUT\"];function\" v(y){var=\"\">-1)?x:y}function r(y,z){z=z||{};var x=z.body;if(y instanceof r){if(y.bodyUsed){throw new TypeError(\"Already read\")}this.url=y.url;this.credentials=y.credentials;if(!z.headers){this.headers=new p(y.headers)}this.method=y.method;this.mode=y.mode;if(!x&&y._bodyInit!=null){x=y._bodyInit;y.bodyUsed=true}}else{this.url=String(y)}this.credentials=z.credentials||this.credentials||\"omit\";if(z.headers||!this.headers){this.headers=new p(z.headers)}this.method=v(z.method||this.method||\"GET\");this.mode=z.mode||this.mode||null;this.referrer=null;if((this.method===\"GET\"||this.method===\"HEAD\")&&x){throw new TypeError(\"Body not allowed for GET or HEAD requests\")}this._initBody(x)}r.prototype.clone=function(){return new r(this,{body:this._bodyInit})};function n(x){var y=new FormData();x.trim().split(\"&\").forEach(function(z){if(z){var B=z.split(\"=\");var A=B.shift().replace(/+/g,\" \");var C=B.join(\"=\").replace(/+/g,\" \");y.append(decodeURIComponent(A),decodeURIComponent(C))}});return y}function w(z){var y=new p();var x=z.replace(/r?n[t ]+/g,\" \");x.split(/r?n/).forEach(function(A){var D=A.split(\":\");var B=D.shift().trim();if(B){var C=D.join(\":\").trim();y.append(B,C)}});return y}q.call(r.prototype);function a(y,x){if(!x){x={}}this.type=\"default\";this.status=x.status===undefined?200:x.status;this.ok=this.status>=200&&this.status</x.length;z++){a[z]=string.fromcharcode(x[z])}return>","site":{"data":{}},"excerpt":"","more":"(function(o){if(o.fetch){return}var l={searchParams:\"URLSearchParams\" in o,iterable:\"Symbol\" in o&&\"iterator\" in Symbol,blob:\"FileReader\" in o&&\"Blob\" in o&&(function(){try{new Blob();return true}catch(x){return false}})(),formData:\"FormData\" in o,arrayBuffer:\"ArrayBuffer\" in o};if(l.arrayBuffer){var m=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\"];var s=function(x){return x&&DataView.prototype.isPrototypeOf(x)};var b=ArrayBuffer.isView||function(x){return x&&m.indexOf(Object.prototype.toString.call(x))>-1}}function i(x){if(typeof x!==\"string\"){x=String(x)}if(/[^a-z0-9-#$%&'*+.^_`|~]/i.test(x)){throw new TypeError(\"Invalid character in header field name\")}return x.toLowerCase()}function j(x){if(typeof x!==\"string\"){x=String(x)}return x}function e(x){var y={next:function(){var z=x.shift();return{done:z===undefined,value:z}}};if(l.iterable){y[Symbol.iterator]=function(){return y}}return y}function p(x){this.map={};if(x instanceof p){x.forEach(function(z,y){this.append(y,z)},this)}else{if(Array.isArray(x)){x.forEach(function(y){this.append(y[0],y[1])},this)}else{if(x){Object.getOwnPropertyNames(x).forEach(function(y){this.append(y,x[y])},this)}}}}p.prototype.append=function(y,z){y=i(y);z=j(z);var x=this.map[y];this.map[y]=x?x+\",\"+z:z};p.prototype[\"delete\"]=function(x){delete this.map[i(x)]};p.prototype.get=function(x){x=i(x);return this.has(x)?this.map[x]:null};p.prototype.has=function(x){return this.map.hasOwnProperty(i(x))};p.prototype.set=function(x,y){this.map[i(x)]=j(y)};p.prototype.forEach=function(z,x){for(var y in this.map){if(this.map.hasOwnProperty(y)){z.call(x,this.map[y],y,this)}}};p.prototype.keys=function(){var x=[];this.forEach(function(z,y){x.push(y)});return e(x)};p.prototype.values=function(){var x=[];this.forEach(function(y){x.push(y)});return e(x)};p.prototype.entries=function(){var x=[];this.forEach(function(z,y){x.push([y,z])});return e(x)};if(l.iterable){p.prototype[Symbol.iterator]=p.prototype.entries}function f(x){if(x.bodyUsed){return Promise.reject(new TypeError(\"Already read\"))}x.bodyUsed=true}function h(x){return new Promise(function(z,y){x.onload=function(){z(x.result)};x.onerror=function(){y(x.error)}})}function c(y){var x=new FileReader();var z=h(x);x.readAsArrayBuffer(y);return z}function d(y){var x=new FileReader();var z=h(x);x.readAsText(y);return z}function u(y){var x=new Uint8Array(y);var A=new Array(x.length);for(var z=0;z<x.length;z++){a[z]=string.fromcharcode(x[z])}return a.join(\"\")}function=\"\" k(y){if(y.slice){return=\"\" y.slice(0)}else{var=\"\" x=\"new\" uint8array(y.bytelength);x.set(new=\"\" uint8array(y));return=\"\" x.buffer}}function=\"\" q(){this.bodyused=\"false;this._initBody=function(x){this._bodyInit=x;if(!x){this._bodyText=\"\"}else{if(typeof\" blob([this._bodyarraybuffer])}else{if(l.arraybuffer&&(arraybuffer.prototype.isprototypeof(x)||b(x))){this._bodyarraybuffer=\"k(x)}else{throw\" new=\"\" error(\"unsupported=\"\" bodyinit=\"\" type\")}}}}}}}if(!this.headers.get(\"content-type\")){if(typeof=\"\" x}if(this._bodyblob){return=\"\" promise.resolve(this._bodyblob)}else{if(this._bodyarraybuffer){return=\"\" promise.resolve(new=\"\" blob([this._bodyarraybuffer]))}else{if(this._bodyformdata){throw=\"\" error(\"could=\"\" not=\"\" read=\"\" formdata=\"\" body=\"\" as=\"\" blob\")}else{return=\"\" blob([this._bodytext]))}}}};this.arraybuffer=\"function(){if(this._bodyArrayBuffer){return\" f(this)||promise.resolve(this._bodyarraybuffer)}else{return=\"\" this.blob().then(c)}}}this.text=\"function(){var\" d(this._bodyblob)}else{if(this._bodyarraybuffer){return=\"\" promise.resolve(u(this._bodyarraybuffer))}else{if(this._bodyformdata){throw=\"\" text\")}else{return=\"\" promise.resolve(this._bodytext)}}}};if(l.formdata){this.formdata=\"function(){return\" this.text().then(n)}}this.json=\"function(){return\" this.text().then(json.parse)};return=\"\" this}var=\"\" t=\"[\"DELETE\",\"GET\",\"HEAD\",\"OPTIONS\",\"POST\",\"PUT\"];function\" v(y){var=\"\">-1)?x:y}function r(y,z){z=z||{};var x=z.body;if(y instanceof r){if(y.bodyUsed){throw new TypeError(\"Already read\")}this.url=y.url;this.credentials=y.credentials;if(!z.headers){this.headers=new p(y.headers)}this.method=y.method;this.mode=y.mode;if(!x&&y._bodyInit!=null){x=y._bodyInit;y.bodyUsed=true}}else{this.url=String(y)}this.credentials=z.credentials||this.credentials||\"omit\";if(z.headers||!this.headers){this.headers=new p(z.headers)}this.method=v(z.method||this.method||\"GET\");this.mode=z.mode||this.mode||null;this.referrer=null;if((this.method===\"GET\"||this.method===\"HEAD\")&&x){throw new TypeError(\"Body not allowed for GET or HEAD requests\")}this._initBody(x)}r.prototype.clone=function(){return new r(this,{body:this._bodyInit})};function n(x){var y=new FormData();x.trim().split(\"&\").forEach(function(z){if(z){var B=z.split(\"=\");var A=B.shift().replace(/+/g,\" \");var C=B.join(\"=\").replace(/+/g,\" \");y.append(decodeURIComponent(A),decodeURIComponent(C))}});return y}function w(z){var y=new p();var x=z.replace(/r?n[t ]+/g,\" \");x.split(/r?n/).forEach(function(A){var D=A.split(\":\");var B=D.shift().trim();if(B){var C=D.join(\":\").trim();y.append(B,C)}});return y}q.call(r.prototype);function a(y,x){if(!x){x={}}this.type=\"default\";this.status=x.status===undefined?200:x.status;this.ok=this.status>=200&&this.status</x.length;z++){a[z]=string.fromcharcode(x[z])}return>"}],"Post":[{"title":"7æ‹›è½»æ¾æå®š JavaScript å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥","date":"2016-01-06T13:24:40.000Z","comments":0,"_content":"\nå¹³å¸¸åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œä¼šç»å¸¸é‡åˆ°å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œæˆ‘éœ€è¦å¤„ç†ä¸€ä¸ª `li` æ ‡ç­¾åŠ¨æ€æ‹¼æ¥æ˜¾ç¤ºåˆ° `ul` ä¸­ï¼Œç­‰ç­‰ï¼Œåƒè¿™æ ·çš„éœ€æ±‚åœºæ™¯è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œè¿™å°±éœ€è¦æ ¹æ®åœ¨é¡¹ç›®ä¸­å®é™…é‡åˆ°çš„éœ€æ±‚æ¥å¤„ç†ï¼Œé€‰æ‹©åˆé€‚çš„æ‹¼æ¥æ–¹å¼ä¼šå¤§å¤§æé«˜å¼€å‘æ•ˆç‡å¹¶å‡å°‘å‡ºé”™çš„å¯èƒ½ï¼Œåœ¨è¿™é‡Œæˆ‘æ€»ç»“äº†7æ‹›å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•ã€‚\n\n<!-- more -->\n#### éœ€æ±‚åœºæ™¯\nåœ¨é¡¹ç›®ä¸­ï¼ŒåŠ¨æ€å¤„ç†åˆ†é¡µï¼Œæ ¹æ®ç³»ç»Ÿè®¾å®šçš„æ˜¾ç¤ºæ¡ç›®ç¡®å®šæœ‰å¤šå°‘åˆ†é¡µï¼Œè¿™æ—¶ï¼Œéœ€è¦å°†åˆ†é¡µçš„å†…å®¹ç»è¿‡å¤„ç†åŠ¨æ€ç”Ÿæˆå†æ”¾å›åˆ°åŸæ¥çš„ `ul` ä¸­ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¤šè¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚\n\n```html\n<li><a href=\"#\">ä¸Šé¡µ</a></li>\n<li><a href=\"#\"> 1 </a></li>\n<li><a href=\"#\">ä¸‹é¡µ</a></li>\n```\nå¯¹äºè¿™æ ·çš„ DOM ç»“æ„éœ€è¦åœ¨ JavaScript ä¸­æ‹¼æ¥ï¼Œä½ ä¼šæ€æ ·å¤„ç†ï¼Ÿ\n#### 1. å¸¸è§„æ–¹æ³•\n```js\nvar s=`<li><a href=\"\">ä¸Šé¡µ</a></li><li><a href=\"\">1</a></li><li><a href=\"\">ä¸‹é¡µ</a></li>`;\n```\n#### 2. å­—ç¬¦ä¸²ç›¸åŠ \n```js\nvar str = `<li><a href=\"#\">ä¸Šé¡µ</a></li>` +\n          `<li><a href=\"#\"> 1 </a></li>` +\n          `<li><a href=\"#\">ä¸‹é¡µ</a></li>`;\n```\n\n#### 3.åæ–œæ \n```js\nvar str = `<li><a href=\"#\">ä¸Šé¡µ</a></li>\\\n           <li><a href=\"#\"> 1 </a></li>\\\n           <li><a href=\"#\">ä¸‹é¡µ</a></li>`;\n```\n\n#### 4.æ•°ç»„åˆ‡å‰²\n```js\nvar str = [\n    `<li><a href=\"#\">ä¸Šé¡µ</a></li>`,\n    `<li><a href=\"#\"> 1 </a></li>`,\n    `<li><a href=\"#\">ä¸‹é¡µ</a></li>`\n].join('\\n');\n```\n\n#### 5. ES6 è¯­æ³•\n```js\nvar str = `<li><a href=\"#\">ä¸Šé¡µ</a></li>\n          <li><a href=\"#\"> 1 </a></li>\n          <li><a href=\"#\">ä¸‹é¡µ</a></li>`\n```\n\n#### 6.æ­£åˆ™è¡¨è¾¾å¼\n```text\næŸ¥æ‰¾ï¼š\\n\næ›¿æ¢ï¼š\\\\\\n\né€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŠŠåŸæœ‰çš„æ¢è¡Œ \\n æ›¿æ¢æˆäº† \\\\\\n å¸¦æœ‰åæ–œæ çš„æ¢è¡Œï¼Œæœ¬è´¨æ˜¯å’Œåæ–œæ æ–¹æ³•ä¸€æ ·\n```\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbn70seheej218s0v8n0x.jpg)\n\n#### 7.é»‘é­”æ³•\n```js\nfunction aHereDoc() {/*\n    <li><a href=\"#\">ä¸Šé¡µ</a></li>\n    <li><a href=\"#\"> 1 </a></li>\n    <li><a href=\"#\">ä¸‹é¡µ</a></li>\n    */}\n\nfunction hereDoc(func) {\n    return func.toString().split(/\\n/).slice(1, -1).join('\\n');\n}\nconsole.log(hereDoc(aHereDoc));\n```\nåˆ©ç”¨ `func.toString()` è·å–éœ€è¦æ‰¹é‡å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œåˆ©ç”¨ `split(/\\n/).slice(1, -1)` å»æ‰é¦–å°¾ä¸¤è¡Œå‡½æ•°å®šä¹‰çš„ä»£ç ï¼Œæ§åˆ¶å°è¾“å‡ºï¼š\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbn6ta8s3yj21460b5jt0.jpg)\n","source":"_posts/7æ‹›è½»æ¾æå®š-JavaScript-å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥.md","raw":"---\ntitle: '7æ‹›è½»æ¾æå®š JavaScript å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥'\ndate: 2016-01-06 21:24:40\ntags:\ncomments: false\n---\n\nå¹³å¸¸åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œä¼šç»å¸¸é‡åˆ°å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œæˆ‘éœ€è¦å¤„ç†ä¸€ä¸ª `li` æ ‡ç­¾åŠ¨æ€æ‹¼æ¥æ˜¾ç¤ºåˆ° `ul` ä¸­ï¼Œç­‰ç­‰ï¼Œåƒè¿™æ ·çš„éœ€æ±‚åœºæ™¯è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œè¿™å°±éœ€è¦æ ¹æ®åœ¨é¡¹ç›®ä¸­å®é™…é‡åˆ°çš„éœ€æ±‚æ¥å¤„ç†ï¼Œé€‰æ‹©åˆé€‚çš„æ‹¼æ¥æ–¹å¼ä¼šå¤§å¤§æé«˜å¼€å‘æ•ˆç‡å¹¶å‡å°‘å‡ºé”™çš„å¯èƒ½ï¼Œåœ¨è¿™é‡Œæˆ‘æ€»ç»“äº†7æ‹›å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•ã€‚\n\n<!-- more -->\n#### éœ€æ±‚åœºæ™¯\nåœ¨é¡¹ç›®ä¸­ï¼ŒåŠ¨æ€å¤„ç†åˆ†é¡µï¼Œæ ¹æ®ç³»ç»Ÿè®¾å®šçš„æ˜¾ç¤ºæ¡ç›®ç¡®å®šæœ‰å¤šå°‘åˆ†é¡µï¼Œè¿™æ—¶ï¼Œéœ€è¦å°†åˆ†é¡µçš„å†…å®¹ç»è¿‡å¤„ç†åŠ¨æ€ç”Ÿæˆå†æ”¾å›åˆ°åŸæ¥çš„ `ul` ä¸­ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¤šè¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚\n\n```html\n<li><a href=\"#\">ä¸Šé¡µ</a></li>\n<li><a href=\"#\"> 1 </a></li>\n<li><a href=\"#\">ä¸‹é¡µ</a></li>\n```\nå¯¹äºè¿™æ ·çš„ DOM ç»“æ„éœ€è¦åœ¨ JavaScript ä¸­æ‹¼æ¥ï¼Œä½ ä¼šæ€æ ·å¤„ç†ï¼Ÿ\n#### 1. å¸¸è§„æ–¹æ³•\n```js\nvar s=`<li><a href=\"\">ä¸Šé¡µ</a></li><li><a href=\"\">1</a></li><li><a href=\"\">ä¸‹é¡µ</a></li>`;\n```\n#### 2. å­—ç¬¦ä¸²ç›¸åŠ \n```js\nvar str = `<li><a href=\"#\">ä¸Šé¡µ</a></li>` +\n          `<li><a href=\"#\"> 1 </a></li>` +\n          `<li><a href=\"#\">ä¸‹é¡µ</a></li>`;\n```\n\n#### 3.åæ–œæ \n```js\nvar str = `<li><a href=\"#\">ä¸Šé¡µ</a></li>\\\n           <li><a href=\"#\"> 1 </a></li>\\\n           <li><a href=\"#\">ä¸‹é¡µ</a></li>`;\n```\n\n#### 4.æ•°ç»„åˆ‡å‰²\n```js\nvar str = [\n    `<li><a href=\"#\">ä¸Šé¡µ</a></li>`,\n    `<li><a href=\"#\"> 1 </a></li>`,\n    `<li><a href=\"#\">ä¸‹é¡µ</a></li>`\n].join('\\n');\n```\n\n#### 5. ES6 è¯­æ³•\n```js\nvar str = `<li><a href=\"#\">ä¸Šé¡µ</a></li>\n          <li><a href=\"#\"> 1 </a></li>\n          <li><a href=\"#\">ä¸‹é¡µ</a></li>`\n```\n\n#### 6.æ­£åˆ™è¡¨è¾¾å¼\n```text\næŸ¥æ‰¾ï¼š\\n\næ›¿æ¢ï¼š\\\\\\n\né€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŠŠåŸæœ‰çš„æ¢è¡Œ \\n æ›¿æ¢æˆäº† \\\\\\n å¸¦æœ‰åæ–œæ çš„æ¢è¡Œï¼Œæœ¬è´¨æ˜¯å’Œåæ–œæ æ–¹æ³•ä¸€æ ·\n```\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbn70seheej218s0v8n0x.jpg)\n\n#### 7.é»‘é­”æ³•\n```js\nfunction aHereDoc() {/*\n    <li><a href=\"#\">ä¸Šé¡µ</a></li>\n    <li><a href=\"#\"> 1 </a></li>\n    <li><a href=\"#\">ä¸‹é¡µ</a></li>\n    */}\n\nfunction hereDoc(func) {\n    return func.toString().split(/\\n/).slice(1, -1).join('\\n');\n}\nconsole.log(hereDoc(aHereDoc));\n```\nåˆ©ç”¨ `func.toString()` è·å–éœ€è¦æ‰¹é‡å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œåˆ©ç”¨ `split(/\\n/).slice(1, -1)` å»æ‰é¦–å°¾ä¸¤è¡Œå‡½æ•°å®šä¹‰çš„ä»£ç ï¼Œæ§åˆ¶å°è¾“å‡ºï¼š\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbn6ta8s3yj21460b5jt0.jpg)\n","slug":"7æ‹›è½»æ¾æå®š-JavaScript-å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidhv0000u4q9aa1hww8v","content":"<p>å¹³å¸¸åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œä¼šç»å¸¸é‡åˆ°å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œæˆ‘éœ€è¦å¤„ç†ä¸€ä¸ª <code>li</code> æ ‡ç­¾åŠ¨æ€æ‹¼æ¥æ˜¾ç¤ºåˆ° <code>ul</code> ä¸­ï¼Œç­‰ç­‰ï¼Œåƒè¿™æ ·çš„éœ€æ±‚åœºæ™¯è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œè¿™å°±éœ€è¦æ ¹æ®åœ¨é¡¹ç›®ä¸­å®é™…é‡åˆ°çš„éœ€æ±‚æ¥å¤„ç†ï¼Œé€‰æ‹©åˆé€‚çš„æ‹¼æ¥æ–¹å¼ä¼šå¤§å¤§æé«˜å¼€å‘æ•ˆç‡å¹¶å‡å°‘å‡ºé”™çš„å¯èƒ½ï¼Œåœ¨è¿™é‡Œæˆ‘æ€»ç»“äº†7æ‹›å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•ã€‚</p>\n<a id=\"more\"></a>\n<h4 id=\"éœ€æ±‚åœºæ™¯\"><a href=\"#éœ€æ±‚åœºæ™¯\" class=\"headerlink\" title=\"éœ€æ±‚åœºæ™¯\"></a>éœ€æ±‚åœºæ™¯</h4><p>åœ¨é¡¹ç›®ä¸­ï¼ŒåŠ¨æ€å¤„ç†åˆ†é¡µï¼Œæ ¹æ®ç³»ç»Ÿè®¾å®šçš„æ˜¾ç¤ºæ¡ç›®ç¡®å®šæœ‰å¤šå°‘åˆ†é¡µï¼Œè¿™æ—¶ï¼Œéœ€è¦å°†åˆ†é¡µçš„å†…å®¹ç»è¿‡å¤„ç†åŠ¨æ€ç”Ÿæˆå†æ”¾å›åˆ°åŸæ¥çš„ <code>ul</code> ä¸­ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¤šè¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>ä¸Šé¡µ<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span> 1 <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>ä¸‹é¡µ<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å¯¹äºè¿™æ ·çš„ DOM ç»“æ„éœ€è¦åœ¨ JavaScript ä¸­æ‹¼æ¥ï¼Œä½ ä¼šæ€æ ·å¤„ç†ï¼Ÿ</p>\n<h4 id=\"1-å¸¸è§„æ–¹æ³•\"><a href=\"#1-å¸¸è§„æ–¹æ³•\" class=\"headerlink\" title=\"1. å¸¸è§„æ–¹æ³•\"></a>1. å¸¸è§„æ–¹æ³•</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> s=<span class=\"string\">`&lt;li&gt;&lt;a href=\"\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\"\"&gt;1&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\"\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span>;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-å­—ç¬¦ä¸²ç›¸åŠ \"><a href=\"#2-å­—ç¬¦ä¸²ç›¸åŠ \" class=\"headerlink\" title=\"2. å­—ç¬¦ä¸²ç›¸åŠ \"></a>2. å­—ç¬¦ä¸²ç›¸åŠ </h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;`</span> +</span><br><span class=\"line\">          <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;`</span> +</span><br><span class=\"line\">          <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span>;</span><br></pre></td></tr></table></figure>\n<h4 id=\"3-åæ–œæ \"><a href=\"#3-åæ–œæ \" class=\"headerlink\" title=\"3.åæ–œæ \"></a>3.åæ–œæ </h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;\\</span></span><br><span class=\"line\"><span class=\"string\">           &lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;\\</span></span><br><span class=\"line\"><span class=\"string\">           &lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span>;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-æ•°ç»„åˆ‡å‰²\"><a href=\"#4-æ•°ç»„åˆ‡å‰²\" class=\"headerlink\" title=\"4.æ•°ç»„åˆ‡å‰²\"></a>4.æ•°ç»„åˆ‡å‰²</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = [</span><br><span class=\"line\">    <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;`</span>,</span><br><span class=\"line\">    <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;`</span>,</span><br><span class=\"line\">    <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span></span><br><span class=\"line\">].join(<span class=\"string\">'\\n'</span>);</span><br></pre></td></tr></table></figure>\n<h4 id=\"5-ES6-è¯­æ³•\"><a href=\"#5-ES6-è¯­æ³•\" class=\"headerlink\" title=\"5. ES6 è¯­æ³•\"></a>5. ES6 è¯­æ³•</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"string\">          &lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"string\">          &lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"6-æ­£åˆ™è¡¨è¾¾å¼\"><a href=\"#6-æ­£åˆ™è¡¨è¾¾å¼\" class=\"headerlink\" title=\"6.æ­£åˆ™è¡¨è¾¾å¼\"></a>6.æ­£åˆ™è¡¨è¾¾å¼</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æŸ¥æ‰¾ï¼š\\n</span><br><span class=\"line\">æ›¿æ¢ï¼š\\\\\\n</span><br><span class=\"line\">é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŠŠåŸæœ‰çš„æ¢è¡Œ \\n æ›¿æ¢æˆäº† \\\\\\n å¸¦æœ‰åæ–œæ çš„æ¢è¡Œï¼Œæœ¬è´¨æ˜¯å’Œåæ–œæ æ–¹æ³•ä¸€æ ·</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbn70seheej218s0v8n0x.jpg\" alt=\"\"></p>\n<h4 id=\"7-é»‘é­”æ³•\"><a href=\"#7-é»‘é­”æ³•\" class=\"headerlink\" title=\"7.é»‘é­”æ³•\"></a>7.é»‘é­”æ³•</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">aHereDoc</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    &lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    &lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    &lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    */</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hereDoc</span>(<span class=\"params\">func</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> func.toString().split(<span class=\"regexp\">/\\n/</span>).slice(<span class=\"number\">1</span>, <span class=\"number\">-1</span>).join(<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(hereDoc(aHereDoc));</span><br></pre></td></tr></table></figure>\n<p>åˆ©ç”¨ <code>func.toString()</code> è·å–éœ€è¦æ‰¹é‡å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œåˆ©ç”¨ <code>split(/\\n/).slice(1, -1)</code> å»æ‰é¦–å°¾ä¸¤è¡Œå‡½æ•°å®šä¹‰çš„ä»£ç ï¼Œæ§åˆ¶å°è¾“å‡ºï¼š<br><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbn6ta8s3yj21460b5jt0.jpg\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"<p>å¹³å¸¸åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œä¼šç»å¸¸é‡åˆ°å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œæˆ‘éœ€è¦å¤„ç†ä¸€ä¸ª <code>li</code> æ ‡ç­¾åŠ¨æ€æ‹¼æ¥æ˜¾ç¤ºåˆ° <code>ul</code> ä¸­ï¼Œç­‰ç­‰ï¼Œåƒè¿™æ ·çš„éœ€æ±‚åœºæ™¯è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œè¿™å°±éœ€è¦æ ¹æ®åœ¨é¡¹ç›®ä¸­å®é™…é‡åˆ°çš„éœ€æ±‚æ¥å¤„ç†ï¼Œé€‰æ‹©åˆé€‚çš„æ‹¼æ¥æ–¹å¼ä¼šå¤§å¤§æé«˜å¼€å‘æ•ˆç‡å¹¶å‡å°‘å‡ºé”™çš„å¯èƒ½ï¼Œåœ¨è¿™é‡Œæˆ‘æ€»ç»“äº†7æ‹›å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•ã€‚</p>","more":"<h4 id=\"éœ€æ±‚åœºæ™¯\"><a href=\"#éœ€æ±‚åœºæ™¯\" class=\"headerlink\" title=\"éœ€æ±‚åœºæ™¯\"></a>éœ€æ±‚åœºæ™¯</h4><p>åœ¨é¡¹ç›®ä¸­ï¼ŒåŠ¨æ€å¤„ç†åˆ†é¡µï¼Œæ ¹æ®ç³»ç»Ÿè®¾å®šçš„æ˜¾ç¤ºæ¡ç›®ç¡®å®šæœ‰å¤šå°‘åˆ†é¡µï¼Œè¿™æ—¶ï¼Œéœ€è¦å°†åˆ†é¡µçš„å†…å®¹ç»è¿‡å¤„ç†åŠ¨æ€ç”Ÿæˆå†æ”¾å›åˆ°åŸæ¥çš„ <code>ul</code> ä¸­ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œå¤šè¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>ä¸Šé¡µ<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span> 1 <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>ä¸‹é¡µ<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å¯¹äºè¿™æ ·çš„ DOM ç»“æ„éœ€è¦åœ¨ JavaScript ä¸­æ‹¼æ¥ï¼Œä½ ä¼šæ€æ ·å¤„ç†ï¼Ÿ</p>\n<h4 id=\"1-å¸¸è§„æ–¹æ³•\"><a href=\"#1-å¸¸è§„æ–¹æ³•\" class=\"headerlink\" title=\"1. å¸¸è§„æ–¹æ³•\"></a>1. å¸¸è§„æ–¹æ³•</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> s=<span class=\"string\">`&lt;li&gt;&lt;a href=\"\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\"\"&gt;1&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\"\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span>;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-å­—ç¬¦ä¸²ç›¸åŠ \"><a href=\"#2-å­—ç¬¦ä¸²ç›¸åŠ \" class=\"headerlink\" title=\"2. å­—ç¬¦ä¸²ç›¸åŠ \"></a>2. å­—ç¬¦ä¸²ç›¸åŠ </h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;`</span> +</span><br><span class=\"line\">          <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;`</span> +</span><br><span class=\"line\">          <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span>;</span><br></pre></td></tr></table></figure>\n<h4 id=\"3-åæ–œæ \"><a href=\"#3-åæ–œæ \" class=\"headerlink\" title=\"3.åæ–œæ \"></a>3.åæ–œæ </h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;\\</span></span><br><span class=\"line\"><span class=\"string\">           &lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;\\</span></span><br><span class=\"line\"><span class=\"string\">           &lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span>;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-æ•°ç»„åˆ‡å‰²\"><a href=\"#4-æ•°ç»„åˆ‡å‰²\" class=\"headerlink\" title=\"4.æ•°ç»„åˆ‡å‰²\"></a>4.æ•°ç»„åˆ‡å‰²</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = [</span><br><span class=\"line\">    <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;`</span>,</span><br><span class=\"line\">    <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;`</span>,</span><br><span class=\"line\">    <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span></span><br><span class=\"line\">].join(<span class=\"string\">'\\n'</span>);</span><br></pre></td></tr></table></figure>\n<h4 id=\"5-ES6-è¯­æ³•\"><a href=\"#5-ES6-è¯­æ³•\" class=\"headerlink\" title=\"5. ES6 è¯­æ³•\"></a>5. ES6 è¯­æ³•</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> str = <span class=\"string\">`&lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"string\">          &lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"string\">          &lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;`</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"6-æ­£åˆ™è¡¨è¾¾å¼\"><a href=\"#6-æ­£åˆ™è¡¨è¾¾å¼\" class=\"headerlink\" title=\"6.æ­£åˆ™è¡¨è¾¾å¼\"></a>6.æ­£åˆ™è¡¨è¾¾å¼</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æŸ¥æ‰¾ï¼š\\n</span><br><span class=\"line\">æ›¿æ¢ï¼š\\\\\\n</span><br><span class=\"line\">é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŠŠåŸæœ‰çš„æ¢è¡Œ \\n æ›¿æ¢æˆäº† \\\\\\n å¸¦æœ‰åæ–œæ çš„æ¢è¡Œï¼Œæœ¬è´¨æ˜¯å’Œåæ–œæ æ–¹æ³•ä¸€æ ·</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbn70seheej218s0v8n0x.jpg\" alt=\"\"></p>\n<h4 id=\"7-é»‘é­”æ³•\"><a href=\"#7-é»‘é­”æ³•\" class=\"headerlink\" title=\"7.é»‘é­”æ³•\"></a>7.é»‘é­”æ³•</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">aHereDoc</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    &lt;li&gt;&lt;a href=\"#\"&gt;ä¸Šé¡µ&lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    &lt;li&gt;&lt;a href=\"#\"&gt; 1 &lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    &lt;li&gt;&lt;a href=\"#\"&gt;ä¸‹é¡µ&lt;/a&gt;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    */</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hereDoc</span>(<span class=\"params\">func</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> func.toString().split(<span class=\"regexp\">/\\n/</span>).slice(<span class=\"number\">1</span>, <span class=\"number\">-1</span>).join(<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(hereDoc(aHereDoc));</span><br></pre></td></tr></table></figure>\n<p>åˆ©ç”¨ <code>func.toString()</code> è·å–éœ€è¦æ‰¹é‡å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œåˆ©ç”¨ <code>split(/\\n/).slice(1, -1)</code> å»æ‰é¦–å°¾ä¸¤è¡Œå‡½æ•°å®šä¹‰çš„ä»£ç ï¼Œæ§åˆ¶å°è¾“å‡ºï¼š<br><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbn6ta8s3yj21460b5jt0.jpg\" alt=\"\"></p>"},{"title":"CentOS 6 x86 Node.js + MongoDB + Express ç¯å¢ƒé…ç½®ç¬”è®°","date":"2015-01-01T12:18:33.000Z","comments":0,"_content":"\næ€»ä½“æ¥è¯´é…ç½®æ¯”è¾ƒé¡ºåˆ©ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ TATï¼Œæ¯•ç«Ÿä¸æ˜¯ä¸“ä¸šçš„è¿ç»´äººå‘˜ï¼ŒLinux ç»éªŒå®Œå…¨åœ¨å¹³å¸¸é¡¹ç›®ä¸­ä¸€ç‚¹ç‚¹ç§¯ç´¯çš„ã€‚\n<!-- more -->\n\n<div class=\"tip\">\n    é‡è¦æç¤ºï¼šæœ¬æ–‡é€‚ç”¨äºæœ‰ä¸€å®š Linux åŸºç¡€çš„ç«¥é‹æ“ä½œï¼Œæ¯”å¦‚æ‡‚å¾— `ls`ã€`cd`ã€`vim`ç­‰å‘½ä»¤åŸºæœ¬ç”¨æ³•ã€‚\n    é€‚ç”¨äºæ“ä½œç³»ç»Ÿï¼šCentOS-6-x86_64ï¼Œå®‰è£… node v6.9.4ï¼Œmongodb v3.4.2ã€‚\n</div>\n\n### Node.js å®‰è£…\n0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®\n```bash\ncd /usr/local/\n```\n\n1.ä¸‹è½½å®‰è£…æ–‡ä»¶\n```bash\nwget https://nodejs.org/dist/v6.9.4/node-v6.9.4-linux-x86.tar.xz\n```\n\n2.è§£å‹æ–‡ä»¶\n```bash\nxz -d node-v6.9.4-linux-x86.tar.xz\ntar xvf node-v6.9.4-linux-x86.tar\n```\n3.é‡å‘½åæ–‡ä»¶\n```bash\nrm -rf node-v*.tar\nmv node-v* node\n```\n\n\n4.é…ç½®ç¯å¢ƒå˜é‡\n```bash\n#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶\nvim ~/.bash_profile\n\n#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€\nPATH=/usr/local/node/bin:$PATH\n\n#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ\nsource ~/.bash_profile\n```\n\n5.éªŒè¯æ˜¯å¦æˆåŠŸï¼Œæ˜¾ç¤ºç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸï¼\n```bash\nnode -v\n```\n\n### Mongodb å®‰è£…\n\n0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®\n```bash\ncd /usr/local/\n```\n\n1.ä¸‹è½½å®‰è£…æ–‡ä»¶\n```bash\nwget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.2.tgz\n```\n\n2.è§£å‹æ–‡ä»¶\n```bash\ntar zxf mongodb-linux-*.tgz\n```\n\n3.é‡å‘½å\n```bash\nrm -rf mongodb-*.tgz\nmv mongodb-* mongodb\n```\n\n4.é…ç½®ç¯å¢ƒå˜é‡\n```bash\n#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶\nvim ~/.bash_profile\n\n#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€\nPATH=/usr/local/mongodb/bin:$PATH\n\n#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ\nsource ~/.bash_profile\n```\n\n5.éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ\n```bash\nmongod --version\n```\n\n6.åˆ›å»ºæ•°æ®åº“ç›®å½•å’Œæ—¥å¿—ç›®å½•\n```bash\nmkdir -p /data/db\nmkdir -p /data/logs/mongodb.log\n```\n\n7.æ–°å¢é…ç½®æ–‡ä»¶ `/data/mongodb.conf`\n```txet\n#æ•°æ®åº“æ–‡ä»¶\ndbpath = /data/\n\n#æ—¥å¿—æ–‡ä»¶\nlogpath = /data/logs/mongodb.log\n\n#é»˜è®¤ç«¯å£\nport = 27017\n\n#åå°è¿è¡Œ\nfork = true\n\n#ç”¨æˆ·æˆæƒ\nauth = true\n\n#ä¸å¯ç”¨httpè®¿é—®\nnohttpinterface = true\n```\n<div class=\"tip\">\næ·»åŠ æˆæƒåéœ€è¦åœ¨ mongodb æ•°æ®åº“æ–‡ä»¶çš„ Users é›†åˆæ–°å¢ç”¨æˆ·ï¼Œæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚\n</div>\n\n\n8.åœ¨è‡ªå¯åŠ¨æ–‡ä»¶ `/etc/rc.local` ä¸­å†™å…¥ mongod è¿›ç¨‹å¸¦é…ç½®æ–‡ä»¶å¯åŠ¨\n```bash\necho \"/usr/local/mongodb/bin/mongod -f /data/mongodb.conf\" >> /etc/rc.local\n```\n\n9.é‡å¯\n```bash\nreboot\n```\n\n\n### Express\n```bash\nnpm i express -g\n```\n","source":"_posts/CentOS-6-x86-Node-js-MongoDB-Express-ç¯å¢ƒé…ç½®ç¬”è®°.md","raw":"---\ntitle: CentOS 6 x86 Node.js + MongoDB + Express ç¯å¢ƒé…ç½®ç¬”è®°\ndate: 2015-1-1 20:18:33\ntags:\ncomments: false\n---\n\næ€»ä½“æ¥è¯´é…ç½®æ¯”è¾ƒé¡ºåˆ©ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ TATï¼Œæ¯•ç«Ÿä¸æ˜¯ä¸“ä¸šçš„è¿ç»´äººå‘˜ï¼ŒLinux ç»éªŒå®Œå…¨åœ¨å¹³å¸¸é¡¹ç›®ä¸­ä¸€ç‚¹ç‚¹ç§¯ç´¯çš„ã€‚\n<!-- more -->\n\n<div class=\"tip\">\n    é‡è¦æç¤ºï¼šæœ¬æ–‡é€‚ç”¨äºæœ‰ä¸€å®š Linux åŸºç¡€çš„ç«¥é‹æ“ä½œï¼Œæ¯”å¦‚æ‡‚å¾— `ls`ã€`cd`ã€`vim`ç­‰å‘½ä»¤åŸºæœ¬ç”¨æ³•ã€‚\n    é€‚ç”¨äºæ“ä½œç³»ç»Ÿï¼šCentOS-6-x86_64ï¼Œå®‰è£… node v6.9.4ï¼Œmongodb v3.4.2ã€‚\n</div>\n\n### Node.js å®‰è£…\n0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®\n```bash\ncd /usr/local/\n```\n\n1.ä¸‹è½½å®‰è£…æ–‡ä»¶\n```bash\nwget https://nodejs.org/dist/v6.9.4/node-v6.9.4-linux-x86.tar.xz\n```\n\n2.è§£å‹æ–‡ä»¶\n```bash\nxz -d node-v6.9.4-linux-x86.tar.xz\ntar xvf node-v6.9.4-linux-x86.tar\n```\n3.é‡å‘½åæ–‡ä»¶\n```bash\nrm -rf node-v*.tar\nmv node-v* node\n```\n\n\n4.é…ç½®ç¯å¢ƒå˜é‡\n```bash\n#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶\nvim ~/.bash_profile\n\n#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€\nPATH=/usr/local/node/bin:$PATH\n\n#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ\nsource ~/.bash_profile\n```\n\n5.éªŒè¯æ˜¯å¦æˆåŠŸï¼Œæ˜¾ç¤ºç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸï¼\n```bash\nnode -v\n```\n\n### Mongodb å®‰è£…\n\n0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®\n```bash\ncd /usr/local/\n```\n\n1.ä¸‹è½½å®‰è£…æ–‡ä»¶\n```bash\nwget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.2.tgz\n```\n\n2.è§£å‹æ–‡ä»¶\n```bash\ntar zxf mongodb-linux-*.tgz\n```\n\n3.é‡å‘½å\n```bash\nrm -rf mongodb-*.tgz\nmv mongodb-* mongodb\n```\n\n4.é…ç½®ç¯å¢ƒå˜é‡\n```bash\n#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶\nvim ~/.bash_profile\n\n#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€\nPATH=/usr/local/mongodb/bin:$PATH\n\n#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ\nsource ~/.bash_profile\n```\n\n5.éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ\n```bash\nmongod --version\n```\n\n6.åˆ›å»ºæ•°æ®åº“ç›®å½•å’Œæ—¥å¿—ç›®å½•\n```bash\nmkdir -p /data/db\nmkdir -p /data/logs/mongodb.log\n```\n\n7.æ–°å¢é…ç½®æ–‡ä»¶ `/data/mongodb.conf`\n```txet\n#æ•°æ®åº“æ–‡ä»¶\ndbpath = /data/\n\n#æ—¥å¿—æ–‡ä»¶\nlogpath = /data/logs/mongodb.log\n\n#é»˜è®¤ç«¯å£\nport = 27017\n\n#åå°è¿è¡Œ\nfork = true\n\n#ç”¨æˆ·æˆæƒ\nauth = true\n\n#ä¸å¯ç”¨httpè®¿é—®\nnohttpinterface = true\n```\n<div class=\"tip\">\næ·»åŠ æˆæƒåéœ€è¦åœ¨ mongodb æ•°æ®åº“æ–‡ä»¶çš„ Users é›†åˆæ–°å¢ç”¨æˆ·ï¼Œæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚\n</div>\n\n\n8.åœ¨è‡ªå¯åŠ¨æ–‡ä»¶ `/etc/rc.local` ä¸­å†™å…¥ mongod è¿›ç¨‹å¸¦é…ç½®æ–‡ä»¶å¯åŠ¨\n```bash\necho \"/usr/local/mongodb/bin/mongod -f /data/mongodb.conf\" >> /etc/rc.local\n```\n\n9.é‡å¯\n```bash\nreboot\n```\n\n\n### Express\n```bash\nnpm i express -g\n```\n","slug":"CentOS-6-x86-Node-js-MongoDB-Express-ç¯å¢ƒé…ç½®ç¬”è®°","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidi10002u4q9o14v5u0x","content":"<p>æ€»ä½“æ¥è¯´é…ç½®æ¯”è¾ƒé¡ºåˆ©ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ TATï¼Œæ¯•ç«Ÿä¸æ˜¯ä¸“ä¸šçš„è¿ç»´äººå‘˜ï¼ŒLinux ç»éªŒå®Œå…¨åœ¨å¹³å¸¸é¡¹ç›®ä¸­ä¸€ç‚¹ç‚¹ç§¯ç´¯çš„ã€‚<br><a id=\"more\"></a></p>\n<div class=\"tip\"><br>    é‡è¦æç¤ºï¼šæœ¬æ–‡é€‚ç”¨äºæœ‰ä¸€å®š Linux åŸºç¡€çš„ç«¥é‹æ“ä½œï¼Œæ¯”å¦‚æ‡‚å¾— <code>ls</code>ã€<code>cd</code>ã€<code>vim</code>ç­‰å‘½ä»¤åŸºæœ¬ç”¨æ³•ã€‚<br>    é€‚ç”¨äºæ“ä½œç³»ç»Ÿï¼šCentOS-6-x86_64ï¼Œå®‰è£… node v6.9.4ï¼Œmongodb v3.4.2ã€‚<br></div>\n\n<h3 id=\"Node-js-å®‰è£…\"><a href=\"#Node-js-å®‰è£…\" class=\"headerlink\" title=\"Node.js å®‰è£…\"></a>Node.js å®‰è£…</h3><p>0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/</span><br></pre></td></tr></table></figure></p>\n<p>1.ä¸‹è½½å®‰è£…æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://nodejs.org/dist/v6.9.4/node-v6.9.4-linux-x86.tar.xz</span><br></pre></td></tr></table></figure></p>\n<p>2.è§£å‹æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xz -d node-v6.9.4-linux-x86.tar.xz</span><br><span class=\"line\">tar xvf node-v6.9.4-linux-x86.tar</span><br></pre></td></tr></table></figure></p>\n<p>3.é‡å‘½åæ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf node-v*.tar</span><br><span class=\"line\">mv node-v* node</span><br></pre></td></tr></table></figure></p>\n<p>4.é…ç½®ç¯å¢ƒå˜é‡<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶</span></span><br><span class=\"line\">vim ~/.bash_profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€</span></span><br><span class=\"line\">PATH=/usr/<span class=\"built_in\">local</span>/node/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>5.éªŒè¯æ˜¯å¦æˆåŠŸï¼Œæ˜¾ç¤ºç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸï¼<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"Mongodb-å®‰è£…\"><a href=\"#Mongodb-å®‰è£…\" class=\"headerlink\" title=\"Mongodb å®‰è£…\"></a>Mongodb å®‰è£…</h3><p>0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/</span><br></pre></td></tr></table></figure></p>\n<p>1.ä¸‹è½½å®‰è£…æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.2.tgz</span><br></pre></td></tr></table></figure></p>\n<p>2.è§£å‹æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxf mongodb-linux-*.tgz</span><br></pre></td></tr></table></figure></p>\n<p>3.é‡å‘½å<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf mongodb-*.tgz</span><br><span class=\"line\">mv mongodb-* mongodb</span><br></pre></td></tr></table></figure></p>\n<p>4.é…ç½®ç¯å¢ƒå˜é‡<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶</span></span><br><span class=\"line\">vim ~/.bash_profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€</span></span><br><span class=\"line\">PATH=/usr/<span class=\"built_in\">local</span>/mongodb/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>5.éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongod --version</span><br></pre></td></tr></table></figure></p>\n<p>6.åˆ›å»ºæ•°æ®åº“ç›®å½•å’Œæ—¥å¿—ç›®å½•<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/db</span><br><span class=\"line\">mkdir -p /data/logs/mongodb.log</span><br></pre></td></tr></table></figure></p>\n<p>7.æ–°å¢é…ç½®æ–‡ä»¶ <code>/data/mongodb.conf</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#æ•°æ®åº“æ–‡ä»¶</span><br><span class=\"line\">dbpath = /data/</span><br><span class=\"line\"></span><br><span class=\"line\">#æ—¥å¿—æ–‡ä»¶</span><br><span class=\"line\">logpath = /data/logs/mongodb.log</span><br><span class=\"line\"></span><br><span class=\"line\">#é»˜è®¤ç«¯å£</span><br><span class=\"line\">port = 27017</span><br><span class=\"line\"></span><br><span class=\"line\">#åå°è¿è¡Œ</span><br><span class=\"line\">fork = true</span><br><span class=\"line\"></span><br><span class=\"line\">#ç”¨æˆ·æˆæƒ</span><br><span class=\"line\">auth = true</span><br><span class=\"line\"></span><br><span class=\"line\">#ä¸å¯ç”¨httpè®¿é—®</span><br><span class=\"line\">nohttpinterface = true</span><br></pre></td></tr></table></figure></p>\n<div class=\"tip\"><br>æ·»åŠ æˆæƒåéœ€è¦åœ¨ mongodb æ•°æ®åº“æ–‡ä»¶çš„ Users é›†åˆæ–°å¢ç”¨æˆ·ï¼Œæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚<br></div>\n\n\n<p>8.åœ¨è‡ªå¯åŠ¨æ–‡ä»¶ <code>/etc/rc.local</code> ä¸­å†™å…¥ mongod è¿›ç¨‹å¸¦é…ç½®æ–‡ä»¶å¯åŠ¨<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"/usr/local/mongodb/bin/mongod -f /data/mongodb.conf\"</span> &gt;&gt; /etc/rc.local</span><br></pre></td></tr></table></figure></p>\n<p>9.é‡å¯<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reboot</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"Express\"><a href=\"#Express\" class=\"headerlink\" title=\"Express\"></a>Express</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i express -g</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>æ€»ä½“æ¥è¯´é…ç½®æ¯”è¾ƒé¡ºåˆ©ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ TATï¼Œæ¯•ç«Ÿä¸æ˜¯ä¸“ä¸šçš„è¿ç»´äººå‘˜ï¼ŒLinux ç»éªŒå®Œå…¨åœ¨å¹³å¸¸é¡¹ç›®ä¸­ä¸€ç‚¹ç‚¹ç§¯ç´¯çš„ã€‚<br>","more":"</p>\n<div class=\"tip\"><br>    é‡è¦æç¤ºï¼šæœ¬æ–‡é€‚ç”¨äºæœ‰ä¸€å®š Linux åŸºç¡€çš„ç«¥é‹æ“ä½œï¼Œæ¯”å¦‚æ‡‚å¾— <code>ls</code>ã€<code>cd</code>ã€<code>vim</code>ç­‰å‘½ä»¤åŸºæœ¬ç”¨æ³•ã€‚<br>    é€‚ç”¨äºæ“ä½œç³»ç»Ÿï¼šCentOS-6-x86_64ï¼Œå®‰è£… node v6.9.4ï¼Œmongodb v3.4.2ã€‚<br></div>\n\n<h3 id=\"Node-js-å®‰è£…\"><a href=\"#Node-js-å®‰è£…\" class=\"headerlink\" title=\"Node.js å®‰è£…\"></a>Node.js å®‰è£…</h3><p>0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/</span><br></pre></td></tr></table></figure></p>\n<p>1.ä¸‹è½½å®‰è£…æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://nodejs.org/dist/v6.9.4/node-v6.9.4-linux-x86.tar.xz</span><br></pre></td></tr></table></figure></p>\n<p>2.è§£å‹æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xz -d node-v6.9.4-linux-x86.tar.xz</span><br><span class=\"line\">tar xvf node-v6.9.4-linux-x86.tar</span><br></pre></td></tr></table></figure></p>\n<p>3.é‡å‘½åæ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf node-v*.tar</span><br><span class=\"line\">mv node-v* node</span><br></pre></td></tr></table></figure></p>\n<p>4.é…ç½®ç¯å¢ƒå˜é‡<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶</span></span><br><span class=\"line\">vim ~/.bash_profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€</span></span><br><span class=\"line\">PATH=/usr/<span class=\"built_in\">local</span>/node/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>5.éªŒè¯æ˜¯å¦æˆåŠŸï¼Œæ˜¾ç¤ºç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸï¼<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"Mongodb-å®‰è£…\"><a href=\"#Mongodb-å®‰è£…\" class=\"headerlink\" title=\"Mongodb å®‰è£…\"></a>Mongodb å®‰è£…</h3><p>0.è¿›å…¥åˆ°å¾…å®‰è£…ä½ç½®<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/</span><br></pre></td></tr></table></figure></p>\n<p>1.ä¸‹è½½å®‰è£…æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.2.tgz</span><br></pre></td></tr></table></figure></p>\n<p>2.è§£å‹æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxf mongodb-linux-*.tgz</span><br></pre></td></tr></table></figure></p>\n<p>3.é‡å‘½å<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf mongodb-*.tgz</span><br><span class=\"line\">mv mongodb-* mongodb</span><br></pre></td></tr></table></figure></p>\n<p>4.é…ç½®ç¯å¢ƒå˜é‡<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶</span></span><br><span class=\"line\">vim ~/.bash_profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#åœ¨æœ€é¡¶ç«¯æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€</span></span><br><span class=\"line\">PATH=/usr/<span class=\"built_in\">local</span>/mongodb/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä¿å­˜åé‡æ–°å¯åŠ¨ä»¥ç”Ÿæ•ˆ</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>5.éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongod --version</span><br></pre></td></tr></table></figure></p>\n<p>6.åˆ›å»ºæ•°æ®åº“ç›®å½•å’Œæ—¥å¿—ç›®å½•<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/db</span><br><span class=\"line\">mkdir -p /data/logs/mongodb.log</span><br></pre></td></tr></table></figure></p>\n<p>7.æ–°å¢é…ç½®æ–‡ä»¶ <code>/data/mongodb.conf</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#æ•°æ®åº“æ–‡ä»¶</span><br><span class=\"line\">dbpath = /data/</span><br><span class=\"line\"></span><br><span class=\"line\">#æ—¥å¿—æ–‡ä»¶</span><br><span class=\"line\">logpath = /data/logs/mongodb.log</span><br><span class=\"line\"></span><br><span class=\"line\">#é»˜è®¤ç«¯å£</span><br><span class=\"line\">port = 27017</span><br><span class=\"line\"></span><br><span class=\"line\">#åå°è¿è¡Œ</span><br><span class=\"line\">fork = true</span><br><span class=\"line\"></span><br><span class=\"line\">#ç”¨æˆ·æˆæƒ</span><br><span class=\"line\">auth = true</span><br><span class=\"line\"></span><br><span class=\"line\">#ä¸å¯ç”¨httpè®¿é—®</span><br><span class=\"line\">nohttpinterface = true</span><br></pre></td></tr></table></figure></p>\n<div class=\"tip\"><br>æ·»åŠ æˆæƒåéœ€è¦åœ¨ mongodb æ•°æ®åº“æ–‡ä»¶çš„ Users é›†åˆæ–°å¢ç”¨æˆ·ï¼Œæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚<br></div>\n\n\n<p>8.åœ¨è‡ªå¯åŠ¨æ–‡ä»¶ <code>/etc/rc.local</code> ä¸­å†™å…¥ mongod è¿›ç¨‹å¸¦é…ç½®æ–‡ä»¶å¯åŠ¨<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"/usr/local/mongodb/bin/mongod -f /data/mongodb.conf\"</span> &gt;&gt; /etc/rc.local</span><br></pre></td></tr></table></figure></p>\n<p>9.é‡å¯<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reboot</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"Express\"><a href=\"#Express\" class=\"headerlink\" title=\"Express\"></a>Express</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i express -g</span><br></pre></td></tr></table></figure>"},{"title":"ES6 Promise ç®€æ˜æŒ‡å—","comments":1,"date":"2018-05-29T14:28:41.000Z","from":"https://codeburst.io/a-simple-guide-to-es6-promises-d71bacd2e13a","_content":"\nPromise æ˜¯ JavaScriptES6 ä¸­æœ€ä»¤äººå…´å¥‹çš„æ–°å¢åŠŸèƒ½ä¹‹ä¸€. ES5 ä¸­ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œ. è¿‡åº¦ä½¿ç”¨å›è°ƒåˆ™ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±å’Œå¤šçº§åµŒå¥—ç¼©å¸¦æ¥çš„é—®é¢˜. Promise é€šè¿‡å°†å¼‚æ­¥ä»£ç è½¬åŒ–æˆåŒæ­¥æ‰§è¡Œçš„æ–¹å¼, å¤§å¤§ç®€åŒ–äº†å¼‚æ­¥ç¼–ç¨‹æ–¹å¼.\n\n<!-- more -->\n\nè¿™ç¯‡æ–‡ç« ä¸­, æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Promise ä»¥åŠåœ¨å¼€å‘ä¸­çš„å®è·µ.\n\n### ä»€ä¹ˆæ˜¯ Promise\n\nç®€å•æ¥è¯´ Promise å°±æ˜¯ä¸€ä¸ªå­˜æ”¾ç€æœªæ¥æ‰ä¼šæœ‰è®¡ç®—ç»“æœçš„å ä½ç¬¦. ç¨å¾®æƒ³æƒ³, ä½ ä¼šå‘ç°, è¿™å’Œæˆ‘ä»¬å¹³å¸¸åœ¨è°ˆè¯è¿‡ç¨‹ä¸­è¯´çš„æ‰¿è¯ºå¾ˆåƒ. ä¸¾ä¸ªä¾‹å­: ä½ å‡†å¤‡å»å°åº¦æ—…è¡Œ, ä½ è®¢äº†ä¸€å¼ å»å°åº¦çš„æœºç¥¨. è¿™ä¸ªæœºç¥¨ä¸Šå†™ç€å¤šå°‘å·, åº§ä½å·æ˜¯å¤šå°‘. è¿™ä¸ªåœºæ™¯ä¸‹, æœºç¥¨å°±æ˜¯èˆªç©ºå…¬å¸ç»™ä½ è®¸ä¸‹çš„æ‰¿è¯º: åœ¨ä½ å‡†å¤‡å‡ºå‘é‚£å¤©ç»™ä½ é¢„ç•™äº†ä¸€ä¸ªå¤´ç­‰èˆ±ï¼ğŸ˜\n\nè¿˜æœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­, ä½ æ‰¿è¯ºä½ çš„æœ‹å‹, å½“ä½ è¯»å®Œã€Šè®¡ç®—æœºç¼–ç¨‹è‰ºæœ¯ã€‹è¿™æœ¬ä¹¦å, ä½ å°±æŠŠè¿™æœ¬ä¹¦è¿˜å›å». åœ¨è¿™é‡Œ, ä½ æ‰€è¯´çš„è¯å°±å¥½æ¯”æ˜¯ä¸€ä¸ªå ä½ç¬¦, éœ€è¦è¿”å›çš„å€¼å°±æ˜¯è¿™æœ¬ä¹¦.\n\nä½ è¿˜å¯ä»¥æƒ³åˆ°å…¶ä»–ä¸€äº›ç±»ä¼¼æ‰¿è¯ºçš„ä¾‹å­, æ¯”å¦‚åœ¨åŒ»ç”ŸåŠå…¬å®¤ç­‰ç€ã€åœ¨é¤é¦†ç‚¹é¤ã€åœ¨å›¾ä¹¦é¦†å†™ä¹¦ç­‰ç­‰. éƒ½æ¶‰åŠæŸç§å½¢å¼çš„æ‰¿è¯º.\n\n### ç”Ÿæˆä¸€ä¸ª Promise\n\nå½“æŸé¡¹ä»»åŠ¡çš„å®Œæˆæ—¶é—´ä¸ç¡®å®šæˆ–å¤ªé•¿æ—¶, å°±å¯ä»¥ä½¿ç”¨ Promise. ä¾‹å¦‚, ç½‘ç»œè¯·æ±‚å¯èƒ½éœ€è¦ 10ms åˆ° 200msï¼ˆæˆ–æ›´é•¿ï¼‰çš„æ—¶é—´, å…·ä½“å–å†³äºç½‘é€Ÿ. æˆ‘ä»¬ä¸æƒ³åœ¨è·å–æ•°æ®æ—¶ç­‰å¾…. 200 æ¯«ç§’å¯¹ä½ æ¥è¯´å¯èƒ½ä¸å¤ªé‡è¦, ä½†å¯¹äºä¸€å°ç”µè„‘æ¥è¯´, è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ—¶é—´. Promise å°±æ˜¯è¦è®©è¿™ç§å¼‚æ­¥å˜å¾—ç®€å•ã€è½»æ¾. ä½¿ç”¨ Promise æ„é€ å‡½æ•°, æ¥å®ä¾‹åŒ–ä¸€ä¸ª myPromise å®ä¾‹, åƒè¿™æ ·:\n\n```js\nconst myPromise = new Promise((resolve, reject) => {\n  if (Math.random() * 100 <= 90) {\n    resolve('Hello, Promises!');\n  }\n  reject(new Error('In 10% of the cases, I fail. Miserably.'));\n});\n```\n\næ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°. `new Promise()` è¢«ç§°ä¸ºæ‰§è¡Œå™¨å‡½æ•°, å®ƒæè¿°äº†è¦å®Œæˆçš„è®¡ç®—. å®ƒçš„è¿™ä¸¤ä¸ªå‚æ•°é€šå¸¸è¢«å«åš `resolve` å’Œ `reject`, å¯ä»¥ç†è§£ä¸º **æ‰§è¡Œ** å’Œ **æ‹’ç»**, å®ƒä»¬ç”¨æ¥æ ‡è®°æ‰§è¡Œå™¨å‡½æ•°æœ€ç»ˆçš„è®¡ç®—ç»“æœ. `resolve` å’Œ `reject` æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒç”¨æ¥è¿”å›ä¸€ä¸ªå€¼ç»™æˆ‘ä»¬çš„ Promise å®ä¾‹.\n\nå½“è¿ç®—ç»“æœæˆåŠŸæ—¶, æˆ–è€…æœªæ¥ç€è¿™ä¸ªå€¼å‡†å¤‡å°±ç»ªæ—¶, æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ª `resolve` å‡½æ•°æ¥è¿”å›ä¸€ä¸ªå€¼, æˆ‘ä»¬å°±è¯´: æˆ‘è·µè¡Œäº†å½“åˆè®¸ä¸‹çš„è¿™ä¸ªæ‰¿è¯º.\n\nåŒç†, å½“è®¡ç®—ç»“æœå¤±è´¥æ—¶, æˆ–è€…è®¡ç®—è¿‡ç¨‹ä¸­é‡åˆ°äº†é”™è¯¯, æˆ‘ä»¬å°±ä½¿ç”¨ `reject` å‡½æ•°, æˆ‘ä»¬å°±è¯´: æˆ‘æ‹’ç»å±¥è¡Œè¿™ä¸ªæ‰¿è¯º. `reject` å‡½æ•°å¯ä»¥æ¥æ”¶ä»»ä½•å€¼æ¥ä½œä¸ºå‚æ•°, ä½†æ˜¯æ¯”è¾ƒæ¨èçš„æ˜¯æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª `Error` å¯¹è±¡, å³: æŠ›å‡ºä¸€ä¸ªé”™è¯¯, ç”¨æ¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ä»£ç , è¿™æ ·å°±å¯ä»¥æ ¹æ®å…·ä½“çš„æŠ›å‡ºé”™è¯¯ä¿¡æ¯å»è§£å†³é—®é¢˜å•¦.\n\nåœ¨ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ä¸­, `Math.random()` ç”¨æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°, åœ¨ 90% çš„æƒ…å†µä¸‹, è¿™ä¸ª Promise éƒ½åº”è¯¥è¢«æ‰§è¡Œ (å‡è®¾ç­‰æ¦‚ç‡åˆ†å¸ƒ), å‰©ä½™çš„æƒ…å†µä¸‹éƒ½æ˜¯æ‹’ç»æ‰§è¡Œçš„.\n\n### å¦‚ä½•ä½¿ç”¨ Promises\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¾‹å­ä¸­, æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª Promise å®ä¾‹ `myPromise`, é‚£ä¹ˆå¦‚ä½•é€šè¿‡ `resolve` å’Œ `reject` å‡½æ•°è®¿é—®è®¡ç®—å®Œæˆåçš„å€¼å‘¢? æ‰€æœ‰çš„ `Promise` å®ä¾‹éƒ½æœ‰ä¸€ä¸ª `.then()` æ–¹æ³•, æˆ‘ä»¬æ¥ç§ç§:\n\n```js\nconst myPromise = new Promise((resolve, reject) => {\n  if (Math.random() * 100 < 90) {\n    console.log('resolving the promise ...');\n    resolve('Hello, Promises!');\n  }\n  reject(new Error('In 10% of the cases, I fail. Miserably.'));\n});\n\n// Two functions\nconst onResolved = resolvedValue => console.log(resolvedValue);\nconst onRejected = error => console.log(error);\n\nmyPromise.then(onResolved, onRejected);\n\n// Same as above, written concisely\nmyPromise.then(\n  resolvedValue => {\n    console.log(resolvedValue);\n  },\n  error => {\n    console.log(error);\n  }\n);\n\n// Output (in 90% of the cases)\n\n// resolving the promise ...\n// Hello, Promises!\n// Hello, Promises!\n```\n\n`.then()` æ–¹æ³•æ¥æ”¶ 2 ä¸ªå›è°ƒå‡½æ•°, ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯å½“æˆ‘ä»¬çš„ Promise å®ä¾‹è¢«æ‰§è¡Œ (resolve) æ—¶è°ƒç”¨, ç¬¬äºŒä¸ªåˆ™æ˜¯è¢«æ‹’ç» (reject) æ—¶è°ƒç”¨. åœ¨ä¸Šé¢çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨ `onResolved` å’Œ `onRejected` å®šä¹‰äº†è¿™ä¸¤ä¸ªå‡½æ•°, ç„¶åæŠŠå®ƒæ”¾åˆ° `.then` å‡½æ•°é‡Œ, å½“ç„¶, ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å¸¸è§„å†™æ³•, ç›´æ¥åœ¨ `.then` å‡½æ•°é‡Œå†™ä¸¤ä¸ªå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„.\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­, æœ‰å‡ ç‚¹éå¸¸é‡è¦, æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹:\n\n* ä¸€ä¸ª `promise` åªèƒ½æ˜¯æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€ä¸­çš„ä¸€ä¸ª. å®ƒä¸èƒ½æˆåŠŸæˆ–è€…å¤±è´¥å¤šæ¬¡. ä¹Ÿä¸èƒ½ä»æˆåŠŸçŠ¶æ€åˆ‡æ¢åˆ°å¤±è´¥çŠ¶æ€, å¤±è´¥åä¹‹äº¦ç„¶.\n* ä½ å¯ä»¥åœ¨æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€å, å»å®šä¹‰è¿™æ ·ä¸€ä¸ªå›è°ƒå‡½æ•°. å½“ä»–ä»¬ `resolve` æˆ–è€… `reject` ä»ç„¶èƒ½æ­£ç¡®è°ƒç”¨.\n\nè¿™å°±è¯´æ˜, `Promise` æœ€ç»ˆåªæœ‰ä¸€ä¸ªçŠ¶æ€, å³ä½¿ä½ å¤šæ¬¡ä½¿ç”¨ `.then` å¤„ç†å‡½æ•°, è¿™ä¸ªçŠ¶æ€ä¸èƒ½æ›´æ”¹ (è®¡ç®—ç»“æœä¹Ÿä¸ä¼šé‡å¤æ‰§è¡Œ).\n\nä¸ºäº†éªŒè¯è¿™ç‚¹, ä½ å¯ä»¥çœ‹åˆ°åœ¨ç¬¬ 3 è¡Œä»£ç ä¸­, `console.log` è¯­å¥, å½“ä½ å¤šæ¬¡ä½¿ç”¨ `.then` å¤„ç†ç¨‹åºè¿è¡Œä¸Šè¿°ä»£ç æ—¶, `console.log` çš„è¯­å¥åªä¼šè¢«æ‰“å°ä¸€æ¬¡. è¿™å°±è¯´æ˜äº† Promise ä¼šç¼“å­˜è®¡ç®—ç»“æœçš„, å½“æœ‰ä¸€äº›ç›¸åŒçš„ç»“æœæ—¶, ç¼“å­˜ç»“æœä¼šè¢«è¿”å›.\n\nå¦ä¸€ä¸ªé‡è¦çš„è¦æ³¨æ„çš„æ˜¯, Promise æ˜¯ [åŠæ—©æ±‚å€¼ (evaluated eagerly)](https://zh.wikipedia.org/wiki/%E5%8F%8A%E6%97%A9%E6%B1%82%E5%80%BC) çš„: åªè¦å£°æ˜å¹¶å°†å…¶èµ‹å€¼åˆ°å˜é‡ä¸Š, å®ƒå·²ç»å¼€å§‹åœ¨å†…å­˜ä¸­æ‰§è¡Œäº†. æ²¡æœ‰ `.start` æˆ– `.begin` æ–¹æ³•. å°±åƒå®ƒåœ¨å‰é¢çš„ä¾‹å­ä¸­å¼€å§‹çš„é‚£æ ·.\n\nä¸ºäº†ç¡®ä¿ Promise èƒ½è¢«å»¶è¿Ÿè°ƒç”¨, æˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦åœ¨å®ƒçš„å¤–å±‚åŒ…è£¹ä¸€ä¸ªå‡½æ•°, ç¨åçš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šè§£é‡Šè¿™ä¸ª.\n\n### æ•è· Promise\n\nåˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† `resolve` çš„åœºæ™¯, é‚£ä¹ˆå½“æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯æ—¶, ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢? åœ¨ `.then()` å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°, å°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ `onRejected` ä¼šè¢«æ‰§è¡Œ, æ¥çœ‹ä¸€ä¸ªä¾‹å­:\n\n```js\nconst myPromise = new Promise((resolve, reject) => {\n  if (Math.random() * 100 < 90) {\n    reject(new Error('The promise was rejected by using reject function.'));\n  }\n  throw new Error('The promise was rejected by throwing an error');\n});\n\nmyPromise.then(\n  () => console.log('resolved'),\n  error => console.log(error.message)\n);\n\n// Output (in 90% of cases)\n\n// The promise was rejected by using reject function.\n```\n\nå’Œç¬¬ä¸€ä¸ªä¾‹å­ä¸€æ ·çš„, ä½†æ˜¯ç°åœ¨ 90% çš„æƒ…å†µæ˜¯è¢« `reject` çš„, å¦å¤– 10% çš„æƒ…å†µåˆ™æ˜¯æŠ›å‡ºä¸€ä¸ªé”™è¯¯è¯­å¥.\n\nåœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† `onResolved` å’Œ `onRejected` æ–¹æ³•, `onRejected` æ–¹æ³•å°†åœ¨é”™è¯¯å‘ç”Ÿæ—¶è¢«è°ƒç”¨, å¯ä»¥çœ‹åˆ° `reject` å‡½æ•°çš„å‚æ•°å¯ä»¥ç›´æ¥æ˜¯é”™è¯¯æç¤º, æ²¡å¿…è¦å¿…é¡» `new Error`, ä¸¤ä¸ªå†™æ³•éƒ½ä¸€æ ·.\n\nå¥å£®çš„ç¨‹åºä»£ç ç¦»ä¸å¼€é”™è¯¯å¤„ç†, `.then` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ç»™äº†æˆ‘ä»¬è¿™æ ·ä¸€ä¸ªæ·å¾„. å½“éœ€è¦å¤„ç†ä¸€ä¸ªé”™è¯¯æ—¶, å¯ä»¥ç”¨ `.catch(onRejected)` æ¥ä»£æ›¿ `.then(null, () => {...})`, `catch` æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•° `onRejected`, å› æ­¤, ä¸Šé¢çš„ä»£ç , å¯ä»¥ä½¿ç”¨ `catch` æ¥ç®€åŒ–å†™æ³•:\n\n```js\nmyPromise.catch(error => console.log(error.message));\n```\n\nè®°ä½: `.catch` æ–¹æ³•ä»…ä»…æ˜¯ `.then(undefined, onRejected)` çš„è¯­æ³•ç³–è€Œå·².\n\n### é“¾å¼ Promise\n\n`.then()` å’Œ `.catch()` æ–¹æ³•æ°¸è¿œä¼šè¿”å›ä¸€ä¸ª Promise å®ä¾‹, æ‰€ä»¥ä½ å¯ä»¥é“¾å¼ä½¿ç”¨å¤šä¸ª `.then` ä¸€èµ·æ¥è°ƒç”¨. è®©æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£å®ƒ.\n\né¦–å…ˆ, æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°, æ¥å»¶è¿Ÿè¿”å›ä¸€ä¸ª Promise å®ä¾‹. è¿™ä¸ªè¿”å›çš„ Promise å°†åœ¨ç¨åçš„æ—¶é—´å†… `resolve`. è¿™é‡Œæ˜¯å®ç°æ–¹æ³•:\n\n```js\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n```\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥åŒ…è£¹æˆ‘ä»¬çš„ Promise å®ä¾‹, æ‰€ä»¥å®ƒå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ. è¿™ä¸ª `delay` å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ—¶é—´æ¥ä½œä¸ºå‚æ•°. è¿™ä¸ªæ‰§è¡Œå‡½æ•°å°†æ¥æ”¶ `ms` ä½œä¸ºä»–çš„å‚æ•°, å®ƒè¿˜åŒ…å«ä¸€ä¸ª `setTimeout` , å®ƒåœ¨ `ms` æ¯«ç§’åè°ƒç”¨ `resolve` å‡½æ•°, ä»è€Œæ­£ç¡®æ‰§è¡Œ. çœ‹è¿™ä¸ªä¾‹å­:\n\n```js\ndelay(5000).then(() => console.log('Resolved after 5 seconds'));\n```\n\n`.then` ä¸­çš„å›è°ƒè¯­å¥å°†åœ¨ `delay(5000)` åæ‰§è¡Œ. å½“ä½ æ‰§è¡Œä¸Šé¢çš„ä»£ç  5 ç§’å, ä½ å°±å¯ä»¥åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°è¾“å‡ºç»“æœäº†.\n\nè¿™é‡Œ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ª `.then()` æ–¹æ³•æ¥é“¾å¼è°ƒç”¨:\n\n```js\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n\ndelay(2000)\n  .then(() => {\n    console.log('Resolved after 2 seconds');\n    return delay(1500);\n  })\n  .then(() => {\n    console.log('Resolved after 1.5 seconds');\n    return delay(3000);\n  })\n  .then(() => {\n    console.log('Resolved after 3 seconds');\n    throw new Error();\n  })\n  .catch(() => {\n    console.log('Caught an error.');\n  })\n  .then(() => {\n    console.log('Done.');\n  });\n\n// Resolved after 2 seconds\n// Resolved after 1.5 seconds\n// Resolved after 3 seconds\n// Caught an error.\n// Done.\n```\n\nä»ç¬¬ 3 è¡Œå¼€å§‹, å®ƒçš„æ‰§è¡Œæ­¥éª¤æ˜¯è¿™æ ·çš„:\n\n* `delay(2000)` å‡½æ•°æ‰§è¡Œ, å®ƒè¿”å›ä¸€ä¸ªç¨å 2 ç§’å³å°†æ‰§è¡Œçš„ Promise å®ä¾‹.\n* ç¬¬ 1 ä¸ª `.then()` æ‰§è¡Œ, å®ƒè¾“å‡ºè¯­å¥ `Resolved after 2 seconds`, ç„¶åå®ƒæ‰§è¡Œ `delay(1500)` åˆè¿”å›ä¸€ä¸ª Promise å®ä¾‹, å¦‚æœä¸€ä¸ª `.then()` è¿”å›äº†ä¸€ä¸ª Promise å®ä¾‹, é‚£ä¹ˆå®ƒçš„ `resolve` å°†è¢«è½¬å‘ç»™ä¸‹ä¸€ä¸ª `.then` æ–¹æ³•è°ƒç”¨, æŠ€æœ¯ä¸Šå«: æ²‰é™ (settlement).\n* åªè¦åƒè¿™æ ·ç»§ç»­ä¸²è”ä¸‹å», å®ƒä¼šç»§ç»­æ‰§è¡Œ.\n\næ³¨æ„åœ¨ç¬¬ä¸‰ä¸ª `.then()` æ–¹æ³•æ—¶, æˆ‘ä»¬åœ¨ `.then` ä¸­æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯. è¿™æ„å‘³ç€å½“å‰çš„ Promise è¢«æ‹’ç». ç„¶åå®ƒä¼šåœ¨ä¸‹ä¸€ä¸ª `.catch` è¯­å¥ä¸­è¢«æ•è·, `Caught an error` å°†ä¼šè¢«è¾“å‡º. ç„¶è€Œä¸€ä¸ª `.catch` è¯­å¥å®ƒè‡ªå·±æ°¸è¿œæ˜¯è¢« `resolve` çš„, æ‰€ä»¥ä¸éœ€è¦åœ¨è¯­å¥é‡Œå†å†™ `reject` (é™¤éä½ æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯), è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ `.catch` è¯­å¥åè¿˜å¯ä»¥ç»§ç»­å†™ `.then` çš„åŸå› .\n\næ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯åœ¨ `.then` æ–¹æ³•åæ‰§è¡Œ `.catch` è€Œä¸æ˜¯ä½¿ç”¨ `onResolved` å’Œ `onRejected`, æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:\n\n```js\nconst promiseThatResolves = () =>\n  new Promise((resolve, reject) => {\n    resolve();\n  });\n\n// Leads to UnhandledPromiseRejection\npromiseThatResolves().then(\n  () => {\n    throw new Error();\n  },\n  err => console.log(err)\n);\n\n// Proper error handling\npromiseThatResolves()\n  .then(() => {\n    throw new Error();\n  })\n  .catch(err => console.log(err));\n```\n\næˆ‘ä»¬åˆ›é€ ä¸€ä¸ªæ°¸è¿œèƒ½è¢« `resolve` çš„ Promise å®ä¾‹, å½“ä½ æ‰§è¡Œ `.then` æ—¶, å¯ä»¥å¸¦ä¸¤ä¸ªå›è°ƒå‡½æ•°: `onResolved` å’Œ `onRejected`, ç¬¬ä¸€ç§å†™æ³•, åœ¨ `then` ç§æ”¾å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°, ä½†æ˜¯: å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ç»§ç»­æŠ›å‡ºé”™è¯¯, é‚£ä¹ˆè¿™ä¸ªé”™è¯¯æ˜¯ä¸èƒ½è¢«æ•è·çš„. ğŸ˜…\n\nç¬¬äºŒç§å†™æ³•, åœ¨ `.then` è¯­å¥çš„åé¢ä½¿ç”¨ `.catch` æ•è·, ä¸å…‰èƒ½æ•è·åˆ°æ‰§è¡Œå‡½æ•° `promiseThatResolves` çš„é”™è¯¯, è€Œä¸”åœ¨ `.then()` ä¸­çš„é”™è¯¯ä¹Ÿæ˜¯èƒ½è¢«æ•è·åˆ°. çŸ¥é“è¿™æ ·å†™çš„å¥½å¤„äº†å§!ğŸ˜\n\n### æ€»ç»“\n\nä½ å¯ä»¥æ‰§è¡Œä¸Šé¢çš„æ‰€æœ‰ä»£ç ç‰‡æ®µæ¥æ›´æ·±å…¥çš„å­¦ä¹ . ä¸€ç§æ¯”è¾ƒå¥½çš„å®è·µå°±æ˜¯, æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å‡½æ•°éƒ½ç”¨ Promise æ¥é‡æ–°å®ç°. å¦‚æœä½ å†™ Node.js çš„è¯, ä½ ä¼šå‘ç° `fs` è¿˜æœ‰å…¶ä»–æ¨¡å—éƒ½æ˜¯åŸºäºå›è°ƒå‡½æ•°æ¥å®ç°çš„. æ‰€ä»¥ä¼šå­˜åœ¨ä¸€äº›å·¥å…·åº“, å®ƒä»¬æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å®ç°æ–¹å¼ä½¿ç”¨ Promise æ¥å®ç°äº†. æ¯”å¦‚ Node.js çš„ [util.promisify](https://nodejs.org/api/util.html#util_util_promisify_original) å’Œ [pify](https://github.com/sindresorhus/pify). å¦‚æœä½ åœ¨å­¦ä¹ çš„è¯, é‚£ä¹ˆå°½å¯èƒ½çš„å°è¯•è‡ªå·±å»å®ç°. æˆ–è€…è¯´å»è¯»è¿™äº› Promise å®ç°åº“çš„æºä»£ç . ç„¶åä½ å°±å¯ä»¥æŠŠè¿™äº›æœ€ä½³å®è·µç”¨äºä½ çš„äº§å“ä¸­å•¦!\n\nè¿˜æœ‰ä¸€äº›å…³äº Promise çš„ä¸œè¥¿æ²¡æœ‰å®Œå…¨è®²åˆ°, æ¯”å¦‚ `Promise.all` å’Œ `Promise.race` æ–¹æ³•, å¤„ç† Promise ä¸­çš„é”™è¯¯, ä»¥åŠä¸€äº›å¸¸è§çš„åæ¨¡å¼å’Œç»†èŠ‚ç­‰. ä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥æ¥å­¦ä¹ æ›´å¤šå…³äº Promise çš„çŸ¥è¯†.\n\n### å‚è€ƒ\n\n* [ECMA Promise Specification](http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects)\n* [Mozilla Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)\n* [Googleâ€™s Developerâ€™s Guide on Promises written by Jake Archibald](https://developers.google.com/web/fundamentals/primers/promises#promise-api-reference)\n* [Exploring JSâ€™s Chapter on Promises](http://exploringjs.com/es6/ch_promises.html#sec_first-example-promises)\n* [Introduction to Promises](http://jamesknelson.com/grokking-es6-promises-the-four-functions-you-need-to-avoid-callback-hell/)\n","source":"_posts/ES6-Promise-ç®€æ˜æŒ‡å—.md","raw":"---\ntitle: ES6 Promise ç®€æ˜æŒ‡å—\ncomments: true\ndate: 2018-05-29 22:28:41\ntags:\nfrom: https://codeburst.io/a-simple-guide-to-es6-promises-d71bacd2e13a\n---\n\nPromise æ˜¯ JavaScriptES6 ä¸­æœ€ä»¤äººå…´å¥‹çš„æ–°å¢åŠŸèƒ½ä¹‹ä¸€. ES5 ä¸­ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œ. è¿‡åº¦ä½¿ç”¨å›è°ƒåˆ™ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±å’Œå¤šçº§åµŒå¥—ç¼©å¸¦æ¥çš„é—®é¢˜. Promise é€šè¿‡å°†å¼‚æ­¥ä»£ç è½¬åŒ–æˆåŒæ­¥æ‰§è¡Œçš„æ–¹å¼, å¤§å¤§ç®€åŒ–äº†å¼‚æ­¥ç¼–ç¨‹æ–¹å¼.\n\n<!-- more -->\n\nè¿™ç¯‡æ–‡ç« ä¸­, æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Promise ä»¥åŠåœ¨å¼€å‘ä¸­çš„å®è·µ.\n\n### ä»€ä¹ˆæ˜¯ Promise\n\nç®€å•æ¥è¯´ Promise å°±æ˜¯ä¸€ä¸ªå­˜æ”¾ç€æœªæ¥æ‰ä¼šæœ‰è®¡ç®—ç»“æœçš„å ä½ç¬¦. ç¨å¾®æƒ³æƒ³, ä½ ä¼šå‘ç°, è¿™å’Œæˆ‘ä»¬å¹³å¸¸åœ¨è°ˆè¯è¿‡ç¨‹ä¸­è¯´çš„æ‰¿è¯ºå¾ˆåƒ. ä¸¾ä¸ªä¾‹å­: ä½ å‡†å¤‡å»å°åº¦æ—…è¡Œ, ä½ è®¢äº†ä¸€å¼ å»å°åº¦çš„æœºç¥¨. è¿™ä¸ªæœºç¥¨ä¸Šå†™ç€å¤šå°‘å·, åº§ä½å·æ˜¯å¤šå°‘. è¿™ä¸ªåœºæ™¯ä¸‹, æœºç¥¨å°±æ˜¯èˆªç©ºå…¬å¸ç»™ä½ è®¸ä¸‹çš„æ‰¿è¯º: åœ¨ä½ å‡†å¤‡å‡ºå‘é‚£å¤©ç»™ä½ é¢„ç•™äº†ä¸€ä¸ªå¤´ç­‰èˆ±ï¼ğŸ˜\n\nè¿˜æœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­, ä½ æ‰¿è¯ºä½ çš„æœ‹å‹, å½“ä½ è¯»å®Œã€Šè®¡ç®—æœºç¼–ç¨‹è‰ºæœ¯ã€‹è¿™æœ¬ä¹¦å, ä½ å°±æŠŠè¿™æœ¬ä¹¦è¿˜å›å». åœ¨è¿™é‡Œ, ä½ æ‰€è¯´çš„è¯å°±å¥½æ¯”æ˜¯ä¸€ä¸ªå ä½ç¬¦, éœ€è¦è¿”å›çš„å€¼å°±æ˜¯è¿™æœ¬ä¹¦.\n\nä½ è¿˜å¯ä»¥æƒ³åˆ°å…¶ä»–ä¸€äº›ç±»ä¼¼æ‰¿è¯ºçš„ä¾‹å­, æ¯”å¦‚åœ¨åŒ»ç”ŸåŠå…¬å®¤ç­‰ç€ã€åœ¨é¤é¦†ç‚¹é¤ã€åœ¨å›¾ä¹¦é¦†å†™ä¹¦ç­‰ç­‰. éƒ½æ¶‰åŠæŸç§å½¢å¼çš„æ‰¿è¯º.\n\n### ç”Ÿæˆä¸€ä¸ª Promise\n\nå½“æŸé¡¹ä»»åŠ¡çš„å®Œæˆæ—¶é—´ä¸ç¡®å®šæˆ–å¤ªé•¿æ—¶, å°±å¯ä»¥ä½¿ç”¨ Promise. ä¾‹å¦‚, ç½‘ç»œè¯·æ±‚å¯èƒ½éœ€è¦ 10ms åˆ° 200msï¼ˆæˆ–æ›´é•¿ï¼‰çš„æ—¶é—´, å…·ä½“å–å†³äºç½‘é€Ÿ. æˆ‘ä»¬ä¸æƒ³åœ¨è·å–æ•°æ®æ—¶ç­‰å¾…. 200 æ¯«ç§’å¯¹ä½ æ¥è¯´å¯èƒ½ä¸å¤ªé‡è¦, ä½†å¯¹äºä¸€å°ç”µè„‘æ¥è¯´, è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ—¶é—´. Promise å°±æ˜¯è¦è®©è¿™ç§å¼‚æ­¥å˜å¾—ç®€å•ã€è½»æ¾. ä½¿ç”¨ Promise æ„é€ å‡½æ•°, æ¥å®ä¾‹åŒ–ä¸€ä¸ª myPromise å®ä¾‹, åƒè¿™æ ·:\n\n```js\nconst myPromise = new Promise((resolve, reject) => {\n  if (Math.random() * 100 <= 90) {\n    resolve('Hello, Promises!');\n  }\n  reject(new Error('In 10% of the cases, I fail. Miserably.'));\n});\n```\n\næ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°. `new Promise()` è¢«ç§°ä¸ºæ‰§è¡Œå™¨å‡½æ•°, å®ƒæè¿°äº†è¦å®Œæˆçš„è®¡ç®—. å®ƒçš„è¿™ä¸¤ä¸ªå‚æ•°é€šå¸¸è¢«å«åš `resolve` å’Œ `reject`, å¯ä»¥ç†è§£ä¸º **æ‰§è¡Œ** å’Œ **æ‹’ç»**, å®ƒä»¬ç”¨æ¥æ ‡è®°æ‰§è¡Œå™¨å‡½æ•°æœ€ç»ˆçš„è®¡ç®—ç»“æœ. `resolve` å’Œ `reject` æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒç”¨æ¥è¿”å›ä¸€ä¸ªå€¼ç»™æˆ‘ä»¬çš„ Promise å®ä¾‹.\n\nå½“è¿ç®—ç»“æœæˆåŠŸæ—¶, æˆ–è€…æœªæ¥ç€è¿™ä¸ªå€¼å‡†å¤‡å°±ç»ªæ—¶, æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ª `resolve` å‡½æ•°æ¥è¿”å›ä¸€ä¸ªå€¼, æˆ‘ä»¬å°±è¯´: æˆ‘è·µè¡Œäº†å½“åˆè®¸ä¸‹çš„è¿™ä¸ªæ‰¿è¯º.\n\nåŒç†, å½“è®¡ç®—ç»“æœå¤±è´¥æ—¶, æˆ–è€…è®¡ç®—è¿‡ç¨‹ä¸­é‡åˆ°äº†é”™è¯¯, æˆ‘ä»¬å°±ä½¿ç”¨ `reject` å‡½æ•°, æˆ‘ä»¬å°±è¯´: æˆ‘æ‹’ç»å±¥è¡Œè¿™ä¸ªæ‰¿è¯º. `reject` å‡½æ•°å¯ä»¥æ¥æ”¶ä»»ä½•å€¼æ¥ä½œä¸ºå‚æ•°, ä½†æ˜¯æ¯”è¾ƒæ¨èçš„æ˜¯æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª `Error` å¯¹è±¡, å³: æŠ›å‡ºä¸€ä¸ªé”™è¯¯, ç”¨æ¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ä»£ç , è¿™æ ·å°±å¯ä»¥æ ¹æ®å…·ä½“çš„æŠ›å‡ºé”™è¯¯ä¿¡æ¯å»è§£å†³é—®é¢˜å•¦.\n\nåœ¨ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ä¸­, `Math.random()` ç”¨æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°, åœ¨ 90% çš„æƒ…å†µä¸‹, è¿™ä¸ª Promise éƒ½åº”è¯¥è¢«æ‰§è¡Œ (å‡è®¾ç­‰æ¦‚ç‡åˆ†å¸ƒ), å‰©ä½™çš„æƒ…å†µä¸‹éƒ½æ˜¯æ‹’ç»æ‰§è¡Œçš„.\n\n### å¦‚ä½•ä½¿ç”¨ Promises\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¾‹å­ä¸­, æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª Promise å®ä¾‹ `myPromise`, é‚£ä¹ˆå¦‚ä½•é€šè¿‡ `resolve` å’Œ `reject` å‡½æ•°è®¿é—®è®¡ç®—å®Œæˆåçš„å€¼å‘¢? æ‰€æœ‰çš„ `Promise` å®ä¾‹éƒ½æœ‰ä¸€ä¸ª `.then()` æ–¹æ³•, æˆ‘ä»¬æ¥ç§ç§:\n\n```js\nconst myPromise = new Promise((resolve, reject) => {\n  if (Math.random() * 100 < 90) {\n    console.log('resolving the promise ...');\n    resolve('Hello, Promises!');\n  }\n  reject(new Error('In 10% of the cases, I fail. Miserably.'));\n});\n\n// Two functions\nconst onResolved = resolvedValue => console.log(resolvedValue);\nconst onRejected = error => console.log(error);\n\nmyPromise.then(onResolved, onRejected);\n\n// Same as above, written concisely\nmyPromise.then(\n  resolvedValue => {\n    console.log(resolvedValue);\n  },\n  error => {\n    console.log(error);\n  }\n);\n\n// Output (in 90% of the cases)\n\n// resolving the promise ...\n// Hello, Promises!\n// Hello, Promises!\n```\n\n`.then()` æ–¹æ³•æ¥æ”¶ 2 ä¸ªå›è°ƒå‡½æ•°, ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯å½“æˆ‘ä»¬çš„ Promise å®ä¾‹è¢«æ‰§è¡Œ (resolve) æ—¶è°ƒç”¨, ç¬¬äºŒä¸ªåˆ™æ˜¯è¢«æ‹’ç» (reject) æ—¶è°ƒç”¨. åœ¨ä¸Šé¢çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨ `onResolved` å’Œ `onRejected` å®šä¹‰äº†è¿™ä¸¤ä¸ªå‡½æ•°, ç„¶åæŠŠå®ƒæ”¾åˆ° `.then` å‡½æ•°é‡Œ, å½“ç„¶, ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å¸¸è§„å†™æ³•, ç›´æ¥åœ¨ `.then` å‡½æ•°é‡Œå†™ä¸¤ä¸ªå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„.\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­, æœ‰å‡ ç‚¹éå¸¸é‡è¦, æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹:\n\n* ä¸€ä¸ª `promise` åªèƒ½æ˜¯æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€ä¸­çš„ä¸€ä¸ª. å®ƒä¸èƒ½æˆåŠŸæˆ–è€…å¤±è´¥å¤šæ¬¡. ä¹Ÿä¸èƒ½ä»æˆåŠŸçŠ¶æ€åˆ‡æ¢åˆ°å¤±è´¥çŠ¶æ€, å¤±è´¥åä¹‹äº¦ç„¶.\n* ä½ å¯ä»¥åœ¨æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€å, å»å®šä¹‰è¿™æ ·ä¸€ä¸ªå›è°ƒå‡½æ•°. å½“ä»–ä»¬ `resolve` æˆ–è€… `reject` ä»ç„¶èƒ½æ­£ç¡®è°ƒç”¨.\n\nè¿™å°±è¯´æ˜, `Promise` æœ€ç»ˆåªæœ‰ä¸€ä¸ªçŠ¶æ€, å³ä½¿ä½ å¤šæ¬¡ä½¿ç”¨ `.then` å¤„ç†å‡½æ•°, è¿™ä¸ªçŠ¶æ€ä¸èƒ½æ›´æ”¹ (è®¡ç®—ç»“æœä¹Ÿä¸ä¼šé‡å¤æ‰§è¡Œ).\n\nä¸ºäº†éªŒè¯è¿™ç‚¹, ä½ å¯ä»¥çœ‹åˆ°åœ¨ç¬¬ 3 è¡Œä»£ç ä¸­, `console.log` è¯­å¥, å½“ä½ å¤šæ¬¡ä½¿ç”¨ `.then` å¤„ç†ç¨‹åºè¿è¡Œä¸Šè¿°ä»£ç æ—¶, `console.log` çš„è¯­å¥åªä¼šè¢«æ‰“å°ä¸€æ¬¡. è¿™å°±è¯´æ˜äº† Promise ä¼šç¼“å­˜è®¡ç®—ç»“æœçš„, å½“æœ‰ä¸€äº›ç›¸åŒçš„ç»“æœæ—¶, ç¼“å­˜ç»“æœä¼šè¢«è¿”å›.\n\nå¦ä¸€ä¸ªé‡è¦çš„è¦æ³¨æ„çš„æ˜¯, Promise æ˜¯ [åŠæ—©æ±‚å€¼ (evaluated eagerly)](https://zh.wikipedia.org/wiki/%E5%8F%8A%E6%97%A9%E6%B1%82%E5%80%BC) çš„: åªè¦å£°æ˜å¹¶å°†å…¶èµ‹å€¼åˆ°å˜é‡ä¸Š, å®ƒå·²ç»å¼€å§‹åœ¨å†…å­˜ä¸­æ‰§è¡Œäº†. æ²¡æœ‰ `.start` æˆ– `.begin` æ–¹æ³•. å°±åƒå®ƒåœ¨å‰é¢çš„ä¾‹å­ä¸­å¼€å§‹çš„é‚£æ ·.\n\nä¸ºäº†ç¡®ä¿ Promise èƒ½è¢«å»¶è¿Ÿè°ƒç”¨, æˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦åœ¨å®ƒçš„å¤–å±‚åŒ…è£¹ä¸€ä¸ªå‡½æ•°, ç¨åçš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šè§£é‡Šè¿™ä¸ª.\n\n### æ•è· Promise\n\nåˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† `resolve` çš„åœºæ™¯, é‚£ä¹ˆå½“æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯æ—¶, ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢? åœ¨ `.then()` å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°, å°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ `onRejected` ä¼šè¢«æ‰§è¡Œ, æ¥çœ‹ä¸€ä¸ªä¾‹å­:\n\n```js\nconst myPromise = new Promise((resolve, reject) => {\n  if (Math.random() * 100 < 90) {\n    reject(new Error('The promise was rejected by using reject function.'));\n  }\n  throw new Error('The promise was rejected by throwing an error');\n});\n\nmyPromise.then(\n  () => console.log('resolved'),\n  error => console.log(error.message)\n);\n\n// Output (in 90% of cases)\n\n// The promise was rejected by using reject function.\n```\n\nå’Œç¬¬ä¸€ä¸ªä¾‹å­ä¸€æ ·çš„, ä½†æ˜¯ç°åœ¨ 90% çš„æƒ…å†µæ˜¯è¢« `reject` çš„, å¦å¤– 10% çš„æƒ…å†µåˆ™æ˜¯æŠ›å‡ºä¸€ä¸ªé”™è¯¯è¯­å¥.\n\nåœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† `onResolved` å’Œ `onRejected` æ–¹æ³•, `onRejected` æ–¹æ³•å°†åœ¨é”™è¯¯å‘ç”Ÿæ—¶è¢«è°ƒç”¨, å¯ä»¥çœ‹åˆ° `reject` å‡½æ•°çš„å‚æ•°å¯ä»¥ç›´æ¥æ˜¯é”™è¯¯æç¤º, æ²¡å¿…è¦å¿…é¡» `new Error`, ä¸¤ä¸ªå†™æ³•éƒ½ä¸€æ ·.\n\nå¥å£®çš„ç¨‹åºä»£ç ç¦»ä¸å¼€é”™è¯¯å¤„ç†, `.then` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ç»™äº†æˆ‘ä»¬è¿™æ ·ä¸€ä¸ªæ·å¾„. å½“éœ€è¦å¤„ç†ä¸€ä¸ªé”™è¯¯æ—¶, å¯ä»¥ç”¨ `.catch(onRejected)` æ¥ä»£æ›¿ `.then(null, () => {...})`, `catch` æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•° `onRejected`, å› æ­¤, ä¸Šé¢çš„ä»£ç , å¯ä»¥ä½¿ç”¨ `catch` æ¥ç®€åŒ–å†™æ³•:\n\n```js\nmyPromise.catch(error => console.log(error.message));\n```\n\nè®°ä½: `.catch` æ–¹æ³•ä»…ä»…æ˜¯ `.then(undefined, onRejected)` çš„è¯­æ³•ç³–è€Œå·².\n\n### é“¾å¼ Promise\n\n`.then()` å’Œ `.catch()` æ–¹æ³•æ°¸è¿œä¼šè¿”å›ä¸€ä¸ª Promise å®ä¾‹, æ‰€ä»¥ä½ å¯ä»¥é“¾å¼ä½¿ç”¨å¤šä¸ª `.then` ä¸€èµ·æ¥è°ƒç”¨. è®©æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£å®ƒ.\n\né¦–å…ˆ, æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°, æ¥å»¶è¿Ÿè¿”å›ä¸€ä¸ª Promise å®ä¾‹. è¿™ä¸ªè¿”å›çš„ Promise å°†åœ¨ç¨åçš„æ—¶é—´å†… `resolve`. è¿™é‡Œæ˜¯å®ç°æ–¹æ³•:\n\n```js\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n```\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥åŒ…è£¹æˆ‘ä»¬çš„ Promise å®ä¾‹, æ‰€ä»¥å®ƒå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ. è¿™ä¸ª `delay` å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ—¶é—´æ¥ä½œä¸ºå‚æ•°. è¿™ä¸ªæ‰§è¡Œå‡½æ•°å°†æ¥æ”¶ `ms` ä½œä¸ºä»–çš„å‚æ•°, å®ƒè¿˜åŒ…å«ä¸€ä¸ª `setTimeout` , å®ƒåœ¨ `ms` æ¯«ç§’åè°ƒç”¨ `resolve` å‡½æ•°, ä»è€Œæ­£ç¡®æ‰§è¡Œ. çœ‹è¿™ä¸ªä¾‹å­:\n\n```js\ndelay(5000).then(() => console.log('Resolved after 5 seconds'));\n```\n\n`.then` ä¸­çš„å›è°ƒè¯­å¥å°†åœ¨ `delay(5000)` åæ‰§è¡Œ. å½“ä½ æ‰§è¡Œä¸Šé¢çš„ä»£ç  5 ç§’å, ä½ å°±å¯ä»¥åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°è¾“å‡ºç»“æœäº†.\n\nè¿™é‡Œ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ª `.then()` æ–¹æ³•æ¥é“¾å¼è°ƒç”¨:\n\n```js\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n\ndelay(2000)\n  .then(() => {\n    console.log('Resolved after 2 seconds');\n    return delay(1500);\n  })\n  .then(() => {\n    console.log('Resolved after 1.5 seconds');\n    return delay(3000);\n  })\n  .then(() => {\n    console.log('Resolved after 3 seconds');\n    throw new Error();\n  })\n  .catch(() => {\n    console.log('Caught an error.');\n  })\n  .then(() => {\n    console.log('Done.');\n  });\n\n// Resolved after 2 seconds\n// Resolved after 1.5 seconds\n// Resolved after 3 seconds\n// Caught an error.\n// Done.\n```\n\nä»ç¬¬ 3 è¡Œå¼€å§‹, å®ƒçš„æ‰§è¡Œæ­¥éª¤æ˜¯è¿™æ ·çš„:\n\n* `delay(2000)` å‡½æ•°æ‰§è¡Œ, å®ƒè¿”å›ä¸€ä¸ªç¨å 2 ç§’å³å°†æ‰§è¡Œçš„ Promise å®ä¾‹.\n* ç¬¬ 1 ä¸ª `.then()` æ‰§è¡Œ, å®ƒè¾“å‡ºè¯­å¥ `Resolved after 2 seconds`, ç„¶åå®ƒæ‰§è¡Œ `delay(1500)` åˆè¿”å›ä¸€ä¸ª Promise å®ä¾‹, å¦‚æœä¸€ä¸ª `.then()` è¿”å›äº†ä¸€ä¸ª Promise å®ä¾‹, é‚£ä¹ˆå®ƒçš„ `resolve` å°†è¢«è½¬å‘ç»™ä¸‹ä¸€ä¸ª `.then` æ–¹æ³•è°ƒç”¨, æŠ€æœ¯ä¸Šå«: æ²‰é™ (settlement).\n* åªè¦åƒè¿™æ ·ç»§ç»­ä¸²è”ä¸‹å», å®ƒä¼šç»§ç»­æ‰§è¡Œ.\n\næ³¨æ„åœ¨ç¬¬ä¸‰ä¸ª `.then()` æ–¹æ³•æ—¶, æˆ‘ä»¬åœ¨ `.then` ä¸­æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯. è¿™æ„å‘³ç€å½“å‰çš„ Promise è¢«æ‹’ç». ç„¶åå®ƒä¼šåœ¨ä¸‹ä¸€ä¸ª `.catch` è¯­å¥ä¸­è¢«æ•è·, `Caught an error` å°†ä¼šè¢«è¾“å‡º. ç„¶è€Œä¸€ä¸ª `.catch` è¯­å¥å®ƒè‡ªå·±æ°¸è¿œæ˜¯è¢« `resolve` çš„, æ‰€ä»¥ä¸éœ€è¦åœ¨è¯­å¥é‡Œå†å†™ `reject` (é™¤éä½ æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯), è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ `.catch` è¯­å¥åè¿˜å¯ä»¥ç»§ç»­å†™ `.then` çš„åŸå› .\n\næ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯åœ¨ `.then` æ–¹æ³•åæ‰§è¡Œ `.catch` è€Œä¸æ˜¯ä½¿ç”¨ `onResolved` å’Œ `onRejected`, æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:\n\n```js\nconst promiseThatResolves = () =>\n  new Promise((resolve, reject) => {\n    resolve();\n  });\n\n// Leads to UnhandledPromiseRejection\npromiseThatResolves().then(\n  () => {\n    throw new Error();\n  },\n  err => console.log(err)\n);\n\n// Proper error handling\npromiseThatResolves()\n  .then(() => {\n    throw new Error();\n  })\n  .catch(err => console.log(err));\n```\n\næˆ‘ä»¬åˆ›é€ ä¸€ä¸ªæ°¸è¿œèƒ½è¢« `resolve` çš„ Promise å®ä¾‹, å½“ä½ æ‰§è¡Œ `.then` æ—¶, å¯ä»¥å¸¦ä¸¤ä¸ªå›è°ƒå‡½æ•°: `onResolved` å’Œ `onRejected`, ç¬¬ä¸€ç§å†™æ³•, åœ¨ `then` ç§æ”¾å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°, ä½†æ˜¯: å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ç»§ç»­æŠ›å‡ºé”™è¯¯, é‚£ä¹ˆè¿™ä¸ªé”™è¯¯æ˜¯ä¸èƒ½è¢«æ•è·çš„. ğŸ˜…\n\nç¬¬äºŒç§å†™æ³•, åœ¨ `.then` è¯­å¥çš„åé¢ä½¿ç”¨ `.catch` æ•è·, ä¸å…‰èƒ½æ•è·åˆ°æ‰§è¡Œå‡½æ•° `promiseThatResolves` çš„é”™è¯¯, è€Œä¸”åœ¨ `.then()` ä¸­çš„é”™è¯¯ä¹Ÿæ˜¯èƒ½è¢«æ•è·åˆ°. çŸ¥é“è¿™æ ·å†™çš„å¥½å¤„äº†å§!ğŸ˜\n\n### æ€»ç»“\n\nä½ å¯ä»¥æ‰§è¡Œä¸Šé¢çš„æ‰€æœ‰ä»£ç ç‰‡æ®µæ¥æ›´æ·±å…¥çš„å­¦ä¹ . ä¸€ç§æ¯”è¾ƒå¥½çš„å®è·µå°±æ˜¯, æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å‡½æ•°éƒ½ç”¨ Promise æ¥é‡æ–°å®ç°. å¦‚æœä½ å†™ Node.js çš„è¯, ä½ ä¼šå‘ç° `fs` è¿˜æœ‰å…¶ä»–æ¨¡å—éƒ½æ˜¯åŸºäºå›è°ƒå‡½æ•°æ¥å®ç°çš„. æ‰€ä»¥ä¼šå­˜åœ¨ä¸€äº›å·¥å…·åº“, å®ƒä»¬æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å®ç°æ–¹å¼ä½¿ç”¨ Promise æ¥å®ç°äº†. æ¯”å¦‚ Node.js çš„ [util.promisify](https://nodejs.org/api/util.html#util_util_promisify_original) å’Œ [pify](https://github.com/sindresorhus/pify). å¦‚æœä½ åœ¨å­¦ä¹ çš„è¯, é‚£ä¹ˆå°½å¯èƒ½çš„å°è¯•è‡ªå·±å»å®ç°. æˆ–è€…è¯´å»è¯»è¿™äº› Promise å®ç°åº“çš„æºä»£ç . ç„¶åä½ å°±å¯ä»¥æŠŠè¿™äº›æœ€ä½³å®è·µç”¨äºä½ çš„äº§å“ä¸­å•¦!\n\nè¿˜æœ‰ä¸€äº›å…³äº Promise çš„ä¸œè¥¿æ²¡æœ‰å®Œå…¨è®²åˆ°, æ¯”å¦‚ `Promise.all` å’Œ `Promise.race` æ–¹æ³•, å¤„ç† Promise ä¸­çš„é”™è¯¯, ä»¥åŠä¸€äº›å¸¸è§çš„åæ¨¡å¼å’Œç»†èŠ‚ç­‰. ä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥æ¥å­¦ä¹ æ›´å¤šå…³äº Promise çš„çŸ¥è¯†.\n\n### å‚è€ƒ\n\n* [ECMA Promise Specification](http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects)\n* [Mozilla Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)\n* [Googleâ€™s Developerâ€™s Guide on Promises written by Jake Archibald](https://developers.google.com/web/fundamentals/primers/promises#promise-api-reference)\n* [Exploring JSâ€™s Chapter on Promises](http://exploringjs.com/es6/ch_promises.html#sec_first-example-promises)\n* [Introduction to Promises](http://jamesknelson.com/grokking-es6-promises-the-four-functions-you-need-to-avoid-callback-hell/)\n","slug":"ES6-Promise-ç®€æ˜æŒ‡å—","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidi40004u4q92yh7opto","content":"<p>Promise æ˜¯ JavaScriptES6 ä¸­æœ€ä»¤äººå…´å¥‹çš„æ–°å¢åŠŸèƒ½ä¹‹ä¸€. ES5 ä¸­ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œ. è¿‡åº¦ä½¿ç”¨å›è°ƒåˆ™ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±å’Œå¤šçº§åµŒå¥—ç¼©å¸¦æ¥çš„é—®é¢˜. Promise é€šè¿‡å°†å¼‚æ­¥ä»£ç è½¬åŒ–æˆåŒæ­¥æ‰§è¡Œçš„æ–¹å¼, å¤§å¤§ç®€åŒ–äº†å¼‚æ­¥ç¼–ç¨‹æ–¹å¼.</p>\n<a id=\"more\"></a>\n<p>è¿™ç¯‡æ–‡ç« ä¸­, æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Promise ä»¥åŠåœ¨å¼€å‘ä¸­çš„å®è·µ.</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-Promise\"><a href=\"#ä»€ä¹ˆæ˜¯-Promise\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Promise\"></a>ä»€ä¹ˆæ˜¯ Promise</h3><p>ç®€å•æ¥è¯´ Promise å°±æ˜¯ä¸€ä¸ªå­˜æ”¾ç€æœªæ¥æ‰ä¼šæœ‰è®¡ç®—ç»“æœçš„å ä½ç¬¦. ç¨å¾®æƒ³æƒ³, ä½ ä¼šå‘ç°, è¿™å’Œæˆ‘ä»¬å¹³å¸¸åœ¨è°ˆè¯è¿‡ç¨‹ä¸­è¯´çš„æ‰¿è¯ºå¾ˆåƒ. ä¸¾ä¸ªä¾‹å­: ä½ å‡†å¤‡å»å°åº¦æ—…è¡Œ, ä½ è®¢äº†ä¸€å¼ å»å°åº¦çš„æœºç¥¨. è¿™ä¸ªæœºç¥¨ä¸Šå†™ç€å¤šå°‘å·, åº§ä½å·æ˜¯å¤šå°‘. è¿™ä¸ªåœºæ™¯ä¸‹, æœºç¥¨å°±æ˜¯èˆªç©ºå…¬å¸ç»™ä½ è®¸ä¸‹çš„æ‰¿è¯º: åœ¨ä½ å‡†å¤‡å‡ºå‘é‚£å¤©ç»™ä½ é¢„ç•™äº†ä¸€ä¸ªå¤´ç­‰èˆ±ï¼ğŸ˜</p>\n<p>è¿˜æœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­, ä½ æ‰¿è¯ºä½ çš„æœ‹å‹, å½“ä½ è¯»å®Œã€Šè®¡ç®—æœºç¼–ç¨‹è‰ºæœ¯ã€‹è¿™æœ¬ä¹¦å, ä½ å°±æŠŠè¿™æœ¬ä¹¦è¿˜å›å». åœ¨è¿™é‡Œ, ä½ æ‰€è¯´çš„è¯å°±å¥½æ¯”æ˜¯ä¸€ä¸ªå ä½ç¬¦, éœ€è¦è¿”å›çš„å€¼å°±æ˜¯è¿™æœ¬ä¹¦.</p>\n<p>ä½ è¿˜å¯ä»¥æƒ³åˆ°å…¶ä»–ä¸€äº›ç±»ä¼¼æ‰¿è¯ºçš„ä¾‹å­, æ¯”å¦‚åœ¨åŒ»ç”ŸåŠå…¬å®¤ç­‰ç€ã€åœ¨é¤é¦†ç‚¹é¤ã€åœ¨å›¾ä¹¦é¦†å†™ä¹¦ç­‰ç­‰. éƒ½æ¶‰åŠæŸç§å½¢å¼çš„æ‰¿è¯º.</p>\n<h3 id=\"ç”Ÿæˆä¸€ä¸ª-Promise\"><a href=\"#ç”Ÿæˆä¸€ä¸ª-Promise\" class=\"headerlink\" title=\"ç”Ÿæˆä¸€ä¸ª Promise\"></a>ç”Ÿæˆä¸€ä¸ª Promise</h3><p>å½“æŸé¡¹ä»»åŠ¡çš„å®Œæˆæ—¶é—´ä¸ç¡®å®šæˆ–å¤ªé•¿æ—¶, å°±å¯ä»¥ä½¿ç”¨ Promise. ä¾‹å¦‚, ç½‘ç»œè¯·æ±‚å¯èƒ½éœ€è¦ 10ms åˆ° 200msï¼ˆæˆ–æ›´é•¿ï¼‰çš„æ—¶é—´, å…·ä½“å–å†³äºç½‘é€Ÿ. æˆ‘ä»¬ä¸æƒ³åœ¨è·å–æ•°æ®æ—¶ç­‰å¾…. 200 æ¯«ç§’å¯¹ä½ æ¥è¯´å¯èƒ½ä¸å¤ªé‡è¦, ä½†å¯¹äºä¸€å°ç”µè„‘æ¥è¯´, è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ—¶é—´. Promise å°±æ˜¯è¦è®©è¿™ç§å¼‚æ­¥å˜å¾—ç®€å•ã€è½»æ¾. ä½¿ç”¨ Promise æ„é€ å‡½æ•°, æ¥å®ä¾‹åŒ–ä¸€ä¸ª myPromise å®ä¾‹, åƒè¿™æ ·:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> myPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">Math</span>.random() * <span class=\"number\">100</span> &lt;= <span class=\"number\">90</span>) &#123;</span><br><span class=\"line\">    resolve(<span class=\"string\">'Hello, Promises!'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  reject(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'In 10% of the cases, I fail. Miserably.'</span>));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°. <code>new Promise()</code> è¢«ç§°ä¸ºæ‰§è¡Œå™¨å‡½æ•°, å®ƒæè¿°äº†è¦å®Œæˆçš„è®¡ç®—. å®ƒçš„è¿™ä¸¤ä¸ªå‚æ•°é€šå¸¸è¢«å«åš <code>resolve</code> å’Œ <code>reject</code>, å¯ä»¥ç†è§£ä¸º <strong>æ‰§è¡Œ</strong> å’Œ <strong>æ‹’ç»</strong>, å®ƒä»¬ç”¨æ¥æ ‡è®°æ‰§è¡Œå™¨å‡½æ•°æœ€ç»ˆçš„è®¡ç®—ç»“æœ. <code>resolve</code> å’Œ <code>reject</code> æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒç”¨æ¥è¿”å›ä¸€ä¸ªå€¼ç»™æˆ‘ä»¬çš„ Promise å®ä¾‹.</p>\n<p>å½“è¿ç®—ç»“æœæˆåŠŸæ—¶, æˆ–è€…æœªæ¥ç€è¿™ä¸ªå€¼å‡†å¤‡å°±ç»ªæ—¶, æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ª <code>resolve</code> å‡½æ•°æ¥è¿”å›ä¸€ä¸ªå€¼, æˆ‘ä»¬å°±è¯´: æˆ‘è·µè¡Œäº†å½“åˆè®¸ä¸‹çš„è¿™ä¸ªæ‰¿è¯º.</p>\n<p>åŒç†, å½“è®¡ç®—ç»“æœå¤±è´¥æ—¶, æˆ–è€…è®¡ç®—è¿‡ç¨‹ä¸­é‡åˆ°äº†é”™è¯¯, æˆ‘ä»¬å°±ä½¿ç”¨ <code>reject</code> å‡½æ•°, æˆ‘ä»¬å°±è¯´: æˆ‘æ‹’ç»å±¥è¡Œè¿™ä¸ªæ‰¿è¯º. <code>reject</code> å‡½æ•°å¯ä»¥æ¥æ”¶ä»»ä½•å€¼æ¥ä½œä¸ºå‚æ•°, ä½†æ˜¯æ¯”è¾ƒæ¨èçš„æ˜¯æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª <code>Error</code> å¯¹è±¡, å³: æŠ›å‡ºä¸€ä¸ªé”™è¯¯, ç”¨æ¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ä»£ç , è¿™æ ·å°±å¯ä»¥æ ¹æ®å…·ä½“çš„æŠ›å‡ºé”™è¯¯ä¿¡æ¯å»è§£å†³é—®é¢˜å•¦.</p>\n<p>åœ¨ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ä¸­, <code>Math.random()</code> ç”¨æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°, åœ¨ 90% çš„æƒ…å†µä¸‹, è¿™ä¸ª Promise éƒ½åº”è¯¥è¢«æ‰§è¡Œ (å‡è®¾ç­‰æ¦‚ç‡åˆ†å¸ƒ), å‰©ä½™çš„æƒ…å†µä¸‹éƒ½æ˜¯æ‹’ç»æ‰§è¡Œçš„.</p>\n<h3 id=\"å¦‚ä½•ä½¿ç”¨-Promises\"><a href=\"#å¦‚ä½•ä½¿ç”¨-Promises\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨ Promises\"></a>å¦‚ä½•ä½¿ç”¨ Promises</h3><p>åœ¨ä¸Šé¢çš„ä»£ç ä¾‹å­ä¸­, æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª Promise å®ä¾‹ <code>myPromise</code>, é‚£ä¹ˆå¦‚ä½•é€šè¿‡ <code>resolve</code> å’Œ <code>reject</code> å‡½æ•°è®¿é—®è®¡ç®—å®Œæˆåçš„å€¼å‘¢? æ‰€æœ‰çš„ <code>Promise</code> å®ä¾‹éƒ½æœ‰ä¸€ä¸ª <code>.then()</code> æ–¹æ³•, æˆ‘ä»¬æ¥ç§ç§:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> myPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">Math</span>.random() * <span class=\"number\">100</span> &lt; <span class=\"number\">90</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'resolving the promise ...'</span>);</span><br><span class=\"line\">    resolve(<span class=\"string\">'Hello, Promises!'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  reject(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'In 10% of the cases, I fail. Miserably.'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Two functions</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> onResolved = <span class=\"function\"><span class=\"params\">resolvedValue</span> =&gt;</span> <span class=\"built_in\">console</span>.log(resolvedValue);</span><br><span class=\"line\"><span class=\"keyword\">const</span> onRejected = <span class=\"function\"><span class=\"params\">error</span> =&gt;</span> <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\"></span><br><span class=\"line\">myPromise.then(onResolved, onRejected);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Same as above, written concisely</span></span><br><span class=\"line\">myPromise.then(</span><br><span class=\"line\">  resolvedValue =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(resolvedValue);</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  error =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output (in 90% of the cases)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// resolving the promise ...</span></span><br><span class=\"line\"><span class=\"comment\">// Hello, Promises!</span></span><br><span class=\"line\"><span class=\"comment\">// Hello, Promises!</span></span><br></pre></td></tr></table></figure>\n<p><code>.then()</code> æ–¹æ³•æ¥æ”¶ 2 ä¸ªå›è°ƒå‡½æ•°, ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯å½“æˆ‘ä»¬çš„ Promise å®ä¾‹è¢«æ‰§è¡Œ (resolve) æ—¶è°ƒç”¨, ç¬¬äºŒä¸ªåˆ™æ˜¯è¢«æ‹’ç» (reject) æ—¶è°ƒç”¨. åœ¨ä¸Šé¢çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨ <code>onResolved</code> å’Œ <code>onRejected</code> å®šä¹‰äº†è¿™ä¸¤ä¸ªå‡½æ•°, ç„¶åæŠŠå®ƒæ”¾åˆ° <code>.then</code> å‡½æ•°é‡Œ, å½“ç„¶, ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å¸¸è§„å†™æ³•, ç›´æ¥åœ¨ <code>.then</code> å‡½æ•°é‡Œå†™ä¸¤ä¸ªå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„.</p>\n<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æœ‰å‡ ç‚¹éå¸¸é‡è¦, æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹:</p>\n<ul>\n<li>ä¸€ä¸ª <code>promise</code> åªèƒ½æ˜¯æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€ä¸­çš„ä¸€ä¸ª. å®ƒä¸èƒ½æˆåŠŸæˆ–è€…å¤±è´¥å¤šæ¬¡. ä¹Ÿä¸èƒ½ä»æˆåŠŸçŠ¶æ€åˆ‡æ¢åˆ°å¤±è´¥çŠ¶æ€, å¤±è´¥åä¹‹äº¦ç„¶.</li>\n<li>ä½ å¯ä»¥åœ¨æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€å, å»å®šä¹‰è¿™æ ·ä¸€ä¸ªå›è°ƒå‡½æ•°. å½“ä»–ä»¬ <code>resolve</code> æˆ–è€… <code>reject</code> ä»ç„¶èƒ½æ­£ç¡®è°ƒç”¨.</li>\n</ul>\n<p>è¿™å°±è¯´æ˜, <code>Promise</code> æœ€ç»ˆåªæœ‰ä¸€ä¸ªçŠ¶æ€, å³ä½¿ä½ å¤šæ¬¡ä½¿ç”¨ <code>.then</code> å¤„ç†å‡½æ•°, è¿™ä¸ªçŠ¶æ€ä¸èƒ½æ›´æ”¹ (è®¡ç®—ç»“æœä¹Ÿä¸ä¼šé‡å¤æ‰§è¡Œ).</p>\n<p>ä¸ºäº†éªŒè¯è¿™ç‚¹, ä½ å¯ä»¥çœ‹åˆ°åœ¨ç¬¬ 3 è¡Œä»£ç ä¸­, <code>console.log</code> è¯­å¥, å½“ä½ å¤šæ¬¡ä½¿ç”¨ <code>.then</code> å¤„ç†ç¨‹åºè¿è¡Œä¸Šè¿°ä»£ç æ—¶, <code>console.log</code> çš„è¯­å¥åªä¼šè¢«æ‰“å°ä¸€æ¬¡. è¿™å°±è¯´æ˜äº† Promise ä¼šç¼“å­˜è®¡ç®—ç»“æœçš„, å½“æœ‰ä¸€äº›ç›¸åŒçš„ç»“æœæ—¶, ç¼“å­˜ç»“æœä¼šè¢«è¿”å›.</p>\n<p>å¦ä¸€ä¸ªé‡è¦çš„è¦æ³¨æ„çš„æ˜¯, Promise æ˜¯ <a href=\"https://zh.wikipedia.org/wiki/%E5%8F%8A%E6%97%A9%E6%B1%82%E5%80%BC\" target=\"_blank\" rel=\"noopener\">åŠæ—©æ±‚å€¼ (evaluated eagerly)</a> çš„: åªè¦å£°æ˜å¹¶å°†å…¶èµ‹å€¼åˆ°å˜é‡ä¸Š, å®ƒå·²ç»å¼€å§‹åœ¨å†…å­˜ä¸­æ‰§è¡Œäº†. æ²¡æœ‰ <code>.start</code> æˆ– <code>.begin</code> æ–¹æ³•. å°±åƒå®ƒåœ¨å‰é¢çš„ä¾‹å­ä¸­å¼€å§‹çš„é‚£æ ·.</p>\n<p>ä¸ºäº†ç¡®ä¿ Promise èƒ½è¢«å»¶è¿Ÿè°ƒç”¨, æˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦åœ¨å®ƒçš„å¤–å±‚åŒ…è£¹ä¸€ä¸ªå‡½æ•°, ç¨åçš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šè§£é‡Šè¿™ä¸ª.</p>\n<h3 id=\"æ•è·-Promise\"><a href=\"#æ•è·-Promise\" class=\"headerlink\" title=\"æ•è· Promise\"></a>æ•è· Promise</h3><p>åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† <code>resolve</code> çš„åœºæ™¯, é‚£ä¹ˆå½“æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯æ—¶, ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢? åœ¨ <code>.then()</code> å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°, å°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ <code>onRejected</code> ä¼šè¢«æ‰§è¡Œ, æ¥çœ‹ä¸€ä¸ªä¾‹å­:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> myPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">Math</span>.random() * <span class=\"number\">100</span> &lt; <span class=\"number\">90</span>) &#123;</span><br><span class=\"line\">    reject(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'The promise was rejected by using reject function.'</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'The promise was rejected by throwing an error'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">myPromise.then(</span><br><span class=\"line\">  () =&gt; <span class=\"built_in\">console</span>.log(<span class=\"string\">'resolved'</span>),</span><br><span class=\"line\">  error =&gt; <span class=\"built_in\">console</span>.log(error.message)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output (in 90% of cases)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The promise was rejected by using reject function.</span></span><br></pre></td></tr></table></figure>\n<p>å’Œç¬¬ä¸€ä¸ªä¾‹å­ä¸€æ ·çš„, ä½†æ˜¯ç°åœ¨ 90% çš„æƒ…å†µæ˜¯è¢« <code>reject</code> çš„, å¦å¤– 10% çš„æƒ…å†µåˆ™æ˜¯æŠ›å‡ºä¸€ä¸ªé”™è¯¯è¯­å¥.</p>\n<p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† <code>onResolved</code> å’Œ <code>onRejected</code> æ–¹æ³•, <code>onRejected</code> æ–¹æ³•å°†åœ¨é”™è¯¯å‘ç”Ÿæ—¶è¢«è°ƒç”¨, å¯ä»¥çœ‹åˆ° <code>reject</code> å‡½æ•°çš„å‚æ•°å¯ä»¥ç›´æ¥æ˜¯é”™è¯¯æç¤º, æ²¡å¿…è¦å¿…é¡» <code>new Error</code>, ä¸¤ä¸ªå†™æ³•éƒ½ä¸€æ ·.</p>\n<p>å¥å£®çš„ç¨‹åºä»£ç ç¦»ä¸å¼€é”™è¯¯å¤„ç†, <code>.then</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ç»™äº†æˆ‘ä»¬è¿™æ ·ä¸€ä¸ªæ·å¾„. å½“éœ€è¦å¤„ç†ä¸€ä¸ªé”™è¯¯æ—¶, å¯ä»¥ç”¨ <code>.catch(onRejected)</code> æ¥ä»£æ›¿ <code>.then(null, () =&gt; {...})</code>, <code>catch</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•° <code>onRejected</code>, å› æ­¤, ä¸Šé¢çš„ä»£ç , å¯ä»¥ä½¿ç”¨ <code>catch</code> æ¥ç®€åŒ–å†™æ³•:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">myPromise.catch(<span class=\"function\"><span class=\"params\">error</span> =&gt;</span> <span class=\"built_in\">console</span>.log(error.message));</span><br></pre></td></tr></table></figure>\n<p>è®°ä½: <code>.catch</code> æ–¹æ³•ä»…ä»…æ˜¯ <code>.then(undefined, onRejected)</code> çš„è¯­æ³•ç³–è€Œå·².</p>\n<h3 id=\"é“¾å¼-Promise\"><a href=\"#é“¾å¼-Promise\" class=\"headerlink\" title=\"é“¾å¼ Promise\"></a>é“¾å¼ Promise</h3><p><code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æ°¸è¿œä¼šè¿”å›ä¸€ä¸ª Promise å®ä¾‹, æ‰€ä»¥ä½ å¯ä»¥é“¾å¼ä½¿ç”¨å¤šä¸ª <code>.then</code> ä¸€èµ·æ¥è°ƒç”¨. è®©æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£å®ƒ.</p>\n<p>é¦–å…ˆ, æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°, æ¥å»¶è¿Ÿè¿”å›ä¸€ä¸ª Promise å®ä¾‹. è¿™ä¸ªè¿”å›çš„ Promise å°†åœ¨ç¨åçš„æ—¶é—´å†… <code>resolve</code>. è¿™é‡Œæ˜¯å®ç°æ–¹æ³•:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> delay = <span class=\"function\"><span class=\"params\">ms</span> =&gt;</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br></pre></td></tr></table></figure>\n<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥åŒ…è£¹æˆ‘ä»¬çš„ Promise å®ä¾‹, æ‰€ä»¥å®ƒå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ. è¿™ä¸ª <code>delay</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ—¶é—´æ¥ä½œä¸ºå‚æ•°. è¿™ä¸ªæ‰§è¡Œå‡½æ•°å°†æ¥æ”¶ <code>ms</code> ä½œä¸ºä»–çš„å‚æ•°, å®ƒè¿˜åŒ…å«ä¸€ä¸ª <code>setTimeout</code> , å®ƒåœ¨ <code>ms</code> æ¯«ç§’åè°ƒç”¨ <code>resolve</code> å‡½æ•°, ä»è€Œæ­£ç¡®æ‰§è¡Œ. çœ‹è¿™ä¸ªä¾‹å­:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">delay(<span class=\"number\">5000</span>).then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 5 seconds'</span>));</span><br></pre></td></tr></table></figure>\n<p><code>.then</code> ä¸­çš„å›è°ƒè¯­å¥å°†åœ¨ <code>delay(5000)</code> åæ‰§è¡Œ. å½“ä½ æ‰§è¡Œä¸Šé¢çš„ä»£ç  5 ç§’å, ä½ å°±å¯ä»¥åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°è¾“å‡ºç»“æœäº†.</p>\n<p>è¿™é‡Œ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ª <code>.then()</code> æ–¹æ³•æ¥é“¾å¼è°ƒç”¨:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> delay = <span class=\"function\"><span class=\"params\">ms</span> =&gt;</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br><span class=\"line\"></span><br><span class=\"line\">delay(<span class=\"number\">2000</span>)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 2 seconds'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delay(<span class=\"number\">1500</span>);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 1.5 seconds'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delay(<span class=\"number\">3000</span>);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 3 seconds'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>();</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Caught an error.'</span>);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Done.'</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Resolved after 2 seconds</span></span><br><span class=\"line\"><span class=\"comment\">// Resolved after 1.5 seconds</span></span><br><span class=\"line\"><span class=\"comment\">// Resolved after 3 seconds</span></span><br><span class=\"line\"><span class=\"comment\">// Caught an error.</span></span><br><span class=\"line\"><span class=\"comment\">// Done.</span></span><br></pre></td></tr></table></figure>\n<p>ä»ç¬¬ 3 è¡Œå¼€å§‹, å®ƒçš„æ‰§è¡Œæ­¥éª¤æ˜¯è¿™æ ·çš„:</p>\n<ul>\n<li><code>delay(2000)</code> å‡½æ•°æ‰§è¡Œ, å®ƒè¿”å›ä¸€ä¸ªç¨å 2 ç§’å³å°†æ‰§è¡Œçš„ Promise å®ä¾‹.</li>\n<li>ç¬¬ 1 ä¸ª <code>.then()</code> æ‰§è¡Œ, å®ƒè¾“å‡ºè¯­å¥ <code>Resolved after 2 seconds</code>, ç„¶åå®ƒæ‰§è¡Œ <code>delay(1500)</code> åˆè¿”å›ä¸€ä¸ª Promise å®ä¾‹, å¦‚æœä¸€ä¸ª <code>.then()</code> è¿”å›äº†ä¸€ä¸ª Promise å®ä¾‹, é‚£ä¹ˆå®ƒçš„ <code>resolve</code> å°†è¢«è½¬å‘ç»™ä¸‹ä¸€ä¸ª <code>.then</code> æ–¹æ³•è°ƒç”¨, æŠ€æœ¯ä¸Šå«: æ²‰é™ (settlement).</li>\n<li>åªè¦åƒè¿™æ ·ç»§ç»­ä¸²è”ä¸‹å», å®ƒä¼šç»§ç»­æ‰§è¡Œ.</li>\n</ul>\n<p>æ³¨æ„åœ¨ç¬¬ä¸‰ä¸ª <code>.then()</code> æ–¹æ³•æ—¶, æˆ‘ä»¬åœ¨ <code>.then</code> ä¸­æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯. è¿™æ„å‘³ç€å½“å‰çš„ Promise è¢«æ‹’ç». ç„¶åå®ƒä¼šåœ¨ä¸‹ä¸€ä¸ª <code>.catch</code> è¯­å¥ä¸­è¢«æ•è·, <code>Caught an error</code> å°†ä¼šè¢«è¾“å‡º. ç„¶è€Œä¸€ä¸ª <code>.catch</code> è¯­å¥å®ƒè‡ªå·±æ°¸è¿œæ˜¯è¢« <code>resolve</code> çš„, æ‰€ä»¥ä¸éœ€è¦åœ¨è¯­å¥é‡Œå†å†™ <code>reject</code> (é™¤éä½ æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯), è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ <code>.catch</code> è¯­å¥åè¿˜å¯ä»¥ç»§ç»­å†™ <code>.then</code> çš„åŸå› .</p>\n<p>æ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯åœ¨ <code>.then</code> æ–¹æ³•åæ‰§è¡Œ <code>.catch</code> è€Œä¸æ˜¯ä½¿ç”¨ <code>onResolved</code> å’Œ <code>onRejected</code>, æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> promiseThatResolves = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">  <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    resolve();</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Leads to UnhandledPromiseRejection</span></span><br><span class=\"line\">promiseThatResolves().then(</span><br><span class=\"line\">  () =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>();</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  err =&gt; <span class=\"built_in\">console</span>.log(err)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Proper error handling</span></span><br><span class=\"line\">promiseThatResolves()</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>();</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> <span class=\"built_in\">console</span>.log(err));</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬åˆ›é€ ä¸€ä¸ªæ°¸è¿œèƒ½è¢« <code>resolve</code> çš„ Promise å®ä¾‹, å½“ä½ æ‰§è¡Œ <code>.then</code> æ—¶, å¯ä»¥å¸¦ä¸¤ä¸ªå›è°ƒå‡½æ•°: <code>onResolved</code> å’Œ <code>onRejected</code>, ç¬¬ä¸€ç§å†™æ³•, åœ¨ <code>then</code> ç§æ”¾å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°, ä½†æ˜¯: å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ç»§ç»­æŠ›å‡ºé”™è¯¯, é‚£ä¹ˆè¿™ä¸ªé”™è¯¯æ˜¯ä¸èƒ½è¢«æ•è·çš„. ğŸ˜…</p>\n<p>ç¬¬äºŒç§å†™æ³•, åœ¨ <code>.then</code> è¯­å¥çš„åé¢ä½¿ç”¨ <code>.catch</code> æ•è·, ä¸å…‰èƒ½æ•è·åˆ°æ‰§è¡Œå‡½æ•° <code>promiseThatResolves</code> çš„é”™è¯¯, è€Œä¸”åœ¨ <code>.then()</code> ä¸­çš„é”™è¯¯ä¹Ÿæ˜¯èƒ½è¢«æ•è·åˆ°. çŸ¥é“è¿™æ ·å†™çš„å¥½å¤„äº†å§!ğŸ˜</p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>ä½ å¯ä»¥æ‰§è¡Œä¸Šé¢çš„æ‰€æœ‰ä»£ç ç‰‡æ®µæ¥æ›´æ·±å…¥çš„å­¦ä¹ . ä¸€ç§æ¯”è¾ƒå¥½çš„å®è·µå°±æ˜¯, æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å‡½æ•°éƒ½ç”¨ Promise æ¥é‡æ–°å®ç°. å¦‚æœä½ å†™ Node.js çš„è¯, ä½ ä¼šå‘ç° <code>fs</code> è¿˜æœ‰å…¶ä»–æ¨¡å—éƒ½æ˜¯åŸºäºå›è°ƒå‡½æ•°æ¥å®ç°çš„. æ‰€ä»¥ä¼šå­˜åœ¨ä¸€äº›å·¥å…·åº“, å®ƒä»¬æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å®ç°æ–¹å¼ä½¿ç”¨ Promise æ¥å®ç°äº†. æ¯”å¦‚ Node.js çš„ <a href=\"https://nodejs.org/api/util.html#util_util_promisify_original\" target=\"_blank\" rel=\"noopener\">util.promisify</a> å’Œ <a href=\"https://github.com/sindresorhus/pify\" target=\"_blank\" rel=\"noopener\">pify</a>. å¦‚æœä½ åœ¨å­¦ä¹ çš„è¯, é‚£ä¹ˆå°½å¯èƒ½çš„å°è¯•è‡ªå·±å»å®ç°. æˆ–è€…è¯´å»è¯»è¿™äº› Promise å®ç°åº“çš„æºä»£ç . ç„¶åä½ å°±å¯ä»¥æŠŠè¿™äº›æœ€ä½³å®è·µç”¨äºä½ çš„äº§å“ä¸­å•¦!</p>\n<p>è¿˜æœ‰ä¸€äº›å…³äº Promise çš„ä¸œè¥¿æ²¡æœ‰å®Œå…¨è®²åˆ°, æ¯”å¦‚ <code>Promise.all</code> å’Œ <code>Promise.race</code> æ–¹æ³•, å¤„ç† Promise ä¸­çš„é”™è¯¯, ä»¥åŠä¸€äº›å¸¸è§çš„åæ¨¡å¼å’Œç»†èŠ‚ç­‰. ä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥æ¥å­¦ä¹ æ›´å¤šå…³äº Promise çš„çŸ¥è¯†.</p>\n<h3 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h3><ul>\n<li><a href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects\" target=\"_blank\" rel=\"noopener\">ECMA Promise Specification</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\" target=\"_blank\" rel=\"noopener\">Mozilla Docs</a></li>\n<li><a href=\"https://developers.google.com/web/fundamentals/primers/promises#promise-api-reference\" target=\"_blank\" rel=\"noopener\">Googleâ€™s Developerâ€™s Guide on Promises written by Jake Archibald</a></li>\n<li><a href=\"http://exploringjs.com/es6/ch_promises.html#sec_first-example-promises\" target=\"_blank\" rel=\"noopener\">Exploring JSâ€™s Chapter on Promises</a></li>\n<li><a href=\"http://jamesknelson.com/grokking-es6-promises-the-four-functions-you-need-to-avoid-callback-hell/\" target=\"_blank\" rel=\"noopener\">Introduction to Promises</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>Promise æ˜¯ JavaScriptES6 ä¸­æœ€ä»¤äººå…´å¥‹çš„æ–°å¢åŠŸèƒ½ä¹‹ä¸€. ES5 ä¸­ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œ. è¿‡åº¦ä½¿ç”¨å›è°ƒåˆ™ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±å’Œå¤šçº§åµŒå¥—ç¼©å¸¦æ¥çš„é—®é¢˜. Promise é€šè¿‡å°†å¼‚æ­¥ä»£ç è½¬åŒ–æˆåŒæ­¥æ‰§è¡Œçš„æ–¹å¼, å¤§å¤§ç®€åŒ–äº†å¼‚æ­¥ç¼–ç¨‹æ–¹å¼.</p>","more":"<p>è¿™ç¯‡æ–‡ç« ä¸­, æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Promise ä»¥åŠåœ¨å¼€å‘ä¸­çš„å®è·µ.</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-Promise\"><a href=\"#ä»€ä¹ˆæ˜¯-Promise\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Promise\"></a>ä»€ä¹ˆæ˜¯ Promise</h3><p>ç®€å•æ¥è¯´ Promise å°±æ˜¯ä¸€ä¸ªå­˜æ”¾ç€æœªæ¥æ‰ä¼šæœ‰è®¡ç®—ç»“æœçš„å ä½ç¬¦. ç¨å¾®æƒ³æƒ³, ä½ ä¼šå‘ç°, è¿™å’Œæˆ‘ä»¬å¹³å¸¸åœ¨è°ˆè¯è¿‡ç¨‹ä¸­è¯´çš„æ‰¿è¯ºå¾ˆåƒ. ä¸¾ä¸ªä¾‹å­: ä½ å‡†å¤‡å»å°åº¦æ—…è¡Œ, ä½ è®¢äº†ä¸€å¼ å»å°åº¦çš„æœºç¥¨. è¿™ä¸ªæœºç¥¨ä¸Šå†™ç€å¤šå°‘å·, åº§ä½å·æ˜¯å¤šå°‘. è¿™ä¸ªåœºæ™¯ä¸‹, æœºç¥¨å°±æ˜¯èˆªç©ºå…¬å¸ç»™ä½ è®¸ä¸‹çš„æ‰¿è¯º: åœ¨ä½ å‡†å¤‡å‡ºå‘é‚£å¤©ç»™ä½ é¢„ç•™äº†ä¸€ä¸ªå¤´ç­‰èˆ±ï¼ğŸ˜</p>\n<p>è¿˜æœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­, ä½ æ‰¿è¯ºä½ çš„æœ‹å‹, å½“ä½ è¯»å®Œã€Šè®¡ç®—æœºç¼–ç¨‹è‰ºæœ¯ã€‹è¿™æœ¬ä¹¦å, ä½ å°±æŠŠè¿™æœ¬ä¹¦è¿˜å›å». åœ¨è¿™é‡Œ, ä½ æ‰€è¯´çš„è¯å°±å¥½æ¯”æ˜¯ä¸€ä¸ªå ä½ç¬¦, éœ€è¦è¿”å›çš„å€¼å°±æ˜¯è¿™æœ¬ä¹¦.</p>\n<p>ä½ è¿˜å¯ä»¥æƒ³åˆ°å…¶ä»–ä¸€äº›ç±»ä¼¼æ‰¿è¯ºçš„ä¾‹å­, æ¯”å¦‚åœ¨åŒ»ç”ŸåŠå…¬å®¤ç­‰ç€ã€åœ¨é¤é¦†ç‚¹é¤ã€åœ¨å›¾ä¹¦é¦†å†™ä¹¦ç­‰ç­‰. éƒ½æ¶‰åŠæŸç§å½¢å¼çš„æ‰¿è¯º.</p>\n<h3 id=\"ç”Ÿæˆä¸€ä¸ª-Promise\"><a href=\"#ç”Ÿæˆä¸€ä¸ª-Promise\" class=\"headerlink\" title=\"ç”Ÿæˆä¸€ä¸ª Promise\"></a>ç”Ÿæˆä¸€ä¸ª Promise</h3><p>å½“æŸé¡¹ä»»åŠ¡çš„å®Œæˆæ—¶é—´ä¸ç¡®å®šæˆ–å¤ªé•¿æ—¶, å°±å¯ä»¥ä½¿ç”¨ Promise. ä¾‹å¦‚, ç½‘ç»œè¯·æ±‚å¯èƒ½éœ€è¦ 10ms åˆ° 200msï¼ˆæˆ–æ›´é•¿ï¼‰çš„æ—¶é—´, å…·ä½“å–å†³äºç½‘é€Ÿ. æˆ‘ä»¬ä¸æƒ³åœ¨è·å–æ•°æ®æ—¶ç­‰å¾…. 200 æ¯«ç§’å¯¹ä½ æ¥è¯´å¯èƒ½ä¸å¤ªé‡è¦, ä½†å¯¹äºä¸€å°ç”µè„‘æ¥è¯´, è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ—¶é—´. Promise å°±æ˜¯è¦è®©è¿™ç§å¼‚æ­¥å˜å¾—ç®€å•ã€è½»æ¾. ä½¿ç”¨ Promise æ„é€ å‡½æ•°, æ¥å®ä¾‹åŒ–ä¸€ä¸ª myPromise å®ä¾‹, åƒè¿™æ ·:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> myPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">Math</span>.random() * <span class=\"number\">100</span> &lt;= <span class=\"number\">90</span>) &#123;</span><br><span class=\"line\">    resolve(<span class=\"string\">'Hello, Promises!'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  reject(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'In 10% of the cases, I fail. Miserably.'</span>));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°. <code>new Promise()</code> è¢«ç§°ä¸ºæ‰§è¡Œå™¨å‡½æ•°, å®ƒæè¿°äº†è¦å®Œæˆçš„è®¡ç®—. å®ƒçš„è¿™ä¸¤ä¸ªå‚æ•°é€šå¸¸è¢«å«åš <code>resolve</code> å’Œ <code>reject</code>, å¯ä»¥ç†è§£ä¸º <strong>æ‰§è¡Œ</strong> å’Œ <strong>æ‹’ç»</strong>, å®ƒä»¬ç”¨æ¥æ ‡è®°æ‰§è¡Œå™¨å‡½æ•°æœ€ç»ˆçš„è®¡ç®—ç»“æœ. <code>resolve</code> å’Œ <code>reject</code> æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒç”¨æ¥è¿”å›ä¸€ä¸ªå€¼ç»™æˆ‘ä»¬çš„ Promise å®ä¾‹.</p>\n<p>å½“è¿ç®—ç»“æœæˆåŠŸæ—¶, æˆ–è€…æœªæ¥ç€è¿™ä¸ªå€¼å‡†å¤‡å°±ç»ªæ—¶, æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ª <code>resolve</code> å‡½æ•°æ¥è¿”å›ä¸€ä¸ªå€¼, æˆ‘ä»¬å°±è¯´: æˆ‘è·µè¡Œäº†å½“åˆè®¸ä¸‹çš„è¿™ä¸ªæ‰¿è¯º.</p>\n<p>åŒç†, å½“è®¡ç®—ç»“æœå¤±è´¥æ—¶, æˆ–è€…è®¡ç®—è¿‡ç¨‹ä¸­é‡åˆ°äº†é”™è¯¯, æˆ‘ä»¬å°±ä½¿ç”¨ <code>reject</code> å‡½æ•°, æˆ‘ä»¬å°±è¯´: æˆ‘æ‹’ç»å±¥è¡Œè¿™ä¸ªæ‰¿è¯º. <code>reject</code> å‡½æ•°å¯ä»¥æ¥æ”¶ä»»ä½•å€¼æ¥ä½œä¸ºå‚æ•°, ä½†æ˜¯æ¯”è¾ƒæ¨èçš„æ˜¯æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª <code>Error</code> å¯¹è±¡, å³: æŠ›å‡ºä¸€ä¸ªé”™è¯¯, ç”¨æ¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ä»£ç , è¿™æ ·å°±å¯ä»¥æ ¹æ®å…·ä½“çš„æŠ›å‡ºé”™è¯¯ä¿¡æ¯å»è§£å†³é—®é¢˜å•¦.</p>\n<p>åœ¨ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ä¸­, <code>Math.random()</code> ç”¨æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°, åœ¨ 90% çš„æƒ…å†µä¸‹, è¿™ä¸ª Promise éƒ½åº”è¯¥è¢«æ‰§è¡Œ (å‡è®¾ç­‰æ¦‚ç‡åˆ†å¸ƒ), å‰©ä½™çš„æƒ…å†µä¸‹éƒ½æ˜¯æ‹’ç»æ‰§è¡Œçš„.</p>\n<h3 id=\"å¦‚ä½•ä½¿ç”¨-Promises\"><a href=\"#å¦‚ä½•ä½¿ç”¨-Promises\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨ Promises\"></a>å¦‚ä½•ä½¿ç”¨ Promises</h3><p>åœ¨ä¸Šé¢çš„ä»£ç ä¾‹å­ä¸­, æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª Promise å®ä¾‹ <code>myPromise</code>, é‚£ä¹ˆå¦‚ä½•é€šè¿‡ <code>resolve</code> å’Œ <code>reject</code> å‡½æ•°è®¿é—®è®¡ç®—å®Œæˆåçš„å€¼å‘¢? æ‰€æœ‰çš„ <code>Promise</code> å®ä¾‹éƒ½æœ‰ä¸€ä¸ª <code>.then()</code> æ–¹æ³•, æˆ‘ä»¬æ¥ç§ç§:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> myPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">Math</span>.random() * <span class=\"number\">100</span> &lt; <span class=\"number\">90</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'resolving the promise ...'</span>);</span><br><span class=\"line\">    resolve(<span class=\"string\">'Hello, Promises!'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  reject(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'In 10% of the cases, I fail. Miserably.'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Two functions</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> onResolved = <span class=\"function\"><span class=\"params\">resolvedValue</span> =&gt;</span> <span class=\"built_in\">console</span>.log(resolvedValue);</span><br><span class=\"line\"><span class=\"keyword\">const</span> onRejected = <span class=\"function\"><span class=\"params\">error</span> =&gt;</span> <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\"></span><br><span class=\"line\">myPromise.then(onResolved, onRejected);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Same as above, written concisely</span></span><br><span class=\"line\">myPromise.then(</span><br><span class=\"line\">  resolvedValue =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(resolvedValue);</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  error =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output (in 90% of the cases)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// resolving the promise ...</span></span><br><span class=\"line\"><span class=\"comment\">// Hello, Promises!</span></span><br><span class=\"line\"><span class=\"comment\">// Hello, Promises!</span></span><br></pre></td></tr></table></figure>\n<p><code>.then()</code> æ–¹æ³•æ¥æ”¶ 2 ä¸ªå›è°ƒå‡½æ•°, ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯å½“æˆ‘ä»¬çš„ Promise å®ä¾‹è¢«æ‰§è¡Œ (resolve) æ—¶è°ƒç”¨, ç¬¬äºŒä¸ªåˆ™æ˜¯è¢«æ‹’ç» (reject) æ—¶è°ƒç”¨. åœ¨ä¸Šé¢çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨ <code>onResolved</code> å’Œ <code>onRejected</code> å®šä¹‰äº†è¿™ä¸¤ä¸ªå‡½æ•°, ç„¶åæŠŠå®ƒæ”¾åˆ° <code>.then</code> å‡½æ•°é‡Œ, å½“ç„¶, ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å¸¸è§„å†™æ³•, ç›´æ¥åœ¨ <code>.then</code> å‡½æ•°é‡Œå†™ä¸¤ä¸ªå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„.</p>\n<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æœ‰å‡ ç‚¹éå¸¸é‡è¦, æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹:</p>\n<ul>\n<li>ä¸€ä¸ª <code>promise</code> åªèƒ½æ˜¯æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€ä¸­çš„ä¸€ä¸ª. å®ƒä¸èƒ½æˆåŠŸæˆ–è€…å¤±è´¥å¤šæ¬¡. ä¹Ÿä¸èƒ½ä»æˆåŠŸçŠ¶æ€åˆ‡æ¢åˆ°å¤±è´¥çŠ¶æ€, å¤±è´¥åä¹‹äº¦ç„¶.</li>\n<li>ä½ å¯ä»¥åœ¨æˆåŠŸæˆ–è€…å¤±è´¥çŠ¶æ€å, å»å®šä¹‰è¿™æ ·ä¸€ä¸ªå›è°ƒå‡½æ•°. å½“ä»–ä»¬ <code>resolve</code> æˆ–è€… <code>reject</code> ä»ç„¶èƒ½æ­£ç¡®è°ƒç”¨.</li>\n</ul>\n<p>è¿™å°±è¯´æ˜, <code>Promise</code> æœ€ç»ˆåªæœ‰ä¸€ä¸ªçŠ¶æ€, å³ä½¿ä½ å¤šæ¬¡ä½¿ç”¨ <code>.then</code> å¤„ç†å‡½æ•°, è¿™ä¸ªçŠ¶æ€ä¸èƒ½æ›´æ”¹ (è®¡ç®—ç»“æœä¹Ÿä¸ä¼šé‡å¤æ‰§è¡Œ).</p>\n<p>ä¸ºäº†éªŒè¯è¿™ç‚¹, ä½ å¯ä»¥çœ‹åˆ°åœ¨ç¬¬ 3 è¡Œä»£ç ä¸­, <code>console.log</code> è¯­å¥, å½“ä½ å¤šæ¬¡ä½¿ç”¨ <code>.then</code> å¤„ç†ç¨‹åºè¿è¡Œä¸Šè¿°ä»£ç æ—¶, <code>console.log</code> çš„è¯­å¥åªä¼šè¢«æ‰“å°ä¸€æ¬¡. è¿™å°±è¯´æ˜äº† Promise ä¼šç¼“å­˜è®¡ç®—ç»“æœçš„, å½“æœ‰ä¸€äº›ç›¸åŒçš„ç»“æœæ—¶, ç¼“å­˜ç»“æœä¼šè¢«è¿”å›.</p>\n<p>å¦ä¸€ä¸ªé‡è¦çš„è¦æ³¨æ„çš„æ˜¯, Promise æ˜¯ <a href=\"https://zh.wikipedia.org/wiki/%E5%8F%8A%E6%97%A9%E6%B1%82%E5%80%BC\" target=\"_blank\" rel=\"noopener\">åŠæ—©æ±‚å€¼ (evaluated eagerly)</a> çš„: åªè¦å£°æ˜å¹¶å°†å…¶èµ‹å€¼åˆ°å˜é‡ä¸Š, å®ƒå·²ç»å¼€å§‹åœ¨å†…å­˜ä¸­æ‰§è¡Œäº†. æ²¡æœ‰ <code>.start</code> æˆ– <code>.begin</code> æ–¹æ³•. å°±åƒå®ƒåœ¨å‰é¢çš„ä¾‹å­ä¸­å¼€å§‹çš„é‚£æ ·.</p>\n<p>ä¸ºäº†ç¡®ä¿ Promise èƒ½è¢«å»¶è¿Ÿè°ƒç”¨, æˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦åœ¨å®ƒçš„å¤–å±‚åŒ…è£¹ä¸€ä¸ªå‡½æ•°, ç¨åçš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šè§£é‡Šè¿™ä¸ª.</p>\n<h3 id=\"æ•è·-Promise\"><a href=\"#æ•è·-Promise\" class=\"headerlink\" title=\"æ•è· Promise\"></a>æ•è· Promise</h3><p>åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† <code>resolve</code> çš„åœºæ™¯, é‚£ä¹ˆå½“æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯æ—¶, ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢? åœ¨ <code>.then()</code> å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°, å°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ <code>onRejected</code> ä¼šè¢«æ‰§è¡Œ, æ¥çœ‹ä¸€ä¸ªä¾‹å­:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> myPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">Math</span>.random() * <span class=\"number\">100</span> &lt; <span class=\"number\">90</span>) &#123;</span><br><span class=\"line\">    reject(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'The promise was rejected by using reject function.'</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'The promise was rejected by throwing an error'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">myPromise.then(</span><br><span class=\"line\">  () =&gt; <span class=\"built_in\">console</span>.log(<span class=\"string\">'resolved'</span>),</span><br><span class=\"line\">  error =&gt; <span class=\"built_in\">console</span>.log(error.message)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output (in 90% of cases)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The promise was rejected by using reject function.</span></span><br></pre></td></tr></table></figure>\n<p>å’Œç¬¬ä¸€ä¸ªä¾‹å­ä¸€æ ·çš„, ä½†æ˜¯ç°åœ¨ 90% çš„æƒ…å†µæ˜¯è¢« <code>reject</code> çš„, å¦å¤– 10% çš„æƒ…å†µåˆ™æ˜¯æŠ›å‡ºä¸€ä¸ªé”™è¯¯è¯­å¥.</p>\n<p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† <code>onResolved</code> å’Œ <code>onRejected</code> æ–¹æ³•, <code>onRejected</code> æ–¹æ³•å°†åœ¨é”™è¯¯å‘ç”Ÿæ—¶è¢«è°ƒç”¨, å¯ä»¥çœ‹åˆ° <code>reject</code> å‡½æ•°çš„å‚æ•°å¯ä»¥ç›´æ¥æ˜¯é”™è¯¯æç¤º, æ²¡å¿…è¦å¿…é¡» <code>new Error</code>, ä¸¤ä¸ªå†™æ³•éƒ½ä¸€æ ·.</p>\n<p>å¥å£®çš„ç¨‹åºä»£ç ç¦»ä¸å¼€é”™è¯¯å¤„ç†, <code>.then</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ç»™äº†æˆ‘ä»¬è¿™æ ·ä¸€ä¸ªæ·å¾„. å½“éœ€è¦å¤„ç†ä¸€ä¸ªé”™è¯¯æ—¶, å¯ä»¥ç”¨ <code>.catch(onRejected)</code> æ¥ä»£æ›¿ <code>.then(null, () =&gt; {...})</code>, <code>catch</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•° <code>onRejected</code>, å› æ­¤, ä¸Šé¢çš„ä»£ç , å¯ä»¥ä½¿ç”¨ <code>catch</code> æ¥ç®€åŒ–å†™æ³•:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">myPromise.catch(<span class=\"function\"><span class=\"params\">error</span> =&gt;</span> <span class=\"built_in\">console</span>.log(error.message));</span><br></pre></td></tr></table></figure>\n<p>è®°ä½: <code>.catch</code> æ–¹æ³•ä»…ä»…æ˜¯ <code>.then(undefined, onRejected)</code> çš„è¯­æ³•ç³–è€Œå·².</p>\n<h3 id=\"é“¾å¼-Promise\"><a href=\"#é“¾å¼-Promise\" class=\"headerlink\" title=\"é“¾å¼ Promise\"></a>é“¾å¼ Promise</h3><p><code>.then()</code> å’Œ <code>.catch()</code> æ–¹æ³•æ°¸è¿œä¼šè¿”å›ä¸€ä¸ª Promise å®ä¾‹, æ‰€ä»¥ä½ å¯ä»¥é“¾å¼ä½¿ç”¨å¤šä¸ª <code>.then</code> ä¸€èµ·æ¥è°ƒç”¨. è®©æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£å®ƒ.</p>\n<p>é¦–å…ˆ, æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°, æ¥å»¶è¿Ÿè¿”å›ä¸€ä¸ª Promise å®ä¾‹. è¿™ä¸ªè¿”å›çš„ Promise å°†åœ¨ç¨åçš„æ—¶é—´å†… <code>resolve</code>. è¿™é‡Œæ˜¯å®ç°æ–¹æ³•:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> delay = <span class=\"function\"><span class=\"params\">ms</span> =&gt;</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br></pre></td></tr></table></figure>\n<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥åŒ…è£¹æˆ‘ä»¬çš„ Promise å®ä¾‹, æ‰€ä»¥å®ƒå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œ. è¿™ä¸ª <code>delay</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ—¶é—´æ¥ä½œä¸ºå‚æ•°. è¿™ä¸ªæ‰§è¡Œå‡½æ•°å°†æ¥æ”¶ <code>ms</code> ä½œä¸ºä»–çš„å‚æ•°, å®ƒè¿˜åŒ…å«ä¸€ä¸ª <code>setTimeout</code> , å®ƒåœ¨ <code>ms</code> æ¯«ç§’åè°ƒç”¨ <code>resolve</code> å‡½æ•°, ä»è€Œæ­£ç¡®æ‰§è¡Œ. çœ‹è¿™ä¸ªä¾‹å­:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">delay(<span class=\"number\">5000</span>).then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 5 seconds'</span>));</span><br></pre></td></tr></table></figure>\n<p><code>.then</code> ä¸­çš„å›è°ƒè¯­å¥å°†åœ¨ <code>delay(5000)</code> åæ‰§è¡Œ. å½“ä½ æ‰§è¡Œä¸Šé¢çš„ä»£ç  5 ç§’å, ä½ å°±å¯ä»¥åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°è¾“å‡ºç»“æœäº†.</p>\n<p>è¿™é‡Œ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ª <code>.then()</code> æ–¹æ³•æ¥é“¾å¼è°ƒç”¨:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> delay = <span class=\"function\"><span class=\"params\">ms</span> =&gt;</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br><span class=\"line\"></span><br><span class=\"line\">delay(<span class=\"number\">2000</span>)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 2 seconds'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delay(<span class=\"number\">1500</span>);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 1.5 seconds'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delay(<span class=\"number\">3000</span>);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Resolved after 3 seconds'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>();</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Caught an error.'</span>);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Done.'</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Resolved after 2 seconds</span></span><br><span class=\"line\"><span class=\"comment\">// Resolved after 1.5 seconds</span></span><br><span class=\"line\"><span class=\"comment\">// Resolved after 3 seconds</span></span><br><span class=\"line\"><span class=\"comment\">// Caught an error.</span></span><br><span class=\"line\"><span class=\"comment\">// Done.</span></span><br></pre></td></tr></table></figure>\n<p>ä»ç¬¬ 3 è¡Œå¼€å§‹, å®ƒçš„æ‰§è¡Œæ­¥éª¤æ˜¯è¿™æ ·çš„:</p>\n<ul>\n<li><code>delay(2000)</code> å‡½æ•°æ‰§è¡Œ, å®ƒè¿”å›ä¸€ä¸ªç¨å 2 ç§’å³å°†æ‰§è¡Œçš„ Promise å®ä¾‹.</li>\n<li>ç¬¬ 1 ä¸ª <code>.then()</code> æ‰§è¡Œ, å®ƒè¾“å‡ºè¯­å¥ <code>Resolved after 2 seconds</code>, ç„¶åå®ƒæ‰§è¡Œ <code>delay(1500)</code> åˆè¿”å›ä¸€ä¸ª Promise å®ä¾‹, å¦‚æœä¸€ä¸ª <code>.then()</code> è¿”å›äº†ä¸€ä¸ª Promise å®ä¾‹, é‚£ä¹ˆå®ƒçš„ <code>resolve</code> å°†è¢«è½¬å‘ç»™ä¸‹ä¸€ä¸ª <code>.then</code> æ–¹æ³•è°ƒç”¨, æŠ€æœ¯ä¸Šå«: æ²‰é™ (settlement).</li>\n<li>åªè¦åƒè¿™æ ·ç»§ç»­ä¸²è”ä¸‹å», å®ƒä¼šç»§ç»­æ‰§è¡Œ.</li>\n</ul>\n<p>æ³¨æ„åœ¨ç¬¬ä¸‰ä¸ª <code>.then()</code> æ–¹æ³•æ—¶, æˆ‘ä»¬åœ¨ <code>.then</code> ä¸­æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯. è¿™æ„å‘³ç€å½“å‰çš„ Promise è¢«æ‹’ç». ç„¶åå®ƒä¼šåœ¨ä¸‹ä¸€ä¸ª <code>.catch</code> è¯­å¥ä¸­è¢«æ•è·, <code>Caught an error</code> å°†ä¼šè¢«è¾“å‡º. ç„¶è€Œä¸€ä¸ª <code>.catch</code> è¯­å¥å®ƒè‡ªå·±æ°¸è¿œæ˜¯è¢« <code>resolve</code> çš„, æ‰€ä»¥ä¸éœ€è¦åœ¨è¯­å¥é‡Œå†å†™ <code>reject</code> (é™¤éä½ æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯), è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ <code>.catch</code> è¯­å¥åè¿˜å¯ä»¥ç»§ç»­å†™ <code>.then</code> çš„åŸå› .</p>\n<p>æ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯åœ¨ <code>.then</code> æ–¹æ³•åæ‰§è¡Œ <code>.catch</code> è€Œä¸æ˜¯ä½¿ç”¨ <code>onResolved</code> å’Œ <code>onRejected</code>, æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> promiseThatResolves = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">  <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    resolve();</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Leads to UnhandledPromiseRejection</span></span><br><span class=\"line\">promiseThatResolves().then(</span><br><span class=\"line\">  () =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>();</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  err =&gt; <span class=\"built_in\">console</span>.log(err)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Proper error handling</span></span><br><span class=\"line\">promiseThatResolves()</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>();</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> <span class=\"built_in\">console</span>.log(err));</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬åˆ›é€ ä¸€ä¸ªæ°¸è¿œèƒ½è¢« <code>resolve</code> çš„ Promise å®ä¾‹, å½“ä½ æ‰§è¡Œ <code>.then</code> æ—¶, å¯ä»¥å¸¦ä¸¤ä¸ªå›è°ƒå‡½æ•°: <code>onResolved</code> å’Œ <code>onRejected</code>, ç¬¬ä¸€ç§å†™æ³•, åœ¨ <code>then</code> ç§æ”¾å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°, ä½†æ˜¯: å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ç»§ç»­æŠ›å‡ºé”™è¯¯, é‚£ä¹ˆè¿™ä¸ªé”™è¯¯æ˜¯ä¸èƒ½è¢«æ•è·çš„. ğŸ˜…</p>\n<p>ç¬¬äºŒç§å†™æ³•, åœ¨ <code>.then</code> è¯­å¥çš„åé¢ä½¿ç”¨ <code>.catch</code> æ•è·, ä¸å…‰èƒ½æ•è·åˆ°æ‰§è¡Œå‡½æ•° <code>promiseThatResolves</code> çš„é”™è¯¯, è€Œä¸”åœ¨ <code>.then()</code> ä¸­çš„é”™è¯¯ä¹Ÿæ˜¯èƒ½è¢«æ•è·åˆ°. çŸ¥é“è¿™æ ·å†™çš„å¥½å¤„äº†å§!ğŸ˜</p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>ä½ å¯ä»¥æ‰§è¡Œä¸Šé¢çš„æ‰€æœ‰ä»£ç ç‰‡æ®µæ¥æ›´æ·±å…¥çš„å­¦ä¹ . ä¸€ç§æ¯”è¾ƒå¥½çš„å®è·µå°±æ˜¯, æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å‡½æ•°éƒ½ç”¨ Promise æ¥é‡æ–°å®ç°. å¦‚æœä½ å†™ Node.js çš„è¯, ä½ ä¼šå‘ç° <code>fs</code> è¿˜æœ‰å…¶ä»–æ¨¡å—éƒ½æ˜¯åŸºäºå›è°ƒå‡½æ•°æ¥å®ç°çš„. æ‰€ä»¥ä¼šå­˜åœ¨ä¸€äº›å·¥å…·åº“, å®ƒä»¬æŠŠæ‰€æœ‰åŸºäºå›è°ƒçš„å®ç°æ–¹å¼ä½¿ç”¨ Promise æ¥å®ç°äº†. æ¯”å¦‚ Node.js çš„ <a href=\"https://nodejs.org/api/util.html#util_util_promisify_original\" target=\"_blank\" rel=\"noopener\">util.promisify</a> å’Œ <a href=\"https://github.com/sindresorhus/pify\" target=\"_blank\" rel=\"noopener\">pify</a>. å¦‚æœä½ åœ¨å­¦ä¹ çš„è¯, é‚£ä¹ˆå°½å¯èƒ½çš„å°è¯•è‡ªå·±å»å®ç°. æˆ–è€…è¯´å»è¯»è¿™äº› Promise å®ç°åº“çš„æºä»£ç . ç„¶åä½ å°±å¯ä»¥æŠŠè¿™äº›æœ€ä½³å®è·µç”¨äºä½ çš„äº§å“ä¸­å•¦!</p>\n<p>è¿˜æœ‰ä¸€äº›å…³äº Promise çš„ä¸œè¥¿æ²¡æœ‰å®Œå…¨è®²åˆ°, æ¯”å¦‚ <code>Promise.all</code> å’Œ <code>Promise.race</code> æ–¹æ³•, å¤„ç† Promise ä¸­çš„é”™è¯¯, ä»¥åŠä¸€äº›å¸¸è§çš„åæ¨¡å¼å’Œç»†èŠ‚ç­‰. ä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥æ¥å­¦ä¹ æ›´å¤šå…³äº Promise çš„çŸ¥è¯†.</p>\n<h3 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h3><ul>\n<li><a href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects\" target=\"_blank\" rel=\"noopener\">ECMA Promise Specification</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\" target=\"_blank\" rel=\"noopener\">Mozilla Docs</a></li>\n<li><a href=\"https://developers.google.com/web/fundamentals/primers/promises#promise-api-reference\" target=\"_blank\" rel=\"noopener\">Googleâ€™s Developerâ€™s Guide on Promises written by Jake Archibald</a></li>\n<li><a href=\"http://exploringjs.com/es6/ch_promises.html#sec_first-example-promises\" target=\"_blank\" rel=\"noopener\">Exploring JSâ€™s Chapter on Promises</a></li>\n<li><a href=\"http://jamesknelson.com/grokking-es6-promises-the-four-functions-you-need-to-avoid-callback-hell/\" target=\"_blank\" rel=\"noopener\">Introduction to Promises</a></li>\n</ul>"},{"title":"Git æ“ä½œè¯¦ç»†æ€»ç»“","date":"2018-05-11T15:25:56.000Z","from":null,"comments":1,"_content":"\nGit æ“ä½œè¯¦ç»†æ€»ç»“ï¼Œä»¥ä¾¿å›é¡¾å’ŒæŸ¥è¯¢ã€‚ç†è§£è¿™äº›æŒ‡ä»¤ï¼Œè§‰å¾—æœ€é‡è¦çš„æ˜¯ç†è§£ Git çš„å†…éƒ¨åŸç†ï¼Œæ¯”å¦‚ Git çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ†æ¸…æ¥šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ï¼Œè¿˜æœ‰å°±æ˜¯ç†è§£ Git è·Ÿè¸ªå¹¶ç®¡ç†çš„æ˜¯ä¿®æ”¹ï¼Œè€Œéæ–‡ä»¶ã€‚\n\n<!-- more -->\n\n![image](https://user-images.githubusercontent.com/15377484/39952532-4c0c156e-55cb-11e8-8052-e62c448325fe.png)\n\n## è®¾ç½®\n\n```bash\ngit config --global user.name \"Your Name\"\ngit config --global user.email \"email@example.com\"\n```\n\n## æäº¤\n\nGit è¿½è¸ªçš„æ˜¯ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ã€‚\n\n![image](https://user-images.githubusercontent.com/15377484/39952534-5c10f236-55cb-11e8-81bf-c4d369d07054.png)\n\n```bash\n# å°† â€œå½“å‰ä¿®æ”¹â€ ç§»åŠ¨åˆ°æš‚å­˜åŒº (stage)\ngit add filename.txt\n\n# å°†æš‚å­˜åŒºä¿®æ”¹æäº¤\ngit commit -m \"Add filename.txt.\"\n```\n\n## çŠ¶æ€\n\n```bash\ngit status\ngit diff\n```\n\n## å›é€€\n\n```bash\n# æ”¾å¼ƒå·¥ä½œåŒºä¿®æ”¹\ngit checkout -- file.name\ngit checkout -- .\n\n# å–æ¶ˆ commit(æ¯”å¦‚éœ€è¦é‡å†™ commit ä¿¡æ¯)\ngit reset --soft HEAD\n\n# å–æ¶ˆ commitã€add(é‡æ–°æäº¤ä»£ç å’Œ commit)\ngit reset HEAD\ngit reset --mixed HEAD\n\n# å–æ¶ˆ commitã€addã€å·¥ä½œåŒºä¿®æ”¹ (éœ€è¦å®Œå…¨é‡ç½®)\ngit reset --hard HEAD\n```\n\n## è®°å½•\n\n```bash\ngit reflog\ngit log\n```\n\n## åˆ é™¤\n\n```bash\nrm file.name\ngit rm file.name\ngit commit -m \"Del\"\n```\n\n## è¿œç¨‹æ“ä½œ\n\n```bash\ngit remote add origin git@github.com:ifyour/ifyour.github.io.git\n\n# ç¬¬ä¸€æ¬¡æ¨é€ï¼Œ-u(--set-upstream) æŒ‡å®šé»˜è®¤ä¸Šæ¸¸\ngit push -u origin master\ngit push origin master\n```\n\n## å…‹éš†\n\n```bash\ngit clone https://github.com/ifyour/ifyour.github.io.git path\ngit clone git@github.com:ifyour/ifyour.github.io.git path\n```\n\n## åˆ†æ”¯æ“ä½œ\n\n![image](https://user-images.githubusercontent.com/15377484/39952537-6b679758-55cb-11e8-9ff7-87440fcbb4d0.png)\n\n```bash\n# æŸ¥çœ‹å½“å‰åˆ†æ”¯\ngit branch\n\n# åˆ›å»ºåˆ†æ”¯\ngit branch dev\n\n# åˆ‡æ¢åˆ†æ”¯\ngit checkout dev\n\n# åˆ›å»ºå¹¶ checkout åˆ†æ”¯\ngit checkout -b dev\n\n# åˆå¹¶åˆ†æ”¯\ngit merge dev\n\n# åˆ é™¤åˆ†æ”¯\ngit branch -d dev\n```\n\n## æ ‡ç­¾\n\n```bash\ngit tag 0.1.1\ngit push origin --tags\n```\n\n## More\n\n- [Git - ç®€æ˜“æŒ‡å—](http://www.bootcss.com/p/git-guide/)\n","source":"_posts/Git-æ“ä½œè¯¦ç»†æ€»ç»“.md","raw":"---\ntitle: Git æ“ä½œè¯¦ç»†æ€»ç»“\ndate: 2018-05-11 23:25:56\ntags:\nfrom:\ncomments: true\n---\n\nGit æ“ä½œè¯¦ç»†æ€»ç»“ï¼Œä»¥ä¾¿å›é¡¾å’ŒæŸ¥è¯¢ã€‚ç†è§£è¿™äº›æŒ‡ä»¤ï¼Œè§‰å¾—æœ€é‡è¦çš„æ˜¯ç†è§£ Git çš„å†…éƒ¨åŸç†ï¼Œæ¯”å¦‚ Git çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ†æ¸…æ¥šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ï¼Œè¿˜æœ‰å°±æ˜¯ç†è§£ Git è·Ÿè¸ªå¹¶ç®¡ç†çš„æ˜¯ä¿®æ”¹ï¼Œè€Œéæ–‡ä»¶ã€‚\n\n<!-- more -->\n\n![image](https://user-images.githubusercontent.com/15377484/39952532-4c0c156e-55cb-11e8-8052-e62c448325fe.png)\n\n## è®¾ç½®\n\n```bash\ngit config --global user.name \"Your Name\"\ngit config --global user.email \"email@example.com\"\n```\n\n## æäº¤\n\nGit è¿½è¸ªçš„æ˜¯ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ã€‚\n\n![image](https://user-images.githubusercontent.com/15377484/39952534-5c10f236-55cb-11e8-81bf-c4d369d07054.png)\n\n```bash\n# å°† â€œå½“å‰ä¿®æ”¹â€ ç§»åŠ¨åˆ°æš‚å­˜åŒº (stage)\ngit add filename.txt\n\n# å°†æš‚å­˜åŒºä¿®æ”¹æäº¤\ngit commit -m \"Add filename.txt.\"\n```\n\n## çŠ¶æ€\n\n```bash\ngit status\ngit diff\n```\n\n## å›é€€\n\n```bash\n# æ”¾å¼ƒå·¥ä½œåŒºä¿®æ”¹\ngit checkout -- file.name\ngit checkout -- .\n\n# å–æ¶ˆ commit(æ¯”å¦‚éœ€è¦é‡å†™ commit ä¿¡æ¯)\ngit reset --soft HEAD\n\n# å–æ¶ˆ commitã€add(é‡æ–°æäº¤ä»£ç å’Œ commit)\ngit reset HEAD\ngit reset --mixed HEAD\n\n# å–æ¶ˆ commitã€addã€å·¥ä½œåŒºä¿®æ”¹ (éœ€è¦å®Œå…¨é‡ç½®)\ngit reset --hard HEAD\n```\n\n## è®°å½•\n\n```bash\ngit reflog\ngit log\n```\n\n## åˆ é™¤\n\n```bash\nrm file.name\ngit rm file.name\ngit commit -m \"Del\"\n```\n\n## è¿œç¨‹æ“ä½œ\n\n```bash\ngit remote add origin git@github.com:ifyour/ifyour.github.io.git\n\n# ç¬¬ä¸€æ¬¡æ¨é€ï¼Œ-u(--set-upstream) æŒ‡å®šé»˜è®¤ä¸Šæ¸¸\ngit push -u origin master\ngit push origin master\n```\n\n## å…‹éš†\n\n```bash\ngit clone https://github.com/ifyour/ifyour.github.io.git path\ngit clone git@github.com:ifyour/ifyour.github.io.git path\n```\n\n## åˆ†æ”¯æ“ä½œ\n\n![image](https://user-images.githubusercontent.com/15377484/39952537-6b679758-55cb-11e8-9ff7-87440fcbb4d0.png)\n\n```bash\n# æŸ¥çœ‹å½“å‰åˆ†æ”¯\ngit branch\n\n# åˆ›å»ºåˆ†æ”¯\ngit branch dev\n\n# åˆ‡æ¢åˆ†æ”¯\ngit checkout dev\n\n# åˆ›å»ºå¹¶ checkout åˆ†æ”¯\ngit checkout -b dev\n\n# åˆå¹¶åˆ†æ”¯\ngit merge dev\n\n# åˆ é™¤åˆ†æ”¯\ngit branch -d dev\n```\n\n## æ ‡ç­¾\n\n```bash\ngit tag 0.1.1\ngit push origin --tags\n```\n\n## More\n\n- [Git - ç®€æ˜“æŒ‡å—](http://www.bootcss.com/p/git-guide/)\n","slug":"Git-æ“ä½œè¯¦ç»†æ€»ç»“","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidi60006u4q9ury1uqbh","content":"<p>Git æ“ä½œè¯¦ç»†æ€»ç»“ï¼Œä»¥ä¾¿å›é¡¾å’ŒæŸ¥è¯¢ã€‚ç†è§£è¿™äº›æŒ‡ä»¤ï¼Œè§‰å¾—æœ€é‡è¦çš„æ˜¯ç†è§£ Git çš„å†…éƒ¨åŸç†ï¼Œæ¯”å¦‚ Git çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ†æ¸…æ¥šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ï¼Œè¿˜æœ‰å°±æ˜¯ç†è§£ Git è·Ÿè¸ªå¹¶ç®¡ç†çš„æ˜¯ä¿®æ”¹ï¼Œè€Œéæ–‡ä»¶ã€‚</p>\n<a id=\"more\"></a>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39952532-4c0c156e-55cb-11e8-8052-e62c448325fe.png\" alt=\"image\"></p>\n<h2 id=\"è®¾ç½®\"><a href=\"#è®¾ç½®\" class=\"headerlink\" title=\"è®¾ç½®\"></a>è®¾ç½®</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">\"Your Name\"</span></span><br><span class=\"line\">git config --global user.email <span class=\"string\">\"email@example.com\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"æäº¤\"><a href=\"#æäº¤\" class=\"headerlink\" title=\"æäº¤\"></a>æäº¤</h2><p>Git è¿½è¸ªçš„æ˜¯ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ã€‚</p>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39952534-5c10f236-55cb-11e8-81bf-c4d369d07054.png\" alt=\"image\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å°† â€œå½“å‰ä¿®æ”¹â€ ç§»åŠ¨åˆ°æš‚å­˜åŒº (stage)</span></span><br><span class=\"line\">git add filename.txt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å°†æš‚å­˜åŒºä¿®æ”¹æäº¤</span></span><br><span class=\"line\">git commit -m <span class=\"string\">\"Add filename.txt.\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"çŠ¶æ€\"><a href=\"#çŠ¶æ€\" class=\"headerlink\" title=\"çŠ¶æ€\"></a>çŠ¶æ€</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git status</span><br><span class=\"line\">git diff</span><br></pre></td></tr></table></figure>\n<h2 id=\"å›é€€\"><a href=\"#å›é€€\" class=\"headerlink\" title=\"å›é€€\"></a>å›é€€</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ”¾å¼ƒå·¥ä½œåŒºä¿®æ”¹</span></span><br><span class=\"line\">git checkout -- file.name</span><br><span class=\"line\">git checkout -- .</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å–æ¶ˆ commit(æ¯”å¦‚éœ€è¦é‡å†™ commit ä¿¡æ¯)</span></span><br><span class=\"line\">git reset --soft HEAD</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å–æ¶ˆ commitã€add(é‡æ–°æäº¤ä»£ç å’Œ commit)</span></span><br><span class=\"line\">git reset HEAD</span><br><span class=\"line\">git reset --mixed HEAD</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å–æ¶ˆ commitã€addã€å·¥ä½œåŒºä¿®æ”¹ (éœ€è¦å®Œå…¨é‡ç½®)</span></span><br><span class=\"line\">git reset --hard HEAD</span><br></pre></td></tr></table></figure>\n<h2 id=\"è®°å½•\"><a href=\"#è®°å½•\" class=\"headerlink\" title=\"è®°å½•\"></a>è®°å½•</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git reflog</span><br><span class=\"line\">git <span class=\"built_in\">log</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"åˆ é™¤\"><a href=\"#åˆ é™¤\" class=\"headerlink\" title=\"åˆ é™¤\"></a>åˆ é™¤</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm file.name</span><br><span class=\"line\">git rm file.name</span><br><span class=\"line\">git commit -m <span class=\"string\">\"Del\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"è¿œç¨‹æ“ä½œ\"><a href=\"#è¿œç¨‹æ“ä½œ\" class=\"headerlink\" title=\"è¿œç¨‹æ“ä½œ\"></a>è¿œç¨‹æ“ä½œ</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin git@github.com:ifyour/ifyour.github.io.git</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¬¬ä¸€æ¬¡æ¨é€ï¼Œ-u(--set-upstream) æŒ‡å®šé»˜è®¤ä¸Šæ¸¸</span></span><br><span class=\"line\">git push -u origin master</span><br><span class=\"line\">git push origin master</span><br></pre></td></tr></table></figure>\n<h2 id=\"å…‹éš†\"><a href=\"#å…‹éš†\" class=\"headerlink\" title=\"å…‹éš†\"></a>å…‹éš†</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/ifyour/ifyour.github.io.git path</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> git@github.com:ifyour/ifyour.github.io.git path</span><br></pre></td></tr></table></figure>\n<h2 id=\"åˆ†æ”¯æ“ä½œ\"><a href=\"#åˆ†æ”¯æ“ä½œ\" class=\"headerlink\" title=\"åˆ†æ”¯æ“ä½œ\"></a>åˆ†æ”¯æ“ä½œ</h2><p><img src=\"https://user-images.githubusercontent.com/15377484/39952537-6b679758-55cb-11e8-9ff7-87440fcbb4d0.png\" alt=\"image\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æŸ¥çœ‹å½“å‰åˆ†æ”¯</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºåˆ†æ”¯</span></span><br><span class=\"line\">git branch dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ‡æ¢åˆ†æ”¯</span></span><br><span class=\"line\">git checkout dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶ checkout åˆ†æ”¯</span></span><br><span class=\"line\">git checkout -b dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆå¹¶åˆ†æ”¯</span></span><br><span class=\"line\">git merge dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ é™¤åˆ†æ”¯</span></span><br><span class=\"line\">git branch -d dev</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ ‡ç­¾\"><a href=\"#æ ‡ç­¾\" class=\"headerlink\" title=\"æ ‡ç­¾\"></a>æ ‡ç­¾</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag 0.1.1</span><br><span class=\"line\">git push origin --tags</span><br></pre></td></tr></table></figure>\n<h2 id=\"More\"><a href=\"#More\" class=\"headerlink\" title=\"More\"></a>More</h2><ul>\n<li><a href=\"http://www.bootcss.com/p/git-guide/\" target=\"_blank\" rel=\"noopener\">Git - ç®€æ˜“æŒ‡å—</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>Git æ“ä½œè¯¦ç»†æ€»ç»“ï¼Œä»¥ä¾¿å›é¡¾å’ŒæŸ¥è¯¢ã€‚ç†è§£è¿™äº›æŒ‡ä»¤ï¼Œè§‰å¾—æœ€é‡è¦çš„æ˜¯ç†è§£ Git çš„å†…éƒ¨åŸç†ï¼Œæ¯”å¦‚ Git çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ†æ¸…æ¥šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ï¼Œè¿˜æœ‰å°±æ˜¯ç†è§£ Git è·Ÿè¸ªå¹¶ç®¡ç†çš„æ˜¯ä¿®æ”¹ï¼Œè€Œéæ–‡ä»¶ã€‚</p>","more":"<p><img src=\"https://user-images.githubusercontent.com/15377484/39952532-4c0c156e-55cb-11e8-8052-e62c448325fe.png\" alt=\"image\"></p>\n<h2 id=\"è®¾ç½®\"><a href=\"#è®¾ç½®\" class=\"headerlink\" title=\"è®¾ç½®\"></a>è®¾ç½®</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">\"Your Name\"</span></span><br><span class=\"line\">git config --global user.email <span class=\"string\">\"email@example.com\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"æäº¤\"><a href=\"#æäº¤\" class=\"headerlink\" title=\"æäº¤\"></a>æäº¤</h2><p>Git è¿½è¸ªçš„æ˜¯ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ã€‚</p>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39952534-5c10f236-55cb-11e8-81bf-c4d369d07054.png\" alt=\"image\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å°† â€œå½“å‰ä¿®æ”¹â€ ç§»åŠ¨åˆ°æš‚å­˜åŒº (stage)</span></span><br><span class=\"line\">git add filename.txt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å°†æš‚å­˜åŒºä¿®æ”¹æäº¤</span></span><br><span class=\"line\">git commit -m <span class=\"string\">\"Add filename.txt.\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"çŠ¶æ€\"><a href=\"#çŠ¶æ€\" class=\"headerlink\" title=\"çŠ¶æ€\"></a>çŠ¶æ€</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git status</span><br><span class=\"line\">git diff</span><br></pre></td></tr></table></figure>\n<h2 id=\"å›é€€\"><a href=\"#å›é€€\" class=\"headerlink\" title=\"å›é€€\"></a>å›é€€</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ”¾å¼ƒå·¥ä½œåŒºä¿®æ”¹</span></span><br><span class=\"line\">git checkout -- file.name</span><br><span class=\"line\">git checkout -- .</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å–æ¶ˆ commit(æ¯”å¦‚éœ€è¦é‡å†™ commit ä¿¡æ¯)</span></span><br><span class=\"line\">git reset --soft HEAD</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å–æ¶ˆ commitã€add(é‡æ–°æäº¤ä»£ç å’Œ commit)</span></span><br><span class=\"line\">git reset HEAD</span><br><span class=\"line\">git reset --mixed HEAD</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å–æ¶ˆ commitã€addã€å·¥ä½œåŒºä¿®æ”¹ (éœ€è¦å®Œå…¨é‡ç½®)</span></span><br><span class=\"line\">git reset --hard HEAD</span><br></pre></td></tr></table></figure>\n<h2 id=\"è®°å½•\"><a href=\"#è®°å½•\" class=\"headerlink\" title=\"è®°å½•\"></a>è®°å½•</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git reflog</span><br><span class=\"line\">git <span class=\"built_in\">log</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"åˆ é™¤\"><a href=\"#åˆ é™¤\" class=\"headerlink\" title=\"åˆ é™¤\"></a>åˆ é™¤</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm file.name</span><br><span class=\"line\">git rm file.name</span><br><span class=\"line\">git commit -m <span class=\"string\">\"Del\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"è¿œç¨‹æ“ä½œ\"><a href=\"#è¿œç¨‹æ“ä½œ\" class=\"headerlink\" title=\"è¿œç¨‹æ“ä½œ\"></a>è¿œç¨‹æ“ä½œ</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin git@github.com:ifyour/ifyour.github.io.git</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¬¬ä¸€æ¬¡æ¨é€ï¼Œ-u(--set-upstream) æŒ‡å®šé»˜è®¤ä¸Šæ¸¸</span></span><br><span class=\"line\">git push -u origin master</span><br><span class=\"line\">git push origin master</span><br></pre></td></tr></table></figure>\n<h2 id=\"å…‹éš†\"><a href=\"#å…‹éš†\" class=\"headerlink\" title=\"å…‹éš†\"></a>å…‹éš†</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/ifyour/ifyour.github.io.git path</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> git@github.com:ifyour/ifyour.github.io.git path</span><br></pre></td></tr></table></figure>\n<h2 id=\"åˆ†æ”¯æ“ä½œ\"><a href=\"#åˆ†æ”¯æ“ä½œ\" class=\"headerlink\" title=\"åˆ†æ”¯æ“ä½œ\"></a>åˆ†æ”¯æ“ä½œ</h2><p><img src=\"https://user-images.githubusercontent.com/15377484/39952537-6b679758-55cb-11e8-9ff7-87440fcbb4d0.png\" alt=\"image\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æŸ¥çœ‹å½“å‰åˆ†æ”¯</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºåˆ†æ”¯</span></span><br><span class=\"line\">git branch dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ‡æ¢åˆ†æ”¯</span></span><br><span class=\"line\">git checkout dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶ checkout åˆ†æ”¯</span></span><br><span class=\"line\">git checkout -b dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆå¹¶åˆ†æ”¯</span></span><br><span class=\"line\">git merge dev</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ é™¤åˆ†æ”¯</span></span><br><span class=\"line\">git branch -d dev</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ ‡ç­¾\"><a href=\"#æ ‡ç­¾\" class=\"headerlink\" title=\"æ ‡ç­¾\"></a>æ ‡ç­¾</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag 0.1.1</span><br><span class=\"line\">git push origin --tags</span><br></pre></td></tr></table></figure>\n<h2 id=\"More\"><a href=\"#More\" class=\"headerlink\" title=\"More\"></a>More</h2><ul>\n<li><a href=\"http://www.bootcss.com/p/git-guide/\" target=\"_blank\" rel=\"noopener\">Git - ç®€æ˜“æŒ‡å—</a></li>\n</ul>"},{"title":"JavaScript ä¸­çš„ this ç”¨æ³•æ€»ç»“","date":"2016-02-19T11:23:36.000Z","comments":0,"_content":"\n`this` æ˜¯ Javascript è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ã€‚å®ƒä»£è¡¨å‡½æ•°è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚éšç€å‡½æ•°ä½¿ç”¨åœºåˆçš„ä¸åŒï¼Œ`this` çš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ€»çš„åŸåˆ™ï¼Œé‚£å°±æ˜¯ `this` æŒ‡çš„æ˜¯ï¼Œè°ƒç”¨å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚\n\n<!-- more -->\n### å››ç§æƒ…å†µ\n#### çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\n\n```js\n// eg:1\nconsole.log(this);// => window å¯¹è±¡\n\n// eg:2\nfunction fun(){\n    this.x = 1;\n}\nconsole.log(x); // => 1\n// this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œå³ DOM ä¸­çš„ window å¯¹è±¡\n```\n\n#### ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\n\n```js\nvar user = {\n    count: 1,\n\n    getCount: function() {\n        return this.count;\n    }\n};\n\nconsole.log(user.getCount());// 1\n// this æŒ‡å‘è°ƒç”¨ getCount æ–¹æ³•çš„å¯¹è±¡ user\n```\n\n#### ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\n```js\nvar x = 2;\n\nfunction fun(){\n    this.x = 1;\n}\n\nvar obj = new fun();\nconsole.log(obj.x); // => 1\nconsole.log(x); // => 2\n//this å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡ obj\n```\n\n#### apply/call è°ƒç”¨\n`apply()` æ˜¯å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ”¹å˜å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±è¡¨ç¤ºæ”¹å˜åçš„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ï¼Œæ— å‚æ•°æ—¶ä¼ å…¥ window å¯¹è±¡ã€‚å› æ­¤ï¼Œ`this` æŒ‡çš„å°±æ˜¯è¿™ç¬¬ä¸€ä¸ªå‚æ•°ã€‚\n```js\nvar x = 0;\n\nfunction fun(){\n    console.log(this.x);\n}\n\nvar obj = {};\nobj.x = 1;\nobj.m = fun;\n\nobj.m(); //           => 1  this æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡å³ï¼šobj\nobj.m.apply();  //    => 0  this æŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡å³ï¼šwindow\nobj.m.apply(obj);//   => 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj\nobj.m.call(obj);//    => 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj\n```\n\n### æ€»ç»“\n1. çº¯ç²¹çš„å‡½æ•°è°ƒç”¨: `this` å°±ä»£è¡¨å…¨å±€å¯¹è±¡ Globalï¼ˆæµè§ˆå™¨ä¸‹å°±æ˜¯ windowï¼‰\n2. ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨: `this` æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡\n3. ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼š`this` å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡\n4. `apply`, `call` è°ƒç”¨ï¼š`this` æŒ‡å‘å°±æ˜¯è¿™äº›å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°\n\nä¸‹ä¸€ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹ï¼š`apply`ã€`call`ã€`bind` çš„ç”¨æ³• :P\n","source":"_posts/JavaScript-ä¸­çš„-this-ç”¨æ³•æ€»ç»“.md","raw":"---\ntitle: JavaScript ä¸­çš„ this ç”¨æ³•æ€»ç»“\ndate: 2016-02-19 19:23:36\ntags:\ncomments: false\n---\n\n`this` æ˜¯ Javascript è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ã€‚å®ƒä»£è¡¨å‡½æ•°è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚éšç€å‡½æ•°ä½¿ç”¨åœºåˆçš„ä¸åŒï¼Œ`this` çš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ€»çš„åŸåˆ™ï¼Œé‚£å°±æ˜¯ `this` æŒ‡çš„æ˜¯ï¼Œè°ƒç”¨å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚\n\n<!-- more -->\n### å››ç§æƒ…å†µ\n#### çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\n\n```js\n// eg:1\nconsole.log(this);// => window å¯¹è±¡\n\n// eg:2\nfunction fun(){\n    this.x = 1;\n}\nconsole.log(x); // => 1\n// this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œå³ DOM ä¸­çš„ window å¯¹è±¡\n```\n\n#### ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\n\n```js\nvar user = {\n    count: 1,\n\n    getCount: function() {\n        return this.count;\n    }\n};\n\nconsole.log(user.getCount());// 1\n// this æŒ‡å‘è°ƒç”¨ getCount æ–¹æ³•çš„å¯¹è±¡ user\n```\n\n#### ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\n```js\nvar x = 2;\n\nfunction fun(){\n    this.x = 1;\n}\n\nvar obj = new fun();\nconsole.log(obj.x); // => 1\nconsole.log(x); // => 2\n//this å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡ obj\n```\n\n#### apply/call è°ƒç”¨\n`apply()` æ˜¯å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ”¹å˜å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±è¡¨ç¤ºæ”¹å˜åçš„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ï¼Œæ— å‚æ•°æ—¶ä¼ å…¥ window å¯¹è±¡ã€‚å› æ­¤ï¼Œ`this` æŒ‡çš„å°±æ˜¯è¿™ç¬¬ä¸€ä¸ªå‚æ•°ã€‚\n```js\nvar x = 0;\n\nfunction fun(){\n    console.log(this.x);\n}\n\nvar obj = {};\nobj.x = 1;\nobj.m = fun;\n\nobj.m(); //           => 1  this æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡å³ï¼šobj\nobj.m.apply();  //    => 0  this æŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡å³ï¼šwindow\nobj.m.apply(obj);//   => 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj\nobj.m.call(obj);//    => 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj\n```\n\n### æ€»ç»“\n1. çº¯ç²¹çš„å‡½æ•°è°ƒç”¨: `this` å°±ä»£è¡¨å…¨å±€å¯¹è±¡ Globalï¼ˆæµè§ˆå™¨ä¸‹å°±æ˜¯ windowï¼‰\n2. ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨: `this` æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡\n3. ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼š`this` å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡\n4. `apply`, `call` è°ƒç”¨ï¼š`this` æŒ‡å‘å°±æ˜¯è¿™äº›å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°\n\nä¸‹ä¸€ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹ï¼š`apply`ã€`call`ã€`bind` çš„ç”¨æ³• :P\n","slug":"JavaScript-ä¸­çš„-this-ç”¨æ³•æ€»ç»“","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidi90008u4q9aafcwebt","content":"<p><code>this</code> æ˜¯ Javascript è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ã€‚å®ƒä»£è¡¨å‡½æ•°è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚éšç€å‡½æ•°ä½¿ç”¨åœºåˆçš„ä¸åŒï¼Œ<code>this</code> çš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ€»çš„åŸåˆ™ï¼Œé‚£å°±æ˜¯ <code>this</code> æŒ‡çš„æ˜¯ï¼Œè°ƒç”¨å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚</p>\n<a id=\"more\"></a>\n<h3 id=\"å››ç§æƒ…å†µ\"><a href=\"#å››ç§æƒ…å†µ\" class=\"headerlink\" title=\"å››ç§æƒ…å†µ\"></a>å››ç§æƒ…å†µ</h3><h4 id=\"çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\"><a href=\"#çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\" class=\"headerlink\" title=\"çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\"></a>çº¯ç²¹çš„å‡½æ•°è°ƒç”¨</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// eg:1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>);<span class=\"comment\">// =&gt; window å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// eg:2</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fun</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.x = <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// =&gt; 1</span></span><br><span class=\"line\"><span class=\"comment\">// this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œå³ DOM ä¸­çš„ window å¯¹è±¡</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\"><a href=\"#ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\" class=\"headerlink\" title=\"ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\"></a>ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> user = &#123;</span><br><span class=\"line\">    count: <span class=\"number\">1</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">    getCount: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(user.getCount());<span class=\"comment\">// 1</span></span><br><span class=\"line\"><span class=\"comment\">// this æŒ‡å‘è°ƒç”¨ getCount æ–¹æ³•çš„å¯¹è±¡ user</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\"><a href=\"#ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\" class=\"headerlink\" title=\"ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\"></a>ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> x = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fun</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.x = <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = <span class=\"keyword\">new</span> fun();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.x); <span class=\"comment\">// =&gt; 1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// =&gt; 2</span></span><br><span class=\"line\"><span class=\"comment\">//this å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡ obj</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"apply-call-è°ƒç”¨\"><a href=\"#apply-call-è°ƒç”¨\" class=\"headerlink\" title=\"apply/call è°ƒç”¨\"></a>apply/call è°ƒç”¨</h4><p><code>apply()</code> æ˜¯å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ”¹å˜å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±è¡¨ç¤ºæ”¹å˜åçš„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ï¼Œæ— å‚æ•°æ—¶ä¼ å…¥ window å¯¹è±¡ã€‚å› æ­¤ï¼Œ<code>this</code> æŒ‡çš„å°±æ˜¯è¿™ç¬¬ä¸€ä¸ªå‚æ•°ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> x = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fun</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.x);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = &#123;&#125;;</span><br><span class=\"line\">obj.x = <span class=\"number\">1</span>;</span><br><span class=\"line\">obj.m = fun;</span><br><span class=\"line\"></span><br><span class=\"line\">obj.m(); <span class=\"comment\">//           =&gt; 1  this æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡å³ï¼šobj</span></span><br><span class=\"line\">obj.m.apply();  <span class=\"comment\">//    =&gt; 0  this æŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡å³ï¼šwindow</span></span><br><span class=\"line\">obj.m.apply(obj);<span class=\"comment\">//   =&gt; 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj</span></span><br><span class=\"line\">obj.m.call(obj);<span class=\"comment\">//    =&gt; 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><ol>\n<li>çº¯ç²¹çš„å‡½æ•°è°ƒç”¨: <code>this</code> å°±ä»£è¡¨å…¨å±€å¯¹è±¡ Globalï¼ˆæµè§ˆå™¨ä¸‹å°±æ˜¯ windowï¼‰</li>\n<li>ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨: <code>this</code> æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡</li>\n<li>ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼š<code>this</code> å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡</li>\n<li><code>apply</code>, <code>call</code> è°ƒç”¨ï¼š<code>this</code> æŒ‡å‘å°±æ˜¯è¿™äº›å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°</li>\n</ol>\n<p>ä¸‹ä¸€ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹ï¼š<code>apply</code>ã€<code>call</code>ã€<code>bind</code> çš„ç”¨æ³• :P</p>\n","site":{"data":{}},"excerpt":"<p><code>this</code> æ˜¯ Javascript è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ã€‚å®ƒä»£è¡¨å‡½æ•°è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚éšç€å‡½æ•°ä½¿ç”¨åœºåˆçš„ä¸åŒï¼Œ<code>this</code> çš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ€»çš„åŸåˆ™ï¼Œé‚£å°±æ˜¯ <code>this</code> æŒ‡çš„æ˜¯ï¼Œè°ƒç”¨å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚</p>","more":"<h3 id=\"å››ç§æƒ…å†µ\"><a href=\"#å››ç§æƒ…å†µ\" class=\"headerlink\" title=\"å››ç§æƒ…å†µ\"></a>å››ç§æƒ…å†µ</h3><h4 id=\"çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\"><a href=\"#çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\" class=\"headerlink\" title=\"çº¯ç²¹çš„å‡½æ•°è°ƒç”¨\"></a>çº¯ç²¹çš„å‡½æ•°è°ƒç”¨</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// eg:1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>);<span class=\"comment\">// =&gt; window å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// eg:2</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fun</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.x = <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// =&gt; 1</span></span><br><span class=\"line\"><span class=\"comment\">// this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œå³ DOM ä¸­çš„ window å¯¹è±¡</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\"><a href=\"#ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\" class=\"headerlink\" title=\"ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\"></a>ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> user = &#123;</span><br><span class=\"line\">    count: <span class=\"number\">1</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">    getCount: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(user.getCount());<span class=\"comment\">// 1</span></span><br><span class=\"line\"><span class=\"comment\">// this æŒ‡å‘è°ƒç”¨ getCount æ–¹æ³•çš„å¯¹è±¡ user</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\"><a href=\"#ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\" class=\"headerlink\" title=\"ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨\"></a>ä½œä¸ºæ„é€ å‡½æ•°çš„è°ƒç”¨</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> x = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fun</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.x = <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = <span class=\"keyword\">new</span> fun();</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.x); <span class=\"comment\">// =&gt; 1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// =&gt; 2</span></span><br><span class=\"line\"><span class=\"comment\">//this å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡ obj</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"apply-call-è°ƒç”¨\"><a href=\"#apply-call-è°ƒç”¨\" class=\"headerlink\" title=\"apply/call è°ƒç”¨\"></a>apply/call è°ƒç”¨</h4><p><code>apply()</code> æ˜¯å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ”¹å˜å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±è¡¨ç¤ºæ”¹å˜åçš„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ï¼Œæ— å‚æ•°æ—¶ä¼ å…¥ window å¯¹è±¡ã€‚å› æ­¤ï¼Œ<code>this</code> æŒ‡çš„å°±æ˜¯è¿™ç¬¬ä¸€ä¸ªå‚æ•°ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> x = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fun</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.x);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = &#123;&#125;;</span><br><span class=\"line\">obj.x = <span class=\"number\">1</span>;</span><br><span class=\"line\">obj.m = fun;</span><br><span class=\"line\"></span><br><span class=\"line\">obj.m(); <span class=\"comment\">//           =&gt; 1  this æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡å³ï¼šobj</span></span><br><span class=\"line\">obj.m.apply();  <span class=\"comment\">//    =&gt; 0  this æŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡å³ï¼šwindow</span></span><br><span class=\"line\">obj.m.apply(obj);<span class=\"comment\">//   =&gt; 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj</span></span><br><span class=\"line\">obj.m.call(obj);<span class=\"comment\">//    =&gt; 1  this æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå‚æ•°å³ï¼šobj</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><ol>\n<li>çº¯ç²¹çš„å‡½æ•°è°ƒç”¨: <code>this</code> å°±ä»£è¡¨å…¨å±€å¯¹è±¡ Globalï¼ˆæµè§ˆå™¨ä¸‹å°±æ˜¯ windowï¼‰</li>\n<li>ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨: <code>this</code> æŒ‡å‘è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡</li>\n<li>ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼š<code>this</code> å°±æŒ‡å‘æ„é€ å™¨åˆ›å»ºçš„æ–°å¯¹è±¡</li>\n<li><code>apply</code>, <code>call</code> è°ƒç”¨ï¼š<code>this</code> æŒ‡å‘å°±æ˜¯è¿™äº›å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°</li>\n</ol>\n<p>ä¸‹ä¸€ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹ï¼š<code>apply</code>ã€<code>call</code>ã€<code>bind</code> çš„ç”¨æ³• :P</p>"},{"title":"Node.JS å­¦ä¹ ç¬”è®° [01] -- å…¥é—¨","date":"2015-01-02T11:00:24.000Z","comments":0,"_content":"\næ•´ç†è®°å½• Node.js å­¦ä¹ ç¬”è®°ï¼Œä½œä¸ºå‰ç«¯äººå‘˜ï¼Œéå¸¸æœ‰å¿…è¦äº†è§£åç«¯çš„ä¸€äº›çŸ¥è¯†ï¼Œæ–¹ä¾¿ä¸åç«¯çš„åŒäº‹åä½œï¼Œæé«˜æ•ˆç‡ï¼Œæå¥½å‰ç«¯åï¼Œä¹Ÿå¯ä»¥å°è¯•å¾€åç«¯å‘å±•ï¼Œæˆä¸ºä¸€åå…¨æ ˆå·¥ç¨‹å¸ˆï¼:P\n<!-- more -->\n![](http://ww4.sinaimg.cn/mw690/6057861cgw1fb6vlzd7i7j20go08cjro.jpg)\n### Node.js ä»‹ç»\nNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚Node.js ä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼ I/O çš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚Node.js çš„åŒ…ç®¡ç†å™¨ npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿã€‚\n\n#### Node.js å’Œ JavaScript çš„åŒºåˆ«\n- Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è¿è¡Œ JavaScript çš„å¹³å°ï¼ŒåŸºäº ChromeV8 å¼•æ“ï¼Œæ˜¯å¯¹ JavaScript çš„å¢å¼ºï¼Œä½¿ JavaScript å…·å¤‡äº†æœåŠ¡å™¨è¯­è¨€çš„å¼€å‘èƒ½åŠ›ï¼Œæ¯”å¦‚æ“ä½œæ–‡ä»¶ã€è¯»å–ç³»ç»Ÿä¿¡æ¯ã€ç½‘ç»œä¼ è¾“ç­‰ã€‚\n- JavaScript æ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œåªè¦æœ‰ JavaScript å¼•æ“å°±èƒ½è¿è¡Œå¹¶ä¸”å¦‚æœJavaScriptè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨å¯¹JavaScriptåŠ å…¥äº†æµè§ˆå™¨å’Œæ–‡æ¡£æ“ä½œçš„æ¥å£ï¼ˆæ–¹æ³•ï¼‰ã€‚\n\n<div class=\"tip\">\nç®€å•ç†è§£ï¼šæµè§ˆå™¨ä¸­ JavaScript ä¸»è¦æ˜¯æ“ä½œ BOM å’Œ DOMï¼Œè€Œ Node.js åˆ™æ˜¯å…·æœ‰æœåŠ¡ç«¯è¯­è¨€å¤„ç†èƒ½åŠ›ï¼ˆå¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä¿å­˜æ•°æ®åˆ°æ•°æ®åº“ç­‰ï¼‰ã€‚\n</div>\n\n#### å®˜æ–¹ç½‘ç«™\n- è‹±æ–‡ç¤¾åŒºï¼š https://www.npmjs.com/\n- ä¸­æ–‡ç¤¾åŒºï¼šhttp://cnodejs.org/\n\n#### Node.js å®‰è£…åŠè¿è¡Œ\nåœ¨ Node.js çš„å®˜æ–¹æä¾›çš„[ä¸‹è½½é¢‘é“](https://nodejs.org/en/download/)é€‰æ‹©å¯¹åº”çš„å¹³å°åŠå®‰è£…ç¨‹åºå®‰è£…å³å¯ã€‚Node.js æä¾›äº† `REPLï¼ˆRead-Evaluate-Print-Loopï¼‰` æ¨¡å¼ï¼Œå³ ***äº¤äº’å¼å‘½ä»¤è¡Œè§£æå™¨***ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥å‘½ä»¤è¡Œï¼Œç¼–å†™ Node.js ä»£ç ã€‚å®‰è£…æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯é‡Œè¾“å…¥ `node -v` è·å–å½“å‰çš„ Node.js ç‰ˆæœ¬å·ï¼Œèƒ½è·å–è¡¨ç¤ºæˆåŠŸå®‰è£…ã€‚\n\n### Node.js æ¨¡å—\næ¨¡å—å¯¹äº Node.js æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¸€ä¸ªç‰¹å®šåŠŸèƒ½çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ã€‚æ¨¡å—ä¹‹é—´å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ª jQuery è½®æ’­çš„æ’ä»¶ï¼Œå®ƒå°±ä¾èµ– jQuery åº“ï¼Œåœ¨ Node.js ä¸­å¯ä»¥éå¸¸æ–¹ä¾¿çš„è¡¨ç¤ºæ¸…æ¥šè¿™ç§ä¾èµ–å…³ç³»ã€‚è¯´åˆ°æ¨¡å—ï¼Œè¿˜éœ€è¦è¯´ä¸€ä¸ªå°±æ˜¯ç¼–å†™æ¨¡å—çš„è§„èŒƒã€‚\n\n#### æ¨¡å—è§„èŒƒ\n- ***AMD*** (Asynchronous Module Definition)ï¼Œè¿™ç§è§„èŒƒæ˜¯å¼‚æ­¥çš„åŠ è½½æ¨¡å—ï¼ŒRequireR.js åº”ç”¨äº†è¿™ä¸€è§„èŒƒ,é€‚åˆå®¢æˆ·ç«¯æµè§ˆå™¨ç¯å¢ƒã€‚\n- ***CMD*** (Common Module Definition), æ˜¯ Sea.js æ¨å´‡çš„è§„èŒƒã€‚\n- ***CommonJS*** , æ˜¯è¯ç”Ÿæ¯”è¾ƒæ—©çš„ã€‚Node.js å°±é‡‡ç”¨äº† CommonJS çš„è§„èŒƒæ¥å®šä¹‰æ¨¡å—ã€‚ä½†æ˜¯ CommonJs é‡‡ç”¨çš„æ˜¯åŒæ­¥åŠ è½½æ–‡ä»¶æ–¹å¼ï¼Œåªé€‚ç”¨äºæœåŠ¡ç«¯ï¼ˆNode.jså¹³å°ï¼‰ã€‚\n\n#### ä½¿ç”¨æ¨¡å—\næ¨¡å—å®šä¹‰å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨æ¨¡å—ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ Node.js ä»¥å¯åŠ¨ç¨‹åºçš„æ¨¡å—è¢«ç§°ä¸º ***ä¸»æ¨¡å—***ã€‚ä¸»æ¨¡å—è´Ÿè´£è°ƒåº¦ç»„æˆæ•´ä¸ªç¨‹åºçš„å…¶å®ƒæ¨¡å—å®Œæˆå·¥ä½œã€‚å…¶å®å°±ç±»ä¼¼ç½‘ç«™ä¸­çš„ `index.html`ï¼ŒNode.js ä¸­çš„ä¸»æ¨¡å—é€šå¸¸æ˜¯ `main.js` æˆ–è€… `index.js`ã€‚\n```js\nvar http = require('http');// é€šè¿‡ require å¼•å…¥ http æ¨¡å—\n```\n\n#### æ¨¡å—ç»„æˆ\nåœ¨ä¸Šæ¡å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ require å¼•å…¥äº†ä¸€ä¸ª http æ¨¡å—ï¼Œå®é™…ä¸Šä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ–‡ä»¶ï¼ŒNode.js ä¸ºæˆ‘ä»¬åœ¨å¤–å±‚åµŒå¥—äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ­£å› ä¸ºæœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡å°±æ˜¯ç§æœ‰å˜é‡å•¦ï¼Œé‚£ä¹ˆæ¯ä¸ªæ¨¡å—ä¹‹é—´å°±ä¸ä¼šäº§ç”Ÿå¹²æ‰°äº†ã€‚é‚£ä¹ˆæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°é•¿ä»€ä¹ˆæ ·å­ã€‚\n```js\nfunction (exports, require, module, __filename, __dirname) {\n    var http = require('http');// é€šè¿‡ require å¼•å…¥ http æ¨¡å—\n}\n```\næœ€å¤–å±‚ï¼ŒNode.js ä¸ºæˆ‘ä»¬çš„ä»£ç åŒ…è£¹äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼ å…¥äº†å‡ ä¸ªå‚æ•°ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š\n- exports ï¼šç”¨äºåœ¨å½“å‰æ¨¡å—ä¸­åŠ è½½å’Œä½¿ç”¨åˆ«çš„æ¨¡å—ï¼Œä¼ å…¥ä¸€ä¸ªæ¨¡å—åï¼Œè¿”å›ä¸€ä¸ªæ¨¡å—å¯¼å‡ºå¯¹è±¡ã€‚\n- requireï¼šå½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ï¼Œç”¨äºå¯¼å‡ºæ¨¡å—å…¬æœ‰æ–¹æ³•å’Œå±æ€§ã€‚\n- moduleï¼šè®¿é—®åˆ°å½“å‰æ¨¡å—çš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œä½†æœ€å¤šçš„ç”¨é€”æ˜¯æ›¿æ¢å½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ã€‚\n- __filenameï¼šå½“å‰æ¨¡å—çš„æ–‡ä»¶å\n- __dirnameï¼šå½“å‰æ¨¡å—çš„ç›®å½•å\n\n#### æ¨¡å—åˆ†ç±»\nNode.js æä¾›ä¸¤ç§æ¨¡å—ç±»å‹ï¼š\n1. æ ¸å¿ƒæ¨¡å—ï¼šæ˜¯ç”± Node.js å¹³å°æä¾›çš„æ¨¡å—ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºâ€œç³»ç»Ÿæ¨¡å—â€ã€‚\n2. æ–‡ä»¶æ¨¡å—ï¼šä»¥ `..` æˆ– `.` å’Œ `/` å¼€å§‹çš„æ ‡è¯†ç¬¦ï¼Œè¿™é‡Œéƒ½è¢«å½“åšæ–‡ä»¶æ¨¡å—æ¥å¤„ç†ã€‚\n\n#### node_modules æ–‡ä»¶å¤¹\nè¯¥æ–‡ä»¶å¤¹æ˜¯ Node.js ä¸­çš„ç‰¹æ®Šæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ node æ¨¡å—ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—æ—¢ä¸æ˜¯ç³»ç»Ÿæ¨¡å—ï¼Œä¹Ÿä¸æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«å­˜æ”¾åœ¨ node_modules æ–‡ä»¶å¤¹ä¸­ã€‚ä½¿ç”¨ `console.log(module.paths);` å¯ä»¥æ‰“å° Node.js ä¼šéå†çš„ node_modules ç›®å½•ã€‚\n```js\n[ '/Users/wangmingming/Documents/Projects/JSstudy/12.26/node_modules',\n  '/Users/wangmingming/Documents/Projects/JSstudy/node_modules',\n  '/Users/wangmingming/Documents/Projects/node_modules',\n  '/Users/wangmingming/Documents/node_modules',\n  '/Users/wangmingming/node_modules',\n  '/Users/node_modules',\n  '/node_modules' ]\n```\n<div class=\"tip\">\nåœ¨è°ƒç”¨ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒNode.js æ²¿è·¯å¾„å‘ä¸Šé€çº§é€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„ node_modules ç›®å½•ã€‚CommonJS æ¨¡è§„èŒƒä¹Ÿå…è®¸åœ¨æ ‡è¯†ç¬¦ä¸­ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNode ä¼šæŒ‰ jsã€jsonã€node çš„æ¬¡åºè¡¥è¶³æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚\n</div>\n\n### åŒ… (Package)\næŠŠç”±å¤šä¸ªå­æ¨¡å—ç»„æˆçš„å¤§æ¨¡å—ç§°åšåŒ…ï¼Œå¹¶æŠŠæ‰€æœ‰å­æ¨¡å—æ”¾åœ¨åŒä¸€ä¸ªç›®å½•é‡Œã€‚åœ¨ä¸€ä¸ªåŒ…ä¸­ï¼Œä¼šç”¨ `package.json` æ–‡ä»¶ä¸­çš„ `main` å±æ€§ç”¨æ¥æè¿°è¿™ä¸ªåŒ…çš„ä¸»æ–‡ä»¶ã€‚\n\n#### NPM (Node Package Manager)\nå¤§åé¼é¼çš„ NPM å®é™…ä¸Šå°±æ˜¯ç”¨æ¥ç®¡ç†åŒ…çš„ä¸€ä¸ªå·¥å…·ï¼Œå€ŸåŠ© NPM æˆ‘ä»¬å¯ä»¥å¿«é€Ÿçš„å®‰è£…å’Œç®¡ç†ä¾èµ–åŒ…ã€‚ä¸‹é¢æ˜¯æˆ‘æ•´ç†çš„ npm å¸¸ç”¨å‘½ä»¤ã€‚\n```bash\nnpm init                   #  åˆå§‹åŒ–åŒ…ï¼Œè¦æ±‚å¡«å…¥åŒ…åç­‰ä¿¡æ¯\nnpm install <name>         #  æœ¬åœ°å®‰è£…ä¸€ä¸ªåŒ…\nnpm install <name> -g      #  å…¨å±€å®‰è£…ä¸€ä¸ªåŒ…\nnpm install <name> --save  #  æœ¬åœ°å®‰è£…å¹¶å†™å…¥ package.json ä¾èµ–ä¸­\nnpm remove <name>          #  ç§»é™¤\nnpm update <name>          #  æ›´æ–°\n\n```\n- æœ¬åœ°å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ `./node_modules` ä¸‹ï¼ˆè¿è¡Œ npm å‘½ä»¤æ—¶æ‰€åœ¨çš„ç›®å½•ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ node_modules ç›®å½•ï¼Œä¼šåœ¨å½“å‰æ‰§è¡Œ npm å‘½ä»¤çš„ç›®å½•ä¸‹ç”Ÿæˆ node_modules ç›®å½•ã€‚å¯ä»¥é€šè¿‡ `require()` æ¥å¼•å…¥æœ¬åœ°å®‰è£…çš„åŒ…ã€‚\n- å…¨å±€å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ `/usr/local` ä¸‹æˆ–è€…ä½  node çš„å®‰è£…ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œä½¿ç”¨ã€‚\n","source":"_posts/Node.JS-å­¦ä¹ ç¬”è®°-[01]----å…¥é—¨.md","raw":"---\ntitle: 'Node.JS å­¦ä¹ ç¬”è®° [01] -- å…¥é—¨'\ndate: 2015-1-2 19:00:24\ntags:\ncomments: false\n---\n\næ•´ç†è®°å½• Node.js å­¦ä¹ ç¬”è®°ï¼Œä½œä¸ºå‰ç«¯äººå‘˜ï¼Œéå¸¸æœ‰å¿…è¦äº†è§£åç«¯çš„ä¸€äº›çŸ¥è¯†ï¼Œæ–¹ä¾¿ä¸åç«¯çš„åŒäº‹åä½œï¼Œæé«˜æ•ˆç‡ï¼Œæå¥½å‰ç«¯åï¼Œä¹Ÿå¯ä»¥å°è¯•å¾€åç«¯å‘å±•ï¼Œæˆä¸ºä¸€åå…¨æ ˆå·¥ç¨‹å¸ˆï¼:P\n<!-- more -->\n![](http://ww4.sinaimg.cn/mw690/6057861cgw1fb6vlzd7i7j20go08cjro.jpg)\n### Node.js ä»‹ç»\nNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚Node.js ä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼ I/O çš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚Node.js çš„åŒ…ç®¡ç†å™¨ npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿã€‚\n\n#### Node.js å’Œ JavaScript çš„åŒºåˆ«\n- Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è¿è¡Œ JavaScript çš„å¹³å°ï¼ŒåŸºäº ChromeV8 å¼•æ“ï¼Œæ˜¯å¯¹ JavaScript çš„å¢å¼ºï¼Œä½¿ JavaScript å…·å¤‡äº†æœåŠ¡å™¨è¯­è¨€çš„å¼€å‘èƒ½åŠ›ï¼Œæ¯”å¦‚æ“ä½œæ–‡ä»¶ã€è¯»å–ç³»ç»Ÿä¿¡æ¯ã€ç½‘ç»œä¼ è¾“ç­‰ã€‚\n- JavaScript æ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œåªè¦æœ‰ JavaScript å¼•æ“å°±èƒ½è¿è¡Œå¹¶ä¸”å¦‚æœJavaScriptè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨å¯¹JavaScriptåŠ å…¥äº†æµè§ˆå™¨å’Œæ–‡æ¡£æ“ä½œçš„æ¥å£ï¼ˆæ–¹æ³•ï¼‰ã€‚\n\n<div class=\"tip\">\nç®€å•ç†è§£ï¼šæµè§ˆå™¨ä¸­ JavaScript ä¸»è¦æ˜¯æ“ä½œ BOM å’Œ DOMï¼Œè€Œ Node.js åˆ™æ˜¯å…·æœ‰æœåŠ¡ç«¯è¯­è¨€å¤„ç†èƒ½åŠ›ï¼ˆå¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä¿å­˜æ•°æ®åˆ°æ•°æ®åº“ç­‰ï¼‰ã€‚\n</div>\n\n#### å®˜æ–¹ç½‘ç«™\n- è‹±æ–‡ç¤¾åŒºï¼š https://www.npmjs.com/\n- ä¸­æ–‡ç¤¾åŒºï¼šhttp://cnodejs.org/\n\n#### Node.js å®‰è£…åŠè¿è¡Œ\nåœ¨ Node.js çš„å®˜æ–¹æä¾›çš„[ä¸‹è½½é¢‘é“](https://nodejs.org/en/download/)é€‰æ‹©å¯¹åº”çš„å¹³å°åŠå®‰è£…ç¨‹åºå®‰è£…å³å¯ã€‚Node.js æä¾›äº† `REPLï¼ˆRead-Evaluate-Print-Loopï¼‰` æ¨¡å¼ï¼Œå³ ***äº¤äº’å¼å‘½ä»¤è¡Œè§£æå™¨***ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥å‘½ä»¤è¡Œï¼Œç¼–å†™ Node.js ä»£ç ã€‚å®‰è£…æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯é‡Œè¾“å…¥ `node -v` è·å–å½“å‰çš„ Node.js ç‰ˆæœ¬å·ï¼Œèƒ½è·å–è¡¨ç¤ºæˆåŠŸå®‰è£…ã€‚\n\n### Node.js æ¨¡å—\næ¨¡å—å¯¹äº Node.js æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¸€ä¸ªç‰¹å®šåŠŸèƒ½çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ã€‚æ¨¡å—ä¹‹é—´å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ª jQuery è½®æ’­çš„æ’ä»¶ï¼Œå®ƒå°±ä¾èµ– jQuery åº“ï¼Œåœ¨ Node.js ä¸­å¯ä»¥éå¸¸æ–¹ä¾¿çš„è¡¨ç¤ºæ¸…æ¥šè¿™ç§ä¾èµ–å…³ç³»ã€‚è¯´åˆ°æ¨¡å—ï¼Œè¿˜éœ€è¦è¯´ä¸€ä¸ªå°±æ˜¯ç¼–å†™æ¨¡å—çš„è§„èŒƒã€‚\n\n#### æ¨¡å—è§„èŒƒ\n- ***AMD*** (Asynchronous Module Definition)ï¼Œè¿™ç§è§„èŒƒæ˜¯å¼‚æ­¥çš„åŠ è½½æ¨¡å—ï¼ŒRequireR.js åº”ç”¨äº†è¿™ä¸€è§„èŒƒ,é€‚åˆå®¢æˆ·ç«¯æµè§ˆå™¨ç¯å¢ƒã€‚\n- ***CMD*** (Common Module Definition), æ˜¯ Sea.js æ¨å´‡çš„è§„èŒƒã€‚\n- ***CommonJS*** , æ˜¯è¯ç”Ÿæ¯”è¾ƒæ—©çš„ã€‚Node.js å°±é‡‡ç”¨äº† CommonJS çš„è§„èŒƒæ¥å®šä¹‰æ¨¡å—ã€‚ä½†æ˜¯ CommonJs é‡‡ç”¨çš„æ˜¯åŒæ­¥åŠ è½½æ–‡ä»¶æ–¹å¼ï¼Œåªé€‚ç”¨äºæœåŠ¡ç«¯ï¼ˆNode.jså¹³å°ï¼‰ã€‚\n\n#### ä½¿ç”¨æ¨¡å—\næ¨¡å—å®šä¹‰å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨æ¨¡å—ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ Node.js ä»¥å¯åŠ¨ç¨‹åºçš„æ¨¡å—è¢«ç§°ä¸º ***ä¸»æ¨¡å—***ã€‚ä¸»æ¨¡å—è´Ÿè´£è°ƒåº¦ç»„æˆæ•´ä¸ªç¨‹åºçš„å…¶å®ƒæ¨¡å—å®Œæˆå·¥ä½œã€‚å…¶å®å°±ç±»ä¼¼ç½‘ç«™ä¸­çš„ `index.html`ï¼ŒNode.js ä¸­çš„ä¸»æ¨¡å—é€šå¸¸æ˜¯ `main.js` æˆ–è€… `index.js`ã€‚\n```js\nvar http = require('http');// é€šè¿‡ require å¼•å…¥ http æ¨¡å—\n```\n\n#### æ¨¡å—ç»„æˆ\nåœ¨ä¸Šæ¡å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ require å¼•å…¥äº†ä¸€ä¸ª http æ¨¡å—ï¼Œå®é™…ä¸Šä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ–‡ä»¶ï¼ŒNode.js ä¸ºæˆ‘ä»¬åœ¨å¤–å±‚åµŒå¥—äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ­£å› ä¸ºæœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡å°±æ˜¯ç§æœ‰å˜é‡å•¦ï¼Œé‚£ä¹ˆæ¯ä¸ªæ¨¡å—ä¹‹é—´å°±ä¸ä¼šäº§ç”Ÿå¹²æ‰°äº†ã€‚é‚£ä¹ˆæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°é•¿ä»€ä¹ˆæ ·å­ã€‚\n```js\nfunction (exports, require, module, __filename, __dirname) {\n    var http = require('http');// é€šè¿‡ require å¼•å…¥ http æ¨¡å—\n}\n```\næœ€å¤–å±‚ï¼ŒNode.js ä¸ºæˆ‘ä»¬çš„ä»£ç åŒ…è£¹äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼ å…¥äº†å‡ ä¸ªå‚æ•°ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š\n- exports ï¼šç”¨äºåœ¨å½“å‰æ¨¡å—ä¸­åŠ è½½å’Œä½¿ç”¨åˆ«çš„æ¨¡å—ï¼Œä¼ å…¥ä¸€ä¸ªæ¨¡å—åï¼Œè¿”å›ä¸€ä¸ªæ¨¡å—å¯¼å‡ºå¯¹è±¡ã€‚\n- requireï¼šå½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ï¼Œç”¨äºå¯¼å‡ºæ¨¡å—å…¬æœ‰æ–¹æ³•å’Œå±æ€§ã€‚\n- moduleï¼šè®¿é—®åˆ°å½“å‰æ¨¡å—çš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œä½†æœ€å¤šçš„ç”¨é€”æ˜¯æ›¿æ¢å½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ã€‚\n- __filenameï¼šå½“å‰æ¨¡å—çš„æ–‡ä»¶å\n- __dirnameï¼šå½“å‰æ¨¡å—çš„ç›®å½•å\n\n#### æ¨¡å—åˆ†ç±»\nNode.js æä¾›ä¸¤ç§æ¨¡å—ç±»å‹ï¼š\n1. æ ¸å¿ƒæ¨¡å—ï¼šæ˜¯ç”± Node.js å¹³å°æä¾›çš„æ¨¡å—ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºâ€œç³»ç»Ÿæ¨¡å—â€ã€‚\n2. æ–‡ä»¶æ¨¡å—ï¼šä»¥ `..` æˆ– `.` å’Œ `/` å¼€å§‹çš„æ ‡è¯†ç¬¦ï¼Œè¿™é‡Œéƒ½è¢«å½“åšæ–‡ä»¶æ¨¡å—æ¥å¤„ç†ã€‚\n\n#### node_modules æ–‡ä»¶å¤¹\nè¯¥æ–‡ä»¶å¤¹æ˜¯ Node.js ä¸­çš„ç‰¹æ®Šæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ node æ¨¡å—ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—æ—¢ä¸æ˜¯ç³»ç»Ÿæ¨¡å—ï¼Œä¹Ÿä¸æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«å­˜æ”¾åœ¨ node_modules æ–‡ä»¶å¤¹ä¸­ã€‚ä½¿ç”¨ `console.log(module.paths);` å¯ä»¥æ‰“å° Node.js ä¼šéå†çš„ node_modules ç›®å½•ã€‚\n```js\n[ '/Users/wangmingming/Documents/Projects/JSstudy/12.26/node_modules',\n  '/Users/wangmingming/Documents/Projects/JSstudy/node_modules',\n  '/Users/wangmingming/Documents/Projects/node_modules',\n  '/Users/wangmingming/Documents/node_modules',\n  '/Users/wangmingming/node_modules',\n  '/Users/node_modules',\n  '/node_modules' ]\n```\n<div class=\"tip\">\nåœ¨è°ƒç”¨ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒNode.js æ²¿è·¯å¾„å‘ä¸Šé€çº§é€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„ node_modules ç›®å½•ã€‚CommonJS æ¨¡è§„èŒƒä¹Ÿå…è®¸åœ¨æ ‡è¯†ç¬¦ä¸­ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNode ä¼šæŒ‰ jsã€jsonã€node çš„æ¬¡åºè¡¥è¶³æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚\n</div>\n\n### åŒ… (Package)\næŠŠç”±å¤šä¸ªå­æ¨¡å—ç»„æˆçš„å¤§æ¨¡å—ç§°åšåŒ…ï¼Œå¹¶æŠŠæ‰€æœ‰å­æ¨¡å—æ”¾åœ¨åŒä¸€ä¸ªç›®å½•é‡Œã€‚åœ¨ä¸€ä¸ªåŒ…ä¸­ï¼Œä¼šç”¨ `package.json` æ–‡ä»¶ä¸­çš„ `main` å±æ€§ç”¨æ¥æè¿°è¿™ä¸ªåŒ…çš„ä¸»æ–‡ä»¶ã€‚\n\n#### NPM (Node Package Manager)\nå¤§åé¼é¼çš„ NPM å®é™…ä¸Šå°±æ˜¯ç”¨æ¥ç®¡ç†åŒ…çš„ä¸€ä¸ªå·¥å…·ï¼Œå€ŸåŠ© NPM æˆ‘ä»¬å¯ä»¥å¿«é€Ÿçš„å®‰è£…å’Œç®¡ç†ä¾èµ–åŒ…ã€‚ä¸‹é¢æ˜¯æˆ‘æ•´ç†çš„ npm å¸¸ç”¨å‘½ä»¤ã€‚\n```bash\nnpm init                   #  åˆå§‹åŒ–åŒ…ï¼Œè¦æ±‚å¡«å…¥åŒ…åç­‰ä¿¡æ¯\nnpm install <name>         #  æœ¬åœ°å®‰è£…ä¸€ä¸ªåŒ…\nnpm install <name> -g      #  å…¨å±€å®‰è£…ä¸€ä¸ªåŒ…\nnpm install <name> --save  #  æœ¬åœ°å®‰è£…å¹¶å†™å…¥ package.json ä¾èµ–ä¸­\nnpm remove <name>          #  ç§»é™¤\nnpm update <name>          #  æ›´æ–°\n\n```\n- æœ¬åœ°å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ `./node_modules` ä¸‹ï¼ˆè¿è¡Œ npm å‘½ä»¤æ—¶æ‰€åœ¨çš„ç›®å½•ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ node_modules ç›®å½•ï¼Œä¼šåœ¨å½“å‰æ‰§è¡Œ npm å‘½ä»¤çš„ç›®å½•ä¸‹ç”Ÿæˆ node_modules ç›®å½•ã€‚å¯ä»¥é€šè¿‡ `require()` æ¥å¼•å…¥æœ¬åœ°å®‰è£…çš„åŒ…ã€‚\n- å…¨å±€å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ `/usr/local` ä¸‹æˆ–è€…ä½  node çš„å®‰è£…ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œä½¿ç”¨ã€‚\n","slug":"Node.JS-å­¦ä¹ ç¬”è®°-[01]----å…¥é—¨","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidib0009u4q9rz5lvwff","content":"<p>æ•´ç†è®°å½• Node.js å­¦ä¹ ç¬”è®°ï¼Œä½œä¸ºå‰ç«¯äººå‘˜ï¼Œéå¸¸æœ‰å¿…è¦äº†è§£åç«¯çš„ä¸€äº›çŸ¥è¯†ï¼Œæ–¹ä¾¿ä¸åç«¯çš„åŒäº‹åä½œï¼Œæé«˜æ•ˆç‡ï¼Œæå¥½å‰ç«¯åï¼Œä¹Ÿå¯ä»¥å°è¯•å¾€åç«¯å‘å±•ï¼Œæˆä¸ºä¸€åå…¨æ ˆå·¥ç¨‹å¸ˆï¼:P<br><a id=\"more\"></a><br><img src=\"http://ww4.sinaimg.cn/mw690/6057861cgw1fb6vlzd7i7j20go08cjro.jpg\" alt=\"\"></p>\n<h3 id=\"Node-js-ä»‹ç»\"><a href=\"#Node-js-ä»‹ç»\" class=\"headerlink\" title=\"Node.js ä»‹ç»\"></a>Node.js ä»‹ç»</h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚Node.js ä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼ I/O çš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚Node.js çš„åŒ…ç®¡ç†å™¨ npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿã€‚</p>\n<h4 id=\"Node-js-å’Œ-JavaScript-çš„åŒºåˆ«\"><a href=\"#Node-js-å’Œ-JavaScript-çš„åŒºåˆ«\" class=\"headerlink\" title=\"Node.js å’Œ JavaScript çš„åŒºåˆ«\"></a>Node.js å’Œ JavaScript çš„åŒºåˆ«</h4><ul>\n<li>Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è¿è¡Œ JavaScript çš„å¹³å°ï¼ŒåŸºäº ChromeV8 å¼•æ“ï¼Œæ˜¯å¯¹ JavaScript çš„å¢å¼ºï¼Œä½¿ JavaScript å…·å¤‡äº†æœåŠ¡å™¨è¯­è¨€çš„å¼€å‘èƒ½åŠ›ï¼Œæ¯”å¦‚æ“ä½œæ–‡ä»¶ã€è¯»å–ç³»ç»Ÿä¿¡æ¯ã€ç½‘ç»œä¼ è¾“ç­‰ã€‚</li>\n<li>JavaScript æ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œåªè¦æœ‰ JavaScript å¼•æ“å°±èƒ½è¿è¡Œå¹¶ä¸”å¦‚æœJavaScriptè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨å¯¹JavaScriptåŠ å…¥äº†æµè§ˆå™¨å’Œæ–‡æ¡£æ“ä½œçš„æ¥å£ï¼ˆæ–¹æ³•ï¼‰ã€‚</li>\n</ul>\n<div class=\"tip\"><br>ç®€å•ç†è§£ï¼šæµè§ˆå™¨ä¸­ JavaScript ä¸»è¦æ˜¯æ“ä½œ BOM å’Œ DOMï¼Œè€Œ Node.js åˆ™æ˜¯å…·æœ‰æœåŠ¡ç«¯è¯­è¨€å¤„ç†èƒ½åŠ›ï¼ˆå¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä¿å­˜æ•°æ®åˆ°æ•°æ®åº“ç­‰ï¼‰ã€‚<br></div>\n\n<h4 id=\"å®˜æ–¹ç½‘ç«™\"><a href=\"#å®˜æ–¹ç½‘ç«™\" class=\"headerlink\" title=\"å®˜æ–¹ç½‘ç«™\"></a>å®˜æ–¹ç½‘ç«™</h4><ul>\n<li>è‹±æ–‡ç¤¾åŒºï¼š <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener\">https://www.npmjs.com/</a></li>\n<li>ä¸­æ–‡ç¤¾åŒºï¼š<a href=\"http://cnodejs.org/\" target=\"_blank\" rel=\"noopener\">http://cnodejs.org/</a></li>\n</ul>\n<h4 id=\"Node-js-å®‰è£…åŠè¿è¡Œ\"><a href=\"#Node-js-å®‰è£…åŠè¿è¡Œ\" class=\"headerlink\" title=\"Node.js å®‰è£…åŠè¿è¡Œ\"></a>Node.js å®‰è£…åŠè¿è¡Œ</h4><p>åœ¨ Node.js çš„å®˜æ–¹æä¾›çš„<a href=\"https://nodejs.org/en/download/\" target=\"_blank\" rel=\"noopener\">ä¸‹è½½é¢‘é“</a>é€‰æ‹©å¯¹åº”çš„å¹³å°åŠå®‰è£…ç¨‹åºå®‰è£…å³å¯ã€‚Node.js æä¾›äº† <code>REPLï¼ˆRead-Evaluate-Print-Loopï¼‰</code> æ¨¡å¼ï¼Œå³ <strong><em>äº¤äº’å¼å‘½ä»¤è¡Œè§£æå™¨</em></strong>ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥å‘½ä»¤è¡Œï¼Œç¼–å†™ Node.js ä»£ç ã€‚å®‰è£…æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯é‡Œè¾“å…¥ <code>node -v</code> è·å–å½“å‰çš„ Node.js ç‰ˆæœ¬å·ï¼Œèƒ½è·å–è¡¨ç¤ºæˆåŠŸå®‰è£…ã€‚</p>\n<h3 id=\"Node-js-æ¨¡å—\"><a href=\"#Node-js-æ¨¡å—\" class=\"headerlink\" title=\"Node.js æ¨¡å—\"></a>Node.js æ¨¡å—</h3><p>æ¨¡å—å¯¹äº Node.js æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¸€ä¸ªç‰¹å®šåŠŸèƒ½çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ã€‚æ¨¡å—ä¹‹é—´å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ª jQuery è½®æ’­çš„æ’ä»¶ï¼Œå®ƒå°±ä¾èµ– jQuery åº“ï¼Œåœ¨ Node.js ä¸­å¯ä»¥éå¸¸æ–¹ä¾¿çš„è¡¨ç¤ºæ¸…æ¥šè¿™ç§ä¾èµ–å…³ç³»ã€‚è¯´åˆ°æ¨¡å—ï¼Œè¿˜éœ€è¦è¯´ä¸€ä¸ªå°±æ˜¯ç¼–å†™æ¨¡å—çš„è§„èŒƒã€‚</p>\n<h4 id=\"æ¨¡å—è§„èŒƒ\"><a href=\"#æ¨¡å—è§„èŒƒ\" class=\"headerlink\" title=\"æ¨¡å—è§„èŒƒ\"></a>æ¨¡å—è§„èŒƒ</h4><ul>\n<li><strong><em>AMD</em></strong> (Asynchronous Module Definition)ï¼Œè¿™ç§è§„èŒƒæ˜¯å¼‚æ­¥çš„åŠ è½½æ¨¡å—ï¼ŒRequireR.js åº”ç”¨äº†è¿™ä¸€è§„èŒƒ,é€‚åˆå®¢æˆ·ç«¯æµè§ˆå™¨ç¯å¢ƒã€‚</li>\n<li><strong><em>CMD</em></strong> (Common Module Definition), æ˜¯ Sea.js æ¨å´‡çš„è§„èŒƒã€‚</li>\n<li><strong><em>CommonJS</em></strong> , æ˜¯è¯ç”Ÿæ¯”è¾ƒæ—©çš„ã€‚Node.js å°±é‡‡ç”¨äº† CommonJS çš„è§„èŒƒæ¥å®šä¹‰æ¨¡å—ã€‚ä½†æ˜¯ CommonJs é‡‡ç”¨çš„æ˜¯åŒæ­¥åŠ è½½æ–‡ä»¶æ–¹å¼ï¼Œåªé€‚ç”¨äºæœåŠ¡ç«¯ï¼ˆNode.jså¹³å°ï¼‰ã€‚</li>\n</ul>\n<h4 id=\"ä½¿ç”¨æ¨¡å—\"><a href=\"#ä½¿ç”¨æ¨¡å—\" class=\"headerlink\" title=\"ä½¿ç”¨æ¨¡å—\"></a>ä½¿ç”¨æ¨¡å—</h4><p>æ¨¡å—å®šä¹‰å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨æ¨¡å—ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ Node.js ä»¥å¯åŠ¨ç¨‹åºçš„æ¨¡å—è¢«ç§°ä¸º <strong><em>ä¸»æ¨¡å—</em></strong>ã€‚ä¸»æ¨¡å—è´Ÿè´£è°ƒåº¦ç»„æˆæ•´ä¸ªç¨‹åºçš„å…¶å®ƒæ¨¡å—å®Œæˆå·¥ä½œã€‚å…¶å®å°±ç±»ä¼¼ç½‘ç«™ä¸­çš„ <code>index.html</code>ï¼ŒNode.js ä¸­çš„ä¸»æ¨¡å—é€šå¸¸æ˜¯ <code>main.js</code> æˆ–è€… <code>index.js</code>ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);<span class=\"comment\">// é€šè¿‡ require å¼•å…¥ http æ¨¡å—</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"æ¨¡å—ç»„æˆ\"><a href=\"#æ¨¡å—ç»„æˆ\" class=\"headerlink\" title=\"æ¨¡å—ç»„æˆ\"></a>æ¨¡å—ç»„æˆ</h4><p>åœ¨ä¸Šæ¡å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ require å¼•å…¥äº†ä¸€ä¸ª http æ¨¡å—ï¼Œå®é™…ä¸Šä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ–‡ä»¶ï¼ŒNode.js ä¸ºæˆ‘ä»¬åœ¨å¤–å±‚åµŒå¥—äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ­£å› ä¸ºæœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡å°±æ˜¯ç§æœ‰å˜é‡å•¦ï¼Œé‚£ä¹ˆæ¯ä¸ªæ¨¡å—ä¹‹é—´å°±ä¸ä¼šäº§ç”Ÿå¹²æ‰°äº†ã€‚é‚£ä¹ˆæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°é•¿ä»€ä¹ˆæ ·å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">exports, require, module, __filename, __dirname</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);<span class=\"comment\">// é€šè¿‡ require å¼•å…¥ http æ¨¡å—</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>æœ€å¤–å±‚ï¼ŒNode.js ä¸ºæˆ‘ä»¬çš„ä»£ç åŒ…è£¹äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼ å…¥äº†å‡ ä¸ªå‚æ•°ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š</p>\n<ul>\n<li>exports ï¼šç”¨äºåœ¨å½“å‰æ¨¡å—ä¸­åŠ è½½å’Œä½¿ç”¨åˆ«çš„æ¨¡å—ï¼Œä¼ å…¥ä¸€ä¸ªæ¨¡å—åï¼Œè¿”å›ä¸€ä¸ªæ¨¡å—å¯¼å‡ºå¯¹è±¡ã€‚</li>\n<li>requireï¼šå½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ï¼Œç”¨äºå¯¼å‡ºæ¨¡å—å…¬æœ‰æ–¹æ³•å’Œå±æ€§ã€‚</li>\n<li>moduleï¼šè®¿é—®åˆ°å½“å‰æ¨¡å—çš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œä½†æœ€å¤šçš„ç”¨é€”æ˜¯æ›¿æ¢å½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ã€‚</li>\n<li>__filenameï¼šå½“å‰æ¨¡å—çš„æ–‡ä»¶å</li>\n<li>__dirnameï¼šå½“å‰æ¨¡å—çš„ç›®å½•å</li>\n</ul>\n<h4 id=\"æ¨¡å—åˆ†ç±»\"><a href=\"#æ¨¡å—åˆ†ç±»\" class=\"headerlink\" title=\"æ¨¡å—åˆ†ç±»\"></a>æ¨¡å—åˆ†ç±»</h4><p>Node.js æä¾›ä¸¤ç§æ¨¡å—ç±»å‹ï¼š</p>\n<ol>\n<li>æ ¸å¿ƒæ¨¡å—ï¼šæ˜¯ç”± Node.js å¹³å°æä¾›çš„æ¨¡å—ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºâ€œç³»ç»Ÿæ¨¡å—â€ã€‚</li>\n<li>æ–‡ä»¶æ¨¡å—ï¼šä»¥ <code>..</code> æˆ– <code>.</code> å’Œ <code>/</code> å¼€å§‹çš„æ ‡è¯†ç¬¦ï¼Œè¿™é‡Œéƒ½è¢«å½“åšæ–‡ä»¶æ¨¡å—æ¥å¤„ç†ã€‚</li>\n</ol>\n<h4 id=\"node-modules-æ–‡ä»¶å¤¹\"><a href=\"#node-modules-æ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"node_modules æ–‡ä»¶å¤¹\"></a>node_modules æ–‡ä»¶å¤¹</h4><p>è¯¥æ–‡ä»¶å¤¹æ˜¯ Node.js ä¸­çš„ç‰¹æ®Šæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ node æ¨¡å—ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—æ—¢ä¸æ˜¯ç³»ç»Ÿæ¨¡å—ï¼Œä¹Ÿä¸æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«å­˜æ”¾åœ¨ node_modules æ–‡ä»¶å¤¹ä¸­ã€‚ä½¿ç”¨ <code>console.log(module.paths);</code> å¯ä»¥æ‰“å° Node.js ä¼šéå†çš„ node_modules ç›®å½•ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ <span class=\"string\">'/Users/wangmingming/Documents/Projects/JSstudy/12.26/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/Documents/Projects/JSstudy/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/Documents/Projects/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/Documents/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/node_modules'</span> ]</span><br></pre></td></tr></table></figure></p>\n<div class=\"tip\"><br>åœ¨è°ƒç”¨ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒNode.js æ²¿è·¯å¾„å‘ä¸Šé€çº§é€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„ node_modules ç›®å½•ã€‚CommonJS æ¨¡è§„èŒƒä¹Ÿå…è®¸åœ¨æ ‡è¯†ç¬¦ä¸­ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNode ä¼šæŒ‰ jsã€jsonã€node çš„æ¬¡åºè¡¥è¶³æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚<br></div>\n\n<h3 id=\"åŒ…-Package\"><a href=\"#åŒ…-Package\" class=\"headerlink\" title=\"åŒ… (Package)\"></a>åŒ… (Package)</h3><p>æŠŠç”±å¤šä¸ªå­æ¨¡å—ç»„æˆçš„å¤§æ¨¡å—ç§°åšåŒ…ï¼Œå¹¶æŠŠæ‰€æœ‰å­æ¨¡å—æ”¾åœ¨åŒä¸€ä¸ªç›®å½•é‡Œã€‚åœ¨ä¸€ä¸ªåŒ…ä¸­ï¼Œä¼šç”¨ <code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>main</code> å±æ€§ç”¨æ¥æè¿°è¿™ä¸ªåŒ…çš„ä¸»æ–‡ä»¶ã€‚</p>\n<h4 id=\"NPM-Node-Package-Manager\"><a href=\"#NPM-Node-Package-Manager\" class=\"headerlink\" title=\"NPM (Node Package Manager)\"></a>NPM (Node Package Manager)</h4><p>å¤§åé¼é¼çš„ NPM å®é™…ä¸Šå°±æ˜¯ç”¨æ¥ç®¡ç†åŒ…çš„ä¸€ä¸ªå·¥å…·ï¼Œå€ŸåŠ© NPM æˆ‘ä»¬å¯ä»¥å¿«é€Ÿçš„å®‰è£…å’Œç®¡ç†ä¾èµ–åŒ…ã€‚ä¸‹é¢æ˜¯æˆ‘æ•´ç†çš„ npm å¸¸ç”¨å‘½ä»¤ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init                   <span class=\"comment\">#  åˆå§‹åŒ–åŒ…ï¼Œè¦æ±‚å¡«å…¥åŒ…åç­‰ä¿¡æ¯</span></span><br><span class=\"line\">npm install &lt;name&gt;         <span class=\"comment\">#  æœ¬åœ°å®‰è£…ä¸€ä¸ªåŒ…</span></span><br><span class=\"line\">npm install &lt;name&gt; -g      <span class=\"comment\">#  å…¨å±€å®‰è£…ä¸€ä¸ªåŒ…</span></span><br><span class=\"line\">npm install &lt;name&gt; --save  <span class=\"comment\">#  æœ¬åœ°å®‰è£…å¹¶å†™å…¥ package.json ä¾èµ–ä¸­</span></span><br><span class=\"line\">npm remove &lt;name&gt;          <span class=\"comment\">#  ç§»é™¤</span></span><br><span class=\"line\">npm update &lt;name&gt;          <span class=\"comment\">#  æ›´æ–°</span></span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>æœ¬åœ°å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ <code>./node_modules</code> ä¸‹ï¼ˆè¿è¡Œ npm å‘½ä»¤æ—¶æ‰€åœ¨çš„ç›®å½•ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ node_modules ç›®å½•ï¼Œä¼šåœ¨å½“å‰æ‰§è¡Œ npm å‘½ä»¤çš„ç›®å½•ä¸‹ç”Ÿæˆ node_modules ç›®å½•ã€‚å¯ä»¥é€šè¿‡ <code>require()</code> æ¥å¼•å…¥æœ¬åœ°å®‰è£…çš„åŒ…ã€‚</li>\n<li>å…¨å±€å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ <code>/usr/local</code> ä¸‹æˆ–è€…ä½  node çš„å®‰è£…ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œä½¿ç”¨ã€‚</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>æ•´ç†è®°å½• Node.js å­¦ä¹ ç¬”è®°ï¼Œä½œä¸ºå‰ç«¯äººå‘˜ï¼Œéå¸¸æœ‰å¿…è¦äº†è§£åç«¯çš„ä¸€äº›çŸ¥è¯†ï¼Œæ–¹ä¾¿ä¸åç«¯çš„åŒäº‹åä½œï¼Œæé«˜æ•ˆç‡ï¼Œæå¥½å‰ç«¯åï¼Œä¹Ÿå¯ä»¥å°è¯•å¾€åç«¯å‘å±•ï¼Œæˆä¸ºä¸€åå…¨æ ˆå·¥ç¨‹å¸ˆï¼:P<br>","more":"<br><img src=\"http://ww4.sinaimg.cn/mw690/6057861cgw1fb6vlzd7i7j20go08cjro.jpg\" alt=\"\"></p>\n<h3 id=\"Node-js-ä»‹ç»\"><a href=\"#Node-js-ä»‹ç»\" class=\"headerlink\" title=\"Node.js ä»‹ç»\"></a>Node.js ä»‹ç»</h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚Node.js ä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€éé˜»å¡å¼ I/O çš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚Node.js çš„åŒ…ç®¡ç†å™¨ npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿã€‚</p>\n<h4 id=\"Node-js-å’Œ-JavaScript-çš„åŒºåˆ«\"><a href=\"#Node-js-å’Œ-JavaScript-çš„åŒºåˆ«\" class=\"headerlink\" title=\"Node.js å’Œ JavaScript çš„åŒºåˆ«\"></a>Node.js å’Œ JavaScript çš„åŒºåˆ«</h4><ul>\n<li>Node.js æ˜¯ä¸€ä¸ªå¯ä»¥è¿è¡Œ JavaScript çš„å¹³å°ï¼ŒåŸºäº ChromeV8 å¼•æ“ï¼Œæ˜¯å¯¹ JavaScript çš„å¢å¼ºï¼Œä½¿ JavaScript å…·å¤‡äº†æœåŠ¡å™¨è¯­è¨€çš„å¼€å‘èƒ½åŠ›ï¼Œæ¯”å¦‚æ“ä½œæ–‡ä»¶ã€è¯»å–ç³»ç»Ÿä¿¡æ¯ã€ç½‘ç»œä¼ è¾“ç­‰ã€‚</li>\n<li>JavaScript æ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œåªè¦æœ‰ JavaScript å¼•æ“å°±èƒ½è¿è¡Œå¹¶ä¸”å¦‚æœJavaScriptè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨å¯¹JavaScriptåŠ å…¥äº†æµè§ˆå™¨å’Œæ–‡æ¡£æ“ä½œçš„æ¥å£ï¼ˆæ–¹æ³•ï¼‰ã€‚</li>\n</ul>\n<div class=\"tip\"><br>ç®€å•ç†è§£ï¼šæµè§ˆå™¨ä¸­ JavaScript ä¸»è¦æ˜¯æ“ä½œ BOM å’Œ DOMï¼Œè€Œ Node.js åˆ™æ˜¯å…·æœ‰æœåŠ¡ç«¯è¯­è¨€å¤„ç†èƒ½åŠ›ï¼ˆå¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä¿å­˜æ•°æ®åˆ°æ•°æ®åº“ç­‰ï¼‰ã€‚<br></div>\n\n<h4 id=\"å®˜æ–¹ç½‘ç«™\"><a href=\"#å®˜æ–¹ç½‘ç«™\" class=\"headerlink\" title=\"å®˜æ–¹ç½‘ç«™\"></a>å®˜æ–¹ç½‘ç«™</h4><ul>\n<li>è‹±æ–‡ç¤¾åŒºï¼š <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener\">https://www.npmjs.com/</a></li>\n<li>ä¸­æ–‡ç¤¾åŒºï¼š<a href=\"http://cnodejs.org/\" target=\"_blank\" rel=\"noopener\">http://cnodejs.org/</a></li>\n</ul>\n<h4 id=\"Node-js-å®‰è£…åŠè¿è¡Œ\"><a href=\"#Node-js-å®‰è£…åŠè¿è¡Œ\" class=\"headerlink\" title=\"Node.js å®‰è£…åŠè¿è¡Œ\"></a>Node.js å®‰è£…åŠè¿è¡Œ</h4><p>åœ¨ Node.js çš„å®˜æ–¹æä¾›çš„<a href=\"https://nodejs.org/en/download/\" target=\"_blank\" rel=\"noopener\">ä¸‹è½½é¢‘é“</a>é€‰æ‹©å¯¹åº”çš„å¹³å°åŠå®‰è£…ç¨‹åºå®‰è£…å³å¯ã€‚Node.js æä¾›äº† <code>REPLï¼ˆRead-Evaluate-Print-Loopï¼‰</code> æ¨¡å¼ï¼Œå³ <strong><em>äº¤äº’å¼å‘½ä»¤è¡Œè§£æå™¨</em></strong>ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥å‘½ä»¤è¡Œï¼Œç¼–å†™ Node.js ä»£ç ã€‚å®‰è£…æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯é‡Œè¾“å…¥ <code>node -v</code> è·å–å½“å‰çš„ Node.js ç‰ˆæœ¬å·ï¼Œèƒ½è·å–è¡¨ç¤ºæˆåŠŸå®‰è£…ã€‚</p>\n<h3 id=\"Node-js-æ¨¡å—\"><a href=\"#Node-js-æ¨¡å—\" class=\"headerlink\" title=\"Node.js æ¨¡å—\"></a>Node.js æ¨¡å—</h3><p>æ¨¡å—å¯¹äº Node.js æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¸€ä¸ªç‰¹å®šåŠŸèƒ½çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ã€‚æ¨¡å—ä¹‹é—´å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ª jQuery è½®æ’­çš„æ’ä»¶ï¼Œå®ƒå°±ä¾èµ– jQuery åº“ï¼Œåœ¨ Node.js ä¸­å¯ä»¥éå¸¸æ–¹ä¾¿çš„è¡¨ç¤ºæ¸…æ¥šè¿™ç§ä¾èµ–å…³ç³»ã€‚è¯´åˆ°æ¨¡å—ï¼Œè¿˜éœ€è¦è¯´ä¸€ä¸ªå°±æ˜¯ç¼–å†™æ¨¡å—çš„è§„èŒƒã€‚</p>\n<h4 id=\"æ¨¡å—è§„èŒƒ\"><a href=\"#æ¨¡å—è§„èŒƒ\" class=\"headerlink\" title=\"æ¨¡å—è§„èŒƒ\"></a>æ¨¡å—è§„èŒƒ</h4><ul>\n<li><strong><em>AMD</em></strong> (Asynchronous Module Definition)ï¼Œè¿™ç§è§„èŒƒæ˜¯å¼‚æ­¥çš„åŠ è½½æ¨¡å—ï¼ŒRequireR.js åº”ç”¨äº†è¿™ä¸€è§„èŒƒ,é€‚åˆå®¢æˆ·ç«¯æµè§ˆå™¨ç¯å¢ƒã€‚</li>\n<li><strong><em>CMD</em></strong> (Common Module Definition), æ˜¯ Sea.js æ¨å´‡çš„è§„èŒƒã€‚</li>\n<li><strong><em>CommonJS</em></strong> , æ˜¯è¯ç”Ÿæ¯”è¾ƒæ—©çš„ã€‚Node.js å°±é‡‡ç”¨äº† CommonJS çš„è§„èŒƒæ¥å®šä¹‰æ¨¡å—ã€‚ä½†æ˜¯ CommonJs é‡‡ç”¨çš„æ˜¯åŒæ­¥åŠ è½½æ–‡ä»¶æ–¹å¼ï¼Œåªé€‚ç”¨äºæœåŠ¡ç«¯ï¼ˆNode.jså¹³å°ï¼‰ã€‚</li>\n</ul>\n<h4 id=\"ä½¿ç”¨æ¨¡å—\"><a href=\"#ä½¿ç”¨æ¨¡å—\" class=\"headerlink\" title=\"ä½¿ç”¨æ¨¡å—\"></a>ä½¿ç”¨æ¨¡å—</h4><p>æ¨¡å—å®šä¹‰å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨æ¨¡å—ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ Node.js ä»¥å¯åŠ¨ç¨‹åºçš„æ¨¡å—è¢«ç§°ä¸º <strong><em>ä¸»æ¨¡å—</em></strong>ã€‚ä¸»æ¨¡å—è´Ÿè´£è°ƒåº¦ç»„æˆæ•´ä¸ªç¨‹åºçš„å…¶å®ƒæ¨¡å—å®Œæˆå·¥ä½œã€‚å…¶å®å°±ç±»ä¼¼ç½‘ç«™ä¸­çš„ <code>index.html</code>ï¼ŒNode.js ä¸­çš„ä¸»æ¨¡å—é€šå¸¸æ˜¯ <code>main.js</code> æˆ–è€… <code>index.js</code>ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);<span class=\"comment\">// é€šè¿‡ require å¼•å…¥ http æ¨¡å—</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"æ¨¡å—ç»„æˆ\"><a href=\"#æ¨¡å—ç»„æˆ\" class=\"headerlink\" title=\"æ¨¡å—ç»„æˆ\"></a>æ¨¡å—ç»„æˆ</h4><p>åœ¨ä¸Šæ¡å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ require å¼•å…¥äº†ä¸€ä¸ª http æ¨¡å—ï¼Œå®é™…ä¸Šä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ–‡ä»¶ï¼ŒNode.js ä¸ºæˆ‘ä»¬åœ¨å¤–å±‚åµŒå¥—äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ­£å› ä¸ºæœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡å°±æ˜¯ç§æœ‰å˜é‡å•¦ï¼Œé‚£ä¹ˆæ¯ä¸ªæ¨¡å—ä¹‹é—´å°±ä¸ä¼šäº§ç”Ÿå¹²æ‰°äº†ã€‚é‚£ä¹ˆæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°é•¿ä»€ä¹ˆæ ·å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">exports, require, module, __filename, __dirname</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);<span class=\"comment\">// é€šè¿‡ require å¼•å…¥ http æ¨¡å—</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>æœ€å¤–å±‚ï¼ŒNode.js ä¸ºæˆ‘ä»¬çš„ä»£ç åŒ…è£¹äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼ å…¥äº†å‡ ä¸ªå‚æ•°ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š</p>\n<ul>\n<li>exports ï¼šç”¨äºåœ¨å½“å‰æ¨¡å—ä¸­åŠ è½½å’Œä½¿ç”¨åˆ«çš„æ¨¡å—ï¼Œä¼ å…¥ä¸€ä¸ªæ¨¡å—åï¼Œè¿”å›ä¸€ä¸ªæ¨¡å—å¯¼å‡ºå¯¹è±¡ã€‚</li>\n<li>requireï¼šå½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ï¼Œç”¨äºå¯¼å‡ºæ¨¡å—å…¬æœ‰æ–¹æ³•å’Œå±æ€§ã€‚</li>\n<li>moduleï¼šè®¿é—®åˆ°å½“å‰æ¨¡å—çš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œä½†æœ€å¤šçš„ç”¨é€”æ˜¯æ›¿æ¢å½“å‰æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ã€‚</li>\n<li>__filenameï¼šå½“å‰æ¨¡å—çš„æ–‡ä»¶å</li>\n<li>__dirnameï¼šå½“å‰æ¨¡å—çš„ç›®å½•å</li>\n</ul>\n<h4 id=\"æ¨¡å—åˆ†ç±»\"><a href=\"#æ¨¡å—åˆ†ç±»\" class=\"headerlink\" title=\"æ¨¡å—åˆ†ç±»\"></a>æ¨¡å—åˆ†ç±»</h4><p>Node.js æä¾›ä¸¤ç§æ¨¡å—ç±»å‹ï¼š</p>\n<ol>\n<li>æ ¸å¿ƒæ¨¡å—ï¼šæ˜¯ç”± Node.js å¹³å°æä¾›çš„æ¨¡å—ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºâ€œç³»ç»Ÿæ¨¡å—â€ã€‚</li>\n<li>æ–‡ä»¶æ¨¡å—ï¼šä»¥ <code>..</code> æˆ– <code>.</code> å’Œ <code>/</code> å¼€å§‹çš„æ ‡è¯†ç¬¦ï¼Œè¿™é‡Œéƒ½è¢«å½“åšæ–‡ä»¶æ¨¡å—æ¥å¤„ç†ã€‚</li>\n</ol>\n<h4 id=\"node-modules-æ–‡ä»¶å¤¹\"><a href=\"#node-modules-æ–‡ä»¶å¤¹\" class=\"headerlink\" title=\"node_modules æ–‡ä»¶å¤¹\"></a>node_modules æ–‡ä»¶å¤¹</h4><p>è¯¥æ–‡ä»¶å¤¹æ˜¯ Node.js ä¸­çš„ç‰¹æ®Šæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ node æ¨¡å—ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—æ—¢ä¸æ˜¯ç³»ç»Ÿæ¨¡å—ï¼Œä¹Ÿä¸æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«å­˜æ”¾åœ¨ node_modules æ–‡ä»¶å¤¹ä¸­ã€‚ä½¿ç”¨ <code>console.log(module.paths);</code> å¯ä»¥æ‰“å° Node.js ä¼šéå†çš„ node_modules ç›®å½•ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ <span class=\"string\">'/Users/wangmingming/Documents/Projects/JSstudy/12.26/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/Documents/Projects/JSstudy/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/Documents/Projects/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/Documents/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/wangmingming/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/Users/node_modules'</span>,</span><br><span class=\"line\">  <span class=\"string\">'/node_modules'</span> ]</span><br></pre></td></tr></table></figure></p>\n<div class=\"tip\"><br>åœ¨è°ƒç”¨ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒNode.js æ²¿è·¯å¾„å‘ä¸Šé€çº§é€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„ node_modules ç›®å½•ã€‚CommonJS æ¨¡è§„èŒƒä¹Ÿå…è®¸åœ¨æ ‡è¯†ç¬¦ä¸­ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNode ä¼šæŒ‰ jsã€jsonã€node çš„æ¬¡åºè¡¥è¶³æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚<br></div>\n\n<h3 id=\"åŒ…-Package\"><a href=\"#åŒ…-Package\" class=\"headerlink\" title=\"åŒ… (Package)\"></a>åŒ… (Package)</h3><p>æŠŠç”±å¤šä¸ªå­æ¨¡å—ç»„æˆçš„å¤§æ¨¡å—ç§°åšåŒ…ï¼Œå¹¶æŠŠæ‰€æœ‰å­æ¨¡å—æ”¾åœ¨åŒä¸€ä¸ªç›®å½•é‡Œã€‚åœ¨ä¸€ä¸ªåŒ…ä¸­ï¼Œä¼šç”¨ <code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>main</code> å±æ€§ç”¨æ¥æè¿°è¿™ä¸ªåŒ…çš„ä¸»æ–‡ä»¶ã€‚</p>\n<h4 id=\"NPM-Node-Package-Manager\"><a href=\"#NPM-Node-Package-Manager\" class=\"headerlink\" title=\"NPM (Node Package Manager)\"></a>NPM (Node Package Manager)</h4><p>å¤§åé¼é¼çš„ NPM å®é™…ä¸Šå°±æ˜¯ç”¨æ¥ç®¡ç†åŒ…çš„ä¸€ä¸ªå·¥å…·ï¼Œå€ŸåŠ© NPM æˆ‘ä»¬å¯ä»¥å¿«é€Ÿçš„å®‰è£…å’Œç®¡ç†ä¾èµ–åŒ…ã€‚ä¸‹é¢æ˜¯æˆ‘æ•´ç†çš„ npm å¸¸ç”¨å‘½ä»¤ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init                   <span class=\"comment\">#  åˆå§‹åŒ–åŒ…ï¼Œè¦æ±‚å¡«å…¥åŒ…åç­‰ä¿¡æ¯</span></span><br><span class=\"line\">npm install &lt;name&gt;         <span class=\"comment\">#  æœ¬åœ°å®‰è£…ä¸€ä¸ªåŒ…</span></span><br><span class=\"line\">npm install &lt;name&gt; -g      <span class=\"comment\">#  å…¨å±€å®‰è£…ä¸€ä¸ªåŒ…</span></span><br><span class=\"line\">npm install &lt;name&gt; --save  <span class=\"comment\">#  æœ¬åœ°å®‰è£…å¹¶å†™å…¥ package.json ä¾èµ–ä¸­</span></span><br><span class=\"line\">npm remove &lt;name&gt;          <span class=\"comment\">#  ç§»é™¤</span></span><br><span class=\"line\">npm update &lt;name&gt;          <span class=\"comment\">#  æ›´æ–°</span></span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>æœ¬åœ°å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ <code>./node_modules</code> ä¸‹ï¼ˆè¿è¡Œ npm å‘½ä»¤æ—¶æ‰€åœ¨çš„ç›®å½•ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ node_modules ç›®å½•ï¼Œä¼šåœ¨å½“å‰æ‰§è¡Œ npm å‘½ä»¤çš„ç›®å½•ä¸‹ç”Ÿæˆ node_modules ç›®å½•ã€‚å¯ä»¥é€šè¿‡ <code>require()</code> æ¥å¼•å…¥æœ¬åœ°å®‰è£…çš„åŒ…ã€‚</li>\n<li>å…¨å±€å®‰è£…ï¼šå°†å®‰è£…åŒ…æ”¾åœ¨ <code>/usr/local</code> ä¸‹æˆ–è€…ä½  node çš„å®‰è£…ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œä½¿ç”¨ã€‚</li>\n</ul>"},{"title":"Mongodb å­¦ä¹ ç¬”è®° -- å¢åˆ æ”¹æŸ¥","date":"2016-01-05T13:24:40.000Z","comments":0,"_content":"\nè®°å½• Mongodb çš„å­¦ä¹ ä¹‹æ—…ï¼Œä»ç¯å¢ƒé…ç½®ï¼Œåˆ°åŸºç¡€å‘½ä»¤è¡Œä½¿ç”¨ï¼Œç®—æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨æ•™ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å­¦ä¹ æ€»ç»“ï¼Œè¿˜æœ‰æŠŠè¸©åˆ°çš„å‘éƒ½è®°å½•ä¸‹æ¥ï¼Œä»¥åé‡åˆ°åŒæ ·çš„é—®é¢˜ä¸è‡³äºåœ¨åŒä¸€ä¸ªåœ°æ–¹ç»§ç»­è¸©å‘ã€‚\n<!-- more -->\n### Mongodb ä»‹ç»\n> MongoDBæ˜¯ä¸€ç§æ–‡æ¡£å¯¼å‘***æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ***ï¼Œç”±C++æ’°å†™è€Œæˆï¼Œæ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚2007å¹´10æœˆï¼ŒMongoDBç”±10genå›¢é˜Ÿæ‰€å‘å±•ã€‚2009å¹´2æœˆé¦–åº¦æ¨å‡ºã€‚ --- ***ç»´åŸºç™¾ç§‘***\n\nMongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å¬ç€å¾ˆé¥¶ï¼Œå…¶å®å°±æ˜¯éå…³ç³»æ•°æ®åº“ã€‚é‚£ä»€ä¹ˆåˆæ˜¯ ***å…³ç³»å‹æ•°æ®åº“*** å‘¢ï¼Ÿå…³ç³»å‹æ•°æ®åº“ä»¥è¡Œå’Œåˆ—çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œè¿™ä¸€ç³»åˆ—çš„è¡Œå’Œåˆ—è¢«ç§°ä¸ºè¡¨ï¼Œä¸€ç»„è¡¨ç»„æˆäº†æ•°æ®åº“ã€‚è¡¨ä¸è¡¨ä¹‹é—´çš„æ•°æ®è®°å½•æœ‰å…³ç³»ã€‚\n\n### Mongodb å®‰è£…\næœ¬äººçš„æ“ä½œç³»ç»Ÿæ˜¯ï¼šMacOSï¼Œä¸”å·²ç»å®‰è£…äº† [brew](http://brew.sh/index_zh-cn.html) ï¼Œæ‰€ä»¥å›¾çœäº‹ï¼Œæˆ‘å°±ä½¿ç”¨ brew ä¸€é”®å®‰è£…äº†ã€‚æ²¡ç”¨è¿‡ brew çš„åŒå­¦å¯ä»¥å»[è¿™é‡Œçœ‹çœ‹](http://www.cnblogs.com/TankXiao/p/3247113.html)ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚\n\n```bash\nbrew install mongodb\n```\nå®‰è£…é€Ÿåº¦å–å†³äºä½ çš„ç½‘ç»œæƒ…å†µï¼Œè¿™é‡Œç¨ç­‰ç‰‡åˆ»ã€‚brew é»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ `/usr/local/Cellar/` ä¸€ä¼šçš„åŠŸå¤«ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨è¿™é‡Œçœ‹åˆ°ï¼ŒMongodb ä¹–ä¹–çš„èººåœ¨è¿™äº†ã€‚å› ä¸º Mongodb ä¼šé»˜è®¤è¯»å– `/data/db` ç›®å½•ä¸‹çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æ–¹ä¾¿çœäº‹ï¼Œæˆ‘ä»¬æŠŠé»˜è®¤çš„æ•°æ®åº“å°±åˆ›å»ºåœ¨è¿™ä¸ªä½ç½®ï¼Œå¹¶ä¸”ç»™ `/data` æ‰§è¡Œæƒé™ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚\n\n```bash\nsudo mkdir -p /data/db         # sudo è¡¨ç¤ºä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œ-p è¡¨ç¤ºåˆ›å»ºå¤šå±‚ç›®å½•\nsudo chown -R  UserName /data  # UserName è¡¨ç¤ºä½ å½“å‰çš„ç³»ç»Ÿç”¨æˆ·å\n```\nå®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨ Mongodb çš„å®‰è£…ç›®å½•ä¸‹ æ‰¾åˆ° `bin` ç›®å½•äº†ï¼Œè¿™é‡Œé¢æ”¾ç€æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„å‘½ä»¤ã€‚\n```bash\ncd /usr/local/Cellar/mongodb/3.4.0/bin\n./mongod   # æ‰§è¡Œ Mongodb è¿›ç¨‹åï¼Œæµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:27017/\n```\næµè§ˆå™¨æ˜¾ç¤ºä¸‹é¢çš„å†…å®¹ï¼Œå°±è¡¨ç¤ºå®‰è£…æˆåŠŸå•¦ã€‚\n```text\nIt looks like you are trying to access MongoDB over HTTP on the native driver port.\n```\næ¥ä¸‹æ¥æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒéªŒè¯æˆ‘ä»¬ç¡®å®å®‰è£…æˆåŠŸäº†ã€‚åœ¨ Mongodb çš„æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥æ‰§è¡Œå¾ˆå¤šå‘½ä»¤æ¥æ“ä½œæ•°æ®åº“ã€‚\n```bash\ncd /usr/local/Cellar/mongodb/3.4.0/bin\n./mongo\n\n# è¿›å…¥ MongoDB shell åï¼Œå…‰æ ‡ä¼šå˜æˆä¸‹é¢è¿‡çš„çŠ¶æ€ï¼Œæ‰§è¡Œ show dbs åï¼Œæ˜¾ç¤ºå¦‚ä¸‹åˆ™å¤§åŠŸå‘Šæˆï¼\n> show dbs\nadmin  0.000GB\nlocal  0.000GB\n```\næ¥ä¸‹æ¥ï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹æ¬¡æ‰§è¡Œ Mongodb ï¼Œæˆ‘ä»¬æŠŠ `bin` ç›®å½•æ”¾åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä¸‹æ¬¡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ `mongod` å³å¯å¯ç”¨æœåŠ¡ï¼Œè¾“å…¥å‘½ä»¤ `mongo` å³å¯è¿›å…¥ shell æ§åˆ¶å°ã€‚\n\n```bash\n# æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè¯­æ³•ï¼šecho \"export PATH=xxxxxx:$PATH\" >> ~/.bash_profile\necho 'export PATH=/usr/local/Cellar/mongodb/3.4.0/bin:$PATH'>>~/.bash_profile\n```\n### Mongodb ä½¿ç”¨\nä½¿ç”¨ä¹‹å‰ï¼Œåœ¨æ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼Œç›¸æ¯”å…³ç³»å‹æ•°æ®åº“ï¼Œéå…³ç³»æ•°æ®åº“é‡‡ç”¨äº† ***æ•°æ®åº“***ã€***é›†åˆ***ã€***æ–‡æ¡£***ã€çš„æ¦‚å¿µã€‚å…¶å®å¯¹æ¯” SQL æ•°æ®åº“ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ï¼Œé›†åˆå°±å¥½æ¯”æ˜¯ä¸€å¼ è¡¨ï¼Œæ–‡æ¡£å¥½æ¯”å°±æ˜¯ä¸€æ•´è¡Œæ•°æ®ã€‚åº“çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚å°±è¿™ç‚¹åŒºåˆ«ã€‚åœ¨ç»ˆç«¯è¾“å…¥ `mongo` è¿›å…¥shell æ§åˆ¶å°ã€‚\n```bash\nmongo\n```\n#### åŸºç¡€å‘½ä»¤\næ–°å¢æ•°æ®\n- æ˜¾ç¤ºæ•°æ®åº“ï¼š`show dbs`\n- ä½¿ç”¨/åˆ›å»ºæ•°æ®åº“ï¼š`use æ•°æ®åº“å`\n- æ˜¾ç¤ºé›†åˆï¼š`show collections`\n- ä¿å­˜æ•°æ®ï¼š`db.collection.save({\"key\":\"value\",\"key2\":\"value2\"})`\n- æ’å…¥æ•°æ®ï¼š`db.collection.insert({\"key\":\"value\",\"key2\":\"value2\"})`\n\n<div class=\"tip\">\nè‹¥æ–°å¢çš„æ•°æ®ä¸»é”®å·²ç»å­˜åœ¨ï¼Œinsert()ä¼šä¸åšæ“ä½œå¹¶æç¤ºé”™è¯¯ï¼Œè€Œsave()åˆ™æ›´æ”¹åŸæ¥çš„å†…å®¹ä¸ºæ–°å†…å®¹ã€‚\n</div>\n\nåˆ é™¤æ•°æ®\n- åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼š`db.collection.remove({})`\n- åˆ é™¤æŒ‡å®šæ–‡æ¡£ï¼š`db.collection.remove({\"key\":\"value\"})`\n- åˆ é™¤é›†åˆï¼š`db.collection.drop()` æˆ–è€… `db.runCommand({\"drop\":\"collection\"})`\n- åˆ é™¤æ•°æ®åº“ï¼š`db.runCommand({\"dropDatabase\": 1})` æ³¨æ„ï¼š1æ²¡æœ‰å¼•å·\n\næŸ¥æ‰¾æ•°æ®\n- æŸ¥æ‰¾æ‰€æœ‰æ•°æ®ï¼š `db.collection.find({})`\n- æŸ¥åˆ°å•æ¡æ•°æ®ï¼š`db.collection.findOne({})`\n- æ¡ä»¶æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":\"value\"})`\n- æ¡ä»¶æŸ¥æ‰¾ key < valueï¼š`db.collection.find({\"key\":{$lt:value}})`\n- æ¡ä»¶æŸ¥æ‰¾ key > valueï¼š`db.collection.find({\"key\":{$gt:value}})`\n- æ¡ä»¶æŸ¥æ‰¾ key >= valueï¼š`db.collection.find({\"key\":{$gte:value}})`\n- èŒƒå›´æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$gt:value1,$lt:value2Â }Â })`\n- æ¨¡è¿ç®—æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$mod:[10,1]}})`\n- èŒƒå›´åœ¨æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$in:[1,2,3]}})`\n- èŒƒå›´ä¸åœ¨åœ¨æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$nin:[1,2,3]}})`\n- æ•°ç»„é•¿åº¦æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$size:1}})` key å¿…é¡»æ˜¯æ•°ç»„\n- å­—æ®µå­˜åœ¨æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$exists:true|false}})`\n- å¤šæ¡ä»¶æŸ¥æ‰¾ï¼š`db.collection.find({$or:[{a:1},{b:2}]})`\n- å†…åµŒå¯¹è±¡ä¸­çš„å€¼æŸ¥æ‰¾ï¼š`db.collection.find({\"key.subkey\":value})`\n- æ’åºï¼š`db.collection.find({}).sort({\"key1\":1,\"key2\":-1})` 1å‡åº -1é™åº\n- å¯¹å­—æ®µå»ºç«‹ç´¢å¼•ï¼š`db.collection.find({})ensureIndex({\"key\":1})` 1å‡åº -1é™åº\n- èŒƒå›´æ§åˆ¶æŸ¥æ‰¾ï¼š`db.collection.find().skip(5).limit(5)` è·³è¿‡5æ¡ï¼Œè¯»å–5æ¡\n- æŸ¥è¯¢ç»“æœé›†ç»Ÿè®¡ï¼š`db.collection.find().count()`\n- æ¨¡ç³ŠæŸ¥æ‰¾ï¼š`db.collection.find({\"key\":/ab/})` æ­£åˆ™\n\n\næ›´æ”¹æ•°æ®\n- `db.collection.update({\"targetKey\":\"targetValue\"},{\"newKey\":\"newVlue\"})`\n\n#### GUI å·¥å…·\n![](http://ww1.sinaimg.cn/large/6057861cgw1fbfwwdbu8qj20zq0dbqah.jpg)\n***Robomongo*** å¯è§†åŒ– Mongodb æ•°æ®åº“ç®¡ç†å·¥å…· ï¼Œç‚¹å‡»[è¿™é‡Œ](https://robomongo.org/download)ä¸‹è½½ï¼Œå®˜æ–¹ç½‘ç«™ï¼šhttps://robomongo.org/ ã€‚\n\n###  Mongoose ä»‹ç»\n[Mongoose](http://mongoosejs.com/) ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ Node ç¯å¢ƒä¸­æ“ä½œ MongoDB æ•°æ®åº“çš„ä¸€ç§å¯¹è±¡æ¨¡å‹å·¥å…·ï¼ŒMongoose å°†æ•°æ®åº“ä¸­çš„æ•°æ®è½¬æ¢ä¸º JavaScript å¯¹è±¡ä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚\n\n#### é…ç½®\nå®‰è£… Mongoose\n```bash\nnpm install mongoose --save\n```\nå¼•å…¥åˆ°é¡¹ç›®æ–‡ä»¶ä¸­å¹¶åˆ›å»ºé“¾æ¥\n```js\n// app.js\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/my_database');\n```\n\n#### æ–°å¢æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"username\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\n// æ•°æ®é›†\nvar content = {name:\"Nick\",age:23,sex:'ç”·'};\n// å®ä¾‹åŒ–å¯¹è±¡å¹¶æ’å…¥æ•°æ®\nvar monInsert = new monModel(content);\nmonInsert.save(function(err){\n  if(err){\n    console.log(err);\n  }else{\n    console.log('æˆåŠŸæ’å…¥æ•°æ®');\n  }\n  db.close();\n});\n```\n#### åˆ é™¤æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// cosole.log(db);\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"name\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\n// åŸæ•°æ®å­—æ®µå€¼\nvar oldValue  = {name:\"Nick\"};\n// å•æ¡ä»¶æ›´æ–°\nvar newData1 = {$set:{name:\"å†…å®¹\"}};\n// å¤šæ¡ä»¶æ›´æ–°\nvar newData2 = {$set:{name:\"å†…å®¹\",age:2}};\nmonModel.update(oldValue,newData,function(err,result){\n  if(err){\n    console.log(err);\n  }else{\n    console.log(\"update\");\n  }\n  db.close();\n});\n```\n\n#### æŸ¥è¯¢æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// cosole.log(db);\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"name\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\nvar content = {name:\"å§“å2\"};\nvar field = {name:1,age:1,sex:1};\nmonModel.find(content,field,function(err,result){\n  if(err){\n    console.log(err);\n  }else{\n    console.log(result);\n  }\n  db.close();\n});\n```\n\n\n#### ä¿®æ”¹æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// cosole.log(db);\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"name\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\n// åŸæ•°æ®å­—æ®µå€¼\nvar oldValue  = {name:\"Nick\"};\n// å•æ¡ä»¶æ›´æ–°\nvar newData1 = {$set:{name:\"å†…å®¹\"}};\n// å¤šæ¡ä»¶æ›´æ–°\nvar newData2 = {$set:{name:\"å†…å®¹\",age:2}};\nmonModel.update(oldValue,newData,function(err,result){\n  if(err){\n    console.log(err);\n  }else{\n    console.log(\"update\");\n  }\n  db.close();\n});\n```\n","source":"_posts/Mongodb-å­¦ä¹ ç¬”è®°----å¢åˆ æ”¹æŸ¥.md","raw":"---\ntitle: 'Mongodb å­¦ä¹ ç¬”è®° -- å¢åˆ æ”¹æŸ¥'\ndate: 2016-01-05 21:24:40\ntags:\ncomments: false\n---\n\nè®°å½• Mongodb çš„å­¦ä¹ ä¹‹æ—…ï¼Œä»ç¯å¢ƒé…ç½®ï¼Œåˆ°åŸºç¡€å‘½ä»¤è¡Œä½¿ç”¨ï¼Œç®—æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨æ•™ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å­¦ä¹ æ€»ç»“ï¼Œè¿˜æœ‰æŠŠè¸©åˆ°çš„å‘éƒ½è®°å½•ä¸‹æ¥ï¼Œä»¥åé‡åˆ°åŒæ ·çš„é—®é¢˜ä¸è‡³äºåœ¨åŒä¸€ä¸ªåœ°æ–¹ç»§ç»­è¸©å‘ã€‚\n<!-- more -->\n### Mongodb ä»‹ç»\n> MongoDBæ˜¯ä¸€ç§æ–‡æ¡£å¯¼å‘***æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ***ï¼Œç”±C++æ’°å†™è€Œæˆï¼Œæ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚2007å¹´10æœˆï¼ŒMongoDBç”±10genå›¢é˜Ÿæ‰€å‘å±•ã€‚2009å¹´2æœˆé¦–åº¦æ¨å‡ºã€‚ --- ***ç»´åŸºç™¾ç§‘***\n\nMongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å¬ç€å¾ˆé¥¶ï¼Œå…¶å®å°±æ˜¯éå…³ç³»æ•°æ®åº“ã€‚é‚£ä»€ä¹ˆåˆæ˜¯ ***å…³ç³»å‹æ•°æ®åº“*** å‘¢ï¼Ÿå…³ç³»å‹æ•°æ®åº“ä»¥è¡Œå’Œåˆ—çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œè¿™ä¸€ç³»åˆ—çš„è¡Œå’Œåˆ—è¢«ç§°ä¸ºè¡¨ï¼Œä¸€ç»„è¡¨ç»„æˆäº†æ•°æ®åº“ã€‚è¡¨ä¸è¡¨ä¹‹é—´çš„æ•°æ®è®°å½•æœ‰å…³ç³»ã€‚\n\n### Mongodb å®‰è£…\næœ¬äººçš„æ“ä½œç³»ç»Ÿæ˜¯ï¼šMacOSï¼Œä¸”å·²ç»å®‰è£…äº† [brew](http://brew.sh/index_zh-cn.html) ï¼Œæ‰€ä»¥å›¾çœäº‹ï¼Œæˆ‘å°±ä½¿ç”¨ brew ä¸€é”®å®‰è£…äº†ã€‚æ²¡ç”¨è¿‡ brew çš„åŒå­¦å¯ä»¥å»[è¿™é‡Œçœ‹çœ‹](http://www.cnblogs.com/TankXiao/p/3247113.html)ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚\n\n```bash\nbrew install mongodb\n```\nå®‰è£…é€Ÿåº¦å–å†³äºä½ çš„ç½‘ç»œæƒ…å†µï¼Œè¿™é‡Œç¨ç­‰ç‰‡åˆ»ã€‚brew é»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ `/usr/local/Cellar/` ä¸€ä¼šçš„åŠŸå¤«ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨è¿™é‡Œçœ‹åˆ°ï¼ŒMongodb ä¹–ä¹–çš„èººåœ¨è¿™äº†ã€‚å› ä¸º Mongodb ä¼šé»˜è®¤è¯»å– `/data/db` ç›®å½•ä¸‹çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æ–¹ä¾¿çœäº‹ï¼Œæˆ‘ä»¬æŠŠé»˜è®¤çš„æ•°æ®åº“å°±åˆ›å»ºåœ¨è¿™ä¸ªä½ç½®ï¼Œå¹¶ä¸”ç»™ `/data` æ‰§è¡Œæƒé™ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚\n\n```bash\nsudo mkdir -p /data/db         # sudo è¡¨ç¤ºä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œ-p è¡¨ç¤ºåˆ›å»ºå¤šå±‚ç›®å½•\nsudo chown -R  UserName /data  # UserName è¡¨ç¤ºä½ å½“å‰çš„ç³»ç»Ÿç”¨æˆ·å\n```\nå®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨ Mongodb çš„å®‰è£…ç›®å½•ä¸‹ æ‰¾åˆ° `bin` ç›®å½•äº†ï¼Œè¿™é‡Œé¢æ”¾ç€æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„å‘½ä»¤ã€‚\n```bash\ncd /usr/local/Cellar/mongodb/3.4.0/bin\n./mongod   # æ‰§è¡Œ Mongodb è¿›ç¨‹åï¼Œæµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:27017/\n```\næµè§ˆå™¨æ˜¾ç¤ºä¸‹é¢çš„å†…å®¹ï¼Œå°±è¡¨ç¤ºå®‰è£…æˆåŠŸå•¦ã€‚\n```text\nIt looks like you are trying to access MongoDB over HTTP on the native driver port.\n```\næ¥ä¸‹æ¥æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒéªŒè¯æˆ‘ä»¬ç¡®å®å®‰è£…æˆåŠŸäº†ã€‚åœ¨ Mongodb çš„æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥æ‰§è¡Œå¾ˆå¤šå‘½ä»¤æ¥æ“ä½œæ•°æ®åº“ã€‚\n```bash\ncd /usr/local/Cellar/mongodb/3.4.0/bin\n./mongo\n\n# è¿›å…¥ MongoDB shell åï¼Œå…‰æ ‡ä¼šå˜æˆä¸‹é¢è¿‡çš„çŠ¶æ€ï¼Œæ‰§è¡Œ show dbs åï¼Œæ˜¾ç¤ºå¦‚ä¸‹åˆ™å¤§åŠŸå‘Šæˆï¼\n> show dbs\nadmin  0.000GB\nlocal  0.000GB\n```\næ¥ä¸‹æ¥ï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹æ¬¡æ‰§è¡Œ Mongodb ï¼Œæˆ‘ä»¬æŠŠ `bin` ç›®å½•æ”¾åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä¸‹æ¬¡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ `mongod` å³å¯å¯ç”¨æœåŠ¡ï¼Œè¾“å…¥å‘½ä»¤ `mongo` å³å¯è¿›å…¥ shell æ§åˆ¶å°ã€‚\n\n```bash\n# æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè¯­æ³•ï¼šecho \"export PATH=xxxxxx:$PATH\" >> ~/.bash_profile\necho 'export PATH=/usr/local/Cellar/mongodb/3.4.0/bin:$PATH'>>~/.bash_profile\n```\n### Mongodb ä½¿ç”¨\nä½¿ç”¨ä¹‹å‰ï¼Œåœ¨æ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼Œç›¸æ¯”å…³ç³»å‹æ•°æ®åº“ï¼Œéå…³ç³»æ•°æ®åº“é‡‡ç”¨äº† ***æ•°æ®åº“***ã€***é›†åˆ***ã€***æ–‡æ¡£***ã€çš„æ¦‚å¿µã€‚å…¶å®å¯¹æ¯” SQL æ•°æ®åº“ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ï¼Œé›†åˆå°±å¥½æ¯”æ˜¯ä¸€å¼ è¡¨ï¼Œæ–‡æ¡£å¥½æ¯”å°±æ˜¯ä¸€æ•´è¡Œæ•°æ®ã€‚åº“çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚å°±è¿™ç‚¹åŒºåˆ«ã€‚åœ¨ç»ˆç«¯è¾“å…¥ `mongo` è¿›å…¥shell æ§åˆ¶å°ã€‚\n```bash\nmongo\n```\n#### åŸºç¡€å‘½ä»¤\næ–°å¢æ•°æ®\n- æ˜¾ç¤ºæ•°æ®åº“ï¼š`show dbs`\n- ä½¿ç”¨/åˆ›å»ºæ•°æ®åº“ï¼š`use æ•°æ®åº“å`\n- æ˜¾ç¤ºé›†åˆï¼š`show collections`\n- ä¿å­˜æ•°æ®ï¼š`db.collection.save({\"key\":\"value\",\"key2\":\"value2\"})`\n- æ’å…¥æ•°æ®ï¼š`db.collection.insert({\"key\":\"value\",\"key2\":\"value2\"})`\n\n<div class=\"tip\">\nè‹¥æ–°å¢çš„æ•°æ®ä¸»é”®å·²ç»å­˜åœ¨ï¼Œinsert()ä¼šä¸åšæ“ä½œå¹¶æç¤ºé”™è¯¯ï¼Œè€Œsave()åˆ™æ›´æ”¹åŸæ¥çš„å†…å®¹ä¸ºæ–°å†…å®¹ã€‚\n</div>\n\nåˆ é™¤æ•°æ®\n- åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼š`db.collection.remove({})`\n- åˆ é™¤æŒ‡å®šæ–‡æ¡£ï¼š`db.collection.remove({\"key\":\"value\"})`\n- åˆ é™¤é›†åˆï¼š`db.collection.drop()` æˆ–è€… `db.runCommand({\"drop\":\"collection\"})`\n- åˆ é™¤æ•°æ®åº“ï¼š`db.runCommand({\"dropDatabase\": 1})` æ³¨æ„ï¼š1æ²¡æœ‰å¼•å·\n\næŸ¥æ‰¾æ•°æ®\n- æŸ¥æ‰¾æ‰€æœ‰æ•°æ®ï¼š `db.collection.find({})`\n- æŸ¥åˆ°å•æ¡æ•°æ®ï¼š`db.collection.findOne({})`\n- æ¡ä»¶æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":\"value\"})`\n- æ¡ä»¶æŸ¥æ‰¾ key < valueï¼š`db.collection.find({\"key\":{$lt:value}})`\n- æ¡ä»¶æŸ¥æ‰¾ key > valueï¼š`db.collection.find({\"key\":{$gt:value}})`\n- æ¡ä»¶æŸ¥æ‰¾ key >= valueï¼š`db.collection.find({\"key\":{$gte:value}})`\n- èŒƒå›´æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$gt:value1,$lt:value2Â }Â })`\n- æ¨¡è¿ç®—æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$mod:[10,1]}})`\n- èŒƒå›´åœ¨æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$in:[1,2,3]}})`\n- èŒƒå›´ä¸åœ¨åœ¨æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$nin:[1,2,3]}})`\n- æ•°ç»„é•¿åº¦æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$size:1}})` key å¿…é¡»æ˜¯æ•°ç»„\n- å­—æ®µå­˜åœ¨æŸ¥æ‰¾ï¼š`db.collection.find({\"key\":{$exists:true|false}})`\n- å¤šæ¡ä»¶æŸ¥æ‰¾ï¼š`db.collection.find({$or:[{a:1},{b:2}]})`\n- å†…åµŒå¯¹è±¡ä¸­çš„å€¼æŸ¥æ‰¾ï¼š`db.collection.find({\"key.subkey\":value})`\n- æ’åºï¼š`db.collection.find({}).sort({\"key1\":1,\"key2\":-1})` 1å‡åº -1é™åº\n- å¯¹å­—æ®µå»ºç«‹ç´¢å¼•ï¼š`db.collection.find({})ensureIndex({\"key\":1})` 1å‡åº -1é™åº\n- èŒƒå›´æ§åˆ¶æŸ¥æ‰¾ï¼š`db.collection.find().skip(5).limit(5)` è·³è¿‡5æ¡ï¼Œè¯»å–5æ¡\n- æŸ¥è¯¢ç»“æœé›†ç»Ÿè®¡ï¼š`db.collection.find().count()`\n- æ¨¡ç³ŠæŸ¥æ‰¾ï¼š`db.collection.find({\"key\":/ab/})` æ­£åˆ™\n\n\næ›´æ”¹æ•°æ®\n- `db.collection.update({\"targetKey\":\"targetValue\"},{\"newKey\":\"newVlue\"})`\n\n#### GUI å·¥å…·\n![](http://ww1.sinaimg.cn/large/6057861cgw1fbfwwdbu8qj20zq0dbqah.jpg)\n***Robomongo*** å¯è§†åŒ– Mongodb æ•°æ®åº“ç®¡ç†å·¥å…· ï¼Œç‚¹å‡»[è¿™é‡Œ](https://robomongo.org/download)ä¸‹è½½ï¼Œå®˜æ–¹ç½‘ç«™ï¼šhttps://robomongo.org/ ã€‚\n\n###  Mongoose ä»‹ç»\n[Mongoose](http://mongoosejs.com/) ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ Node ç¯å¢ƒä¸­æ“ä½œ MongoDB æ•°æ®åº“çš„ä¸€ç§å¯¹è±¡æ¨¡å‹å·¥å…·ï¼ŒMongoose å°†æ•°æ®åº“ä¸­çš„æ•°æ®è½¬æ¢ä¸º JavaScript å¯¹è±¡ä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚\n\n#### é…ç½®\nå®‰è£… Mongoose\n```bash\nnpm install mongoose --save\n```\nå¼•å…¥åˆ°é¡¹ç›®æ–‡ä»¶ä¸­å¹¶åˆ›å»ºé“¾æ¥\n```js\n// app.js\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/my_database');\n```\n\n#### æ–°å¢æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"username\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\n// æ•°æ®é›†\nvar content = {name:\"Nick\",age:23,sex:'ç”·'};\n// å®ä¾‹åŒ–å¯¹è±¡å¹¶æ’å…¥æ•°æ®\nvar monInsert = new monModel(content);\nmonInsert.save(function(err){\n  if(err){\n    console.log(err);\n  }else{\n    console.log('æˆåŠŸæ’å…¥æ•°æ®');\n  }\n  db.close();\n});\n```\n#### åˆ é™¤æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// cosole.log(db);\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"name\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\n// åŸæ•°æ®å­—æ®µå€¼\nvar oldValue  = {name:\"Nick\"};\n// å•æ¡ä»¶æ›´æ–°\nvar newData1 = {$set:{name:\"å†…å®¹\"}};\n// å¤šæ¡ä»¶æ›´æ–°\nvar newData2 = {$set:{name:\"å†…å®¹\",age:2}};\nmonModel.update(oldValue,newData,function(err,result){\n  if(err){\n    console.log(err);\n  }else{\n    console.log(\"update\");\n  }\n  db.close();\n});\n```\n\n#### æŸ¥è¯¢æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// cosole.log(db);\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"name\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\nvar content = {name:\"å§“å2\"};\nvar field = {name:1,age:1,sex:1};\nmonModel.find(content,field,function(err,result){\n  if(err){\n    console.log(err);\n  }else{\n    console.log(result);\n  }\n  db.close();\n});\n```\n\n\n#### ä¿®æ”¹æ•°æ®\n```js\n// å¼•å…¥æ¨¡å—\nvar mongoose = require('mongoose');\n// è¿æ¥æ•°æ®åº“\nvar db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');\n// cosole.log(db);\n// è®¾ç½®æ•°æ®ç±»å‹\nvar monSchema = new mongooose.Schema({\n    name:{type:String,default:\"name\"},\n    ageï¼š{type:Number},\n    sex:{type:String}\n});\n// é€‰æ‹©é›†åˆ\nvar monModel = db.model('user',monSchema);\n// åŸæ•°æ®å­—æ®µå€¼\nvar oldValue  = {name:\"Nick\"};\n// å•æ¡ä»¶æ›´æ–°\nvar newData1 = {$set:{name:\"å†…å®¹\"}};\n// å¤šæ¡ä»¶æ›´æ–°\nvar newData2 = {$set:{name:\"å†…å®¹\",age:2}};\nmonModel.update(oldValue,newData,function(err,result){\n  if(err){\n    console.log(err);\n  }else{\n    console.log(\"update\");\n  }\n  db.close();\n});\n```\n","slug":"Mongodb-å­¦ä¹ ç¬”è®°----å¢åˆ æ”¹æŸ¥","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidic000au4q9kx3hmnu9","content":"<p>è®°å½• Mongodb çš„å­¦ä¹ ä¹‹æ—…ï¼Œä»ç¯å¢ƒé…ç½®ï¼Œåˆ°åŸºç¡€å‘½ä»¤è¡Œä½¿ç”¨ï¼Œç®—æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨æ•™ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å­¦ä¹ æ€»ç»“ï¼Œè¿˜æœ‰æŠŠè¸©åˆ°çš„å‘éƒ½è®°å½•ä¸‹æ¥ï¼Œä»¥åé‡åˆ°åŒæ ·çš„é—®é¢˜ä¸è‡³äºåœ¨åŒä¸€ä¸ªåœ°æ–¹ç»§ç»­è¸©å‘ã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"Mongodb-ä»‹ç»\"><a href=\"#Mongodb-ä»‹ç»\" class=\"headerlink\" title=\"Mongodb ä»‹ç»\"></a>Mongodb ä»‹ç»</h3><blockquote>\n<p>MongoDBæ˜¯ä¸€ç§æ–‡æ¡£å¯¼å‘<strong><em>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</em></strong>ï¼Œç”±C++æ’°å†™è€Œæˆï¼Œæ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚2007å¹´10æœˆï¼ŒMongoDBç”±10genå›¢é˜Ÿæ‰€å‘å±•ã€‚2009å¹´2æœˆé¦–åº¦æ¨å‡ºã€‚ â€” <strong><em>ç»´åŸºç™¾ç§‘</em></strong></p>\n</blockquote>\n<p>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å¬ç€å¾ˆé¥¶ï¼Œå…¶å®å°±æ˜¯éå…³ç³»æ•°æ®åº“ã€‚é‚£ä»€ä¹ˆåˆæ˜¯ <strong><em>å…³ç³»å‹æ•°æ®åº“</em></strong> å‘¢ï¼Ÿå…³ç³»å‹æ•°æ®åº“ä»¥è¡Œå’Œåˆ—çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œè¿™ä¸€ç³»åˆ—çš„è¡Œå’Œåˆ—è¢«ç§°ä¸ºè¡¨ï¼Œä¸€ç»„è¡¨ç»„æˆäº†æ•°æ®åº“ã€‚è¡¨ä¸è¡¨ä¹‹é—´çš„æ•°æ®è®°å½•æœ‰å…³ç³»ã€‚</p>\n<h3 id=\"Mongodb-å®‰è£…\"><a href=\"#Mongodb-å®‰è£…\" class=\"headerlink\" title=\"Mongodb å®‰è£…\"></a>Mongodb å®‰è£…</h3><p>æœ¬äººçš„æ“ä½œç³»ç»Ÿæ˜¯ï¼šMacOSï¼Œä¸”å·²ç»å®‰è£…äº† <a href=\"http://brew.sh/index_zh-cn.html\" target=\"_blank\" rel=\"noopener\">brew</a> ï¼Œæ‰€ä»¥å›¾çœäº‹ï¼Œæˆ‘å°±ä½¿ç”¨ brew ä¸€é”®å®‰è£…äº†ã€‚æ²¡ç”¨è¿‡ brew çš„åŒå­¦å¯ä»¥å»<a href=\"http://www.cnblogs.com/TankXiao/p/3247113.html\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œçœ‹çœ‹</a>ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install mongodb</span><br></pre></td></tr></table></figure>\n<p>å®‰è£…é€Ÿåº¦å–å†³äºä½ çš„ç½‘ç»œæƒ…å†µï¼Œè¿™é‡Œç¨ç­‰ç‰‡åˆ»ã€‚brew é»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ <code>/usr/local/Cellar/</code> ä¸€ä¼šçš„åŠŸå¤«ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨è¿™é‡Œçœ‹åˆ°ï¼ŒMongodb ä¹–ä¹–çš„èººåœ¨è¿™äº†ã€‚å› ä¸º Mongodb ä¼šé»˜è®¤è¯»å– <code>/data/db</code> ç›®å½•ä¸‹çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æ–¹ä¾¿çœäº‹ï¼Œæˆ‘ä»¬æŠŠé»˜è®¤çš„æ•°æ®åº“å°±åˆ›å»ºåœ¨è¿™ä¸ªä½ç½®ï¼Œå¹¶ä¸”ç»™ <code>/data</code> æ‰§è¡Œæƒé™ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mkdir -p /data/db         <span class=\"comment\"># sudo è¡¨ç¤ºä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œ-p è¡¨ç¤ºåˆ›å»ºå¤šå±‚ç›®å½•</span></span><br><span class=\"line\">sudo chown -R  UserName /data  <span class=\"comment\"># UserName è¡¨ç¤ºä½ å½“å‰çš„ç³»ç»Ÿç”¨æˆ·å</span></span><br></pre></td></tr></table></figure>\n<p>å®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨ Mongodb çš„å®‰è£…ç›®å½•ä¸‹ æ‰¾åˆ° <code>bin</code> ç›®å½•äº†ï¼Œè¿™é‡Œé¢æ”¾ç€æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„å‘½ä»¤ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/Cellar/mongodb/3.4.0/bin</span><br><span class=\"line\">./mongod   <span class=\"comment\"># æ‰§è¡Œ Mongodb è¿›ç¨‹åï¼Œæµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:27017/</span></span><br></pre></td></tr></table></figure></p>\n<p>æµè§ˆå™¨æ˜¾ç¤ºä¸‹é¢çš„å†…å®¹ï¼Œå°±è¡¨ç¤ºå®‰è£…æˆåŠŸå•¦ã€‚<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">It looks like you are trying to access MongoDB over HTTP on the native driver port.</span><br></pre></td></tr></table></figure></p>\n<p>æ¥ä¸‹æ¥æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒéªŒè¯æˆ‘ä»¬ç¡®å®å®‰è£…æˆåŠŸäº†ã€‚åœ¨ Mongodb çš„æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥æ‰§è¡Œå¾ˆå¤šå‘½ä»¤æ¥æ“ä½œæ•°æ®åº“ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/Cellar/mongodb/3.4.0/bin</span><br><span class=\"line\">./mongo</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿›å…¥ MongoDB shell åï¼Œå…‰æ ‡ä¼šå˜æˆä¸‹é¢è¿‡çš„çŠ¶æ€ï¼Œæ‰§è¡Œ show dbs åï¼Œæ˜¾ç¤ºå¦‚ä¸‹åˆ™å¤§åŠŸå‘Šæˆï¼</span></span><br><span class=\"line\">&gt; show dbs</span><br><span class=\"line\">admin  0.000GB</span><br><span class=\"line\"><span class=\"built_in\">local</span>  0.000GB</span><br></pre></td></tr></table></figure></p>\n<p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹æ¬¡æ‰§è¡Œ Mongodb ï¼Œæˆ‘ä»¬æŠŠ <code>bin</code> ç›®å½•æ”¾åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä¸‹æ¬¡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ <code>mongod</code> å³å¯å¯ç”¨æœåŠ¡ï¼Œè¾“å…¥å‘½ä»¤ <code>mongo</code> å³å¯è¿›å…¥ shell æ§åˆ¶å°ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè¯­æ³•ï¼šecho \"export PATH=xxxxxx:$PATH\" &gt;&gt; ~/.bash_profile</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PATH=/usr/local/Cellar/mongodb/3.4.0/bin:$PATH'</span>&gt;&gt;~/.bash_profile</span><br></pre></td></tr></table></figure>\n<h3 id=\"Mongodb-ä½¿ç”¨\"><a href=\"#Mongodb-ä½¿ç”¨\" class=\"headerlink\" title=\"Mongodb ä½¿ç”¨\"></a>Mongodb ä½¿ç”¨</h3><p>ä½¿ç”¨ä¹‹å‰ï¼Œåœ¨æ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼Œç›¸æ¯”å…³ç³»å‹æ•°æ®åº“ï¼Œéå…³ç³»æ•°æ®åº“é‡‡ç”¨äº† <strong><em>æ•°æ®åº“</em></strong>ã€<strong><em>é›†åˆ</em></strong>ã€<strong><em>æ–‡æ¡£</em></strong>ã€çš„æ¦‚å¿µã€‚å…¶å®å¯¹æ¯” SQL æ•°æ®åº“ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ï¼Œé›†åˆå°±å¥½æ¯”æ˜¯ä¸€å¼ è¡¨ï¼Œæ–‡æ¡£å¥½æ¯”å°±æ˜¯ä¸€æ•´è¡Œæ•°æ®ã€‚åº“çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚å°±è¿™ç‚¹åŒºåˆ«ã€‚åœ¨ç»ˆç«¯è¾“å…¥ <code>mongo</code> è¿›å…¥shell æ§åˆ¶å°ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"åŸºç¡€å‘½ä»¤\"><a href=\"#åŸºç¡€å‘½ä»¤\" class=\"headerlink\" title=\"åŸºç¡€å‘½ä»¤\"></a>åŸºç¡€å‘½ä»¤</h4><p>æ–°å¢æ•°æ®</p>\n<ul>\n<li>æ˜¾ç¤ºæ•°æ®åº“ï¼š<code>show dbs</code></li>\n<li>ä½¿ç”¨/åˆ›å»ºæ•°æ®åº“ï¼š<code>use æ•°æ®åº“å</code></li>\n<li>æ˜¾ç¤ºé›†åˆï¼š<code>show collections</code></li>\n<li>ä¿å­˜æ•°æ®ï¼š<code>db.collection.save({&quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;})</code></li>\n<li>æ’å…¥æ•°æ®ï¼š<code>db.collection.insert({&quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;})</code></li>\n</ul>\n<div class=\"tip\"><br>è‹¥æ–°å¢çš„æ•°æ®ä¸»é”®å·²ç»å­˜åœ¨ï¼Œinsert()ä¼šä¸åšæ“ä½œå¹¶æç¤ºé”™è¯¯ï¼Œè€Œsave()åˆ™æ›´æ”¹åŸæ¥çš„å†…å®¹ä¸ºæ–°å†…å®¹ã€‚<br></div>\n\n<p>åˆ é™¤æ•°æ®</p>\n<ul>\n<li>åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼š<code>db.collection.remove({})</code></li>\n<li>åˆ é™¤æŒ‡å®šæ–‡æ¡£ï¼š<code>db.collection.remove({&quot;key&quot;:&quot;value&quot;})</code></li>\n<li>åˆ é™¤é›†åˆï¼š<code>db.collection.drop()</code> æˆ–è€… <code>db.runCommand({&quot;drop&quot;:&quot;collection&quot;})</code></li>\n<li>åˆ é™¤æ•°æ®åº“ï¼š<code>db.runCommand({&quot;dropDatabase&quot;: 1})</code> æ³¨æ„ï¼š1æ²¡æœ‰å¼•å·</li>\n</ul>\n<p>æŸ¥æ‰¾æ•°æ®</p>\n<ul>\n<li>æŸ¥æ‰¾æ‰€æœ‰æ•°æ®ï¼š <code>db.collection.find({})</code></li>\n<li>æŸ¥åˆ°å•æ¡æ•°æ®ï¼š<code>db.collection.findOne({})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:&quot;value&quot;})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ key &lt; valueï¼š<code>db.collection.find({&quot;key&quot;:{$lt:value}})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ key &gt; valueï¼š<code>db.collection.find({&quot;key&quot;:{$gt:value}})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ key &gt;= valueï¼š<code>db.collection.find({&quot;key&quot;:{$gte:value}})</code></li>\n<li>èŒƒå›´æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$gt:value1,$lt:value2 } })</code></li>\n<li>æ¨¡è¿ç®—æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$mod:[10,1]}})</code></li>\n<li>èŒƒå›´åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$in:[1,2,3]}})</code></li>\n<li>èŒƒå›´ä¸åœ¨åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$nin:[1,2,3]}})</code></li>\n<li>æ•°ç»„é•¿åº¦æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$size:1}})</code> key å¿…é¡»æ˜¯æ•°ç»„</li>\n<li>å­—æ®µå­˜åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$exists:true|false}})</code></li>\n<li>å¤šæ¡ä»¶æŸ¥æ‰¾ï¼š<code>db.collection.find({$or:[{a:1},{b:2}]})</code></li>\n<li>å†…åµŒå¯¹è±¡ä¸­çš„å€¼æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key.subkey&quot;:value})</code></li>\n<li>æ’åºï¼š<code>db.collection.find({}).sort({&quot;key1&quot;:1,&quot;key2&quot;:-1})</code> 1å‡åº -1é™åº</li>\n<li>å¯¹å­—æ®µå»ºç«‹ç´¢å¼•ï¼š<code>db.collection.find({})ensureIndex({&quot;key&quot;:1})</code> 1å‡åº -1é™åº</li>\n<li>èŒƒå›´æ§åˆ¶æŸ¥æ‰¾ï¼š<code>db.collection.find().skip(5).limit(5)</code> è·³è¿‡5æ¡ï¼Œè¯»å–5æ¡</li>\n<li>æŸ¥è¯¢ç»“æœé›†ç»Ÿè®¡ï¼š<code>db.collection.find().count()</code></li>\n<li>æ¨¡ç³ŠæŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:/ab/})</code> æ­£åˆ™</li>\n</ul>\n<p>æ›´æ”¹æ•°æ®</p>\n<ul>\n<li><code>db.collection.update({&quot;targetKey&quot;:&quot;targetValue&quot;},{&quot;newKey&quot;:&quot;newVlue&quot;})</code></li>\n</ul>\n<h4 id=\"GUI-å·¥å…·\"><a href=\"#GUI-å·¥å…·\" class=\"headerlink\" title=\"GUI å·¥å…·\"></a>GUI å·¥å…·</h4><p><img src=\"http://ww1.sinaimg.cn/large/6057861cgw1fbfwwdbu8qj20zq0dbqah.jpg\" alt=\"\"><br><strong><em>Robomongo</em></strong> å¯è§†åŒ– Mongodb æ•°æ®åº“ç®¡ç†å·¥å…· ï¼Œç‚¹å‡»<a href=\"https://robomongo.org/download\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>ä¸‹è½½ï¼Œå®˜æ–¹ç½‘ç«™ï¼š<a href=\"https://robomongo.org/\" target=\"_blank\" rel=\"noopener\">https://robomongo.org/</a> ã€‚</p>\n<h3 id=\"Mongoose-ä»‹ç»\"><a href=\"#Mongoose-ä»‹ç»\" class=\"headerlink\" title=\"Mongoose ä»‹ç»\"></a>Mongoose ä»‹ç»</h3><p><a href=\"http://mongoosejs.com/\" target=\"_blank\" rel=\"noopener\">Mongoose</a> ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ Node ç¯å¢ƒä¸­æ“ä½œ MongoDB æ•°æ®åº“çš„ä¸€ç§å¯¹è±¡æ¨¡å‹å·¥å…·ï¼ŒMongoose å°†æ•°æ®åº“ä¸­çš„æ•°æ®è½¬æ¢ä¸º JavaScript å¯¹è±¡ä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚</p>\n<h4 id=\"é…ç½®\"><a href=\"#é…ç½®\" class=\"headerlink\" title=\"é…ç½®\"></a>é…ç½®</h4><p>å®‰è£… Mongoose<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install mongoose --save</span><br></pre></td></tr></table></figure></p>\n<p>å¼•å…¥åˆ°é¡¹ç›®æ–‡ä»¶ä¸­å¹¶åˆ›å»ºé“¾æ¥<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\">mongoose.connect(<span class=\"string\">'mongodb://localhost/my_database'</span>);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"æ–°å¢æ•°æ®\"><a href=\"#æ–°å¢æ•°æ®\" class=\"headerlink\" title=\"æ–°å¢æ•°æ®\"></a>æ–°å¢æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"username\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"comment\">// æ•°æ®é›†</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> content = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"Nick\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">23</span>,<span class=\"attr\">sex</span>:<span class=\"string\">'ç”·'</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹åŒ–å¯¹è±¡å¹¶æ’å…¥æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monInsert = <span class=\"keyword\">new</span> monModel(content);</span><br><span class=\"line\">monInsert.save(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'æˆåŠŸæ’å…¥æ•°æ®'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"åˆ é™¤æ•°æ®\"><a href=\"#åˆ é™¤æ•°æ®\" class=\"headerlink\" title=\"åˆ é™¤æ•°æ®\"></a>åˆ é™¤æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// cosole.log(db);</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"comment\">// åŸæ•°æ®å­—æ®µå€¼</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> oldValue  = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"Nick\"</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å•æ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData1 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å¤šæ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData2 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">2</span>&#125;&#125;;</span><br><span class=\"line\">monModel.update(oldValue,newData,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,result</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"update\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"æŸ¥è¯¢æ•°æ®\"><a href=\"#æŸ¥è¯¢æ•°æ®\" class=\"headerlink\" title=\"æŸ¥è¯¢æ•°æ®\"></a>æŸ¥è¯¢æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// cosole.log(db);</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"keyword\">var</span> content = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å§“å2\"</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">var</span> field = &#123;<span class=\"attr\">name</span>:<span class=\"number\">1</span>,<span class=\"attr\">age</span>:<span class=\"number\">1</span>,<span class=\"attr\">sex</span>:<span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">monModel.find(content,field,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,result</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(result);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"ä¿®æ”¹æ•°æ®\"><a href=\"#ä¿®æ”¹æ•°æ®\" class=\"headerlink\" title=\"ä¿®æ”¹æ•°æ®\"></a>ä¿®æ”¹æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// cosole.log(db);</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"comment\">// åŸæ•°æ®å­—æ®µå€¼</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> oldValue  = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"Nick\"</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å•æ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData1 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å¤šæ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData2 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">2</span>&#125;&#125;;</span><br><span class=\"line\">monModel.update(oldValue,newData,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,result</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"update\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>è®°å½• Mongodb çš„å­¦ä¹ ä¹‹æ—…ï¼Œä»ç¯å¢ƒé…ç½®ï¼Œåˆ°åŸºç¡€å‘½ä»¤è¡Œä½¿ç”¨ï¼Œç®—æ˜¯ä¸€ä¸ªç®€å•çš„å…¥é—¨æ•™ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å­¦ä¹ æ€»ç»“ï¼Œè¿˜æœ‰æŠŠè¸©åˆ°çš„å‘éƒ½è®°å½•ä¸‹æ¥ï¼Œä»¥åé‡åˆ°åŒæ ·çš„é—®é¢˜ä¸è‡³äºåœ¨åŒä¸€ä¸ªåœ°æ–¹ç»§ç»­è¸©å‘ã€‚<br>","more":"</p>\n<h3 id=\"Mongodb-ä»‹ç»\"><a href=\"#Mongodb-ä»‹ç»\" class=\"headerlink\" title=\"Mongodb ä»‹ç»\"></a>Mongodb ä»‹ç»</h3><blockquote>\n<p>MongoDBæ˜¯ä¸€ç§æ–‡æ¡£å¯¼å‘<strong><em>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</em></strong>ï¼Œç”±C++æ’°å†™è€Œæˆï¼Œæ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚2007å¹´10æœˆï¼ŒMongoDBç”±10genå›¢é˜Ÿæ‰€å‘å±•ã€‚2009å¹´2æœˆé¦–åº¦æ¨å‡ºã€‚ â€” <strong><em>ç»´åŸºç™¾ç§‘</em></strong></p>\n</blockquote>\n<p>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å¬ç€å¾ˆé¥¶ï¼Œå…¶å®å°±æ˜¯éå…³ç³»æ•°æ®åº“ã€‚é‚£ä»€ä¹ˆåˆæ˜¯ <strong><em>å…³ç³»å‹æ•°æ®åº“</em></strong> å‘¢ï¼Ÿå…³ç³»å‹æ•°æ®åº“ä»¥è¡Œå’Œåˆ—çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œè¿™ä¸€ç³»åˆ—çš„è¡Œå’Œåˆ—è¢«ç§°ä¸ºè¡¨ï¼Œä¸€ç»„è¡¨ç»„æˆäº†æ•°æ®åº“ã€‚è¡¨ä¸è¡¨ä¹‹é—´çš„æ•°æ®è®°å½•æœ‰å…³ç³»ã€‚</p>\n<h3 id=\"Mongodb-å®‰è£…\"><a href=\"#Mongodb-å®‰è£…\" class=\"headerlink\" title=\"Mongodb å®‰è£…\"></a>Mongodb å®‰è£…</h3><p>æœ¬äººçš„æ“ä½œç³»ç»Ÿæ˜¯ï¼šMacOSï¼Œä¸”å·²ç»å®‰è£…äº† <a href=\"http://brew.sh/index_zh-cn.html\" target=\"_blank\" rel=\"noopener\">brew</a> ï¼Œæ‰€ä»¥å›¾çœäº‹ï¼Œæˆ‘å°±ä½¿ç”¨ brew ä¸€é”®å®‰è£…äº†ã€‚æ²¡ç”¨è¿‡ brew çš„åŒå­¦å¯ä»¥å»<a href=\"http://www.cnblogs.com/TankXiao/p/3247113.html\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œçœ‹çœ‹</a>ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install mongodb</span><br></pre></td></tr></table></figure>\n<p>å®‰è£…é€Ÿåº¦å–å†³äºä½ çš„ç½‘ç»œæƒ…å†µï¼Œè¿™é‡Œç¨ç­‰ç‰‡åˆ»ã€‚brew é»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ <code>/usr/local/Cellar/</code> ä¸€ä¼šçš„åŠŸå¤«ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨è¿™é‡Œçœ‹åˆ°ï¼ŒMongodb ä¹–ä¹–çš„èººåœ¨è¿™äº†ã€‚å› ä¸º Mongodb ä¼šé»˜è®¤è¯»å– <code>/data/db</code> ç›®å½•ä¸‹çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æ–¹ä¾¿çœäº‹ï¼Œæˆ‘ä»¬æŠŠé»˜è®¤çš„æ•°æ®åº“å°±åˆ›å»ºåœ¨è¿™ä¸ªä½ç½®ï¼Œå¹¶ä¸”ç»™ <code>/data</code> æ‰§è¡Œæƒé™ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mkdir -p /data/db         <span class=\"comment\"># sudo è¡¨ç¤ºä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œ-p è¡¨ç¤ºåˆ›å»ºå¤šå±‚ç›®å½•</span></span><br><span class=\"line\">sudo chown -R  UserName /data  <span class=\"comment\"># UserName è¡¨ç¤ºä½ å½“å‰çš„ç³»ç»Ÿç”¨æˆ·å</span></span><br></pre></td></tr></table></figure>\n<p>å®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨ Mongodb çš„å®‰è£…ç›®å½•ä¸‹ æ‰¾åˆ° <code>bin</code> ç›®å½•äº†ï¼Œè¿™é‡Œé¢æ”¾ç€æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„å‘½ä»¤ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/Cellar/mongodb/3.4.0/bin</span><br><span class=\"line\">./mongod   <span class=\"comment\"># æ‰§è¡Œ Mongodb è¿›ç¨‹åï¼Œæµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:27017/</span></span><br></pre></td></tr></table></figure></p>\n<p>æµè§ˆå™¨æ˜¾ç¤ºä¸‹é¢çš„å†…å®¹ï¼Œå°±è¡¨ç¤ºå®‰è£…æˆåŠŸå•¦ã€‚<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">It looks like you are trying to access MongoDB over HTTP on the native driver port.</span><br></pre></td></tr></table></figure></p>\n<p>æ¥ä¸‹æ¥æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒéªŒè¯æˆ‘ä»¬ç¡®å®å®‰è£…æˆåŠŸäº†ã€‚åœ¨ Mongodb çš„æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥æ‰§è¡Œå¾ˆå¤šå‘½ä»¤æ¥æ“ä½œæ•°æ®åº“ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/Cellar/mongodb/3.4.0/bin</span><br><span class=\"line\">./mongo</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿›å…¥ MongoDB shell åï¼Œå…‰æ ‡ä¼šå˜æˆä¸‹é¢è¿‡çš„çŠ¶æ€ï¼Œæ‰§è¡Œ show dbs åï¼Œæ˜¾ç¤ºå¦‚ä¸‹åˆ™å¤§åŠŸå‘Šæˆï¼</span></span><br><span class=\"line\">&gt; show dbs</span><br><span class=\"line\">admin  0.000GB</span><br><span class=\"line\"><span class=\"built_in\">local</span>  0.000GB</span><br></pre></td></tr></table></figure></p>\n<p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹æ¬¡æ‰§è¡Œ Mongodb ï¼Œæˆ‘ä»¬æŠŠ <code>bin</code> ç›®å½•æ”¾åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä¸‹æ¬¡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ <code>mongod</code> å³å¯å¯ç”¨æœåŠ¡ï¼Œè¾“å…¥å‘½ä»¤ <code>mongo</code> å³å¯è¿›å…¥ shell æ§åˆ¶å°ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè¯­æ³•ï¼šecho \"export PATH=xxxxxx:$PATH\" &gt;&gt; ~/.bash_profile</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PATH=/usr/local/Cellar/mongodb/3.4.0/bin:$PATH'</span>&gt;&gt;~/.bash_profile</span><br></pre></td></tr></table></figure>\n<h3 id=\"Mongodb-ä½¿ç”¨\"><a href=\"#Mongodb-ä½¿ç”¨\" class=\"headerlink\" title=\"Mongodb ä½¿ç”¨\"></a>Mongodb ä½¿ç”¨</h3><p>ä½¿ç”¨ä¹‹å‰ï¼Œåœ¨æ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼Œç›¸æ¯”å…³ç³»å‹æ•°æ®åº“ï¼Œéå…³ç³»æ•°æ®åº“é‡‡ç”¨äº† <strong><em>æ•°æ®åº“</em></strong>ã€<strong><em>é›†åˆ</em></strong>ã€<strong><em>æ–‡æ¡£</em></strong>ã€çš„æ¦‚å¿µã€‚å…¶å®å¯¹æ¯” SQL æ•°æ®åº“ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ï¼Œé›†åˆå°±å¥½æ¯”æ˜¯ä¸€å¼ è¡¨ï¼Œæ–‡æ¡£å¥½æ¯”å°±æ˜¯ä¸€æ•´è¡Œæ•°æ®ã€‚åº“çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚å°±è¿™ç‚¹åŒºåˆ«ã€‚åœ¨ç»ˆç«¯è¾“å…¥ <code>mongo</code> è¿›å…¥shell æ§åˆ¶å°ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"åŸºç¡€å‘½ä»¤\"><a href=\"#åŸºç¡€å‘½ä»¤\" class=\"headerlink\" title=\"åŸºç¡€å‘½ä»¤\"></a>åŸºç¡€å‘½ä»¤</h4><p>æ–°å¢æ•°æ®</p>\n<ul>\n<li>æ˜¾ç¤ºæ•°æ®åº“ï¼š<code>show dbs</code></li>\n<li>ä½¿ç”¨/åˆ›å»ºæ•°æ®åº“ï¼š<code>use æ•°æ®åº“å</code></li>\n<li>æ˜¾ç¤ºé›†åˆï¼š<code>show collections</code></li>\n<li>ä¿å­˜æ•°æ®ï¼š<code>db.collection.save({&quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;})</code></li>\n<li>æ’å…¥æ•°æ®ï¼š<code>db.collection.insert({&quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;})</code></li>\n</ul>\n<div class=\"tip\"><br>è‹¥æ–°å¢çš„æ•°æ®ä¸»é”®å·²ç»å­˜åœ¨ï¼Œinsert()ä¼šä¸åšæ“ä½œå¹¶æç¤ºé”™è¯¯ï¼Œè€Œsave()åˆ™æ›´æ”¹åŸæ¥çš„å†…å®¹ä¸ºæ–°å†…å®¹ã€‚<br></div>\n\n<p>åˆ é™¤æ•°æ®</p>\n<ul>\n<li>åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼š<code>db.collection.remove({})</code></li>\n<li>åˆ é™¤æŒ‡å®šæ–‡æ¡£ï¼š<code>db.collection.remove({&quot;key&quot;:&quot;value&quot;})</code></li>\n<li>åˆ é™¤é›†åˆï¼š<code>db.collection.drop()</code> æˆ–è€… <code>db.runCommand({&quot;drop&quot;:&quot;collection&quot;})</code></li>\n<li>åˆ é™¤æ•°æ®åº“ï¼š<code>db.runCommand({&quot;dropDatabase&quot;: 1})</code> æ³¨æ„ï¼š1æ²¡æœ‰å¼•å·</li>\n</ul>\n<p>æŸ¥æ‰¾æ•°æ®</p>\n<ul>\n<li>æŸ¥æ‰¾æ‰€æœ‰æ•°æ®ï¼š <code>db.collection.find({})</code></li>\n<li>æŸ¥åˆ°å•æ¡æ•°æ®ï¼š<code>db.collection.findOne({})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:&quot;value&quot;})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ key &lt; valueï¼š<code>db.collection.find({&quot;key&quot;:{$lt:value}})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ key &gt; valueï¼š<code>db.collection.find({&quot;key&quot;:{$gt:value}})</code></li>\n<li>æ¡ä»¶æŸ¥æ‰¾ key &gt;= valueï¼š<code>db.collection.find({&quot;key&quot;:{$gte:value}})</code></li>\n<li>èŒƒå›´æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$gt:value1,$lt:value2 } })</code></li>\n<li>æ¨¡è¿ç®—æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$mod:[10,1]}})</code></li>\n<li>èŒƒå›´åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$in:[1,2,3]}})</code></li>\n<li>èŒƒå›´ä¸åœ¨åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$nin:[1,2,3]}})</code></li>\n<li>æ•°ç»„é•¿åº¦æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$size:1}})</code> key å¿…é¡»æ˜¯æ•°ç»„</li>\n<li>å­—æ®µå­˜åœ¨æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:{$exists:true|false}})</code></li>\n<li>å¤šæ¡ä»¶æŸ¥æ‰¾ï¼š<code>db.collection.find({$or:[{a:1},{b:2}]})</code></li>\n<li>å†…åµŒå¯¹è±¡ä¸­çš„å€¼æŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key.subkey&quot;:value})</code></li>\n<li>æ’åºï¼š<code>db.collection.find({}).sort({&quot;key1&quot;:1,&quot;key2&quot;:-1})</code> 1å‡åº -1é™åº</li>\n<li>å¯¹å­—æ®µå»ºç«‹ç´¢å¼•ï¼š<code>db.collection.find({})ensureIndex({&quot;key&quot;:1})</code> 1å‡åº -1é™åº</li>\n<li>èŒƒå›´æ§åˆ¶æŸ¥æ‰¾ï¼š<code>db.collection.find().skip(5).limit(5)</code> è·³è¿‡5æ¡ï¼Œè¯»å–5æ¡</li>\n<li>æŸ¥è¯¢ç»“æœé›†ç»Ÿè®¡ï¼š<code>db.collection.find().count()</code></li>\n<li>æ¨¡ç³ŠæŸ¥æ‰¾ï¼š<code>db.collection.find({&quot;key&quot;:/ab/})</code> æ­£åˆ™</li>\n</ul>\n<p>æ›´æ”¹æ•°æ®</p>\n<ul>\n<li><code>db.collection.update({&quot;targetKey&quot;:&quot;targetValue&quot;},{&quot;newKey&quot;:&quot;newVlue&quot;})</code></li>\n</ul>\n<h4 id=\"GUI-å·¥å…·\"><a href=\"#GUI-å·¥å…·\" class=\"headerlink\" title=\"GUI å·¥å…·\"></a>GUI å·¥å…·</h4><p><img src=\"http://ww1.sinaimg.cn/large/6057861cgw1fbfwwdbu8qj20zq0dbqah.jpg\" alt=\"\"><br><strong><em>Robomongo</em></strong> å¯è§†åŒ– Mongodb æ•°æ®åº“ç®¡ç†å·¥å…· ï¼Œç‚¹å‡»<a href=\"https://robomongo.org/download\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>ä¸‹è½½ï¼Œå®˜æ–¹ç½‘ç«™ï¼š<a href=\"https://robomongo.org/\" target=\"_blank\" rel=\"noopener\">https://robomongo.org/</a> ã€‚</p>\n<h3 id=\"Mongoose-ä»‹ç»\"><a href=\"#Mongoose-ä»‹ç»\" class=\"headerlink\" title=\"Mongoose ä»‹ç»\"></a>Mongoose ä»‹ç»</h3><p><a href=\"http://mongoosejs.com/\" target=\"_blank\" rel=\"noopener\">Mongoose</a> ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ Node ç¯å¢ƒä¸­æ“ä½œ MongoDB æ•°æ®åº“çš„ä¸€ç§å¯¹è±¡æ¨¡å‹å·¥å…·ï¼ŒMongoose å°†æ•°æ®åº“ä¸­çš„æ•°æ®è½¬æ¢ä¸º JavaScript å¯¹è±¡ä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚</p>\n<h4 id=\"é…ç½®\"><a href=\"#é…ç½®\" class=\"headerlink\" title=\"é…ç½®\"></a>é…ç½®</h4><p>å®‰è£… Mongoose<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install mongoose --save</span><br></pre></td></tr></table></figure></p>\n<p>å¼•å…¥åˆ°é¡¹ç›®æ–‡ä»¶ä¸­å¹¶åˆ›å»ºé“¾æ¥<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\">mongoose.connect(<span class=\"string\">'mongodb://localhost/my_database'</span>);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"æ–°å¢æ•°æ®\"><a href=\"#æ–°å¢æ•°æ®\" class=\"headerlink\" title=\"æ–°å¢æ•°æ®\"></a>æ–°å¢æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"username\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"comment\">// æ•°æ®é›†</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> content = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"Nick\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">23</span>,<span class=\"attr\">sex</span>:<span class=\"string\">'ç”·'</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹åŒ–å¯¹è±¡å¹¶æ’å…¥æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monInsert = <span class=\"keyword\">new</span> monModel(content);</span><br><span class=\"line\">monInsert.save(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'æˆåŠŸæ’å…¥æ•°æ®'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"åˆ é™¤æ•°æ®\"><a href=\"#åˆ é™¤æ•°æ®\" class=\"headerlink\" title=\"åˆ é™¤æ•°æ®\"></a>åˆ é™¤æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// cosole.log(db);</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"comment\">// åŸæ•°æ®å­—æ®µå€¼</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> oldValue  = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"Nick\"</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å•æ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData1 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å¤šæ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData2 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">2</span>&#125;&#125;;</span><br><span class=\"line\">monModel.update(oldValue,newData,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,result</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"update\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"æŸ¥è¯¢æ•°æ®\"><a href=\"#æŸ¥è¯¢æ•°æ®\" class=\"headerlink\" title=\"æŸ¥è¯¢æ•°æ®\"></a>æŸ¥è¯¢æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// cosole.log(db);</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"keyword\">var</span> content = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å§“å2\"</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">var</span> field = &#123;<span class=\"attr\">name</span>:<span class=\"number\">1</span>,<span class=\"attr\">age</span>:<span class=\"number\">1</span>,<span class=\"attr\">sex</span>:<span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">monModel.find(content,field,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,result</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(result);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"ä¿®æ”¹æ•°æ®\"><a href=\"#ä¿®æ”¹æ•°æ®\" class=\"headerlink\" title=\"ä¿®æ”¹æ•°æ®\"></a>ä¿®æ”¹æ•°æ®</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> mongoose = <span class=\"built_in\">require</span>(<span class=\"string\">'mongoose'</span>);</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> db = mongoose.createConnection(<span class=\"string\">'mongodb://127.0.0.1:27017/test'</span>);</span><br><span class=\"line\"><span class=\"comment\">// cosole.log(db);</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½®æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monSchema = <span class=\"keyword\">new</span> mongooose.Schema(&#123;</span><br><span class=\"line\">    name:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>,<span class=\"attr\">default</span>:<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">    ageï¼š&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">Number</span>&#125;,</span><br><span class=\"line\">    sex:&#123;<span class=\"attr\">type</span>:<span class=\"built_in\">String</span>&#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// é€‰æ‹©é›†åˆ</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> monModel = db.model(<span class=\"string\">'user'</span>,monSchema);</span><br><span class=\"line\"><span class=\"comment\">// åŸæ•°æ®å­—æ®µå€¼</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> oldValue  = &#123;<span class=\"attr\">name</span>:<span class=\"string\">\"Nick\"</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å•æ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData1 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"comment\">// å¤šæ¡ä»¶æ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> newData2 = &#123;<span class=\"attr\">$set</span>:&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"å†…å®¹\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">2</span>&#125;&#125;;</span><br><span class=\"line\">monModel.update(oldValue,newData,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,result</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(err)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"update\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  db.close();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>"},{"title":"Node.JS å­¦ä¹ ç¬”è®° [02] -- åŒæ­¥å¼‚æ­¥","date":"2015-01-03T00:27:02.000Z","comments":0,"_content":"\nåœ¨ä½¿ç”¨ npm çš„æ—¶å€™ï¼Œæˆ‘å‘ç°åœ¨é€Ÿåº¦å®åœ¨å¤ªæ…¢ï¼Œå®‰è£…å°ä¸€ç‚¹çš„åŒ…ç¡®å®æ²¡å•¥é—®é¢˜ï¼Œè£…å¤§ä¸€ç‚¹çš„ï¼Œä¾èµ–å¤šä¸€ç‚¹çš„åŒ…çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ã€‚é€Ÿåº¦æ…¢ï¼Œå“åº”è¿Ÿé’ã€‚***nrm*** æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®‰è£… nrm åï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„å‘½ä»¤å¿«é€Ÿæ¥åˆ‡æ¢ npm æºï¼Œæ¯”å¦‚åˆ‡æ¢åˆ° cnpmã€taobao æºç­‰ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥ç‚¹[è¿™é‡Œ](https://github.com/Pana/nrm#install)è¿›å»äº†è§£ä¸‹ã€‚\n<!-- more -->\n### Node.js ä½¿ç”¨\n\n#### Node.js æ§åˆ¶å°\nå‰é¢è¯´äº†ï¼ŒNode.js æä¾›äº† REPL æ¨¡å¼æ¥è§£æè¾“å…¥çš„æ¯æ¡å‘½ä»¤ï¼Œç°åœ¨å¯ä»¥å®æˆ˜ä¸€ä¸‹äº†ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œç„¶åè¾“å…¥ `node` è¿›å…¥ Node.js å¼€å§‹æ•²å‘½ä»¤å§ï¼\n```js\nconsole.log('hello,world!'); // æ™®é€šè¾“å…¥\nconsole.error('é”™è¯¯æ¶ˆæ¯');    // é”™è¯¯è¾“å‡º\nconsole.time('time');        // ä¼šè®¡ç®—åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¹‹é—´çš„ä»£ç å—æ‰§è¡Œè€—æ—¶\n// {...}\nconsole.time('time');\nconsole.assert(3>10,'str..');// æ–­è¨€ï¼šè¡¨è¾¾å¼ä¸æˆç«‹ï¼Œä¼šè¾“å‡ºåé¢çš„å­—ç¬¦ä¸²\n```\n\n#### Node.js ä½œç”¨åŸŸ\n- å…¨å±€ä½œç”¨åŸŸï¼šæ²¡æœ‰ä½¿ç”¨ `var` éšå¼å£°æ˜çš„ä¸€ä¸ªå˜é‡ï¼Œä¼šäº«å—å…¨å±€ä½œç”¨åŸŸï¼Œæˆ–è€…åœ¨ `global` ä¸ŠæŒ‚è½½çš„å˜é‡ï¼Œä¹Ÿå…·æœ‰å…¨å±€ä½œç”¨åŸŸçš„å±æ€§ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«å…¶å®ƒæ¨¡å—ä½¿ç”¨ã€‚\n- å±€éƒ¨ä½œç”¨åŸŸï¼šåœ¨ Node.js ä¸­ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œåœ¨è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨è¿™ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ã€‚\n\n```js\n// è¿™äº›å˜é‡éƒ½å±äºå…¨å±€å˜é‡\nname = 'ifyour';\nglobal.age = 18; // Node.js ä¸­çš„ global ç±»ä¼¼ JavaScript ä¸­çš„ window\n```\n<div class='tip'>\nå°½é‡é¿å…ä½¿ç”¨å…¨å±€å˜é‡ï¼Œä¼šé€ æˆå˜é‡æ±¡æŸ“ã€‚\n</div>\n\n#### å›è°ƒå‡½æ•°\nNode.js ä¸­å¤§é‡ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹‹å‰åœ¨ç®€ä¹¦å†™äº†ä¸€ç¯‡ï¼Œæˆ‘çš„ç†è§£å¿ƒå¾—ï¼Œæœ‰å…´è¶£çš„å¯ä»¥[å»çœ‹çœ‹](http://www.jianshu.com/p/1383f4cb9a75)ã€‚å…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹Ÿæ­£æ˜¯åœ¨ Node.js ä¸­å¯¹å®ƒçš„ç†è§£æ›´ä¸ºæ·±åˆ»äº†ï¼ŒNode.js å¤§é‡çš„å¼‚æ­¥ä»£ç éƒ½å€ŸåŠ©å›è°ƒå‡½æ•°å®ç°ï¼Œæ­£å› å¦‚æ­¤ï¼Œæ€§èƒ½æ›´é«˜å‘€ã€‚çœ‹ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚\n\n```js\n// å®šä¹‰å›è°ƒå‡½æ•°\nfunction cb(){\n  console.log('Hello,callback!');\n}\n\n// æŠŠå›è°ƒå‡½æ•°çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ä¼ å…¥è¯¥å‡½æ•°ï¼Œä¸€ç§’åæ‰§è¡Œ\nsetTimeout(cb,1000);\n```\nå€ŸåŠ©è¿™ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°å›è°ƒå‡½æ•°çš„å®ç°æœºåˆ¶ï¼š\n- å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼ˆå…¶å®å®ƒå°±æ˜¯å›è°ƒå‡½æ•°ï¼‰\n- å°†è¯¥å‡½æ•°çš„å¼•ç”¨åœ°å€ä½œä¸ºå‚æ•°ä¼ ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å­ä¸­çš„ `setTimeout`\n- å½“ç‰¹å®šæ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè°ƒç”¨è€…ä½¿ç”¨è¿™ä¸ªå¼•ç”¨åœ°å€å»æ‰§è¡Œè¯¥å‡½æ•°\n\nå›è°ƒå‡½æ•°çš„ç”¨é€”å¾ˆå¤šï¼Œæ¯”å¦‚å®ç°äº‹ä»¶æ³¨å†Œã€å¼‚æ­¥ä»£ç ç­‰ã€‚åœ¨ jQuery ä¸­çš„åŠ¨ç”»å°±æ˜¯å›è°ƒå‡½æ•°çš„ç»å…¸ç”¨æ³•ï¼Œ`animate(x,y,z,function(){...})`,å½“ä¸€ä¸ªåŠ¨ç”»æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚å½“ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„å‡½æ•°å—ï¼Œè¿™äº›éƒ½æ˜¯å›è°ƒå‡½æ•°ã€‚\n\n### Node.js äº‹ä»¶\nNode.js ä¸­çš„ event æ¨¡å—å°±æ˜¯æä¾›äº‹ä»¶ç¼–ç¨‹çš„ APIï¼Œæ‰€æœ‰å…·æœ‰è§¦å‘äº‹ä»¶çš„å¯¹è±¡éƒ½ç»§æ‰¿æˆ–å†…éƒ¨åŒ…å«äº† `EventEmitter` å¯¹è±¡ã€‚æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­å§ï¼\n```js\n//events æ¨¡å—ä¸­çš„ EventEmitter å¯¹è±¡ï¼Œå®šä¹‰äº†äº‹ä»¶å¯¹è±¡çš„åŸºç¡€ä¿¡æ¯å’Œè¡Œä¸º\nvar EventEmitter = require('events').EventEmitter;\nvar event = new EventEmitter();// å®ä¾‹åŒ–ä¸€ä¸ª event å¯¹è±¡\nevent.on('myevent',function(name){ // ç»‘å®š myevent äº‹ä»¶\n    console.log('Hi!' + name);\n});\nevent.emit('myevent','ifyour');// è§¦å‘äº‹ä»¶\n```\n#### äº‹ä»¶å¸¸ç”¨æ–¹æ³•\n\n|æ–¹æ³•                               | æè¿°                                                     |\n|:---------------------------------|:---------------------------------------------------------|\n|addListener(event, listener)      | ä¸ºæŒ‡å®šäº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨åˆ°ç›‘å¬å™¨æ•°ç»„çš„å°¾éƒ¨ã€‚ä¸onç­‰ä»·          |\n|on(event, listener)               | ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸² event å’Œä¸€ä¸ªå›è°ƒå‡½æ•° |\n|once(event, listener)             | ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªå•æ¬¡ç›‘å¬å™¨                                |\n|removeListener(event,listener)    |ç§»é™¤æŒ‡å®šäº‹ä»¶çš„æŸä¸ªç›‘å¬å™¨ï¼Œç›‘å¬å™¨å¿…é¡»æ˜¯è¯¥äº‹ä»¶å·²ç»æ³¨å†Œè¿‡çš„ç›‘å¬å™¨  |\n|removeAllListeners([event])       |ç§»é™¤æ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨å¦‚æœæŒ‡å®šäº‹ä»¶ï¼Œåˆ™ç§»é™¤è¯¥äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨  |\n|setMaxListeners(n)                |setMaxListeners å‡½æ•°ç”¨äºæé«˜ç›‘å¬å™¨çš„é»˜è®¤é™åˆ¶çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ 10 |\n|listeners(event)                  |è¿”å›æŒ‡å®šäº‹ä»¶çš„ç›‘å¬å™¨æ•°ç»„                                    |\n|emit(event, [arg1], [arg2], [...])|æŒ‰é¡ºåºæ‰§è¡Œç›‘å¬å™¨ï¼Œå¦‚æœäº‹ä»¶æœ‰æ³¨å†Œç›‘å¬è¿”å› trueï¼Œå¦åˆ™è¿”å› false |\n\n\n### Node.js å¼‚æ­¥ä¸åŒæ­¥\n\n***åŒæ­¥***ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰€æœ‰ä»»åŠ¡æ¶ˆè€—æ—¶é—´ä¹‹å’Œã€‚\n***å¼‚æ­¥***ï¼šå‡ ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œä¸é™åˆ¶å…ˆåï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰§è¡Œè€—æ—¶æœ€é•¿çš„é‚£ä¸ªä»»åŠ¡çš„æ¶ˆè€—æ—¶é—´ã€‚\n\nåœ¨ Node.js ä¸­æ¯ä¸€ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œä¸æ˜¯æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ï¼Œè€Œæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåä¸€ä¸ªä»»åŠ¡åˆ™æ˜¯ä¸ç­‰å‰ä¸€ä¸ªä»»åŠ¡ç»“æŸå°±æ‰§è¡Œï¼Œæ‰€ä»¥ç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€å¼‚æ­¥çš„ã€‚\n\n#### å¼‚æ­¥çš„å®ç°\n- å›è°ƒå‡½æ•°\n- äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰\n- Promise ï¼ˆES6ï¼‰\n\nå‰é¢å·²ç»è®²äº†å›è°ƒå‡½æ•°çš„å®ç°æ–¹å¼ï¼Œä¸‹é¢ä¸¾ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜ Node.js ä¸­ ***äº‹ä»¶*** å’Œ ***Promise*** å®ç°å¼‚æ­¥ã€‚\n```js\n// äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰å®ç°å¼‚æ­¥\nvar fs = require('fs');\n\nvar stream = fs.createReadStream('./data');// è°ƒç”¨ fs æ¨¡å—åˆ›å»ºä¸€ä¸ªè¯»å–æµå¯¹è±¡\nstream.on('data',getData);// è¯»å–äº‹ä»¶ï¼Œæ¯æ¬¡è¯»å–æ—¶è§¦å‘è°ƒç”¨å›è°ƒå‡½æ•° getData\nstream.on('end',getDataDone);// è¯»å–å®Œæ¯•è°ƒç”¨å›è°ƒå‡½æ•° getDataDone\n\nfunction getDataDone() {\n    console.log('read done!');\n}\nfunction getData(data) {\n    console.log(data.toString());\n}\n```\nä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“è¯»å–å¤šä¸ª `data` æ–‡ä»¶æ—¶ï¼Œè¾“å‡ºçš„å†…å®¹çš„é¡ºåºå¯èƒ½ä¸ä¸€è‡´ï¼Œå› ä¸ºäº‹ä»¶é‡‡ç”¨å›è°ƒå‡½æ•°å®ç°äº†å¼‚æ­¥æ“ä½œã€‚å¯ä»¥çœ‹å‡ºï¼Œäº‹ä»¶å®ç°å¼‚æ­¥ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å›è°ƒå‡½æ•°ã€‚\n\n> æ‰€è°“Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚\n\nä¸‹é¢æ¥çœ‹çœ‹ `Promise` çš„ä¸€ä¸ªå®ä¾‹ï¼š\n```js\nvar fs = require('fs');\n\nvar p = new Promise(function (resolve, reject) {// ä½¿ç”¨ Promise ç”Ÿæˆå®ä¾‹\n    fs.readFile('./1', 'utf-8', function (err, data) {// readFile æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•\n        if (!err) {\n            resolve(data);\n        } else {\n            reject(err);\n        }\n    })\n});\n\np.then(function (data) {// è°ƒç”¨å®ä¾‹çš„ then æ–¹æ³•\n    console.log(data);\n}, function (err) {\n    console.log(err);\n});\n```\nES6 è§„å®šï¼ŒPromise å¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Promise å®ä¾‹ã€‚Promise æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ `resolve` å’Œ `reject`ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± JavaScript å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚\n\n- resolve : åœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›\n- reject  : åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚\n\nPromiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨ `then` æ–¹æ³•åˆ†åˆ«æŒ‡å®š Resolved çŠ¶æ€å’Œ Reject çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚\n```js\npromise.then(function(value) {\n  // success\n}, function(error) {\n  // failure\n});\n```\næœ‰äº† Promise å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼ŒPromise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚\n\nä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåœ¨æœªä½¿ç”¨ `Promise` æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦ `p1` è¯»å–å®Œæ•°æ®åï¼Œç´§æ¥ç€ `p2` ã€`p3` è¯»å–ï¼Œå°±éœ€è¦åœ¨ `p1` çš„å›è°ƒè¯»å–æˆåŠŸå‡½æ•°é‡Œç»§ç»­å†™ `p2` çš„è¯»å–ï¼Œç±»ä¼¼çš„ `p3` ä¹Ÿè¦åœ¨ `p2` çš„å›è°ƒå‡½æ•°ä¸­å†™ï¼Œè¿™å°±é€ æˆäº† ***å±‚å±‚åµŒå¥—*** ä¸åˆ©äºä»£ç é˜…è¯»ã€‚è€Œä½¿ç”¨ `Promise` åï¼Œ`then` æ–¹æ³•æŠŠé‡Œé¢çš„å›è°ƒå‡½æ•°ç»Ÿä¸€æå–å‡ºæ¥ï¼Œ å¯è¯»æ€§æ›´å¥½äº†ï¼Œä¹Ÿæ–¹ä¾¿ç†è§£ã€‚\n```js\n// Promise æä¾›çš„ then æ–¹æ³•é¿å…å±‚æ¬¡åµŒå¥—ï¼Œç›¸å½“äºå®ç° then çš„é“¾å¼æ“ä½œ\n// p1 æ‰§è¡Œå®Œ then æ–¹æ³•åï¼Œé€šè¿‡ return p2 ï¼Œè®© p2 ç»§ç»­æ‰§è¡Œ then æ–¹æ³•\np1.then(function(data){\n    console.log(data);\n    return p2;\n},function(err){\n    console.log(err);\n    return p2;\n}).then(function(data){\n    console.log(data);\n    return p3;\n},function(err){\n    console.log(err);\n    return p3;\n}).then(function(data){\n    console.log(data);\n},function(){\n    console.log(err);\n});\n```\næ›´å¤š Promise è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒé˜®ä¸€å³°çš„ã€Š[ECMAScript 6 å…¥é—¨](http://es6.ruanyifeng.com/#docs/promise#åŸºæœ¬ç”¨æ³•)ã€‹ã€‚\n","source":"_posts/Node.JS-å­¦ä¹ ç¬”è®°-[02]----åŒæ­¥å¼‚æ­¥.md","raw":"---\ntitle: 'Node.JS å­¦ä¹ ç¬”è®° [02] -- åŒæ­¥å¼‚æ­¥'\ndate: 2015-1-3 08:27:02\ncomments: false\n---\n\nåœ¨ä½¿ç”¨ npm çš„æ—¶å€™ï¼Œæˆ‘å‘ç°åœ¨é€Ÿåº¦å®åœ¨å¤ªæ…¢ï¼Œå®‰è£…å°ä¸€ç‚¹çš„åŒ…ç¡®å®æ²¡å•¥é—®é¢˜ï¼Œè£…å¤§ä¸€ç‚¹çš„ï¼Œä¾èµ–å¤šä¸€ç‚¹çš„åŒ…çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ã€‚é€Ÿåº¦æ…¢ï¼Œå“åº”è¿Ÿé’ã€‚***nrm*** æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®‰è£… nrm åï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„å‘½ä»¤å¿«é€Ÿæ¥åˆ‡æ¢ npm æºï¼Œæ¯”å¦‚åˆ‡æ¢åˆ° cnpmã€taobao æºç­‰ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥ç‚¹[è¿™é‡Œ](https://github.com/Pana/nrm#install)è¿›å»äº†è§£ä¸‹ã€‚\n<!-- more -->\n### Node.js ä½¿ç”¨\n\n#### Node.js æ§åˆ¶å°\nå‰é¢è¯´äº†ï¼ŒNode.js æä¾›äº† REPL æ¨¡å¼æ¥è§£æè¾“å…¥çš„æ¯æ¡å‘½ä»¤ï¼Œç°åœ¨å¯ä»¥å®æˆ˜ä¸€ä¸‹äº†ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œç„¶åè¾“å…¥ `node` è¿›å…¥ Node.js å¼€å§‹æ•²å‘½ä»¤å§ï¼\n```js\nconsole.log('hello,world!'); // æ™®é€šè¾“å…¥\nconsole.error('é”™è¯¯æ¶ˆæ¯');    // é”™è¯¯è¾“å‡º\nconsole.time('time');        // ä¼šè®¡ç®—åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¹‹é—´çš„ä»£ç å—æ‰§è¡Œè€—æ—¶\n// {...}\nconsole.time('time');\nconsole.assert(3>10,'str..');// æ–­è¨€ï¼šè¡¨è¾¾å¼ä¸æˆç«‹ï¼Œä¼šè¾“å‡ºåé¢çš„å­—ç¬¦ä¸²\n```\n\n#### Node.js ä½œç”¨åŸŸ\n- å…¨å±€ä½œç”¨åŸŸï¼šæ²¡æœ‰ä½¿ç”¨ `var` éšå¼å£°æ˜çš„ä¸€ä¸ªå˜é‡ï¼Œä¼šäº«å—å…¨å±€ä½œç”¨åŸŸï¼Œæˆ–è€…åœ¨ `global` ä¸ŠæŒ‚è½½çš„å˜é‡ï¼Œä¹Ÿå…·æœ‰å…¨å±€ä½œç”¨åŸŸçš„å±æ€§ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«å…¶å®ƒæ¨¡å—ä½¿ç”¨ã€‚\n- å±€éƒ¨ä½œç”¨åŸŸï¼šåœ¨ Node.js ä¸­ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œåœ¨è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨è¿™ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ã€‚\n\n```js\n// è¿™äº›å˜é‡éƒ½å±äºå…¨å±€å˜é‡\nname = 'ifyour';\nglobal.age = 18; // Node.js ä¸­çš„ global ç±»ä¼¼ JavaScript ä¸­çš„ window\n```\n<div class='tip'>\nå°½é‡é¿å…ä½¿ç”¨å…¨å±€å˜é‡ï¼Œä¼šé€ æˆå˜é‡æ±¡æŸ“ã€‚\n</div>\n\n#### å›è°ƒå‡½æ•°\nNode.js ä¸­å¤§é‡ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹‹å‰åœ¨ç®€ä¹¦å†™äº†ä¸€ç¯‡ï¼Œæˆ‘çš„ç†è§£å¿ƒå¾—ï¼Œæœ‰å…´è¶£çš„å¯ä»¥[å»çœ‹çœ‹](http://www.jianshu.com/p/1383f4cb9a75)ã€‚å…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹Ÿæ­£æ˜¯åœ¨ Node.js ä¸­å¯¹å®ƒçš„ç†è§£æ›´ä¸ºæ·±åˆ»äº†ï¼ŒNode.js å¤§é‡çš„å¼‚æ­¥ä»£ç éƒ½å€ŸåŠ©å›è°ƒå‡½æ•°å®ç°ï¼Œæ­£å› å¦‚æ­¤ï¼Œæ€§èƒ½æ›´é«˜å‘€ã€‚çœ‹ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚\n\n```js\n// å®šä¹‰å›è°ƒå‡½æ•°\nfunction cb(){\n  console.log('Hello,callback!');\n}\n\n// æŠŠå›è°ƒå‡½æ•°çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ä¼ å…¥è¯¥å‡½æ•°ï¼Œä¸€ç§’åæ‰§è¡Œ\nsetTimeout(cb,1000);\n```\nå€ŸåŠ©è¿™ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°å›è°ƒå‡½æ•°çš„å®ç°æœºåˆ¶ï¼š\n- å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼ˆå…¶å®å®ƒå°±æ˜¯å›è°ƒå‡½æ•°ï¼‰\n- å°†è¯¥å‡½æ•°çš„å¼•ç”¨åœ°å€ä½œä¸ºå‚æ•°ä¼ ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å­ä¸­çš„ `setTimeout`\n- å½“ç‰¹å®šæ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè°ƒç”¨è€…ä½¿ç”¨è¿™ä¸ªå¼•ç”¨åœ°å€å»æ‰§è¡Œè¯¥å‡½æ•°\n\nå›è°ƒå‡½æ•°çš„ç”¨é€”å¾ˆå¤šï¼Œæ¯”å¦‚å®ç°äº‹ä»¶æ³¨å†Œã€å¼‚æ­¥ä»£ç ç­‰ã€‚åœ¨ jQuery ä¸­çš„åŠ¨ç”»å°±æ˜¯å›è°ƒå‡½æ•°çš„ç»å…¸ç”¨æ³•ï¼Œ`animate(x,y,z,function(){...})`,å½“ä¸€ä¸ªåŠ¨ç”»æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚å½“ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„å‡½æ•°å—ï¼Œè¿™äº›éƒ½æ˜¯å›è°ƒå‡½æ•°ã€‚\n\n### Node.js äº‹ä»¶\nNode.js ä¸­çš„ event æ¨¡å—å°±æ˜¯æä¾›äº‹ä»¶ç¼–ç¨‹çš„ APIï¼Œæ‰€æœ‰å…·æœ‰è§¦å‘äº‹ä»¶çš„å¯¹è±¡éƒ½ç»§æ‰¿æˆ–å†…éƒ¨åŒ…å«äº† `EventEmitter` å¯¹è±¡ã€‚æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­å§ï¼\n```js\n//events æ¨¡å—ä¸­çš„ EventEmitter å¯¹è±¡ï¼Œå®šä¹‰äº†äº‹ä»¶å¯¹è±¡çš„åŸºç¡€ä¿¡æ¯å’Œè¡Œä¸º\nvar EventEmitter = require('events').EventEmitter;\nvar event = new EventEmitter();// å®ä¾‹åŒ–ä¸€ä¸ª event å¯¹è±¡\nevent.on('myevent',function(name){ // ç»‘å®š myevent äº‹ä»¶\n    console.log('Hi!' + name);\n});\nevent.emit('myevent','ifyour');// è§¦å‘äº‹ä»¶\n```\n#### äº‹ä»¶å¸¸ç”¨æ–¹æ³•\n\n|æ–¹æ³•                               | æè¿°                                                     |\n|:---------------------------------|:---------------------------------------------------------|\n|addListener(event, listener)      | ä¸ºæŒ‡å®šäº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨åˆ°ç›‘å¬å™¨æ•°ç»„çš„å°¾éƒ¨ã€‚ä¸onç­‰ä»·          |\n|on(event, listener)               | ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸² event å’Œä¸€ä¸ªå›è°ƒå‡½æ•° |\n|once(event, listener)             | ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªå•æ¬¡ç›‘å¬å™¨                                |\n|removeListener(event,listener)    |ç§»é™¤æŒ‡å®šäº‹ä»¶çš„æŸä¸ªç›‘å¬å™¨ï¼Œç›‘å¬å™¨å¿…é¡»æ˜¯è¯¥äº‹ä»¶å·²ç»æ³¨å†Œè¿‡çš„ç›‘å¬å™¨  |\n|removeAllListeners([event])       |ç§»é™¤æ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨å¦‚æœæŒ‡å®šäº‹ä»¶ï¼Œåˆ™ç§»é™¤è¯¥äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨  |\n|setMaxListeners(n)                |setMaxListeners å‡½æ•°ç”¨äºæé«˜ç›‘å¬å™¨çš„é»˜è®¤é™åˆ¶çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ 10 |\n|listeners(event)                  |è¿”å›æŒ‡å®šäº‹ä»¶çš„ç›‘å¬å™¨æ•°ç»„                                    |\n|emit(event, [arg1], [arg2], [...])|æŒ‰é¡ºåºæ‰§è¡Œç›‘å¬å™¨ï¼Œå¦‚æœäº‹ä»¶æœ‰æ³¨å†Œç›‘å¬è¿”å› trueï¼Œå¦åˆ™è¿”å› false |\n\n\n### Node.js å¼‚æ­¥ä¸åŒæ­¥\n\n***åŒæ­¥***ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰€æœ‰ä»»åŠ¡æ¶ˆè€—æ—¶é—´ä¹‹å’Œã€‚\n***å¼‚æ­¥***ï¼šå‡ ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œä¸é™åˆ¶å…ˆåï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰§è¡Œè€—æ—¶æœ€é•¿çš„é‚£ä¸ªä»»åŠ¡çš„æ¶ˆè€—æ—¶é—´ã€‚\n\nåœ¨ Node.js ä¸­æ¯ä¸€ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œä¸æ˜¯æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ï¼Œè€Œæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåä¸€ä¸ªä»»åŠ¡åˆ™æ˜¯ä¸ç­‰å‰ä¸€ä¸ªä»»åŠ¡ç»“æŸå°±æ‰§è¡Œï¼Œæ‰€ä»¥ç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€å¼‚æ­¥çš„ã€‚\n\n#### å¼‚æ­¥çš„å®ç°\n- å›è°ƒå‡½æ•°\n- äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰\n- Promise ï¼ˆES6ï¼‰\n\nå‰é¢å·²ç»è®²äº†å›è°ƒå‡½æ•°çš„å®ç°æ–¹å¼ï¼Œä¸‹é¢ä¸¾ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜ Node.js ä¸­ ***äº‹ä»¶*** å’Œ ***Promise*** å®ç°å¼‚æ­¥ã€‚\n```js\n// äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰å®ç°å¼‚æ­¥\nvar fs = require('fs');\n\nvar stream = fs.createReadStream('./data');// è°ƒç”¨ fs æ¨¡å—åˆ›å»ºä¸€ä¸ªè¯»å–æµå¯¹è±¡\nstream.on('data',getData);// è¯»å–äº‹ä»¶ï¼Œæ¯æ¬¡è¯»å–æ—¶è§¦å‘è°ƒç”¨å›è°ƒå‡½æ•° getData\nstream.on('end',getDataDone);// è¯»å–å®Œæ¯•è°ƒç”¨å›è°ƒå‡½æ•° getDataDone\n\nfunction getDataDone() {\n    console.log('read done!');\n}\nfunction getData(data) {\n    console.log(data.toString());\n}\n```\nä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“è¯»å–å¤šä¸ª `data` æ–‡ä»¶æ—¶ï¼Œè¾“å‡ºçš„å†…å®¹çš„é¡ºåºå¯èƒ½ä¸ä¸€è‡´ï¼Œå› ä¸ºäº‹ä»¶é‡‡ç”¨å›è°ƒå‡½æ•°å®ç°äº†å¼‚æ­¥æ“ä½œã€‚å¯ä»¥çœ‹å‡ºï¼Œäº‹ä»¶å®ç°å¼‚æ­¥ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å›è°ƒå‡½æ•°ã€‚\n\n> æ‰€è°“Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚\n\nä¸‹é¢æ¥çœ‹çœ‹ `Promise` çš„ä¸€ä¸ªå®ä¾‹ï¼š\n```js\nvar fs = require('fs');\n\nvar p = new Promise(function (resolve, reject) {// ä½¿ç”¨ Promise ç”Ÿæˆå®ä¾‹\n    fs.readFile('./1', 'utf-8', function (err, data) {// readFile æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•\n        if (!err) {\n            resolve(data);\n        } else {\n            reject(err);\n        }\n    })\n});\n\np.then(function (data) {// è°ƒç”¨å®ä¾‹çš„ then æ–¹æ³•\n    console.log(data);\n}, function (err) {\n    console.log(err);\n});\n```\nES6 è§„å®šï¼ŒPromise å¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Promise å®ä¾‹ã€‚Promise æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ `resolve` å’Œ `reject`ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± JavaScript å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚\n\n- resolve : åœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›\n- reject  : åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚\n\nPromiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨ `then` æ–¹æ³•åˆ†åˆ«æŒ‡å®š Resolved çŠ¶æ€å’Œ Reject çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚\n```js\npromise.then(function(value) {\n  // success\n}, function(error) {\n  // failure\n});\n```\næœ‰äº† Promise å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼ŒPromise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚\n\nä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåœ¨æœªä½¿ç”¨ `Promise` æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦ `p1` è¯»å–å®Œæ•°æ®åï¼Œç´§æ¥ç€ `p2` ã€`p3` è¯»å–ï¼Œå°±éœ€è¦åœ¨ `p1` çš„å›è°ƒè¯»å–æˆåŠŸå‡½æ•°é‡Œç»§ç»­å†™ `p2` çš„è¯»å–ï¼Œç±»ä¼¼çš„ `p3` ä¹Ÿè¦åœ¨ `p2` çš„å›è°ƒå‡½æ•°ä¸­å†™ï¼Œè¿™å°±é€ æˆäº† ***å±‚å±‚åµŒå¥—*** ä¸åˆ©äºä»£ç é˜…è¯»ã€‚è€Œä½¿ç”¨ `Promise` åï¼Œ`then` æ–¹æ³•æŠŠé‡Œé¢çš„å›è°ƒå‡½æ•°ç»Ÿä¸€æå–å‡ºæ¥ï¼Œ å¯è¯»æ€§æ›´å¥½äº†ï¼Œä¹Ÿæ–¹ä¾¿ç†è§£ã€‚\n```js\n// Promise æä¾›çš„ then æ–¹æ³•é¿å…å±‚æ¬¡åµŒå¥—ï¼Œç›¸å½“äºå®ç° then çš„é“¾å¼æ“ä½œ\n// p1 æ‰§è¡Œå®Œ then æ–¹æ³•åï¼Œé€šè¿‡ return p2 ï¼Œè®© p2 ç»§ç»­æ‰§è¡Œ then æ–¹æ³•\np1.then(function(data){\n    console.log(data);\n    return p2;\n},function(err){\n    console.log(err);\n    return p2;\n}).then(function(data){\n    console.log(data);\n    return p3;\n},function(err){\n    console.log(err);\n    return p3;\n}).then(function(data){\n    console.log(data);\n},function(){\n    console.log(err);\n});\n```\næ›´å¤š Promise è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒé˜®ä¸€å³°çš„ã€Š[ECMAScript 6 å…¥é—¨](http://es6.ruanyifeng.com/#docs/promise#åŸºæœ¬ç”¨æ³•)ã€‹ã€‚\n","slug":"Node.JS-å­¦ä¹ ç¬”è®°-[02]----åŒæ­¥å¼‚æ­¥","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidie000bu4q96jpr81qj","content":"<p>åœ¨ä½¿ç”¨ npm çš„æ—¶å€™ï¼Œæˆ‘å‘ç°åœ¨é€Ÿåº¦å®åœ¨å¤ªæ…¢ï¼Œå®‰è£…å°ä¸€ç‚¹çš„åŒ…ç¡®å®æ²¡å•¥é—®é¢˜ï¼Œè£…å¤§ä¸€ç‚¹çš„ï¼Œä¾èµ–å¤šä¸€ç‚¹çš„åŒ…çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ã€‚é€Ÿåº¦æ…¢ï¼Œå“åº”è¿Ÿé’ã€‚<strong><em>nrm</em></strong> æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®‰è£… nrm åï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„å‘½ä»¤å¿«é€Ÿæ¥åˆ‡æ¢ npm æºï¼Œæ¯”å¦‚åˆ‡æ¢åˆ° cnpmã€taobao æºç­‰ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥ç‚¹<a href=\"https://github.com/Pana/nrm#install\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>è¿›å»äº†è§£ä¸‹ã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"Node-js-ä½¿ç”¨\"><a href=\"#Node-js-ä½¿ç”¨\" class=\"headerlink\" title=\"Node.js ä½¿ç”¨\"></a>Node.js ä½¿ç”¨</h3><h4 id=\"Node-js-æ§åˆ¶å°\"><a href=\"#Node-js-æ§åˆ¶å°\" class=\"headerlink\" title=\"Node.js æ§åˆ¶å°\"></a>Node.js æ§åˆ¶å°</h4><p>å‰é¢è¯´äº†ï¼ŒNode.js æä¾›äº† REPL æ¨¡å¼æ¥è§£æè¾“å…¥çš„æ¯æ¡å‘½ä»¤ï¼Œç°åœ¨å¯ä»¥å®æˆ˜ä¸€ä¸‹äº†ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œç„¶åè¾“å…¥ <code>node</code> è¿›å…¥ Node.js å¼€å§‹æ•²å‘½ä»¤å§ï¼<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">'hello,world!'</span>); <span class=\"comment\">// æ™®é€šè¾“å…¥</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.error(<span class=\"string\">'é”™è¯¯æ¶ˆæ¯'</span>);    <span class=\"comment\">// é”™è¯¯è¾“å‡º</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'time'</span>);        <span class=\"comment\">// ä¼šè®¡ç®—åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¹‹é—´çš„ä»£ç å—æ‰§è¡Œè€—æ—¶</span></span><br><span class=\"line\"><span class=\"comment\">// &#123;...&#125;</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'time'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.assert(<span class=\"number\">3</span>&gt;<span class=\"number\">10</span>,<span class=\"string\">'str..'</span>);<span class=\"comment\">// æ–­è¨€ï¼šè¡¨è¾¾å¼ä¸æˆç«‹ï¼Œä¼šè¾“å‡ºåé¢çš„å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"Node-js-ä½œç”¨åŸŸ\"><a href=\"#Node-js-ä½œç”¨åŸŸ\" class=\"headerlink\" title=\"Node.js ä½œç”¨åŸŸ\"></a>Node.js ä½œç”¨åŸŸ</h4><ul>\n<li>å…¨å±€ä½œç”¨åŸŸï¼šæ²¡æœ‰ä½¿ç”¨ <code>var</code> éšå¼å£°æ˜çš„ä¸€ä¸ªå˜é‡ï¼Œä¼šäº«å—å…¨å±€ä½œç”¨åŸŸï¼Œæˆ–è€…åœ¨ <code>global</code> ä¸ŠæŒ‚è½½çš„å˜é‡ï¼Œä¹Ÿå…·æœ‰å…¨å±€ä½œç”¨åŸŸçš„å±æ€§ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«å…¶å®ƒæ¨¡å—ä½¿ç”¨ã€‚</li>\n<li>å±€éƒ¨ä½œç”¨åŸŸï¼šåœ¨ Node.js ä¸­ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œåœ¨è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨è¿™ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ã€‚</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿™äº›å˜é‡éƒ½å±äºå…¨å±€å˜é‡</span></span><br><span class=\"line\">name = <span class=\"string\">'ifyour'</span>;</span><br><span class=\"line\">global.age = <span class=\"number\">18</span>; <span class=\"comment\">// Node.js ä¸­çš„ global ç±»ä¼¼ JavaScript ä¸­çš„ window</span></span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br>å°½é‡é¿å…ä½¿ç”¨å…¨å±€å˜é‡ï¼Œä¼šé€ æˆå˜é‡æ±¡æŸ“ã€‚<br></div>\n\n<h4 id=\"å›è°ƒå‡½æ•°\"><a href=\"#å›è°ƒå‡½æ•°\" class=\"headerlink\" title=\"å›è°ƒå‡½æ•°\"></a>å›è°ƒå‡½æ•°</h4><p>Node.js ä¸­å¤§é‡ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹‹å‰åœ¨ç®€ä¹¦å†™äº†ä¸€ç¯‡ï¼Œæˆ‘çš„ç†è§£å¿ƒå¾—ï¼Œæœ‰å…´è¶£çš„å¯ä»¥<a href=\"http://www.jianshu.com/p/1383f4cb9a75\" target=\"_blank\" rel=\"noopener\">å»çœ‹çœ‹</a>ã€‚å…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹Ÿæ­£æ˜¯åœ¨ Node.js ä¸­å¯¹å®ƒçš„ç†è§£æ›´ä¸ºæ·±åˆ»äº†ï¼ŒNode.js å¤§é‡çš„å¼‚æ­¥ä»£ç éƒ½å€ŸåŠ©å›è°ƒå‡½æ•°å®ç°ï¼Œæ­£å› å¦‚æ­¤ï¼Œæ€§èƒ½æ›´é«˜å‘€ã€‚çœ‹ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å®šä¹‰å›è°ƒå‡½æ•°</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">cb</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'Hello,callback!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŠŠå›è°ƒå‡½æ•°çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ä¼ å…¥è¯¥å‡½æ•°ï¼Œä¸€ç§’åæ‰§è¡Œ</span></span><br><span class=\"line\">setTimeout(cb,<span class=\"number\">1000</span>);</span><br></pre></td></tr></table></figure>\n<p>å€ŸåŠ©è¿™ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°å›è°ƒå‡½æ•°çš„å®ç°æœºåˆ¶ï¼š</p>\n<ul>\n<li>å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼ˆå…¶å®å®ƒå°±æ˜¯å›è°ƒå‡½æ•°ï¼‰</li>\n<li>å°†è¯¥å‡½æ•°çš„å¼•ç”¨åœ°å€ä½œä¸ºå‚æ•°ä¼ ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å­ä¸­çš„ <code>setTimeout</code></li>\n<li>å½“ç‰¹å®šæ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè°ƒç”¨è€…ä½¿ç”¨è¿™ä¸ªå¼•ç”¨åœ°å€å»æ‰§è¡Œè¯¥å‡½æ•°</li>\n</ul>\n<p>å›è°ƒå‡½æ•°çš„ç”¨é€”å¾ˆå¤šï¼Œæ¯”å¦‚å®ç°äº‹ä»¶æ³¨å†Œã€å¼‚æ­¥ä»£ç ç­‰ã€‚åœ¨ jQuery ä¸­çš„åŠ¨ç”»å°±æ˜¯å›è°ƒå‡½æ•°çš„ç»å…¸ç”¨æ³•ï¼Œ<code>animate(x,y,z,function(){...})</code>,å½“ä¸€ä¸ªåŠ¨ç”»æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚å½“ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„å‡½æ•°å—ï¼Œè¿™äº›éƒ½æ˜¯å›è°ƒå‡½æ•°ã€‚</p>\n<h3 id=\"Node-js-äº‹ä»¶\"><a href=\"#Node-js-äº‹ä»¶\" class=\"headerlink\" title=\"Node.js äº‹ä»¶\"></a>Node.js äº‹ä»¶</h3><p>Node.js ä¸­çš„ event æ¨¡å—å°±æ˜¯æä¾›äº‹ä»¶ç¼–ç¨‹çš„ APIï¼Œæ‰€æœ‰å…·æœ‰è§¦å‘äº‹ä»¶çš„å¯¹è±¡éƒ½ç»§æ‰¿æˆ–å†…éƒ¨åŒ…å«äº† <code>EventEmitter</code> å¯¹è±¡ã€‚æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­å§ï¼<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//events æ¨¡å—ä¸­çš„ EventEmitter å¯¹è±¡ï¼Œå®šä¹‰äº†äº‹ä»¶å¯¹è±¡çš„åŸºç¡€ä¿¡æ¯å’Œè¡Œä¸º</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> EventEmitter = <span class=\"built_in\">require</span>(<span class=\"string\">'events'</span>).EventEmitter;</span><br><span class=\"line\"><span class=\"keyword\">var</span> event = <span class=\"keyword\">new</span> EventEmitter();<span class=\"comment\">// å®ä¾‹åŒ–ä¸€ä¸ª event å¯¹è±¡</span></span><br><span class=\"line\">event.on(<span class=\"string\">'myevent'</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>)</span>&#123; <span class=\"comment\">// ç»‘å®š myevent äº‹ä»¶</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Hi!'</span> + name);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">event.emit(<span class=\"string\">'myevent'</span>,<span class=\"string\">'ifyour'</span>);<span class=\"comment\">// è§¦å‘äº‹ä»¶</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"äº‹ä»¶å¸¸ç”¨æ–¹æ³•\"><a href=\"#äº‹ä»¶å¸¸ç”¨æ–¹æ³•\" class=\"headerlink\" title=\"äº‹ä»¶å¸¸ç”¨æ–¹æ³•\"></a>äº‹ä»¶å¸¸ç”¨æ–¹æ³•</h4><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">æ–¹æ³•</th>\n<th style=\"text-align:left\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">addListener(event, listener)</td>\n<td style=\"text-align:left\">ä¸ºæŒ‡å®šäº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨åˆ°ç›‘å¬å™¨æ•°ç»„çš„å°¾éƒ¨ã€‚ä¸onç­‰ä»·</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">on(event, listener)</td>\n<td style=\"text-align:left\">ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸² event å’Œä¸€ä¸ªå›è°ƒå‡½æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">once(event, listener)</td>\n<td style=\"text-align:left\">ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªå•æ¬¡ç›‘å¬å™¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">removeListener(event,listener)</td>\n<td style=\"text-align:left\">ç§»é™¤æŒ‡å®šäº‹ä»¶çš„æŸä¸ªç›‘å¬å™¨ï¼Œç›‘å¬å™¨å¿…é¡»æ˜¯è¯¥äº‹ä»¶å·²ç»æ³¨å†Œè¿‡çš„ç›‘å¬å™¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">removeAllListeners([event])</td>\n<td style=\"text-align:left\">ç§»é™¤æ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨å¦‚æœæŒ‡å®šäº‹ä»¶ï¼Œåˆ™ç§»é™¤è¯¥äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setMaxListeners(n)</td>\n<td style=\"text-align:left\">setMaxListeners å‡½æ•°ç”¨äºæé«˜ç›‘å¬å™¨çš„é»˜è®¤é™åˆ¶çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ 10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">listeners(event)</td>\n<td style=\"text-align:left\">è¿”å›æŒ‡å®šäº‹ä»¶çš„ç›‘å¬å™¨æ•°ç»„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">emit(event, [arg1], [arg2], [â€¦])</td>\n<td style=\"text-align:left\">æŒ‰é¡ºåºæ‰§è¡Œç›‘å¬å™¨ï¼Œå¦‚æœäº‹ä»¶æœ‰æ³¨å†Œç›‘å¬è¿”å› trueï¼Œå¦åˆ™è¿”å› false</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Node-js-å¼‚æ­¥ä¸åŒæ­¥\"><a href=\"#Node-js-å¼‚æ­¥ä¸åŒæ­¥\" class=\"headerlink\" title=\"Node.js å¼‚æ­¥ä¸åŒæ­¥\"></a>Node.js å¼‚æ­¥ä¸åŒæ­¥</h3><p><strong><em>åŒæ­¥</em></strong>ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰€æœ‰ä»»åŠ¡æ¶ˆè€—æ—¶é—´ä¹‹å’Œã€‚<br><strong><em>å¼‚æ­¥</em></strong>ï¼šå‡ ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œä¸é™åˆ¶å…ˆåï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰§è¡Œè€—æ—¶æœ€é•¿çš„é‚£ä¸ªä»»åŠ¡çš„æ¶ˆè€—æ—¶é—´ã€‚</p>\n<p>åœ¨ Node.js ä¸­æ¯ä¸€ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œä¸æ˜¯æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ï¼Œè€Œæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåä¸€ä¸ªä»»åŠ¡åˆ™æ˜¯ä¸ç­‰å‰ä¸€ä¸ªä»»åŠ¡ç»“æŸå°±æ‰§è¡Œï¼Œæ‰€ä»¥ç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€å¼‚æ­¥çš„ã€‚</p>\n<h4 id=\"å¼‚æ­¥çš„å®ç°\"><a href=\"#å¼‚æ­¥çš„å®ç°\" class=\"headerlink\" title=\"å¼‚æ­¥çš„å®ç°\"></a>å¼‚æ­¥çš„å®ç°</h4><ul>\n<li>å›è°ƒå‡½æ•°</li>\n<li>äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰</li>\n<li>Promise ï¼ˆES6ï¼‰</li>\n</ul>\n<p>å‰é¢å·²ç»è®²äº†å›è°ƒå‡½æ•°çš„å®ç°æ–¹å¼ï¼Œä¸‹é¢ä¸¾ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜ Node.js ä¸­ <strong><em>äº‹ä»¶</em></strong> å’Œ <strong><em>Promise</em></strong> å®ç°å¼‚æ­¥ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰å®ç°å¼‚æ­¥</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> stream = fs.createReadStream(<span class=\"string\">'./data'</span>);<span class=\"comment\">// è°ƒç”¨ fs æ¨¡å—åˆ›å»ºä¸€ä¸ªè¯»å–æµå¯¹è±¡</span></span><br><span class=\"line\">stream.on(<span class=\"string\">'data'</span>,getData);<span class=\"comment\">// è¯»å–äº‹ä»¶ï¼Œæ¯æ¬¡è¯»å–æ—¶è§¦å‘è°ƒç”¨å›è°ƒå‡½æ•° getData</span></span><br><span class=\"line\">stream.on(<span class=\"string\">'end'</span>,getDataDone);<span class=\"comment\">// è¯»å–å®Œæ¯•è°ƒç”¨å›è°ƒå‡½æ•° getDataDone</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getDataDone</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'read done!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getData</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data.toString());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“è¯»å–å¤šä¸ª <code>data</code> æ–‡ä»¶æ—¶ï¼Œè¾“å‡ºçš„å†…å®¹çš„é¡ºåºå¯èƒ½ä¸ä¸€è‡´ï¼Œå› ä¸ºäº‹ä»¶é‡‡ç”¨å›è°ƒå‡½æ•°å®ç°äº†å¼‚æ­¥æ“ä½œã€‚å¯ä»¥çœ‹å‡ºï¼Œäº‹ä»¶å®ç°å¼‚æ­¥ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å›è°ƒå‡½æ•°ã€‚</p>\n<blockquote>\n<p>æ‰€è°“Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢æ¥çœ‹çœ‹ <code>Promise</code> çš„ä¸€ä¸ªå®ä¾‹ï¼š<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">resolve, reject</span>) </span>&#123;<span class=\"comment\">// ä½¿ç”¨ Promise ç”Ÿæˆå®ä¾‹</span></span><br><span class=\"line\">    fs.readFile(<span class=\"string\">'./1'</span>, <span class=\"string\">'utf-8'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, data</span>) </span>&#123;<span class=\"comment\">// readFile æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!err) &#123;</span><br><span class=\"line\">            resolve(data);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            reject(err);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">p.then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;<span class=\"comment\">// è°ƒç”¨å®ä¾‹çš„ then æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>ES6 è§„å®šï¼ŒPromise å¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Promise å®ä¾‹ã€‚Promise æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ <code>resolve</code> å’Œ <code>reject</code>ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± JavaScript å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚</p>\n<ul>\n<li>resolve : åœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›</li>\n<li>reject  : åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚</li>\n</ul>\n<p>Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨ <code>then</code> æ–¹æ³•åˆ†åˆ«æŒ‡å®š Resolved çŠ¶æ€å’Œ Reject çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promise.then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// success</span></span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// failure</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>æœ‰äº† Promise å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼ŒPromise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚</p>\n<p>ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåœ¨æœªä½¿ç”¨ <code>Promise</code> æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦ <code>p1</code> è¯»å–å®Œæ•°æ®åï¼Œç´§æ¥ç€ <code>p2</code> ã€<code>p3</code> è¯»å–ï¼Œå°±éœ€è¦åœ¨ <code>p1</code> çš„å›è°ƒè¯»å–æˆåŠŸå‡½æ•°é‡Œç»§ç»­å†™ <code>p2</code> çš„è¯»å–ï¼Œç±»ä¼¼çš„ <code>p3</code> ä¹Ÿè¦åœ¨ <code>p2</code> çš„å›è°ƒå‡½æ•°ä¸­å†™ï¼Œè¿™å°±é€ æˆäº† <strong><em>å±‚å±‚åµŒå¥—</em></strong> ä¸åˆ©äºä»£ç é˜…è¯»ã€‚è€Œä½¿ç”¨ <code>Promise</code> åï¼Œ<code>then</code> æ–¹æ³•æŠŠé‡Œé¢çš„å›è°ƒå‡½æ•°ç»Ÿä¸€æå–å‡ºæ¥ï¼Œ å¯è¯»æ€§æ›´å¥½äº†ï¼Œä¹Ÿæ–¹ä¾¿ç†è§£ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Promise æä¾›çš„ then æ–¹æ³•é¿å…å±‚æ¬¡åµŒå¥—ï¼Œç›¸å½“äºå®ç° then çš„é“¾å¼æ“ä½œ</span></span><br><span class=\"line\"><span class=\"comment\">// p1 æ‰§è¡Œå®Œ then æ–¹æ³•åï¼Œé€šè¿‡ return p2 ï¼Œè®© p2 ç»§ç»­æ‰§è¡Œ then æ–¹æ³•</span></span><br><span class=\"line\">p1.then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p2;</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p2;</span><br><span class=\"line\">&#125;).then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p3;</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p3;</span><br><span class=\"line\">&#125;).then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>æ›´å¤š Promise è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒé˜®ä¸€å³°çš„ã€Š<a href=\"http://es6.ruanyifeng.com/#docs/promise#åŸºæœ¬ç”¨æ³•\" target=\"_blank\" rel=\"noopener\">ECMAScript 6 å…¥é—¨</a>ã€‹ã€‚</p>\n","site":{"data":{}},"excerpt":"<p>åœ¨ä½¿ç”¨ npm çš„æ—¶å€™ï¼Œæˆ‘å‘ç°åœ¨é€Ÿåº¦å®åœ¨å¤ªæ…¢ï¼Œå®‰è£…å°ä¸€ç‚¹çš„åŒ…ç¡®å®æ²¡å•¥é—®é¢˜ï¼Œè£…å¤§ä¸€ç‚¹çš„ï¼Œä¾èµ–å¤šä¸€ç‚¹çš„åŒ…çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ã€‚é€Ÿåº¦æ…¢ï¼Œå“åº”è¿Ÿé’ã€‚<strong><em>nrm</em></strong> æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®‰è£… nrm åï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„å‘½ä»¤å¿«é€Ÿæ¥åˆ‡æ¢ npm æºï¼Œæ¯”å¦‚åˆ‡æ¢åˆ° cnpmã€taobao æºç­‰ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥ç‚¹<a href=\"https://github.com/Pana/nrm#install\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>è¿›å»äº†è§£ä¸‹ã€‚<br>","more":"</p>\n<h3 id=\"Node-js-ä½¿ç”¨\"><a href=\"#Node-js-ä½¿ç”¨\" class=\"headerlink\" title=\"Node.js ä½¿ç”¨\"></a>Node.js ä½¿ç”¨</h3><h4 id=\"Node-js-æ§åˆ¶å°\"><a href=\"#Node-js-æ§åˆ¶å°\" class=\"headerlink\" title=\"Node.js æ§åˆ¶å°\"></a>Node.js æ§åˆ¶å°</h4><p>å‰é¢è¯´äº†ï¼ŒNode.js æä¾›äº† REPL æ¨¡å¼æ¥è§£æè¾“å…¥çš„æ¯æ¡å‘½ä»¤ï¼Œç°åœ¨å¯ä»¥å®æˆ˜ä¸€ä¸‹äº†ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œç„¶åè¾“å…¥ <code>node</code> è¿›å…¥ Node.js å¼€å§‹æ•²å‘½ä»¤å§ï¼<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">'hello,world!'</span>); <span class=\"comment\">// æ™®é€šè¾“å…¥</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.error(<span class=\"string\">'é”™è¯¯æ¶ˆæ¯'</span>);    <span class=\"comment\">// é”™è¯¯è¾“å‡º</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'time'</span>);        <span class=\"comment\">// ä¼šè®¡ç®—åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¹‹é—´çš„ä»£ç å—æ‰§è¡Œè€—æ—¶</span></span><br><span class=\"line\"><span class=\"comment\">// &#123;...&#125;</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.time(<span class=\"string\">'time'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.assert(<span class=\"number\">3</span>&gt;<span class=\"number\">10</span>,<span class=\"string\">'str..'</span>);<span class=\"comment\">// æ–­è¨€ï¼šè¡¨è¾¾å¼ä¸æˆç«‹ï¼Œä¼šè¾“å‡ºåé¢çš„å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"Node-js-ä½œç”¨åŸŸ\"><a href=\"#Node-js-ä½œç”¨åŸŸ\" class=\"headerlink\" title=\"Node.js ä½œç”¨åŸŸ\"></a>Node.js ä½œç”¨åŸŸ</h4><ul>\n<li>å…¨å±€ä½œç”¨åŸŸï¼šæ²¡æœ‰ä½¿ç”¨ <code>var</code> éšå¼å£°æ˜çš„ä¸€ä¸ªå˜é‡ï¼Œä¼šäº«å—å…¨å±€ä½œç”¨åŸŸï¼Œæˆ–è€…åœ¨ <code>global</code> ä¸ŠæŒ‚è½½çš„å˜é‡ï¼Œä¹Ÿå…·æœ‰å…¨å±€ä½œç”¨åŸŸçš„å±æ€§ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«å…¶å®ƒæ¨¡å—ä½¿ç”¨ã€‚</li>\n<li>å±€éƒ¨ä½œç”¨åŸŸï¼šåœ¨ Node.js ä¸­ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œåœ¨è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨è¿™ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ã€‚</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿™äº›å˜é‡éƒ½å±äºå…¨å±€å˜é‡</span></span><br><span class=\"line\">name = <span class=\"string\">'ifyour'</span>;</span><br><span class=\"line\">global.age = <span class=\"number\">18</span>; <span class=\"comment\">// Node.js ä¸­çš„ global ç±»ä¼¼ JavaScript ä¸­çš„ window</span></span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br>å°½é‡é¿å…ä½¿ç”¨å…¨å±€å˜é‡ï¼Œä¼šé€ æˆå˜é‡æ±¡æŸ“ã€‚<br></div>\n\n<h4 id=\"å›è°ƒå‡½æ•°\"><a href=\"#å›è°ƒå‡½æ•°\" class=\"headerlink\" title=\"å›è°ƒå‡½æ•°\"></a>å›è°ƒå‡½æ•°</h4><p>Node.js ä¸­å¤§é‡ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹‹å‰åœ¨ç®€ä¹¦å†™äº†ä¸€ç¯‡ï¼Œæˆ‘çš„ç†è§£å¿ƒå¾—ï¼Œæœ‰å…´è¶£çš„å¯ä»¥<a href=\"http://www.jianshu.com/p/1383f4cb9a75\" target=\"_blank\" rel=\"noopener\">å»çœ‹çœ‹</a>ã€‚å…³äºå›è°ƒå‡½æ•°ï¼Œæˆ‘ä¹Ÿæ­£æ˜¯åœ¨ Node.js ä¸­å¯¹å®ƒçš„ç†è§£æ›´ä¸ºæ·±åˆ»äº†ï¼ŒNode.js å¤§é‡çš„å¼‚æ­¥ä»£ç éƒ½å€ŸåŠ©å›è°ƒå‡½æ•°å®ç°ï¼Œæ­£å› å¦‚æ­¤ï¼Œæ€§èƒ½æ›´é«˜å‘€ã€‚çœ‹ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å®šä¹‰å›è°ƒå‡½æ•°</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">cb</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'Hello,callback!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŠŠå›è°ƒå‡½æ•°çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ä¼ å…¥è¯¥å‡½æ•°ï¼Œä¸€ç§’åæ‰§è¡Œ</span></span><br><span class=\"line\">setTimeout(cb,<span class=\"number\">1000</span>);</span><br></pre></td></tr></table></figure>\n<p>å€ŸåŠ©è¿™ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°å›è°ƒå‡½æ•°çš„å®ç°æœºåˆ¶ï¼š</p>\n<ul>\n<li>å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼ˆå…¶å®å®ƒå°±æ˜¯å›è°ƒå‡½æ•°ï¼‰</li>\n<li>å°†è¯¥å‡½æ•°çš„å¼•ç”¨åœ°å€ä½œä¸ºå‚æ•°ä¼ ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å­ä¸­çš„ <code>setTimeout</code></li>\n<li>å½“ç‰¹å®šæ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè°ƒç”¨è€…ä½¿ç”¨è¿™ä¸ªå¼•ç”¨åœ°å€å»æ‰§è¡Œè¯¥å‡½æ•°</li>\n</ul>\n<p>å›è°ƒå‡½æ•°çš„ç”¨é€”å¾ˆå¤šï¼Œæ¯”å¦‚å®ç°äº‹ä»¶æ³¨å†Œã€å¼‚æ­¥ä»£ç ç­‰ã€‚åœ¨ jQuery ä¸­çš„åŠ¨ç”»å°±æ˜¯å›è°ƒå‡½æ•°çš„ç»å…¸ç”¨æ³•ï¼Œ<code>animate(x,y,z,function(){...})</code>,å½“ä¸€ä¸ªåŠ¨ç”»æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚å½“ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„å‡½æ•°å—ï¼Œè¿™äº›éƒ½æ˜¯å›è°ƒå‡½æ•°ã€‚</p>\n<h3 id=\"Node-js-äº‹ä»¶\"><a href=\"#Node-js-äº‹ä»¶\" class=\"headerlink\" title=\"Node.js äº‹ä»¶\"></a>Node.js äº‹ä»¶</h3><p>Node.js ä¸­çš„ event æ¨¡å—å°±æ˜¯æä¾›äº‹ä»¶ç¼–ç¨‹çš„ APIï¼Œæ‰€æœ‰å…·æœ‰è§¦å‘äº‹ä»¶çš„å¯¹è±¡éƒ½ç»§æ‰¿æˆ–å†…éƒ¨åŒ…å«äº† <code>EventEmitter</code> å¯¹è±¡ã€‚æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­å§ï¼<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//events æ¨¡å—ä¸­çš„ EventEmitter å¯¹è±¡ï¼Œå®šä¹‰äº†äº‹ä»¶å¯¹è±¡çš„åŸºç¡€ä¿¡æ¯å’Œè¡Œä¸º</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> EventEmitter = <span class=\"built_in\">require</span>(<span class=\"string\">'events'</span>).EventEmitter;</span><br><span class=\"line\"><span class=\"keyword\">var</span> event = <span class=\"keyword\">new</span> EventEmitter();<span class=\"comment\">// å®ä¾‹åŒ–ä¸€ä¸ª event å¯¹è±¡</span></span><br><span class=\"line\">event.on(<span class=\"string\">'myevent'</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>)</span>&#123; <span class=\"comment\">// ç»‘å®š myevent äº‹ä»¶</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Hi!'</span> + name);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">event.emit(<span class=\"string\">'myevent'</span>,<span class=\"string\">'ifyour'</span>);<span class=\"comment\">// è§¦å‘äº‹ä»¶</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"äº‹ä»¶å¸¸ç”¨æ–¹æ³•\"><a href=\"#äº‹ä»¶å¸¸ç”¨æ–¹æ³•\" class=\"headerlink\" title=\"äº‹ä»¶å¸¸ç”¨æ–¹æ³•\"></a>äº‹ä»¶å¸¸ç”¨æ–¹æ³•</h4><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">æ–¹æ³•</th>\n<th style=\"text-align:left\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">addListener(event, listener)</td>\n<td style=\"text-align:left\">ä¸ºæŒ‡å®šäº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨åˆ°ç›‘å¬å™¨æ•°ç»„çš„å°¾éƒ¨ã€‚ä¸onç­‰ä»·</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">on(event, listener)</td>\n<td style=\"text-align:left\">ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸² event å’Œä¸€ä¸ªå›è°ƒå‡½æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">once(event, listener)</td>\n<td style=\"text-align:left\">ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªå•æ¬¡ç›‘å¬å™¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">removeListener(event,listener)</td>\n<td style=\"text-align:left\">ç§»é™¤æŒ‡å®šäº‹ä»¶çš„æŸä¸ªç›‘å¬å™¨ï¼Œç›‘å¬å™¨å¿…é¡»æ˜¯è¯¥äº‹ä»¶å·²ç»æ³¨å†Œè¿‡çš„ç›‘å¬å™¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">removeAllListeners([event])</td>\n<td style=\"text-align:left\">ç§»é™¤æ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨å¦‚æœæŒ‡å®šäº‹ä»¶ï¼Œåˆ™ç§»é™¤è¯¥äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setMaxListeners(n)</td>\n<td style=\"text-align:left\">setMaxListeners å‡½æ•°ç”¨äºæé«˜ç›‘å¬å™¨çš„é»˜è®¤é™åˆ¶çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ 10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">listeners(event)</td>\n<td style=\"text-align:left\">è¿”å›æŒ‡å®šäº‹ä»¶çš„ç›‘å¬å™¨æ•°ç»„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">emit(event, [arg1], [arg2], [â€¦])</td>\n<td style=\"text-align:left\">æŒ‰é¡ºåºæ‰§è¡Œç›‘å¬å™¨ï¼Œå¦‚æœäº‹ä»¶æœ‰æ³¨å†Œç›‘å¬è¿”å› trueï¼Œå¦åˆ™è¿”å› false</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Node-js-å¼‚æ­¥ä¸åŒæ­¥\"><a href=\"#Node-js-å¼‚æ­¥ä¸åŒæ­¥\" class=\"headerlink\" title=\"Node.js å¼‚æ­¥ä¸åŒæ­¥\"></a>Node.js å¼‚æ­¥ä¸åŒæ­¥</h3><p><strong><em>åŒæ­¥</em></strong>ï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰€æœ‰ä»»åŠ¡æ¶ˆè€—æ—¶é—´ä¹‹å’Œã€‚<br><strong><em>å¼‚æ­¥</em></strong>ï¼šå‡ ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œä¸é™åˆ¶å…ˆåï¼Œæ‰§è¡Œæ€»æ—¶é—´ç­‰äºæ‰§è¡Œè€—æ—¶æœ€é•¿çš„é‚£ä¸ªä»»åŠ¡çš„æ¶ˆè€—æ—¶é—´ã€‚</p>\n<p>åœ¨ Node.js ä¸­æ¯ä¸€ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œä¸æ˜¯æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ï¼Œè€Œæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåä¸€ä¸ªä»»åŠ¡åˆ™æ˜¯ä¸ç­‰å‰ä¸€ä¸ªä»»åŠ¡ç»“æŸå°±æ‰§è¡Œï¼Œæ‰€ä»¥ç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€å¼‚æ­¥çš„ã€‚</p>\n<h4 id=\"å¼‚æ­¥çš„å®ç°\"><a href=\"#å¼‚æ­¥çš„å®ç°\" class=\"headerlink\" title=\"å¼‚æ­¥çš„å®ç°\"></a>å¼‚æ­¥çš„å®ç°</h4><ul>\n<li>å›è°ƒå‡½æ•°</li>\n<li>äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰</li>\n<li>Promise ï¼ˆES6ï¼‰</li>\n</ul>\n<p>å‰é¢å·²ç»è®²äº†å›è°ƒå‡½æ•°çš„å®ç°æ–¹å¼ï¼Œä¸‹é¢ä¸¾ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜ Node.js ä¸­ <strong><em>äº‹ä»¶</em></strong> å’Œ <strong><em>Promise</em></strong> å®ç°å¼‚æ­¥ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// äº‹ä»¶ï¼ˆåŸºäºå›è°ƒå‡½æ•°ï¼‰å®ç°å¼‚æ­¥</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> stream = fs.createReadStream(<span class=\"string\">'./data'</span>);<span class=\"comment\">// è°ƒç”¨ fs æ¨¡å—åˆ›å»ºä¸€ä¸ªè¯»å–æµå¯¹è±¡</span></span><br><span class=\"line\">stream.on(<span class=\"string\">'data'</span>,getData);<span class=\"comment\">// è¯»å–äº‹ä»¶ï¼Œæ¯æ¬¡è¯»å–æ—¶è§¦å‘è°ƒç”¨å›è°ƒå‡½æ•° getData</span></span><br><span class=\"line\">stream.on(<span class=\"string\">'end'</span>,getDataDone);<span class=\"comment\">// è¯»å–å®Œæ¯•è°ƒç”¨å›è°ƒå‡½æ•° getDataDone</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getDataDone</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'read done!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getData</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data.toString());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“è¯»å–å¤šä¸ª <code>data</code> æ–‡ä»¶æ—¶ï¼Œè¾“å‡ºçš„å†…å®¹çš„é¡ºåºå¯èƒ½ä¸ä¸€è‡´ï¼Œå› ä¸ºäº‹ä»¶é‡‡ç”¨å›è°ƒå‡½æ•°å®ç°äº†å¼‚æ­¥æ“ä½œã€‚å¯ä»¥çœ‹å‡ºï¼Œäº‹ä»¶å®ç°å¼‚æ­¥ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å›è°ƒå‡½æ•°ã€‚</p>\n<blockquote>\n<p>æ‰€è°“Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢æ¥çœ‹çœ‹ <code>Promise</code> çš„ä¸€ä¸ªå®ä¾‹ï¼š<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">resolve, reject</span>) </span>&#123;<span class=\"comment\">// ä½¿ç”¨ Promise ç”Ÿæˆå®ä¾‹</span></span><br><span class=\"line\">    fs.readFile(<span class=\"string\">'./1'</span>, <span class=\"string\">'utf-8'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, data</span>) </span>&#123;<span class=\"comment\">// readFile æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!err) &#123;</span><br><span class=\"line\">            resolve(data);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            reject(err);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">p.then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;<span class=\"comment\">// è°ƒç”¨å®ä¾‹çš„ then æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>ES6 è§„å®šï¼ŒPromise å¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Promise å®ä¾‹ã€‚Promise æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ <code>resolve</code> å’Œ <code>reject</code>ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± JavaScript å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚</p>\n<ul>\n<li>resolve : åœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›</li>\n<li>reject  : åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚</li>\n</ul>\n<p>Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨ <code>then</code> æ–¹æ³•åˆ†åˆ«æŒ‡å®š Resolved çŠ¶æ€å’Œ Reject çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promise.then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">value</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// success</span></span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// failure</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>æœ‰äº† Promise å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼ŒPromise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚</p>\n<p>ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåœ¨æœªä½¿ç”¨ <code>Promise</code> æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦ <code>p1</code> è¯»å–å®Œæ•°æ®åï¼Œç´§æ¥ç€ <code>p2</code> ã€<code>p3</code> è¯»å–ï¼Œå°±éœ€è¦åœ¨ <code>p1</code> çš„å›è°ƒè¯»å–æˆåŠŸå‡½æ•°é‡Œç»§ç»­å†™ <code>p2</code> çš„è¯»å–ï¼Œç±»ä¼¼çš„ <code>p3</code> ä¹Ÿè¦åœ¨ <code>p2</code> çš„å›è°ƒå‡½æ•°ä¸­å†™ï¼Œè¿™å°±é€ æˆäº† <strong><em>å±‚å±‚åµŒå¥—</em></strong> ä¸åˆ©äºä»£ç é˜…è¯»ã€‚è€Œä½¿ç”¨ <code>Promise</code> åï¼Œ<code>then</code> æ–¹æ³•æŠŠé‡Œé¢çš„å›è°ƒå‡½æ•°ç»Ÿä¸€æå–å‡ºæ¥ï¼Œ å¯è¯»æ€§æ›´å¥½äº†ï¼Œä¹Ÿæ–¹ä¾¿ç†è§£ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Promise æä¾›çš„ then æ–¹æ³•é¿å…å±‚æ¬¡åµŒå¥—ï¼Œç›¸å½“äºå®ç° then çš„é“¾å¼æ“ä½œ</span></span><br><span class=\"line\"><span class=\"comment\">// p1 æ‰§è¡Œå®Œ then æ–¹æ³•åï¼Œé€šè¿‡ return p2 ï¼Œè®© p2 ç»§ç»­æ‰§è¡Œ then æ–¹æ³•</span></span><br><span class=\"line\">p1.then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p2;</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p2;</span><br><span class=\"line\">&#125;).then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p3;</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p3;</span><br><span class=\"line\">&#125;).then(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>æ›´å¤š Promise è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒé˜®ä¸€å³°çš„ã€Š<a href=\"http://es6.ruanyifeng.com/#docs/promise#åŸºæœ¬ç”¨æ³•\" target=\"_blank\" rel=\"noopener\">ECMAScript 6 å…¥é—¨</a>ã€‹ã€‚</p>"},{"title":"Node.JS å­¦ä¹ ç¬”è®° [03] -- Buffer fs path","date":"2015-01-04T13:57:05.000Z","comments":0,"_content":"\nä»Šå¤©å­¦ä¹ äº† Node.js çš„ç¼“å†²åŒºï¼ˆBufferï¼‰ã€æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰ã€è·¯å¾„ï¼ˆpathï¼‰æ¨¡å—ï¼Œæ„Ÿå—äº†ä¸€ä¸‹ Node.js ä½œä¸º JavaScript çš„æ‰©å±•åœ¨åå°æ–¹é¢çš„ä¸€äº›åŠŸèƒ½ã€‚ç»™æˆ‘æœ€å¤šçš„æ„Ÿå—æ˜¯ï¼Œå¤§é‡çš„å¼‚æ­¥ä»£ç å’Œå›è°ƒå‡½æ•°ï¼Œè®© Node.js æ€§èƒ½éå¸¸å‡ºè‰²ã€‚æ¥æ€»ç»“ä¸‹ä»Šå¤©å­¦ä¹ çš„å†…å®¹å§ã€‚\n<!-- more -->\n### ç¼“å†²åŒº (Buffer)\nJavaScript è¯­è¨€è‡ªèº«åªæœ‰å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚ä½†åœ¨å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶æµæ—¶ï¼Œå¿…é¡»ä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚å› æ­¤åœ¨ Node.js ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Buffer ç±»ï¼Œè¯¥ç±»ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å­˜åŒºã€‚æŒ‰ç…§æˆ‘çš„ç†è§£ï¼ŒBuffer ç±»å¾ˆåƒæˆ‘ä»¬çš„æ•´æ•°æ•°ç»„ã€‚æœ‰å¯¹åº”çš„ç´¢å¼•ï¼Œå­˜å‚¨æ–¹å¼ä¹Ÿå’Œæ•°ç»„ç±»ä¼¼ã€‚æ¥çœ‹çœ‹ Buffer ç±»æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚\n#### åˆ›å»º Buffer ç±»\n```js\n// æ–¹æ³•1\n// åˆ›å»ºé•¿åº¦ä¸º10å­—èŠ‚çš„ Buffer ç±»\nvar buf = new Buffer(10); // æ„é€ å‡½æ•°ï¼Œæ³¨æ„è¿™ç§åˆ›å»ºå½¢å¼\n\n// æ–¹æ³•2\n// ç›´æ¥é€šè¿‡æ•°ç»„èµ‹å€¼çš„å½¢å¼åˆ›å»º\nvar buf2 = new Buffer([1,2,3,4,5]);\n\n// æ–¹æ³•3\n// é€šè¿‡å­—ç¬¦ä¸²æ¥åˆ›å»º\nvar buf3 = new Buffer('ifyour','utf-8');// utf-8 é»˜è®¤ç¼–ç ï¼Œå¯ä»¥çœç•¥\n```\nä»ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ª Buffer ç±»æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œè®©å®ƒå…·æœ‰ä¸€äº› Buffer ç±»çš„æ–¹æ³•ï¼Œæ€»å¾—æ¥è¯´å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸‹é¢ä¸‰ç§ã€‚\n#### å†™å…¥ç¼“å†²åŒº\n```js\n// è¯­æ³•ï¼š  buf.write(string[, offset[, length]][, encoding])\n// å®ä¾‹ï¼š\n\nvar b4 = new Buffer(14);\nlen = b4.write('this is buffer');\nconsole.log('Buffer å†™å…¥äº† ' + len + ' å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼š' + b4.toString());\n// Buffer å†™å…¥äº† 14å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼šthis is buffer\n```\n#### ç¼“å†²åŒºè¯»å–\n```js\n// è¯­æ³•ï¼š buf.toString([encoding[, start[, end]]])\n// å®ä¾‹ï¼š\nbuf = new Buffer(26);\nfor (var i = 0 ; i < 26 ; i++) {\n  buf[i] = i + 97;\n}\n\nconsole.log( buf.toString('ascii'));       // è¾“å‡º: abcdefghijklmnopqrstuvwxyz\nconsole.log( buf.toString('ascii',0,5));   // è¾“å‡º: abcde\nconsole.log( buf.toString('utf8',0,5));    // è¾“å‡º: abcde\nconsole.log( buf.toString(undefined,0,5)); // ä½¿ç”¨ 'utf8' ç¼–ç , å¹¶è¾“å‡º: abcde\n```\n\n#### ç¼“å†²åŒºæ‹·è´\n```js\n//è¯­æ³•ï¼š buf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]])\n//å®ä¾‹ï¼š\nvar b5 = new Buffer([1,2,3,4,5]);\nvar b6 = new  Buffer(5);\n\nb5.copy(b6,1,0,2);// æŠŠ b5 ä¸­çš„ç´¢å¼• 0-2 ï¼ˆä¸åŒ…æ‹¬2ï¼‰ çš„å€¼å¤åˆ¶ç»™ b6 çš„ç¬¬ 1 ä½ç½®\nconsole.log(b6);\n```\n### æ–‡ä»¶ç³»ç»Ÿ (fs)\nNode.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ¨¡å—ä¸­çš„æ–¹æ³•å‡æœ‰å¼‚æ­¥å’ŒåŒæ­¥ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ `fs.readFile()` å’ŒåŒæ­¥çš„ `fs.readFileSync()`ã€‚å¼‚æ­¥çš„æ–¹æ³•å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«äº†é”™è¯¯ä¿¡æ¯ (error)ã€‚ç›¸æ¯”åŒæ­¥ï¼Œå¼‚æ­¥æ•ˆç‡æ›´é«˜ï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ²¡æœ‰é˜»å¡ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸€å®šè¦å¤„ç†å¥½å…ˆåé¡ºåºã€‚\n\n#### æ–‡ä»¶è¯»å†™æ–¹å¼\næ–‡ä»¶è¯»å–æ–¹å¼ï¼Œä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œå¥½æ¯”å…ˆæŠŠæ•´ä¸ªæ•°æ®æºå®Œæ•´æ‹¿å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­ï¼Œå†ä½¿ç”¨ `writeFile` æ–¹æ³•æˆ– `writeFileSync` æ–¹æ³•å†™å…¥æ–‡ä»¶å†…å®¹ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ•°æ®æºéå¸¸å¤§ï¼ˆ10GBï¼‰ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæ•ˆç‡å°±å¾ˆä½äº†ã€‚è¯´ä¸å®šå°±æ­»æœºäº†ã€‚:) è¿™æ—¶å€™ï¼Œå°±éœ€è¦ä¸‹ä¸€èŠ‚è®²åˆ°çš„ ***æµè¯»å–***ã€‚\n\n```Text\n// data.txt\nHello,Node.js!\n```\n```js\nvar fs = require(\"fs\");\n\n// å¼‚æ­¥è¯»å–\nfs.readFile('data.txt', function (err, data) {\n   if (err) {\n       return console.error(err);\n   }\n   console.log(\"å¼‚æ­¥è¯»å–: \" + data.toString());\n});\n\n// åŒæ­¥è¯»å–\nvar data = fs.readFileSync('data.txt');\nconsole.log(\"åŒæ­¥è¯»å–: \" + data.toString());\n\nconsole.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\");\n```\n\n```Text\nåŒæ­¥è¯»å–: Hello,Node.js!\nç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\n\nå¼‚æ­¥è¯»å–: Hello,Node.js!\n```\n\n<div class=\"tip\">\nNode.js ä¸­ï¼Œå…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œåæ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥è°ƒç”¨ ***é˜Ÿåˆ—***ï¼Œä»¥ ***å…ˆè¿›å…ˆå‡º*** çš„å½¢å¼ä¾æ¬¡è°ƒç”¨ã€‚\n</div>\n\n```js\nvar fs = require('fs');\n// å¼‚æ­¥å†™å…¥\nfs.writeFile('./data/d2.txt','æˆ‘æ˜¯ä¸€æ¡æ•°æ®',function (err) {\n    if (!err){\n        console.log('æ–‡ä»¶å†™å…¥æˆåŠŸ');\n    }else {\n        console.log('å†™å…¥å¤±è´¥');\n    }\n});\n\n// åŒæ­¥å†™å…¥\nfs.writeFileSync('./data/d3','æˆ‘æ˜¯ä¸€æ¡æ•°æ®');\n\nvar data = fs.readFileSync('./data/d3');\n\nconsole.log(data.toString());// æˆ‘æ˜¯ä¸€æ¡æ•°æ®\n```\n\n\n#### æµè¯»å†™æ–¹å¼\nåº”ç”¨ç¨‹åºä¸­ï¼Œæµæ˜¯ä¸€ç»„æœ‰åºçš„ã€æœ‰èµ·ç‚¹å’Œç»ˆç‚¹çš„ ***å­—èŠ‚æ•°æ®çš„ä¼ è¾“æ–¹å¼***ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å„ç§å¯¹è±¡ä¹‹é—´äº¤æ¢ä¸ä¼ è¾“æ•°æ®çš„æ—¶å€™ï¼Œæ€»æ˜¯å…ˆå°†è¯¥å¯¹è±¡ä¸­æ‰€åŒ…å«çš„æ•°æ®è½¬æ¢ä¸ºå„ç§å½¢å¼çš„æµæ•°æ®ï¼ˆå³å­—èŠ‚æ•°æ®ï¼‰ï¼Œå†é€šè¿‡æµçš„ä¼ è¾“ï¼Œåˆ°è¾¾ç›®çš„å¯¹è±¡åå†å°†æµæ•°æ®è½¬æ¢ä¸ºè¯¥å¯¹è±¡ä¸­å¯ä»¥ä½¿ç”¨çš„æ•°æ®ã€‚\n\n```js\nvar fs = require('fs');\nvar data = '';\n// æµè¯»å–\nvar stream = fs.createReadStream('./data/d1.txt','utf-8');\nstream.on('data',function (result) {\n    data += result;\n});\n// data end äº‹ä»¶è¡¨ç¤ºè¿è´¯çš„è¡Œä¸ºï¼Œå­—èŠ‚æµéœ€è¦èµ·ç‚¹å’Œç»ˆç‚¹ã€‚\nstream.on('end',function () {\n    console.log(data);\n});\n\nstream.on('error',function (err) {\n    console.log(err.stack);\n});\n\n// æµå†™å…¥\nvar stream = fs.createWriteStream('./data/123.txt','utf-8');\nstream.write('hello','utf-8');\n\nstream.end();\n\nstream.on('finish',function () {// finish äº‹ä»¶è§¦å‘ï¼Œå¿…é¡»ç­‰ end äº‹ä»¶ç»“æŸæ‰å¯ä»¥\n   console.log('å†™å…¥å®Œæˆï¼');\n});\n\nstream.on('error', function(err){\n    console.log(err.stack);\n});\n```\n<div class=\"tip\">\næµè¯»å–ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š data -> end -> error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚\næµå†™å…¥ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š end -> finish -> error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚\n</div>\n\n#### ç®¡é“æµè¯»å†™\nç®¡é“(pipe) æä¾›äº†ä¸€ä¸ªè¾“å‡ºæµåˆ°è¾“å…¥æµçš„æœºåˆ¶ã€‚é€šå¸¸æˆ‘ä»¬ç”¨äºä»ä¸€ä¸ªæµä¸­è·å–æ•°æ®å¹¶å°†æ•°æ®ä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªæµä¸­ã€‚é€šè¿‡ç®¡é“ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°å¤§æ–‡ä»¶æµå…¥å¦å¤–ä¸€ä¸ªæ–‡ä»¶çš„å¤åˆ¶è¿‡ç¨‹ã€‚\n```js\nvar fs = require('fs');\n\nvar readStream = fs.createReadStream('./data/d1.txt');\n\nvar writeStrem = fs.createWriteStream('./data/d3.txt');\n\nreadStream.pipe(writeStrem);// å®ç°äº† d1.txt åˆ° d3.txt çš„ä¼ è¾“è¿‡ç¨‹\n```\n\n#### é“¾å¼æµè¯»å†™\né“¾å¼æ˜¯é€šè¿‡è¿æ¥è¾“å‡ºæµåˆ°å¦å¤–ä¸€ä¸ªæµå¹¶åˆ›å»ºå¤šä¸ªå¯¹ä¸ªæµæ“ä½œé“¾çš„æœºåˆ¶ã€‚é“¾å¼æµä¸€èˆ¬ç”¨äºç®¡é“æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯ç”¨ç®¡é“å’Œé“¾å¼æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚\n```js\n// compress.js\nvar fs = require('fs');\nvar zlib = require('zlib'); // å¼•å…¥å‹ç¼©æ¨¡å—\n\nfs.createReadStream('./data/123.txt')\n    .pipe(zlib.createGzip())\n    .pipe(fs.createWriteStream('./data/123.txt.gz'));// é“¾å¼æ“ä½œ\nconsole.log('æ–‡ä»¶å‹ç¼©å®Œæˆ');\n```\n#### æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\n```js\nvar fs = require(\"fs\");\n// æ–‡ä»¶ç›®å½•è¯»å–ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ–‡ä»¶åŠæ–‡ä»¶å¤¹\nfs.readdir(\"./testdir\",function(err,files){\n    if (!err){\n        console.log(files);// [ 'index.html', 'main.css', 'subdir' ]\n    }else {\n        console.log(err);\n    }\n});\n\n// æ–‡ä»¶åˆ é™¤\nconsole.log(\"å‡†å¤‡åˆ é™¤æ–‡ä»¶ï¼\");\nfs.unlink('./data/123.txt.gz', function(err) {\n    if (err) {\n        return err;\n    }\n    console.log(\"æ–‡ä»¶åˆ é™¤æˆåŠŸï¼\");\n});\n\n// ç©ºæ–‡ä»¶å¤¹åˆ é™¤\nfs.rmdir('./data',function (err) {\n    if (!err){\n        console.log('åˆ é™¤æˆåŠŸï¼');\n    }else {\n        console.log(err);\n    }\n});\n\n```\nä¸€ä¸ªé€’å½’åˆ é™¤çš„å°ç»ƒä¹ ï¼ŒæŠŠå‰é¢çš„ç»¼åˆè¿ç”¨ä¸€ä¸‹ã€‚\n```js\ndelDir('./testdir');\n\n// ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹è·¯å¾„ï¼Œåˆ é™¤æ‰è¯¥æ–‡ä»¶å¤¹æ‰€æœ‰å†…å®¹\n// @param pathStr string ä¼ å…¥ä¸€ä¸ªè·¯å¾„\nfunction delDir(pathStr) {\n    var fs = require('fs');\n    if (fs.existsSync(pathStr)){\n        var files = fs.readdirSync(pathStr);\n        for (var i = 0; i < files.length; i++) {\n            var curPath = pathStr + '/' + files[i];\n            var stats = fs.statSync(curPath);\n            if (stats.isFile()){\n                fs.unlink(curPath);\n            }else if(stats.isDirectory()){\n                delDir(curPath);// é€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆåˆ é™¤æ‰æ‰€æœ‰æ–‡ä»¶ï¼Œåªå‰©ç©ºç›®å½•\n            }\n        }\n        fs.rmdirSync(pathStr);// æ”¶å°¾ï¼Œåˆ æ‰ç©ºç›®å½•\n    }else {\n        console.log('æ–‡ä»¶å¤¹ä¸å­˜åœ¨');\n    }\n}\n```\n<div class=\"tip\">\næ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æ“ä½œï¼Œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥çš„ä»£ç ï¼Œæ¯”å¦‚ `fs.unlink()` å’Œ `fs.unlinkSync()`,é»˜è®¤éƒ½æ˜¯å¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šè°ƒç”¨å›è°ƒå‡½æ•°è¿›è¡Œæ“ä½œï¼ŒåŒæ­¥ä»£ç ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿›è¡Œåç»­çš„æ“ä½œï¼Œå¯ä»¥è®¤çœŸè§‚å¯Ÿä¸Šé¢ä»£ç çš„åŒºåˆ«ã€‚ä½¿ç”¨å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œä¸€å®šæ³¨æ„æ‰§è¡Œé¡ºåºã€‚\n</div>\n\n\n### è·¯å¾„ (path)\npath æ¨¡å—åŒ…å«ä¸€å¥—ç”¨äº ***å¤„ç†å’Œè½¬æ¢æ–‡ä»¶è·¯å¾„*** çš„å·¥å…·é›†ï¼Œç”¨äºå¤„ç†ç›®å½•çš„å¯¹è±¡ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ç”¨ Node.js çš„ path å‘½ä»¤ï¼Œä¸ä½¿ç”¨ Linux ä¸‹çš„ shell è„šæœ¬å‘½ä»¤ç›¸ä¼¼ã€‚å‡ ä¹æ‰€æœ‰çš„æ–¹æ³•ä»…å¯¹å­—ç¬¦ä¸²è¿›è¡Œè½¬æ¢ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸ä¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦çœŸå®æœ‰æ•ˆã€‚\n```js\n// å¼•å…¥pathå¯¹è±¡\nvar path = require('path');\n\n/*\n* æ ¼å¼åŒ–è·¯å¾„  path.normalize(p)\n* ç‰¹ç‚¹ï¼šå°†ä¸ç¬¦åˆè§„èŒƒçš„è·¯å¾„æ ¼å¼åŒ–ï¼Œç®€åŒ–å¼€å‘äººå‘˜ä¸­å¤„ç†å„ç§å¤æ‚çš„è·¯å¾„åˆ¤æ–­\n* */\npath.normalize('/foo/bar//baz/asdf/quux/..');\n// returns\n'/foo/bar/baz/asdf'\n\n/*\n* è·¯å¾„è”åˆ path.join([path1], [path2], [...])\n* ç‰¹ç‚¹ï¼šå°†æ‰€æœ‰åç§°ç”¨path.seqä¸²è”èµ·æ¥ï¼Œç„¶åç”¨normailzeæ ¼å¼åŒ–\n* */\npath.join('///foo', 'bar', '//baz/asdf', 'quux', '..');\n// returns\n'/foo/bar/baz/asdf'\n\n/*\n* è·¯å¾„å¯»èˆª path.resolve([from ...], to)\n* ç‰¹ç‚¹ï¼šç›¸å½“äºä¸æ–­çš„è°ƒç”¨ç³»ç»Ÿçš„cdå‘½ä»¤\n* */\npath.resolve('foo/bar', '/tmp/file/', '..', 'a/../subfile');\n// ç›¸å½“äºç»ˆç«¯å‘½ä»¤ï¼š\n// cd foo/bar\n// cd /tmp/file/\n// cd ..\n// cd a/../subfile\n// pwd\n\n/*\n* ç›¸å¯¹è·¯å¾„ path.relative(from, to)\n* ç‰¹ç‚¹ï¼šè¿”å›æŸä¸ªè·¯å¾„ä¸‹ç›¸å¯¹äºå¦ä¸€ä¸ªè·¯å¾„çš„ç›¸å¯¹ä½ç½®ä¸²ï¼Œ\n* ç›¸å½“äºï¼špath.resolve(from, path.relative(from, to)) == path.resolve(to)\n* */\n//ç®€å•ç†è§£ï¼š åœ°å€ä¸€æ‰§è¡Œæ€æ ·çš„ shell å‘½ä»¤ï¼Œåˆ°è¾¾åœ°å€äºŒ\npath.relative('/data/orandea/test/aaa', '/data/orandea/impl/bbb')\n// returns\n'../../impl/bbb'\n\n/*\n* æ–‡ä»¶å¤¹åç§° path.dirname(p)\n* ç‰¹ç‚¹ï¼šè¿”å›è·¯å¾„çš„ä¸Šçº§è·¯å¾„\n* */\npath.dirname('/foo/bar/baz/asdf/quux')\n// returns\n'/foo/bar/baz/asdf'\n\n/*\n* æ–‡ä»¶åç§° path.basename(p, [ext])\n* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šçš„æ–‡ä»¶åï¼Œè¿”å›ç»“æœå¯å»æ‰[ext]åç¼€å­—ç¬¦ä¸²\n* */\npath.basename('/foo/bar/baz/asdf/quux.html')\n// returns\n'quux.html'\n\npath.basename('/foo/bar/baz/asdf/quux.html', '.html')\n// returns\n'quux'\n\n/*\n* æ‰©å±•åç§° path.extname(p)\n* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šæ–‡ä»¶åçš„æ‰©å±•åç§°\n* */\npath.extname('index.html')\n// returns\n'.html'\n\npath.extname('index.')\n// returns\n'.'\n\npath.extname('index')\n// returns\n''\n\n/*\n* è·¯å¾„åˆ†éš”ç¬¦ path.sep\n* ç‰¹ç‚¹ï¼šè·å–æ–‡ä»¶è·¯å¾„çš„åˆ†éš”ç¬¦ï¼Œä¸»è¦æ˜¯ä¸æ“ä½œç³»ç»Ÿç›¸å…³\n* æ³¨æ„è°ƒç”¨æ–¹å¼\n* */\n'foo/bar/baz'.split(path.sep)\n// returns\n['foo', 'bar', 'baz']\n```\n","source":"_posts/Node.JS-å­¦ä¹ ç¬”è®°-[03]----Buffer-fs-path.md","raw":"---\ntitle: 'Node.JS å­¦ä¹ ç¬”è®° [03] -- Buffer fs path'\ndate: 2015-1-4 21:57:05\ntags:\ncomments: false\n---\n\nä»Šå¤©å­¦ä¹ äº† Node.js çš„ç¼“å†²åŒºï¼ˆBufferï¼‰ã€æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰ã€è·¯å¾„ï¼ˆpathï¼‰æ¨¡å—ï¼Œæ„Ÿå—äº†ä¸€ä¸‹ Node.js ä½œä¸º JavaScript çš„æ‰©å±•åœ¨åå°æ–¹é¢çš„ä¸€äº›åŠŸèƒ½ã€‚ç»™æˆ‘æœ€å¤šçš„æ„Ÿå—æ˜¯ï¼Œå¤§é‡çš„å¼‚æ­¥ä»£ç å’Œå›è°ƒå‡½æ•°ï¼Œè®© Node.js æ€§èƒ½éå¸¸å‡ºè‰²ã€‚æ¥æ€»ç»“ä¸‹ä»Šå¤©å­¦ä¹ çš„å†…å®¹å§ã€‚\n<!-- more -->\n### ç¼“å†²åŒº (Buffer)\nJavaScript è¯­è¨€è‡ªèº«åªæœ‰å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚ä½†åœ¨å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶æµæ—¶ï¼Œå¿…é¡»ä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚å› æ­¤åœ¨ Node.js ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Buffer ç±»ï¼Œè¯¥ç±»ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å­˜åŒºã€‚æŒ‰ç…§æˆ‘çš„ç†è§£ï¼ŒBuffer ç±»å¾ˆåƒæˆ‘ä»¬çš„æ•´æ•°æ•°ç»„ã€‚æœ‰å¯¹åº”çš„ç´¢å¼•ï¼Œå­˜å‚¨æ–¹å¼ä¹Ÿå’Œæ•°ç»„ç±»ä¼¼ã€‚æ¥çœ‹çœ‹ Buffer ç±»æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚\n#### åˆ›å»º Buffer ç±»\n```js\n// æ–¹æ³•1\n// åˆ›å»ºé•¿åº¦ä¸º10å­—èŠ‚çš„ Buffer ç±»\nvar buf = new Buffer(10); // æ„é€ å‡½æ•°ï¼Œæ³¨æ„è¿™ç§åˆ›å»ºå½¢å¼\n\n// æ–¹æ³•2\n// ç›´æ¥é€šè¿‡æ•°ç»„èµ‹å€¼çš„å½¢å¼åˆ›å»º\nvar buf2 = new Buffer([1,2,3,4,5]);\n\n// æ–¹æ³•3\n// é€šè¿‡å­—ç¬¦ä¸²æ¥åˆ›å»º\nvar buf3 = new Buffer('ifyour','utf-8');// utf-8 é»˜è®¤ç¼–ç ï¼Œå¯ä»¥çœç•¥\n```\nä»ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ª Buffer ç±»æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œè®©å®ƒå…·æœ‰ä¸€äº› Buffer ç±»çš„æ–¹æ³•ï¼Œæ€»å¾—æ¥è¯´å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸‹é¢ä¸‰ç§ã€‚\n#### å†™å…¥ç¼“å†²åŒº\n```js\n// è¯­æ³•ï¼š  buf.write(string[, offset[, length]][, encoding])\n// å®ä¾‹ï¼š\n\nvar b4 = new Buffer(14);\nlen = b4.write('this is buffer');\nconsole.log('Buffer å†™å…¥äº† ' + len + ' å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼š' + b4.toString());\n// Buffer å†™å…¥äº† 14å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼šthis is buffer\n```\n#### ç¼“å†²åŒºè¯»å–\n```js\n// è¯­æ³•ï¼š buf.toString([encoding[, start[, end]]])\n// å®ä¾‹ï¼š\nbuf = new Buffer(26);\nfor (var i = 0 ; i < 26 ; i++) {\n  buf[i] = i + 97;\n}\n\nconsole.log( buf.toString('ascii'));       // è¾“å‡º: abcdefghijklmnopqrstuvwxyz\nconsole.log( buf.toString('ascii',0,5));   // è¾“å‡º: abcde\nconsole.log( buf.toString('utf8',0,5));    // è¾“å‡º: abcde\nconsole.log( buf.toString(undefined,0,5)); // ä½¿ç”¨ 'utf8' ç¼–ç , å¹¶è¾“å‡º: abcde\n```\n\n#### ç¼“å†²åŒºæ‹·è´\n```js\n//è¯­æ³•ï¼š buf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]])\n//å®ä¾‹ï¼š\nvar b5 = new Buffer([1,2,3,4,5]);\nvar b6 = new  Buffer(5);\n\nb5.copy(b6,1,0,2);// æŠŠ b5 ä¸­çš„ç´¢å¼• 0-2 ï¼ˆä¸åŒ…æ‹¬2ï¼‰ çš„å€¼å¤åˆ¶ç»™ b6 çš„ç¬¬ 1 ä½ç½®\nconsole.log(b6);\n```\n### æ–‡ä»¶ç³»ç»Ÿ (fs)\nNode.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ¨¡å—ä¸­çš„æ–¹æ³•å‡æœ‰å¼‚æ­¥å’ŒåŒæ­¥ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ `fs.readFile()` å’ŒåŒæ­¥çš„ `fs.readFileSync()`ã€‚å¼‚æ­¥çš„æ–¹æ³•å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«äº†é”™è¯¯ä¿¡æ¯ (error)ã€‚ç›¸æ¯”åŒæ­¥ï¼Œå¼‚æ­¥æ•ˆç‡æ›´é«˜ï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ²¡æœ‰é˜»å¡ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸€å®šè¦å¤„ç†å¥½å…ˆåé¡ºåºã€‚\n\n#### æ–‡ä»¶è¯»å†™æ–¹å¼\næ–‡ä»¶è¯»å–æ–¹å¼ï¼Œä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œå¥½æ¯”å…ˆæŠŠæ•´ä¸ªæ•°æ®æºå®Œæ•´æ‹¿å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­ï¼Œå†ä½¿ç”¨ `writeFile` æ–¹æ³•æˆ– `writeFileSync` æ–¹æ³•å†™å…¥æ–‡ä»¶å†…å®¹ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ•°æ®æºéå¸¸å¤§ï¼ˆ10GBï¼‰ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæ•ˆç‡å°±å¾ˆä½äº†ã€‚è¯´ä¸å®šå°±æ­»æœºäº†ã€‚:) è¿™æ—¶å€™ï¼Œå°±éœ€è¦ä¸‹ä¸€èŠ‚è®²åˆ°çš„ ***æµè¯»å–***ã€‚\n\n```Text\n// data.txt\nHello,Node.js!\n```\n```js\nvar fs = require(\"fs\");\n\n// å¼‚æ­¥è¯»å–\nfs.readFile('data.txt', function (err, data) {\n   if (err) {\n       return console.error(err);\n   }\n   console.log(\"å¼‚æ­¥è¯»å–: \" + data.toString());\n});\n\n// åŒæ­¥è¯»å–\nvar data = fs.readFileSync('data.txt');\nconsole.log(\"åŒæ­¥è¯»å–: \" + data.toString());\n\nconsole.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\");\n```\n\n```Text\nåŒæ­¥è¯»å–: Hello,Node.js!\nç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\n\nå¼‚æ­¥è¯»å–: Hello,Node.js!\n```\n\n<div class=\"tip\">\nNode.js ä¸­ï¼Œå…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œåæ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥è°ƒç”¨ ***é˜Ÿåˆ—***ï¼Œä»¥ ***å…ˆè¿›å…ˆå‡º*** çš„å½¢å¼ä¾æ¬¡è°ƒç”¨ã€‚\n</div>\n\n```js\nvar fs = require('fs');\n// å¼‚æ­¥å†™å…¥\nfs.writeFile('./data/d2.txt','æˆ‘æ˜¯ä¸€æ¡æ•°æ®',function (err) {\n    if (!err){\n        console.log('æ–‡ä»¶å†™å…¥æˆåŠŸ');\n    }else {\n        console.log('å†™å…¥å¤±è´¥');\n    }\n});\n\n// åŒæ­¥å†™å…¥\nfs.writeFileSync('./data/d3','æˆ‘æ˜¯ä¸€æ¡æ•°æ®');\n\nvar data = fs.readFileSync('./data/d3');\n\nconsole.log(data.toString());// æˆ‘æ˜¯ä¸€æ¡æ•°æ®\n```\n\n\n#### æµè¯»å†™æ–¹å¼\nåº”ç”¨ç¨‹åºä¸­ï¼Œæµæ˜¯ä¸€ç»„æœ‰åºçš„ã€æœ‰èµ·ç‚¹å’Œç»ˆç‚¹çš„ ***å­—èŠ‚æ•°æ®çš„ä¼ è¾“æ–¹å¼***ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å„ç§å¯¹è±¡ä¹‹é—´äº¤æ¢ä¸ä¼ è¾“æ•°æ®çš„æ—¶å€™ï¼Œæ€»æ˜¯å…ˆå°†è¯¥å¯¹è±¡ä¸­æ‰€åŒ…å«çš„æ•°æ®è½¬æ¢ä¸ºå„ç§å½¢å¼çš„æµæ•°æ®ï¼ˆå³å­—èŠ‚æ•°æ®ï¼‰ï¼Œå†é€šè¿‡æµçš„ä¼ è¾“ï¼Œåˆ°è¾¾ç›®çš„å¯¹è±¡åå†å°†æµæ•°æ®è½¬æ¢ä¸ºè¯¥å¯¹è±¡ä¸­å¯ä»¥ä½¿ç”¨çš„æ•°æ®ã€‚\n\n```js\nvar fs = require('fs');\nvar data = '';\n// æµè¯»å–\nvar stream = fs.createReadStream('./data/d1.txt','utf-8');\nstream.on('data',function (result) {\n    data += result;\n});\n// data end äº‹ä»¶è¡¨ç¤ºè¿è´¯çš„è¡Œä¸ºï¼Œå­—èŠ‚æµéœ€è¦èµ·ç‚¹å’Œç»ˆç‚¹ã€‚\nstream.on('end',function () {\n    console.log(data);\n});\n\nstream.on('error',function (err) {\n    console.log(err.stack);\n});\n\n// æµå†™å…¥\nvar stream = fs.createWriteStream('./data/123.txt','utf-8');\nstream.write('hello','utf-8');\n\nstream.end();\n\nstream.on('finish',function () {// finish äº‹ä»¶è§¦å‘ï¼Œå¿…é¡»ç­‰ end äº‹ä»¶ç»“æŸæ‰å¯ä»¥\n   console.log('å†™å…¥å®Œæˆï¼');\n});\n\nstream.on('error', function(err){\n    console.log(err.stack);\n});\n```\n<div class=\"tip\">\næµè¯»å–ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š data -> end -> error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚\næµå†™å…¥ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š end -> finish -> error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚\n</div>\n\n#### ç®¡é“æµè¯»å†™\nç®¡é“(pipe) æä¾›äº†ä¸€ä¸ªè¾“å‡ºæµåˆ°è¾“å…¥æµçš„æœºåˆ¶ã€‚é€šå¸¸æˆ‘ä»¬ç”¨äºä»ä¸€ä¸ªæµä¸­è·å–æ•°æ®å¹¶å°†æ•°æ®ä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªæµä¸­ã€‚é€šè¿‡ç®¡é“ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°å¤§æ–‡ä»¶æµå…¥å¦å¤–ä¸€ä¸ªæ–‡ä»¶çš„å¤åˆ¶è¿‡ç¨‹ã€‚\n```js\nvar fs = require('fs');\n\nvar readStream = fs.createReadStream('./data/d1.txt');\n\nvar writeStrem = fs.createWriteStream('./data/d3.txt');\n\nreadStream.pipe(writeStrem);// å®ç°äº† d1.txt åˆ° d3.txt çš„ä¼ è¾“è¿‡ç¨‹\n```\n\n#### é“¾å¼æµè¯»å†™\né“¾å¼æ˜¯é€šè¿‡è¿æ¥è¾“å‡ºæµåˆ°å¦å¤–ä¸€ä¸ªæµå¹¶åˆ›å»ºå¤šä¸ªå¯¹ä¸ªæµæ“ä½œé“¾çš„æœºåˆ¶ã€‚é“¾å¼æµä¸€èˆ¬ç”¨äºç®¡é“æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯ç”¨ç®¡é“å’Œé“¾å¼æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚\n```js\n// compress.js\nvar fs = require('fs');\nvar zlib = require('zlib'); // å¼•å…¥å‹ç¼©æ¨¡å—\n\nfs.createReadStream('./data/123.txt')\n    .pipe(zlib.createGzip())\n    .pipe(fs.createWriteStream('./data/123.txt.gz'));// é“¾å¼æ“ä½œ\nconsole.log('æ–‡ä»¶å‹ç¼©å®Œæˆ');\n```\n#### æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\n```js\nvar fs = require(\"fs\");\n// æ–‡ä»¶ç›®å½•è¯»å–ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ–‡ä»¶åŠæ–‡ä»¶å¤¹\nfs.readdir(\"./testdir\",function(err,files){\n    if (!err){\n        console.log(files);// [ 'index.html', 'main.css', 'subdir' ]\n    }else {\n        console.log(err);\n    }\n});\n\n// æ–‡ä»¶åˆ é™¤\nconsole.log(\"å‡†å¤‡åˆ é™¤æ–‡ä»¶ï¼\");\nfs.unlink('./data/123.txt.gz', function(err) {\n    if (err) {\n        return err;\n    }\n    console.log(\"æ–‡ä»¶åˆ é™¤æˆåŠŸï¼\");\n});\n\n// ç©ºæ–‡ä»¶å¤¹åˆ é™¤\nfs.rmdir('./data',function (err) {\n    if (!err){\n        console.log('åˆ é™¤æˆåŠŸï¼');\n    }else {\n        console.log(err);\n    }\n});\n\n```\nä¸€ä¸ªé€’å½’åˆ é™¤çš„å°ç»ƒä¹ ï¼ŒæŠŠå‰é¢çš„ç»¼åˆè¿ç”¨ä¸€ä¸‹ã€‚\n```js\ndelDir('./testdir');\n\n// ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹è·¯å¾„ï¼Œåˆ é™¤æ‰è¯¥æ–‡ä»¶å¤¹æ‰€æœ‰å†…å®¹\n// @param pathStr string ä¼ å…¥ä¸€ä¸ªè·¯å¾„\nfunction delDir(pathStr) {\n    var fs = require('fs');\n    if (fs.existsSync(pathStr)){\n        var files = fs.readdirSync(pathStr);\n        for (var i = 0; i < files.length; i++) {\n            var curPath = pathStr + '/' + files[i];\n            var stats = fs.statSync(curPath);\n            if (stats.isFile()){\n                fs.unlink(curPath);\n            }else if(stats.isDirectory()){\n                delDir(curPath);// é€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆåˆ é™¤æ‰æ‰€æœ‰æ–‡ä»¶ï¼Œåªå‰©ç©ºç›®å½•\n            }\n        }\n        fs.rmdirSync(pathStr);// æ”¶å°¾ï¼Œåˆ æ‰ç©ºç›®å½•\n    }else {\n        console.log('æ–‡ä»¶å¤¹ä¸å­˜åœ¨');\n    }\n}\n```\n<div class=\"tip\">\næ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æ“ä½œï¼Œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥çš„ä»£ç ï¼Œæ¯”å¦‚ `fs.unlink()` å’Œ `fs.unlinkSync()`,é»˜è®¤éƒ½æ˜¯å¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šè°ƒç”¨å›è°ƒå‡½æ•°è¿›è¡Œæ“ä½œï¼ŒåŒæ­¥ä»£ç ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿›è¡Œåç»­çš„æ“ä½œï¼Œå¯ä»¥è®¤çœŸè§‚å¯Ÿä¸Šé¢ä»£ç çš„åŒºåˆ«ã€‚ä½¿ç”¨å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œä¸€å®šæ³¨æ„æ‰§è¡Œé¡ºåºã€‚\n</div>\n\n\n### è·¯å¾„ (path)\npath æ¨¡å—åŒ…å«ä¸€å¥—ç”¨äº ***å¤„ç†å’Œè½¬æ¢æ–‡ä»¶è·¯å¾„*** çš„å·¥å…·é›†ï¼Œç”¨äºå¤„ç†ç›®å½•çš„å¯¹è±¡ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ç”¨ Node.js çš„ path å‘½ä»¤ï¼Œä¸ä½¿ç”¨ Linux ä¸‹çš„ shell è„šæœ¬å‘½ä»¤ç›¸ä¼¼ã€‚å‡ ä¹æ‰€æœ‰çš„æ–¹æ³•ä»…å¯¹å­—ç¬¦ä¸²è¿›è¡Œè½¬æ¢ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸ä¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦çœŸå®æœ‰æ•ˆã€‚\n```js\n// å¼•å…¥pathå¯¹è±¡\nvar path = require('path');\n\n/*\n* æ ¼å¼åŒ–è·¯å¾„  path.normalize(p)\n* ç‰¹ç‚¹ï¼šå°†ä¸ç¬¦åˆè§„èŒƒçš„è·¯å¾„æ ¼å¼åŒ–ï¼Œç®€åŒ–å¼€å‘äººå‘˜ä¸­å¤„ç†å„ç§å¤æ‚çš„è·¯å¾„åˆ¤æ–­\n* */\npath.normalize('/foo/bar//baz/asdf/quux/..');\n// returns\n'/foo/bar/baz/asdf'\n\n/*\n* è·¯å¾„è”åˆ path.join([path1], [path2], [...])\n* ç‰¹ç‚¹ï¼šå°†æ‰€æœ‰åç§°ç”¨path.seqä¸²è”èµ·æ¥ï¼Œç„¶åç”¨normailzeæ ¼å¼åŒ–\n* */\npath.join('///foo', 'bar', '//baz/asdf', 'quux', '..');\n// returns\n'/foo/bar/baz/asdf'\n\n/*\n* è·¯å¾„å¯»èˆª path.resolve([from ...], to)\n* ç‰¹ç‚¹ï¼šç›¸å½“äºä¸æ–­çš„è°ƒç”¨ç³»ç»Ÿçš„cdå‘½ä»¤\n* */\npath.resolve('foo/bar', '/tmp/file/', '..', 'a/../subfile');\n// ç›¸å½“äºç»ˆç«¯å‘½ä»¤ï¼š\n// cd foo/bar\n// cd /tmp/file/\n// cd ..\n// cd a/../subfile\n// pwd\n\n/*\n* ç›¸å¯¹è·¯å¾„ path.relative(from, to)\n* ç‰¹ç‚¹ï¼šè¿”å›æŸä¸ªè·¯å¾„ä¸‹ç›¸å¯¹äºå¦ä¸€ä¸ªè·¯å¾„çš„ç›¸å¯¹ä½ç½®ä¸²ï¼Œ\n* ç›¸å½“äºï¼špath.resolve(from, path.relative(from, to)) == path.resolve(to)\n* */\n//ç®€å•ç†è§£ï¼š åœ°å€ä¸€æ‰§è¡Œæ€æ ·çš„ shell å‘½ä»¤ï¼Œåˆ°è¾¾åœ°å€äºŒ\npath.relative('/data/orandea/test/aaa', '/data/orandea/impl/bbb')\n// returns\n'../../impl/bbb'\n\n/*\n* æ–‡ä»¶å¤¹åç§° path.dirname(p)\n* ç‰¹ç‚¹ï¼šè¿”å›è·¯å¾„çš„ä¸Šçº§è·¯å¾„\n* */\npath.dirname('/foo/bar/baz/asdf/quux')\n// returns\n'/foo/bar/baz/asdf'\n\n/*\n* æ–‡ä»¶åç§° path.basename(p, [ext])\n* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šçš„æ–‡ä»¶åï¼Œè¿”å›ç»“æœå¯å»æ‰[ext]åç¼€å­—ç¬¦ä¸²\n* */\npath.basename('/foo/bar/baz/asdf/quux.html')\n// returns\n'quux.html'\n\npath.basename('/foo/bar/baz/asdf/quux.html', '.html')\n// returns\n'quux'\n\n/*\n* æ‰©å±•åç§° path.extname(p)\n* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šæ–‡ä»¶åçš„æ‰©å±•åç§°\n* */\npath.extname('index.html')\n// returns\n'.html'\n\npath.extname('index.')\n// returns\n'.'\n\npath.extname('index')\n// returns\n''\n\n/*\n* è·¯å¾„åˆ†éš”ç¬¦ path.sep\n* ç‰¹ç‚¹ï¼šè·å–æ–‡ä»¶è·¯å¾„çš„åˆ†éš”ç¬¦ï¼Œä¸»è¦æ˜¯ä¸æ“ä½œç³»ç»Ÿç›¸å…³\n* æ³¨æ„è°ƒç”¨æ–¹å¼\n* */\n'foo/bar/baz'.split(path.sep)\n// returns\n['foo', 'bar', 'baz']\n```\n","slug":"Node.JS-å­¦ä¹ ç¬”è®°-[03]----Buffer-fs-path","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidil000cu4q94ipaepx1","content":"<p>ä»Šå¤©å­¦ä¹ äº† Node.js çš„ç¼“å†²åŒºï¼ˆBufferï¼‰ã€æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰ã€è·¯å¾„ï¼ˆpathï¼‰æ¨¡å—ï¼Œæ„Ÿå—äº†ä¸€ä¸‹ Node.js ä½œä¸º JavaScript çš„æ‰©å±•åœ¨åå°æ–¹é¢çš„ä¸€äº›åŠŸèƒ½ã€‚ç»™æˆ‘æœ€å¤šçš„æ„Ÿå—æ˜¯ï¼Œå¤§é‡çš„å¼‚æ­¥ä»£ç å’Œå›è°ƒå‡½æ•°ï¼Œè®© Node.js æ€§èƒ½éå¸¸å‡ºè‰²ã€‚æ¥æ€»ç»“ä¸‹ä»Šå¤©å­¦ä¹ çš„å†…å®¹å§ã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"ç¼“å†²åŒº-Buffer\"><a href=\"#ç¼“å†²åŒº-Buffer\" class=\"headerlink\" title=\"ç¼“å†²åŒº (Buffer)\"></a>ç¼“å†²åŒº (Buffer)</h3><p>JavaScript è¯­è¨€è‡ªèº«åªæœ‰å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚ä½†åœ¨å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶æµæ—¶ï¼Œå¿…é¡»ä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚å› æ­¤åœ¨ Node.js ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Buffer ç±»ï¼Œè¯¥ç±»ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å­˜åŒºã€‚æŒ‰ç…§æˆ‘çš„ç†è§£ï¼ŒBuffer ç±»å¾ˆåƒæˆ‘ä»¬çš„æ•´æ•°æ•°ç»„ã€‚æœ‰å¯¹åº”çš„ç´¢å¼•ï¼Œå­˜å‚¨æ–¹å¼ä¹Ÿå’Œæ•°ç»„ç±»ä¼¼ã€‚æ¥çœ‹çœ‹ Buffer ç±»æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚</p>\n<h4 id=\"åˆ›å»º-Buffer-ç±»\"><a href=\"#åˆ›å»º-Buffer-ç±»\" class=\"headerlink\" title=\"åˆ›å»º Buffer ç±»\"></a>åˆ›å»º Buffer ç±»</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–¹æ³•1</span></span><br><span class=\"line\"><span class=\"comment\">// åˆ›å»ºé•¿åº¦ä¸º10å­—èŠ‚çš„ Buffer ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> buf = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">10</span>); <span class=\"comment\">// æ„é€ å‡½æ•°ï¼Œæ³¨æ„è¿™ç§åˆ›å»ºå½¢å¼</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹æ³•2</span></span><br><span class=\"line\"><span class=\"comment\">// ç›´æ¥é€šè¿‡æ•°ç»„èµ‹å€¼çš„å½¢å¼åˆ›å»º</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> buf2 = <span class=\"keyword\">new</span> Buffer([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹æ³•3</span></span><br><span class=\"line\"><span class=\"comment\">// é€šè¿‡å­—ç¬¦ä¸²æ¥åˆ›å»º</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> buf3 = <span class=\"keyword\">new</span> Buffer(<span class=\"string\">'ifyour'</span>,<span class=\"string\">'utf-8'</span>);<span class=\"comment\">// utf-8 é»˜è®¤ç¼–ç ï¼Œå¯ä»¥çœç•¥</span></span><br></pre></td></tr></table></figure>\n<p>ä»ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ª Buffer ç±»æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œè®©å®ƒå…·æœ‰ä¸€äº› Buffer ç±»çš„æ–¹æ³•ï¼Œæ€»å¾—æ¥è¯´å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸‹é¢ä¸‰ç§ã€‚</p>\n<h4 id=\"å†™å…¥ç¼“å†²åŒº\"><a href=\"#å†™å…¥ç¼“å†²åŒº\" class=\"headerlink\" title=\"å†™å…¥ç¼“å†²åŒº\"></a>å†™å…¥ç¼“å†²åŒº</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¯­æ³•ï¼š  buf.write(string[, offset[, length]][, encoding])</span></span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹ï¼š</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> b4 = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">14</span>);</span><br><span class=\"line\">len = b4.write(<span class=\"string\">'this is buffer'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">'Buffer å†™å…¥äº† '</span> + len + <span class=\"string\">' å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼š'</span> + b4.toString());</span><br><span class=\"line\"><span class=\"comment\">// Buffer å†™å…¥äº† 14å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼šthis is buffer</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ç¼“å†²åŒºè¯»å–\"><a href=\"#ç¼“å†²åŒºè¯»å–\" class=\"headerlink\" title=\"ç¼“å†²åŒºè¯»å–\"></a>ç¼“å†²åŒºè¯»å–</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¯­æ³•ï¼š buf.toString([encoding[, start[, end]]])</span></span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹ï¼š</span></span><br><span class=\"line\">buf = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">26</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span> ; i &lt; <span class=\"number\">26</span> ; i++) &#123;</span><br><span class=\"line\">  buf[i] = i + <span class=\"number\">97</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"string\">'ascii'</span>));       <span class=\"comment\">// è¾“å‡º: abcdefghijklmnopqrstuvwxyz</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"string\">'ascii'</span>,<span class=\"number\">0</span>,<span class=\"number\">5</span>));   <span class=\"comment\">// è¾“å‡º: abcde</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"string\">'utf8'</span>,<span class=\"number\">0</span>,<span class=\"number\">5</span>));    <span class=\"comment\">// è¾“å‡º: abcde</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"literal\">undefined</span>,<span class=\"number\">0</span>,<span class=\"number\">5</span>)); <span class=\"comment\">// ä½¿ç”¨ 'utf8' ç¼–ç , å¹¶è¾“å‡º: abcde</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ç¼“å†²åŒºæ‹·è´\"><a href=\"#ç¼“å†²åŒºæ‹·è´\" class=\"headerlink\" title=\"ç¼“å†²åŒºæ‹·è´\"></a>ç¼“å†²åŒºæ‹·è´</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//è¯­æ³•ï¼š buf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]])</span></span><br><span class=\"line\"><span class=\"comment\">//å®ä¾‹ï¼š</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> b5 = <span class=\"keyword\">new</span> Buffer([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>]);</span><br><span class=\"line\"><span class=\"keyword\">var</span> b6 = <span class=\"keyword\">new</span>  Buffer(<span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">b5.copy(b6,<span class=\"number\">1</span>,<span class=\"number\">0</span>,<span class=\"number\">2</span>);<span class=\"comment\">// æŠŠ b5 ä¸­çš„ç´¢å¼• 0-2 ï¼ˆä¸åŒ…æ‹¬2ï¼‰ çš„å€¼å¤åˆ¶ç»™ b6 çš„ç¬¬ 1 ä½ç½®</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(b6);</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ–‡ä»¶ç³»ç»Ÿ-fs\"><a href=\"#æ–‡ä»¶ç³»ç»Ÿ-fs\" class=\"headerlink\" title=\"æ–‡ä»¶ç³»ç»Ÿ (fs)\"></a>æ–‡ä»¶ç³»ç»Ÿ (fs)</h3><p>Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ¨¡å—ä¸­çš„æ–¹æ³•å‡æœ‰å¼‚æ­¥å’ŒåŒæ­¥ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ <code>fs.readFile()</code> å’ŒåŒæ­¥çš„ <code>fs.readFileSync()</code>ã€‚å¼‚æ­¥çš„æ–¹æ³•å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«äº†é”™è¯¯ä¿¡æ¯ (error)ã€‚ç›¸æ¯”åŒæ­¥ï¼Œå¼‚æ­¥æ•ˆç‡æ›´é«˜ï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ²¡æœ‰é˜»å¡ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸€å®šè¦å¤„ç†å¥½å…ˆåé¡ºåºã€‚</p>\n<h4 id=\"æ–‡ä»¶è¯»å†™æ–¹å¼\"><a href=\"#æ–‡ä»¶è¯»å†™æ–¹å¼\" class=\"headerlink\" title=\"æ–‡ä»¶è¯»å†™æ–¹å¼\"></a>æ–‡ä»¶è¯»å†™æ–¹å¼</h4><p>æ–‡ä»¶è¯»å–æ–¹å¼ï¼Œä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œå¥½æ¯”å…ˆæŠŠæ•´ä¸ªæ•°æ®æºå®Œæ•´æ‹¿å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­ï¼Œå†ä½¿ç”¨ <code>writeFile</code> æ–¹æ³•æˆ– <code>writeFileSync</code> æ–¹æ³•å†™å…¥æ–‡ä»¶å†…å®¹ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ•°æ®æºéå¸¸å¤§ï¼ˆ10GBï¼‰ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæ•ˆç‡å°±å¾ˆä½äº†ã€‚è¯´ä¸å®šå°±æ­»æœºäº†ã€‚:) è¿™æ—¶å€™ï¼Œå°±éœ€è¦ä¸‹ä¸€èŠ‚è®²åˆ°çš„ <strong><em>æµè¯»å–</em></strong>ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// data.txt</span><br><span class=\"line\">Hello,Node.js!</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¼‚æ­¥è¯»å–</span></span><br><span class=\"line\">fs.readFile(<span class=\"string\">'data.txt'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, data</span>) </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">       <span class=\"keyword\">return</span> <span class=\"built_in\">console</span>.error(err);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(<span class=\"string\">\"å¼‚æ­¥è¯»å–: \"</span> + data.toString());</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åŒæ­¥è¯»å–</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> data = fs.readFileSync(<span class=\"string\">'data.txt'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"åŒæ­¥è¯»å–: \"</span> + data.toString());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\"</span>);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">åŒæ­¥è¯»å–: Hello,Node.js!</span><br><span class=\"line\">ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">å¼‚æ­¥è¯»å–: Hello,Node.js!</span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br>Node.js ä¸­ï¼Œå…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œåæ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥è°ƒç”¨ <strong><em>é˜Ÿåˆ—</em></strong>ï¼Œä»¥ <strong><em>å…ˆè¿›å…ˆå‡º</em></strong> çš„å½¢å¼ä¾æ¬¡è°ƒç”¨ã€‚<br></div>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"comment\">// å¼‚æ­¥å†™å…¥</span></span><br><span class=\"line\">fs.writeFile(<span class=\"string\">'./data/d2.txt'</span>,<span class=\"string\">'æˆ‘æ˜¯ä¸€æ¡æ•°æ®'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!err)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'æ–‡ä»¶å†™å…¥æˆåŠŸ'</span>);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'å†™å…¥å¤±è´¥'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åŒæ­¥å†™å…¥</span></span><br><span class=\"line\">fs.writeFileSync(<span class=\"string\">'./data/d3'</span>,<span class=\"string\">'æˆ‘æ˜¯ä¸€æ¡æ•°æ®'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> data = fs.readFileSync(<span class=\"string\">'./data/d3'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(data.toString());<span class=\"comment\">// æˆ‘æ˜¯ä¸€æ¡æ•°æ®</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"æµè¯»å†™æ–¹å¼\"><a href=\"#æµè¯»å†™æ–¹å¼\" class=\"headerlink\" title=\"æµè¯»å†™æ–¹å¼\"></a>æµè¯»å†™æ–¹å¼</h4><p>åº”ç”¨ç¨‹åºä¸­ï¼Œæµæ˜¯ä¸€ç»„æœ‰åºçš„ã€æœ‰èµ·ç‚¹å’Œç»ˆç‚¹çš„ <strong><em>å­—èŠ‚æ•°æ®çš„ä¼ è¾“æ–¹å¼</em></strong>ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å„ç§å¯¹è±¡ä¹‹é—´äº¤æ¢ä¸ä¼ è¾“æ•°æ®çš„æ—¶å€™ï¼Œæ€»æ˜¯å…ˆå°†è¯¥å¯¹è±¡ä¸­æ‰€åŒ…å«çš„æ•°æ®è½¬æ¢ä¸ºå„ç§å½¢å¼çš„æµæ•°æ®ï¼ˆå³å­—èŠ‚æ•°æ®ï¼‰ï¼Œå†é€šè¿‡æµçš„ä¼ è¾“ï¼Œåˆ°è¾¾ç›®çš„å¯¹è±¡åå†å°†æµæ•°æ®è½¬æ¢ä¸ºè¯¥å¯¹è±¡ä¸­å¯ä»¥ä½¿ç”¨çš„æ•°æ®ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> data = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"comment\">// æµè¯»å–</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> stream = fs.createReadStream(<span class=\"string\">'./data/d1.txt'</span>,<span class=\"string\">'utf-8'</span>);</span><br><span class=\"line\">stream.on(<span class=\"string\">'data'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">result</span>) </span>&#123;</span><br><span class=\"line\">    data += result;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// data end äº‹ä»¶è¡¨ç¤ºè¿è´¯çš„è¡Œä¸ºï¼Œå­—èŠ‚æµéœ€è¦èµ·ç‚¹å’Œç»ˆç‚¹ã€‚</span></span><br><span class=\"line\">stream.on(<span class=\"string\">'end'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'error'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err.stack);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æµå†™å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> stream = fs.createWriteStream(<span class=\"string\">'./data/123.txt'</span>,<span class=\"string\">'utf-8'</span>);</span><br><span class=\"line\">stream.write(<span class=\"string\">'hello'</span>,<span class=\"string\">'utf-8'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">stream.end();</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'finish'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">// finish äº‹ä»¶è§¦å‘ï¼Œå¿…é¡»ç­‰ end äº‹ä»¶ç»“æŸæ‰å¯ä»¥</span></span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(<span class=\"string\">'å†™å…¥å®Œæˆï¼'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'error'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err.stack);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br>æµè¯»å–ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š data -&gt; end -&gt; error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚<br>æµå†™å…¥ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š end -&gt; finish -&gt; error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚<br></div>\n\n<h4 id=\"ç®¡é“æµè¯»å†™\"><a href=\"#ç®¡é“æµè¯»å†™\" class=\"headerlink\" title=\"ç®¡é“æµè¯»å†™\"></a>ç®¡é“æµè¯»å†™</h4><p>ç®¡é“(pipe) æä¾›äº†ä¸€ä¸ªè¾“å‡ºæµåˆ°è¾“å…¥æµçš„æœºåˆ¶ã€‚é€šå¸¸æˆ‘ä»¬ç”¨äºä»ä¸€ä¸ªæµä¸­è·å–æ•°æ®å¹¶å°†æ•°æ®ä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªæµä¸­ã€‚é€šè¿‡ç®¡é“ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°å¤§æ–‡ä»¶æµå…¥å¦å¤–ä¸€ä¸ªæ–‡ä»¶çš„å¤åˆ¶è¿‡ç¨‹ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> readStream = fs.createReadStream(<span class=\"string\">'./data/d1.txt'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> writeStrem = fs.createWriteStream(<span class=\"string\">'./data/d3.txt'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">readStream.pipe(writeStrem);<span class=\"comment\">// å®ç°äº† d1.txt åˆ° d3.txt çš„ä¼ è¾“è¿‡ç¨‹</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"é“¾å¼æµè¯»å†™\"><a href=\"#é“¾å¼æµè¯»å†™\" class=\"headerlink\" title=\"é“¾å¼æµè¯»å†™\"></a>é“¾å¼æµè¯»å†™</h4><p>é“¾å¼æ˜¯é€šè¿‡è¿æ¥è¾“å‡ºæµåˆ°å¦å¤–ä¸€ä¸ªæµå¹¶åˆ›å»ºå¤šä¸ªå¯¹ä¸ªæµæ“ä½œé“¾çš„æœºåˆ¶ã€‚é“¾å¼æµä¸€èˆ¬ç”¨äºç®¡é“æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯ç”¨ç®¡é“å’Œé“¾å¼æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// compress.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> zlib = <span class=\"built_in\">require</span>(<span class=\"string\">'zlib'</span>); <span class=\"comment\">// å¼•å…¥å‹ç¼©æ¨¡å—</span></span><br><span class=\"line\"></span><br><span class=\"line\">fs.createReadStream(<span class=\"string\">'./data/123.txt'</span>)</span><br><span class=\"line\">    .pipe(zlib.createGzip())</span><br><span class=\"line\">    .pipe(fs.createWriteStream(<span class=\"string\">'./data/123.txt.gz'</span>));<span class=\"comment\">// é“¾å¼æ“ä½œ</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">'æ–‡ä»¶å‹ç¼©å®Œæˆ'</span>);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\"><a href=\"#æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\" class=\"headerlink\" title=\"æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\"></a>æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// æ–‡ä»¶ç›®å½•è¯»å–ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ–‡ä»¶åŠæ–‡ä»¶å¤¹</span></span><br><span class=\"line\">fs.readdir(<span class=\"string\">\"./testdir\"</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,files</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!err)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(files);<span class=\"comment\">// [ 'index.html', 'main.css', 'subdir' ]</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–‡ä»¶åˆ é™¤</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"å‡†å¤‡åˆ é™¤æ–‡ä»¶ï¼\"</span>);</span><br><span class=\"line\">fs.unlink(<span class=\"string\">'./data/123.txt.gz'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"æ–‡ä»¶åˆ é™¤æˆåŠŸï¼\"</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç©ºæ–‡ä»¶å¤¹åˆ é™¤</span></span><br><span class=\"line\">fs.rmdir(<span class=\"string\">'./data'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!err)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'åˆ é™¤æˆåŠŸï¼'</span>);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>ä¸€ä¸ªé€’å½’åˆ é™¤çš„å°ç»ƒä¹ ï¼ŒæŠŠå‰é¢çš„ç»¼åˆè¿ç”¨ä¸€ä¸‹ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">delDir(<span class=\"string\">'./testdir'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹è·¯å¾„ï¼Œåˆ é™¤æ‰è¯¥æ–‡ä»¶å¤¹æ‰€æœ‰å†…å®¹</span></span><br><span class=\"line\"><span class=\"comment\">// @param pathStr string ä¼ å…¥ä¸€ä¸ªè·¯å¾„</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">delDir</span>(<span class=\"params\">pathStr</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fs.existsSync(pathStr))&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> files = fs.readdirSync(pathStr);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; files.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> curPath = pathStr + <span class=\"string\">'/'</span> + files[i];</span><br><span class=\"line\">            <span class=\"keyword\">var</span> stats = fs.statSync(curPath);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (stats.isFile())&#123;</span><br><span class=\"line\">                fs.unlink(curPath);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(stats.isDirectory())&#123;</span><br><span class=\"line\">                delDir(curPath);<span class=\"comment\">// é€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆåˆ é™¤æ‰æ‰€æœ‰æ–‡ä»¶ï¼Œåªå‰©ç©ºç›®å½•</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fs.rmdirSync(pathStr);<span class=\"comment\">// æ”¶å°¾ï¼Œåˆ æ‰ç©ºç›®å½•</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<div class=\"tip\"><br>æ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æ“ä½œï¼Œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥çš„ä»£ç ï¼Œæ¯”å¦‚ <code>fs.unlink()</code> å’Œ <code>fs.unlinkSync()</code>,é»˜è®¤éƒ½æ˜¯å¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šè°ƒç”¨å›è°ƒå‡½æ•°è¿›è¡Œæ“ä½œï¼ŒåŒæ­¥ä»£ç ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿›è¡Œåç»­çš„æ“ä½œï¼Œå¯ä»¥è®¤çœŸè§‚å¯Ÿä¸Šé¢ä»£ç çš„åŒºåˆ«ã€‚ä½¿ç”¨å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œä¸€å®šæ³¨æ„æ‰§è¡Œé¡ºåºã€‚<br></div>\n\n\n<h3 id=\"è·¯å¾„-path\"><a href=\"#è·¯å¾„-path\" class=\"headerlink\" title=\"è·¯å¾„ (path)\"></a>è·¯å¾„ (path)</h3><p>path æ¨¡å—åŒ…å«ä¸€å¥—ç”¨äº <strong><em>å¤„ç†å’Œè½¬æ¢æ–‡ä»¶è·¯å¾„</em></strong> çš„å·¥å…·é›†ï¼Œç”¨äºå¤„ç†ç›®å½•çš„å¯¹è±¡ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ç”¨ Node.js çš„ path å‘½ä»¤ï¼Œä¸ä½¿ç”¨ Linux ä¸‹çš„ shell è„šæœ¬å‘½ä»¤ç›¸ä¼¼ã€‚å‡ ä¹æ‰€æœ‰çš„æ–¹æ³•ä»…å¯¹å­—ç¬¦ä¸²è¿›è¡Œè½¬æ¢ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸ä¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦çœŸå®æœ‰æ•ˆã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥pathå¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ ¼å¼åŒ–è·¯å¾„  path.normalize(p)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šå°†ä¸ç¬¦åˆè§„èŒƒçš„è·¯å¾„æ ¼å¼åŒ–ï¼Œç®€åŒ–å¼€å‘äººå‘˜ä¸­å¤„ç†å„ç§å¤æ‚çš„è·¯å¾„åˆ¤æ–­</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.normalize(<span class=\"string\">'/foo/bar//baz/asdf/quux/..'</span>);</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'/foo/bar/baz/asdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* è·¯å¾„è”åˆ path.join([path1], [path2], [...])</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šå°†æ‰€æœ‰åç§°ç”¨path.seqä¸²è”èµ·æ¥ï¼Œç„¶åç”¨normailzeæ ¼å¼åŒ–</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.join(<span class=\"string\">'///foo'</span>, <span class=\"string\">'bar'</span>, <span class=\"string\">'//baz/asdf'</span>, <span class=\"string\">'quux'</span>, <span class=\"string\">'..'</span>);</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'/foo/bar/baz/asdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* è·¯å¾„å¯»èˆª path.resolve([from ...], to)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šç›¸å½“äºä¸æ–­çš„è°ƒç”¨ç³»ç»Ÿçš„cdå‘½ä»¤</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.resolve(<span class=\"string\">'foo/bar'</span>, <span class=\"string\">'/tmp/file/'</span>, <span class=\"string\">'..'</span>, <span class=\"string\">'a/../subfile'</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç›¸å½“äºç»ˆç«¯å‘½ä»¤ï¼š</span></span><br><span class=\"line\"><span class=\"comment\">// cd foo/bar</span></span><br><span class=\"line\"><span class=\"comment\">// cd /tmp/file/</span></span><br><span class=\"line\"><span class=\"comment\">// cd ..</span></span><br><span class=\"line\"><span class=\"comment\">// cd a/../subfile</span></span><br><span class=\"line\"><span class=\"comment\">// pwd</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* ç›¸å¯¹è·¯å¾„ path.relative(from, to)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›æŸä¸ªè·¯å¾„ä¸‹ç›¸å¯¹äºå¦ä¸€ä¸ªè·¯å¾„çš„ç›¸å¯¹ä½ç½®ä¸²ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">* ç›¸å½“äºï¼špath.resolve(from, path.relative(from, to)) == path.resolve(to)</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\"><span class=\"comment\">//ç®€å•ç†è§£ï¼š åœ°å€ä¸€æ‰§è¡Œæ€æ ·çš„ shell å‘½ä»¤ï¼Œåˆ°è¾¾åœ°å€äºŒ</span></span><br><span class=\"line\">path.relative(<span class=\"string\">'/data/orandea/test/aaa'</span>, <span class=\"string\">'/data/orandea/impl/bbb'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'../../impl/bbb'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ–‡ä»¶å¤¹åç§° path.dirname(p)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›è·¯å¾„çš„ä¸Šçº§è·¯å¾„</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.dirname(<span class=\"string\">'/foo/bar/baz/asdf/quux'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'/foo/bar/baz/asdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ–‡ä»¶åç§° path.basename(p, [ext])</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šçš„æ–‡ä»¶åï¼Œè¿”å›ç»“æœå¯å»æ‰[ext]åç¼€å­—ç¬¦ä¸²</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.basename(<span class=\"string\">'/foo/bar/baz/asdf/quux.html'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'quux.html'</span></span><br><span class=\"line\"></span><br><span class=\"line\">path.basename(<span class=\"string\">'/foo/bar/baz/asdf/quux.html'</span>, <span class=\"string\">'.html'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'quux'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ‰©å±•åç§° path.extname(p)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šæ–‡ä»¶åçš„æ‰©å±•åç§°</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.extname(<span class=\"string\">'index.html'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'.html'</span></span><br><span class=\"line\"></span><br><span class=\"line\">path.extname(<span class=\"string\">'index.'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'.'</span></span><br><span class=\"line\"></span><br><span class=\"line\">path.extname(<span class=\"string\">'index'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">''</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* è·¯å¾„åˆ†éš”ç¬¦ path.sep</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè·å–æ–‡ä»¶è·¯å¾„çš„åˆ†éš”ç¬¦ï¼Œä¸»è¦æ˜¯ä¸æ“ä½œç³»ç»Ÿç›¸å…³</span></span><br><span class=\"line\"><span class=\"comment\">* æ³¨æ„è°ƒç”¨æ–¹å¼</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\"><span class=\"string\">'foo/bar/baz'</span>.split(path.sep)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\">[<span class=\"string\">'foo'</span>, <span class=\"string\">'bar'</span>, <span class=\"string\">'baz'</span>]</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<p>ä»Šå¤©å­¦ä¹ äº† Node.js çš„ç¼“å†²åŒºï¼ˆBufferï¼‰ã€æ–‡ä»¶ç³»ç»Ÿï¼ˆfsï¼‰ã€è·¯å¾„ï¼ˆpathï¼‰æ¨¡å—ï¼Œæ„Ÿå—äº†ä¸€ä¸‹ Node.js ä½œä¸º JavaScript çš„æ‰©å±•åœ¨åå°æ–¹é¢çš„ä¸€äº›åŠŸèƒ½ã€‚ç»™æˆ‘æœ€å¤šçš„æ„Ÿå—æ˜¯ï¼Œå¤§é‡çš„å¼‚æ­¥ä»£ç å’Œå›è°ƒå‡½æ•°ï¼Œè®© Node.js æ€§èƒ½éå¸¸å‡ºè‰²ã€‚æ¥æ€»ç»“ä¸‹ä»Šå¤©å­¦ä¹ çš„å†…å®¹å§ã€‚<br>","more":"</p>\n<h3 id=\"ç¼“å†²åŒº-Buffer\"><a href=\"#ç¼“å†²åŒº-Buffer\" class=\"headerlink\" title=\"ç¼“å†²åŒº (Buffer)\"></a>ç¼“å†²åŒº (Buffer)</h3><p>JavaScript è¯­è¨€è‡ªèº«åªæœ‰å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚ä½†åœ¨å¤„ç†åƒ TCP æµæˆ–æ–‡ä»¶æµæ—¶ï¼Œå¿…é¡»ä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚å› æ­¤åœ¨ Node.js ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Buffer ç±»ï¼Œè¯¥ç±»ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å­˜åŒºã€‚æŒ‰ç…§æˆ‘çš„ç†è§£ï¼ŒBuffer ç±»å¾ˆåƒæˆ‘ä»¬çš„æ•´æ•°æ•°ç»„ã€‚æœ‰å¯¹åº”çš„ç´¢å¼•ï¼Œå­˜å‚¨æ–¹å¼ä¹Ÿå’Œæ•°ç»„ç±»ä¼¼ã€‚æ¥çœ‹çœ‹ Buffer ç±»æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚</p>\n<h4 id=\"åˆ›å»º-Buffer-ç±»\"><a href=\"#åˆ›å»º-Buffer-ç±»\" class=\"headerlink\" title=\"åˆ›å»º Buffer ç±»\"></a>åˆ›å»º Buffer ç±»</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–¹æ³•1</span></span><br><span class=\"line\"><span class=\"comment\">// åˆ›å»ºé•¿åº¦ä¸º10å­—èŠ‚çš„ Buffer ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> buf = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">10</span>); <span class=\"comment\">// æ„é€ å‡½æ•°ï¼Œæ³¨æ„è¿™ç§åˆ›å»ºå½¢å¼</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹æ³•2</span></span><br><span class=\"line\"><span class=\"comment\">// ç›´æ¥é€šè¿‡æ•°ç»„èµ‹å€¼çš„å½¢å¼åˆ›å»º</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> buf2 = <span class=\"keyword\">new</span> Buffer([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹æ³•3</span></span><br><span class=\"line\"><span class=\"comment\">// é€šè¿‡å­—ç¬¦ä¸²æ¥åˆ›å»º</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> buf3 = <span class=\"keyword\">new</span> Buffer(<span class=\"string\">'ifyour'</span>,<span class=\"string\">'utf-8'</span>);<span class=\"comment\">// utf-8 é»˜è®¤ç¼–ç ï¼Œå¯ä»¥çœç•¥</span></span><br></pre></td></tr></table></figure>\n<p>ä»ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ª Buffer ç±»æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œè®©å®ƒå…·æœ‰ä¸€äº› Buffer ç±»çš„æ–¹æ³•ï¼Œæ€»å¾—æ¥è¯´å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸‹é¢ä¸‰ç§ã€‚</p>\n<h4 id=\"å†™å…¥ç¼“å†²åŒº\"><a href=\"#å†™å…¥ç¼“å†²åŒº\" class=\"headerlink\" title=\"å†™å…¥ç¼“å†²åŒº\"></a>å†™å…¥ç¼“å†²åŒº</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¯­æ³•ï¼š  buf.write(string[, offset[, length]][, encoding])</span></span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹ï¼š</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> b4 = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">14</span>);</span><br><span class=\"line\">len = b4.write(<span class=\"string\">'this is buffer'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">'Buffer å†™å…¥äº† '</span> + len + <span class=\"string\">' å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼š'</span> + b4.toString());</span><br><span class=\"line\"><span class=\"comment\">// Buffer å†™å…¥äº† 14å­—èŠ‚ï¼Œå†…å®¹ä¸ºï¼šthis is buffer</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ç¼“å†²åŒºè¯»å–\"><a href=\"#ç¼“å†²åŒºè¯»å–\" class=\"headerlink\" title=\"ç¼“å†²åŒºè¯»å–\"></a>ç¼“å†²åŒºè¯»å–</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¯­æ³•ï¼š buf.toString([encoding[, start[, end]]])</span></span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹ï¼š</span></span><br><span class=\"line\">buf = <span class=\"keyword\">new</span> Buffer(<span class=\"number\">26</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span> ; i &lt; <span class=\"number\">26</span> ; i++) &#123;</span><br><span class=\"line\">  buf[i] = i + <span class=\"number\">97</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"string\">'ascii'</span>));       <span class=\"comment\">// è¾“å‡º: abcdefghijklmnopqrstuvwxyz</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"string\">'ascii'</span>,<span class=\"number\">0</span>,<span class=\"number\">5</span>));   <span class=\"comment\">// è¾“å‡º: abcde</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"string\">'utf8'</span>,<span class=\"number\">0</span>,<span class=\"number\">5</span>));    <span class=\"comment\">// è¾“å‡º: abcde</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log( buf.toString(<span class=\"literal\">undefined</span>,<span class=\"number\">0</span>,<span class=\"number\">5</span>)); <span class=\"comment\">// ä½¿ç”¨ 'utf8' ç¼–ç , å¹¶è¾“å‡º: abcde</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ç¼“å†²åŒºæ‹·è´\"><a href=\"#ç¼“å†²åŒºæ‹·è´\" class=\"headerlink\" title=\"ç¼“å†²åŒºæ‹·è´\"></a>ç¼“å†²åŒºæ‹·è´</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//è¯­æ³•ï¼š buf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]])</span></span><br><span class=\"line\"><span class=\"comment\">//å®ä¾‹ï¼š</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> b5 = <span class=\"keyword\">new</span> Buffer([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>]);</span><br><span class=\"line\"><span class=\"keyword\">var</span> b6 = <span class=\"keyword\">new</span>  Buffer(<span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">b5.copy(b6,<span class=\"number\">1</span>,<span class=\"number\">0</span>,<span class=\"number\">2</span>);<span class=\"comment\">// æŠŠ b5 ä¸­çš„ç´¢å¼• 0-2 ï¼ˆä¸åŒ…æ‹¬2ï¼‰ çš„å€¼å¤åˆ¶ç»™ b6 çš„ç¬¬ 1 ä½ç½®</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(b6);</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ–‡ä»¶ç³»ç»Ÿ-fs\"><a href=\"#æ–‡ä»¶ç³»ç»Ÿ-fs\" class=\"headerlink\" title=\"æ–‡ä»¶ç³»ç»Ÿ (fs)\"></a>æ–‡ä»¶ç³»ç»Ÿ (fs)</h3><p>Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ¨¡å—ä¸­çš„æ–¹æ³•å‡æœ‰å¼‚æ­¥å’ŒåŒæ­¥ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ <code>fs.readFile()</code> å’ŒåŒæ­¥çš„ <code>fs.readFileSync()</code>ã€‚å¼‚æ­¥çš„æ–¹æ³•å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«äº†é”™è¯¯ä¿¡æ¯ (error)ã€‚ç›¸æ¯”åŒæ­¥ï¼Œå¼‚æ­¥æ•ˆç‡æ›´é«˜ï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ²¡æœ‰é˜»å¡ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸€å®šè¦å¤„ç†å¥½å…ˆåé¡ºåºã€‚</p>\n<h4 id=\"æ–‡ä»¶è¯»å†™æ–¹å¼\"><a href=\"#æ–‡ä»¶è¯»å†™æ–¹å¼\" class=\"headerlink\" title=\"æ–‡ä»¶è¯»å†™æ–¹å¼\"></a>æ–‡ä»¶è¯»å†™æ–¹å¼</h4><p>æ–‡ä»¶è¯»å–æ–¹å¼ï¼Œä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œå¥½æ¯”å…ˆæŠŠæ•´ä¸ªæ•°æ®æºå®Œæ•´æ‹¿å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­ï¼Œå†ä½¿ç”¨ <code>writeFile</code> æ–¹æ³•æˆ– <code>writeFileSync</code> æ–¹æ³•å†™å…¥æ–‡ä»¶å†…å®¹ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ•°æ®æºéå¸¸å¤§ï¼ˆ10GBï¼‰ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæ•ˆç‡å°±å¾ˆä½äº†ã€‚è¯´ä¸å®šå°±æ­»æœºäº†ã€‚:) è¿™æ—¶å€™ï¼Œå°±éœ€è¦ä¸‹ä¸€èŠ‚è®²åˆ°çš„ <strong><em>æµè¯»å–</em></strong>ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// data.txt</span><br><span class=\"line\">Hello,Node.js!</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¼‚æ­¥è¯»å–</span></span><br><span class=\"line\">fs.readFile(<span class=\"string\">'data.txt'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, data</span>) </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">       <span class=\"keyword\">return</span> <span class=\"built_in\">console</span>.error(err);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(<span class=\"string\">\"å¼‚æ­¥è¯»å–: \"</span> + data.toString());</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åŒæ­¥è¯»å–</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> data = fs.readFileSync(<span class=\"string\">'data.txt'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"åŒæ­¥è¯»å–: \"</span> + data.toString());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\"</span>);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">åŒæ­¥è¯»å–: Hello,Node.js!</span><br><span class=\"line\">ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">å¼‚æ­¥è¯»å–: Hello,Node.js!</span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br>Node.js ä¸­ï¼Œå…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œåæ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥è°ƒç”¨ <strong><em>é˜Ÿåˆ—</em></strong>ï¼Œä»¥ <strong><em>å…ˆè¿›å…ˆå‡º</em></strong> çš„å½¢å¼ä¾æ¬¡è°ƒç”¨ã€‚<br></div>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"comment\">// å¼‚æ­¥å†™å…¥</span></span><br><span class=\"line\">fs.writeFile(<span class=\"string\">'./data/d2.txt'</span>,<span class=\"string\">'æˆ‘æ˜¯ä¸€æ¡æ•°æ®'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!err)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'æ–‡ä»¶å†™å…¥æˆåŠŸ'</span>);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'å†™å…¥å¤±è´¥'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åŒæ­¥å†™å…¥</span></span><br><span class=\"line\">fs.writeFileSync(<span class=\"string\">'./data/d3'</span>,<span class=\"string\">'æˆ‘æ˜¯ä¸€æ¡æ•°æ®'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> data = fs.readFileSync(<span class=\"string\">'./data/d3'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(data.toString());<span class=\"comment\">// æˆ‘æ˜¯ä¸€æ¡æ•°æ®</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"æµè¯»å†™æ–¹å¼\"><a href=\"#æµè¯»å†™æ–¹å¼\" class=\"headerlink\" title=\"æµè¯»å†™æ–¹å¼\"></a>æµè¯»å†™æ–¹å¼</h4><p>åº”ç”¨ç¨‹åºä¸­ï¼Œæµæ˜¯ä¸€ç»„æœ‰åºçš„ã€æœ‰èµ·ç‚¹å’Œç»ˆç‚¹çš„ <strong><em>å­—èŠ‚æ•°æ®çš„ä¼ è¾“æ–¹å¼</em></strong>ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å„ç§å¯¹è±¡ä¹‹é—´äº¤æ¢ä¸ä¼ è¾“æ•°æ®çš„æ—¶å€™ï¼Œæ€»æ˜¯å…ˆå°†è¯¥å¯¹è±¡ä¸­æ‰€åŒ…å«çš„æ•°æ®è½¬æ¢ä¸ºå„ç§å½¢å¼çš„æµæ•°æ®ï¼ˆå³å­—èŠ‚æ•°æ®ï¼‰ï¼Œå†é€šè¿‡æµçš„ä¼ è¾“ï¼Œåˆ°è¾¾ç›®çš„å¯¹è±¡åå†å°†æµæ•°æ®è½¬æ¢ä¸ºè¯¥å¯¹è±¡ä¸­å¯ä»¥ä½¿ç”¨çš„æ•°æ®ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> data = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"comment\">// æµè¯»å–</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> stream = fs.createReadStream(<span class=\"string\">'./data/d1.txt'</span>,<span class=\"string\">'utf-8'</span>);</span><br><span class=\"line\">stream.on(<span class=\"string\">'data'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">result</span>) </span>&#123;</span><br><span class=\"line\">    data += result;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// data end äº‹ä»¶è¡¨ç¤ºè¿è´¯çš„è¡Œä¸ºï¼Œå­—èŠ‚æµéœ€è¦èµ·ç‚¹å’Œç»ˆç‚¹ã€‚</span></span><br><span class=\"line\">stream.on(<span class=\"string\">'end'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'error'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err.stack);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æµå†™å…¥</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> stream = fs.createWriteStream(<span class=\"string\">'./data/123.txt'</span>,<span class=\"string\">'utf-8'</span>);</span><br><span class=\"line\">stream.write(<span class=\"string\">'hello'</span>,<span class=\"string\">'utf-8'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">stream.end();</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'finish'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">// finish äº‹ä»¶è§¦å‘ï¼Œå¿…é¡»ç­‰ end äº‹ä»¶ç»“æŸæ‰å¯ä»¥</span></span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(<span class=\"string\">'å†™å…¥å®Œæˆï¼'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">stream.on(<span class=\"string\">'error'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(err.stack);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br>æµè¯»å–ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š data -&gt; end -&gt; error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚<br>æµå†™å…¥ä¼šä¾æ¬¡è§¦å‘äº‹ä»¶ï¼š end -&gt; finish -&gt; error ,æ¯ä¸ªäº‹ä»¶å‘ç”Ÿä¼šæœ‰å¯¹åº”çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚<br></div>\n\n<h4 id=\"ç®¡é“æµè¯»å†™\"><a href=\"#ç®¡é“æµè¯»å†™\" class=\"headerlink\" title=\"ç®¡é“æµè¯»å†™\"></a>ç®¡é“æµè¯»å†™</h4><p>ç®¡é“(pipe) æä¾›äº†ä¸€ä¸ªè¾“å‡ºæµåˆ°è¾“å…¥æµçš„æœºåˆ¶ã€‚é€šå¸¸æˆ‘ä»¬ç”¨äºä»ä¸€ä¸ªæµä¸­è·å–æ•°æ®å¹¶å°†æ•°æ®ä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªæµä¸­ã€‚é€šè¿‡ç®¡é“ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°å¤§æ–‡ä»¶æµå…¥å¦å¤–ä¸€ä¸ªæ–‡ä»¶çš„å¤åˆ¶è¿‡ç¨‹ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> readStream = fs.createReadStream(<span class=\"string\">'./data/d1.txt'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> writeStrem = fs.createWriteStream(<span class=\"string\">'./data/d3.txt'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">readStream.pipe(writeStrem);<span class=\"comment\">// å®ç°äº† d1.txt åˆ° d3.txt çš„ä¼ è¾“è¿‡ç¨‹</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"é“¾å¼æµè¯»å†™\"><a href=\"#é“¾å¼æµè¯»å†™\" class=\"headerlink\" title=\"é“¾å¼æµè¯»å†™\"></a>é“¾å¼æµè¯»å†™</h4><p>é“¾å¼æ˜¯é€šè¿‡è¿æ¥è¾“å‡ºæµåˆ°å¦å¤–ä¸€ä¸ªæµå¹¶åˆ›å»ºå¤šä¸ªå¯¹ä¸ªæµæ“ä½œé“¾çš„æœºåˆ¶ã€‚é“¾å¼æµä¸€èˆ¬ç”¨äºç®¡é“æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯ç”¨ç®¡é“å’Œé“¾å¼æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// compress.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> zlib = <span class=\"built_in\">require</span>(<span class=\"string\">'zlib'</span>); <span class=\"comment\">// å¼•å…¥å‹ç¼©æ¨¡å—</span></span><br><span class=\"line\"></span><br><span class=\"line\">fs.createReadStream(<span class=\"string\">'./data/123.txt'</span>)</span><br><span class=\"line\">    .pipe(zlib.createGzip())</span><br><span class=\"line\">    .pipe(fs.createWriteStream(<span class=\"string\">'./data/123.txt.gz'</span>));<span class=\"comment\">// é“¾å¼æ“ä½œ</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">'æ–‡ä»¶å‹ç¼©å®Œæˆ'</span>);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\"><a href=\"#æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\" class=\"headerlink\" title=\"æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤\"></a>æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ é™¤</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// æ–‡ä»¶ç›®å½•è¯»å–ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ–‡ä»¶åŠæ–‡ä»¶å¤¹</span></span><br><span class=\"line\">fs.readdir(<span class=\"string\">\"./testdir\"</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err,files</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!err)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(files);<span class=\"comment\">// [ 'index.html', 'main.css', 'subdir' ]</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–‡ä»¶åˆ é™¤</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"å‡†å¤‡åˆ é™¤æ–‡ä»¶ï¼\"</span>);</span><br><span class=\"line\">fs.unlink(<span class=\"string\">'./data/123.txt.gz'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"æ–‡ä»¶åˆ é™¤æˆåŠŸï¼\"</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç©ºæ–‡ä»¶å¤¹åˆ é™¤</span></span><br><span class=\"line\">fs.rmdir(<span class=\"string\">'./data'</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!err)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'åˆ é™¤æˆåŠŸï¼'</span>);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(err);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>ä¸€ä¸ªé€’å½’åˆ é™¤çš„å°ç»ƒä¹ ï¼ŒæŠŠå‰é¢çš„ç»¼åˆè¿ç”¨ä¸€ä¸‹ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">delDir(<span class=\"string\">'./testdir'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹è·¯å¾„ï¼Œåˆ é™¤æ‰è¯¥æ–‡ä»¶å¤¹æ‰€æœ‰å†…å®¹</span></span><br><span class=\"line\"><span class=\"comment\">// @param pathStr string ä¼ å…¥ä¸€ä¸ªè·¯å¾„</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">delDir</span>(<span class=\"params\">pathStr</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fs.existsSync(pathStr))&#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> files = fs.readdirSync(pathStr);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; files.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> curPath = pathStr + <span class=\"string\">'/'</span> + files[i];</span><br><span class=\"line\">            <span class=\"keyword\">var</span> stats = fs.statSync(curPath);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (stats.isFile())&#123;</span><br><span class=\"line\">                fs.unlink(curPath);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(stats.isDirectory())&#123;</span><br><span class=\"line\">                delDir(curPath);<span class=\"comment\">// é€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆåˆ é™¤æ‰æ‰€æœ‰æ–‡ä»¶ï¼Œåªå‰©ç©ºç›®å½•</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fs.rmdirSync(pathStr);<span class=\"comment\">// æ”¶å°¾ï¼Œåˆ æ‰ç©ºç›®å½•</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<div class=\"tip\"><br>æ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„æ“ä½œï¼Œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥çš„ä»£ç ï¼Œæ¯”å¦‚ <code>fs.unlink()</code> å’Œ <code>fs.unlinkSync()</code>,é»˜è®¤éƒ½æ˜¯å¼‚æ­¥ä»£ç ï¼Œå¼‚æ­¥ä»£ç ä¼šè°ƒç”¨å›è°ƒå‡½æ•°è¿›è¡Œæ“ä½œï¼ŒåŒæ­¥ä»£ç ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿›è¡Œåç»­çš„æ“ä½œï¼Œå¯ä»¥è®¤çœŸè§‚å¯Ÿä¸Šé¢ä»£ç çš„åŒºåˆ«ã€‚ä½¿ç”¨å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œä¸€å®šæ³¨æ„æ‰§è¡Œé¡ºåºã€‚<br></div>\n\n\n<h3 id=\"è·¯å¾„-path\"><a href=\"#è·¯å¾„-path\" class=\"headerlink\" title=\"è·¯å¾„ (path)\"></a>è·¯å¾„ (path)</h3><p>path æ¨¡å—åŒ…å«ä¸€å¥—ç”¨äº <strong><em>å¤„ç†å’Œè½¬æ¢æ–‡ä»¶è·¯å¾„</em></strong> çš„å·¥å…·é›†ï¼Œç”¨äºå¤„ç†ç›®å½•çš„å¯¹è±¡ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ç”¨ Node.js çš„ path å‘½ä»¤ï¼Œä¸ä½¿ç”¨ Linux ä¸‹çš„ shell è„šæœ¬å‘½ä»¤ç›¸ä¼¼ã€‚å‡ ä¹æ‰€æœ‰çš„æ–¹æ³•ä»…å¯¹å­—ç¬¦ä¸²è¿›è¡Œè½¬æ¢ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸ä¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦çœŸå®æœ‰æ•ˆã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥pathå¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ ¼å¼åŒ–è·¯å¾„  path.normalize(p)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šå°†ä¸ç¬¦åˆè§„èŒƒçš„è·¯å¾„æ ¼å¼åŒ–ï¼Œç®€åŒ–å¼€å‘äººå‘˜ä¸­å¤„ç†å„ç§å¤æ‚çš„è·¯å¾„åˆ¤æ–­</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.normalize(<span class=\"string\">'/foo/bar//baz/asdf/quux/..'</span>);</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'/foo/bar/baz/asdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* è·¯å¾„è”åˆ path.join([path1], [path2], [...])</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šå°†æ‰€æœ‰åç§°ç”¨path.seqä¸²è”èµ·æ¥ï¼Œç„¶åç”¨normailzeæ ¼å¼åŒ–</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.join(<span class=\"string\">'///foo'</span>, <span class=\"string\">'bar'</span>, <span class=\"string\">'//baz/asdf'</span>, <span class=\"string\">'quux'</span>, <span class=\"string\">'..'</span>);</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'/foo/bar/baz/asdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* è·¯å¾„å¯»èˆª path.resolve([from ...], to)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šç›¸å½“äºä¸æ–­çš„è°ƒç”¨ç³»ç»Ÿçš„cdå‘½ä»¤</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.resolve(<span class=\"string\">'foo/bar'</span>, <span class=\"string\">'/tmp/file/'</span>, <span class=\"string\">'..'</span>, <span class=\"string\">'a/../subfile'</span>);</span><br><span class=\"line\"><span class=\"comment\">// ç›¸å½“äºç»ˆç«¯å‘½ä»¤ï¼š</span></span><br><span class=\"line\"><span class=\"comment\">// cd foo/bar</span></span><br><span class=\"line\"><span class=\"comment\">// cd /tmp/file/</span></span><br><span class=\"line\"><span class=\"comment\">// cd ..</span></span><br><span class=\"line\"><span class=\"comment\">// cd a/../subfile</span></span><br><span class=\"line\"><span class=\"comment\">// pwd</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* ç›¸å¯¹è·¯å¾„ path.relative(from, to)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›æŸä¸ªè·¯å¾„ä¸‹ç›¸å¯¹äºå¦ä¸€ä¸ªè·¯å¾„çš„ç›¸å¯¹ä½ç½®ä¸²ï¼Œ</span></span><br><span class=\"line\"><span class=\"comment\">* ç›¸å½“äºï¼špath.resolve(from, path.relative(from, to)) == path.resolve(to)</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\"><span class=\"comment\">//ç®€å•ç†è§£ï¼š åœ°å€ä¸€æ‰§è¡Œæ€æ ·çš„ shell å‘½ä»¤ï¼Œåˆ°è¾¾åœ°å€äºŒ</span></span><br><span class=\"line\">path.relative(<span class=\"string\">'/data/orandea/test/aaa'</span>, <span class=\"string\">'/data/orandea/impl/bbb'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'../../impl/bbb'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ–‡ä»¶å¤¹åç§° path.dirname(p)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›è·¯å¾„çš„ä¸Šçº§è·¯å¾„</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.dirname(<span class=\"string\">'/foo/bar/baz/asdf/quux'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'/foo/bar/baz/asdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ–‡ä»¶åç§° path.basename(p, [ext])</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šçš„æ–‡ä»¶åï¼Œè¿”å›ç»“æœå¯å»æ‰[ext]åç¼€å­—ç¬¦ä¸²</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.basename(<span class=\"string\">'/foo/bar/baz/asdf/quux.html'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'quux.html'</span></span><br><span class=\"line\"></span><br><span class=\"line\">path.basename(<span class=\"string\">'/foo/bar/baz/asdf/quux.html'</span>, <span class=\"string\">'.html'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'quux'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* æ‰©å±•åç§° path.extname(p)</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè¿”å›æŒ‡å®šæ–‡ä»¶åçš„æ‰©å±•åç§°</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\">path.extname(<span class=\"string\">'index.html'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'.html'</span></span><br><span class=\"line\"></span><br><span class=\"line\">path.extname(<span class=\"string\">'index.'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">'.'</span></span><br><span class=\"line\"></span><br><span class=\"line\">path.extname(<span class=\"string\">'index'</span>)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\"><span class=\"string\">''</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">* è·¯å¾„åˆ†éš”ç¬¦ path.sep</span></span><br><span class=\"line\"><span class=\"comment\">* ç‰¹ç‚¹ï¼šè·å–æ–‡ä»¶è·¯å¾„çš„åˆ†éš”ç¬¦ï¼Œä¸»è¦æ˜¯ä¸æ“ä½œç³»ç»Ÿç›¸å…³</span></span><br><span class=\"line\"><span class=\"comment\">* æ³¨æ„è°ƒç”¨æ–¹å¼</span></span><br><span class=\"line\"><span class=\"comment\">* */</span></span><br><span class=\"line\"><span class=\"string\">'foo/bar/baz'</span>.split(path.sep)</span><br><span class=\"line\"><span class=\"comment\">// returns</span></span><br><span class=\"line\">[<span class=\"string\">'foo'</span>, <span class=\"string\">'bar'</span>, <span class=\"string\">'baz'</span>]</span><br></pre></td></tr></table></figure></p>"},{"title":"Node.JS å­¦ä¹ ç¬”è®° [04] -- HTTP","date":"2015-01-05T07:05:10.000Z","comments":0,"_content":"\næœ¬æ¬¡çš„å­¦ä¹ å†…å®¹æ˜¯ Node.js Web æ¨¡å—ï¼Œä»‹ç»äº†ä»€ä¹ˆæ˜¯ web æœåŠ¡å™¨ï¼Œä»¥åŠå¸¸è§çš„å‡ ç§æ¨¡å¼ï¼Œæ¯”å¦‚ B/S æ¨¡å¼ï¼ˆBrowser/Serverï¼Œæµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ï¼‰ï¼ŒC/S æ¨¡å¼ï¼ˆClient/Serverï¼Œå®¢æˆ·ç«¯/æœåŠ¡å™¨æ¨¡å¼ï¼‰ç­‰ã€‚Web å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨ HTTP åè®®å°±èƒ½è®¿é—®åˆ° Web æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼ŒWeb æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚\n<!-- more -->\n### HTTP\n#### HTTP åè®®\n***HTTP***  åè®®æ˜¯ Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,æ˜¯ç”¨äºä»ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚ç”¨äºå®šä¹‰ Web æµè§ˆå™¨ä¸ Web æœåŠ¡å™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹ä»¥åŠæ•°æ®æœ¬èº«çš„æ ¼å¼ã€‚\n\nç®€å•ç†è§£å…¶å®å°±æ˜¯ä¸€ç§è§„èŒƒï¼Œä»¥ä½•ç§æ–¹å¼è¯·æ±‚ï¼Œä»¥ä½•ç§æ–¹å¼åº”ç­”ã€‚ç‰¹ç‚¹å˜›ï¼Œ***ä¸€æ¬¡è¯·æ±‚ï¼ˆRequestï¼‰å¯¹åº”ä¸€æ¬¡å“åº”ï¼ˆResponseï¼‰***ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè®¿é—® Google é¦–é¡µçš„è¯·æ±‚å’Œåº”ç­”ã€‚\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbb9dlv1ylj20xy0ts7ct.jpg)\n\nåœ¨ç¬¬ä¸€æ  General ä¸­å¯ä»¥çœ‹åˆ°æœ¬æ¬¡çš„è¯·æ±‚ç›®æ ‡ï¼Œæ¥è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°ä»£è¡¨å•¥æ„æ€ã€‚\n\n- Request URL:https://www.google.com/  è¯·æ±‚çš„ URLï¼Œè¿™é‡Œæˆ‘ä»¬è®¿é—®çš„æ˜¯ Google é¦–é¡µã€‚\n- Request Method:GET è¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ GET æ–¹å¼è¯·æ±‚ã€‚\n- Status Code:200  çŠ¶æ€ç 200 ï¼Œè¡¨ç¤º OKã€‚\n- Remote Address:127.0.0.1:1080 è¿™é‡Œè¡¨ç¤ºè¯·æ±‚çš„è¿œç«¯ IP åœ°å€åŠç«¯å£ï¼Œå› ä¸ºæˆ‘æ˜¯ç§‘å­¦ä¸Šç½‘ï¼Œè¿™é‡Œæ‰æ˜¾ç¤ºäº†ä¸€ä¸ªå›è·¯åœ°å€ã€‚\n\n#### Node.js æ­å»º http æœåŠ¡å™¨\nNode.js æä¾›äº† http æ¨¡å—ï¼Œä½¿ç”¨ HTTP æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯åŠŸèƒ½å¿…é¡»è°ƒç”¨ http æ¨¡å—ï¼ŒNode.js æ­å»ºä¸€ä¸ª http æœåŠ¡å™¨éå¸¸ç®€å•ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼Œæ¥çœ‹çœ‹æŠŠã€‚:P\n```js\n// å¼•å…¥ http æ¨¡å—\nvar http = require('http');\n\n// åˆ›å»ºæœåŠ¡ï¼Œå›è°ƒå‡½æ•°å¤„ç†è¯·æ±‚ï¼ˆRequestï¼‰å’Œå“åº”ï¼ˆResponseï¼‰ï¼Œç›‘å¬8080ç«¯å£\nhttp.createServer(function (req, res) {\n    res.write('hello,world!');\n    res.end();\n}).listen(8080, function () {\n    console.log('Server running at http://127.0.0.1:8080/');\n});\n```\næ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ http://127.0.0.1:8080/ å°±å¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„æœåŠ¡æˆåŠŸå•¦ã€‚\n![](http://ww4.sinaimg.cn/large/6057861cgw1fbbabbplavj20tg08mmyp.jpg)\n\n#### HTTP å“åº”å†…å®¹\né—®é¢˜æ¥äº†ï¼Œé‚£ä¹ˆå¦‚ä½•æ ¹æ®ä¸åŒçš„ URL æ¥å“åº”ä¸åŒçš„å†…å®¹å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œhttp æœåŠ¡å™¨åœ¨å¤„ç† URL çš„æ—¶å€™ï¼Œä¼šæ ¹æ® URL çš„å‚æ•°æ¥åˆ†è¾¨ä¸åŒçš„è¯·æ±‚å†…å®¹ï¼Œæ ¹æ®è¯·æ±‚çš„å†…å®¹æ¥å“åº”ä¸ä¹‹å¯¹åº”çš„å†…å®¹ã€‚ä¸€ä¸ªå®Œæ•´çš„ URL é•¿è¿™ä¸ªæ ·å­ã€‚\n```Text\nscheme://host.domain:port/path/filename?queryName=queryValue\n```\n- schemeï¼šå®šä¹‰æœåŠ¡ç±»å‹ï¼Œå¸¸è§çš„å¦‚ http\n- hostï¼šå®šä¹‰åŸŸä¸»æœºï¼Œhttp é€šå¸¸æ˜¯ www\n- domainï¼šå®šä¹‰åŸŸåï¼Œæ¯”å¦‚ google.com\n- :portï¼šå®šä¹‰ä¸»æœºçš„ç«¯å£å·ï¼Œé»˜è®¤æ˜¯80\n- pathï¼šå®šä¹‰è·¯å¾„ï¼Œçœç•¥ `/` è¡¨ç¤ºæ ¹ç›®å½•\n- filenameï¼šå®šä¹‰æ–‡ä»¶å\n- ?queryName=queryValueï¼šæŸ¥è¯¢å­—ç¬¦ä¸²\n\nå¯ä»¥çœ‹å‡ºï¼Œæƒ³è¦å“åº”ä¸åŒçš„å†…å®¹ï¼Œå°±éœ€è¦åˆ†æå‡º URL ä¸­çš„ `path` å’Œ `filename` ä»¥åŠå¯¹åº”çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\nvar http = require('http');\nvar fs = require('fs');\nvar url = require('url');// å¼•å…¥ url æ¨¡å—ç”¨äºå¤„ç†åœ°å€\nvar querystring = require('querystring'); // å¼•å…¥ querystring æ¨¡å—\n\nhttp.createServer(function (req, res) {\n    // é¦–é¡µ\n    var path = url.parse(req.url).pathname;\n    if (path == '/') {\n        fs.readFile('./html/index.html', 'utf-8', function (err, result) {\n            if (!err) {\n                res.write(result);\n                res.end();\n            }\n        });\n    }\n    // ç™»å½•\n    if (path == '/login'){\n        //{...}\n    }\n    // ç™»å½•éªŒè¯\n    if (path == '/checkLogin') {\n        var queryObj = querystring.parse(url.parse(req.url).query);\n        // querystring.parse() æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ï¼Œ{ usr: 'admin', pwd: '123' }\n        if (queryObj.usr == 'admin' && queryObj.pwd == '123') {\n            res.write('Login Success!');\n            res.end();\n        }\n    }\n}).listen(8080, function () {\n    console.log('Server running at http://127.0.0.1:8080/');\n});\n```\n\n#### HTTP å“åº”çŠ¶æ€ç \nHTTP çŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTP çŠ¶æ€ç å…±åˆ†ä¸º5ç§ç±»å‹ï¼š\n\n|åˆ†ç±»   |åˆ†ç±»æè¿°                                   |\n|:-----|:------------------------------------------|\n|1**   |ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ   |\n|2**   |æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†                   |\n|3**   |é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚            |\n|4**   |å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚     |\n|5**   |æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ |\n\néœ€è¦è®°ä½å¸¸è§çš„å‡ ç§å°±å¯ä»¥äº†ï¼Œå¦å¤–çš„å¯ä»¥[æŸ¥æ‰‹å†Œ](http://tools.jb51.net/table/http_status_code)æ‰¾åˆ°éå¸¸è¯¦ç»†çš„è§£é‡Šã€‚\n- 200\tOK\tè¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äº GET ä¸ POST è¯·æ±‚ã€‚\n- 304\tNot Modified\tæœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚\n- 404\tNot Found\tæœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚\n- 500\tInternal Server Error\tæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ã€‚\n\n#### HTTP å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\næœåŠ¡å™¨å…·æœ‰è¿”å›å„ç§æ•°æ®çš„èƒ½åŠ›ï¼Œä½†æ˜¯è¿”å›æ•°æ®æ—¶ï¼Œåº”å‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆæ–‡ä»¶ã€‚é€šè¿‡ `Content-Type` å¯ä»¥è®¾ç½®ï¼Œå“åº”çš„æ•°æ®ç±»å‹ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\nvar http = require('http');\nvar fs = require('fs');\n\nhttp.createServer(function (req, res) {\n    // è®¾ç½®å“åº”çš„çŠ¶æ€ç ï¼Œæ•°æ®ç±»å‹\n    res.writeHeader('200', {'Content-Type': 'image/png;charset=utf-8'});\n    fs.readFile('./hello.png', function (err, result) {\n        if (!err) {\n            res.write(result);\n            res.end();\n        }\n    })\n}).listen(8080, function () {\n    console.log('Server running at http://127.0.0.1:8080/');\n});\n```\nå¯ä»¥é€šè¿‡ [node-mime](https://github.com/broofa/node-mime) æ¥æŸ¥è¯¢å„ç§æ–‡ä»¶çš„æ•°æ®ç±»å‹ã€‚å…ˆç”¨ npm å®‰è£…ã€‚\n```bash\nnpm install mime --save\n```\n```js\nvar mime = require('mime');\n\nconsole.log(mime.lookup('test.txt'));   // text/plain\nconsole.log(mime.lookup('test.html'));  // text/html\nconsole.log(mime.lookup('test.css'));   // text/css\nconsole.log(mime.lookup('test.js'));    // application/javascript\nconsole.log(mime.lookup('test.mp3'));   // audio/mpeg\n```\n### Web å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\n\n#### é€šè¿‡ URL ä¼ é€’\n```Text\nscheme://host.domain:port/path/filename?queryName=queryValue\n```\nå…¶ä¸­ `?queryName=queryValue` å°±æ˜¯é€šè¿‡ URL ä¼ é€’çš„æ•°æ®ï¼Œä¸¾ä¸ªä¾‹å­ï¼š`?usr=admin&pwd=123` å°±è¡¨ç¤ºä¼ é€’ä¸€ä¸ª `usr` ä¸º `admin` ï¼Œ`pwd` ä¸º `123` çš„æ•°æ®åˆ°åå°ã€‚\n#### é€šè¿‡è¡¨å•ä¼ é€’\n```html\n<form action=\"/user\" method=\"get\">\n    ç”¨æˆ·åï¼š<input type=\"text\" name=\"username\"/><br/>\n    å¯† ç ï¼š<input type=\"password\" name=\"password\"><br/>\n    <input type=\"submit\" value=\"æäº¤\"/>\n</form>\n```\n- actionï¼šæäº¤åˆ°æœåŠ¡å™¨å¤„ç†ç¨‹åºçš„urlåœ°å€\n- methodï¼šæäº¤æ–¹å¼æœ‰ `GET` å’Œ `POST`\n- GETï¼šä¼šæŠŠè¡¨å•æ•°æ®ä½œä¸º URL çš„ä¸€éƒ¨åˆ†æ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼ŒURL é•¿åº¦æœ‰é™åˆ¶ä¸èƒ½æäº¤å¤§é‡æ•°æ®\n- POSTï¼šä¼šæŠŠè¡¨å•æ•°æ®æ”¾åˆ° HTTP è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹å®‰å…¨ï¼Œè€Œä¸”å¯ä»¥æäº¤å¤§é‡æ•°æ®ï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰\n\n#### æ•°æ®ç±»å‹\nå‰é¢è®²äº†ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿”å›ç»™æµè§ˆå™¨æ•°æ®æ—¶ï¼Œä¼šé€šè¿‡ `Content-Type` æŒ‡å®šæ•°æ®ç±»å‹ï¼ŒåŒæ ·çš„ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨ä¼ é€’æ•°æ®æ—¶ï¼Œä¹Ÿéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚åœ¨è¿™ä¸¤ç§æ•°æ®ä¼ é€’æ–¹å¼ä¸­ï¼Œè¡¨å•ä¼ é€’æ•°æ®æ—¶ï¼Œ`POST` æ–¹å¼ï¼Œå¿…é¡»æŒ‡å®šæ•°æ®ç±»å‹ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```html\n<form action=\"/user\" method=\"post\" enctype=\"multipart/form-data\">\n    <input type=\"file\">\n    <input type=\"submit\" value=\"ä¸Šä¼ \">\n</form>\n```\n`enctype` æŒ‡å®š POST çš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤æ˜¯ `application/x-www-form-urlencoded`ï¼Œä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå°±éœ€è¦ `multipart/form-data` ç±»å‹äº†ã€‚\n","source":"_posts/Node.JS-å­¦ä¹ ç¬”è®°-[04]----HTTP.md","raw":"---\ntitle: 'Node.JS å­¦ä¹ ç¬”è®° [04] -- HTTP'\ndate: 2015-01-05 15:05:10\ntags:\ncomments: false\n---\n\næœ¬æ¬¡çš„å­¦ä¹ å†…å®¹æ˜¯ Node.js Web æ¨¡å—ï¼Œä»‹ç»äº†ä»€ä¹ˆæ˜¯ web æœåŠ¡å™¨ï¼Œä»¥åŠå¸¸è§çš„å‡ ç§æ¨¡å¼ï¼Œæ¯”å¦‚ B/S æ¨¡å¼ï¼ˆBrowser/Serverï¼Œæµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ï¼‰ï¼ŒC/S æ¨¡å¼ï¼ˆClient/Serverï¼Œå®¢æˆ·ç«¯/æœåŠ¡å™¨æ¨¡å¼ï¼‰ç­‰ã€‚Web å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨ HTTP åè®®å°±èƒ½è®¿é—®åˆ° Web æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼ŒWeb æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚\n<!-- more -->\n### HTTP\n#### HTTP åè®®\n***HTTP***  åè®®æ˜¯ Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,æ˜¯ç”¨äºä»ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚ç”¨äºå®šä¹‰ Web æµè§ˆå™¨ä¸ Web æœåŠ¡å™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹ä»¥åŠæ•°æ®æœ¬èº«çš„æ ¼å¼ã€‚\n\nç®€å•ç†è§£å…¶å®å°±æ˜¯ä¸€ç§è§„èŒƒï¼Œä»¥ä½•ç§æ–¹å¼è¯·æ±‚ï¼Œä»¥ä½•ç§æ–¹å¼åº”ç­”ã€‚ç‰¹ç‚¹å˜›ï¼Œ***ä¸€æ¬¡è¯·æ±‚ï¼ˆRequestï¼‰å¯¹åº”ä¸€æ¬¡å“åº”ï¼ˆResponseï¼‰***ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè®¿é—® Google é¦–é¡µçš„è¯·æ±‚å’Œåº”ç­”ã€‚\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbb9dlv1ylj20xy0ts7ct.jpg)\n\nåœ¨ç¬¬ä¸€æ  General ä¸­å¯ä»¥çœ‹åˆ°æœ¬æ¬¡çš„è¯·æ±‚ç›®æ ‡ï¼Œæ¥è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°ä»£è¡¨å•¥æ„æ€ã€‚\n\n- Request URL:https://www.google.com/  è¯·æ±‚çš„ URLï¼Œè¿™é‡Œæˆ‘ä»¬è®¿é—®çš„æ˜¯ Google é¦–é¡µã€‚\n- Request Method:GET è¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ GET æ–¹å¼è¯·æ±‚ã€‚\n- Status Code:200  çŠ¶æ€ç 200 ï¼Œè¡¨ç¤º OKã€‚\n- Remote Address:127.0.0.1:1080 è¿™é‡Œè¡¨ç¤ºè¯·æ±‚çš„è¿œç«¯ IP åœ°å€åŠç«¯å£ï¼Œå› ä¸ºæˆ‘æ˜¯ç§‘å­¦ä¸Šç½‘ï¼Œè¿™é‡Œæ‰æ˜¾ç¤ºäº†ä¸€ä¸ªå›è·¯åœ°å€ã€‚\n\n#### Node.js æ­å»º http æœåŠ¡å™¨\nNode.js æä¾›äº† http æ¨¡å—ï¼Œä½¿ç”¨ HTTP æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯åŠŸèƒ½å¿…é¡»è°ƒç”¨ http æ¨¡å—ï¼ŒNode.js æ­å»ºä¸€ä¸ª http æœåŠ¡å™¨éå¸¸ç®€å•ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼Œæ¥çœ‹çœ‹æŠŠã€‚:P\n```js\n// å¼•å…¥ http æ¨¡å—\nvar http = require('http');\n\n// åˆ›å»ºæœåŠ¡ï¼Œå›è°ƒå‡½æ•°å¤„ç†è¯·æ±‚ï¼ˆRequestï¼‰å’Œå“åº”ï¼ˆResponseï¼‰ï¼Œç›‘å¬8080ç«¯å£\nhttp.createServer(function (req, res) {\n    res.write('hello,world!');\n    res.end();\n}).listen(8080, function () {\n    console.log('Server running at http://127.0.0.1:8080/');\n});\n```\næ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ http://127.0.0.1:8080/ å°±å¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„æœåŠ¡æˆåŠŸå•¦ã€‚\n![](http://ww4.sinaimg.cn/large/6057861cgw1fbbabbplavj20tg08mmyp.jpg)\n\n#### HTTP å“åº”å†…å®¹\né—®é¢˜æ¥äº†ï¼Œé‚£ä¹ˆå¦‚ä½•æ ¹æ®ä¸åŒçš„ URL æ¥å“åº”ä¸åŒçš„å†…å®¹å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œhttp æœåŠ¡å™¨åœ¨å¤„ç† URL çš„æ—¶å€™ï¼Œä¼šæ ¹æ® URL çš„å‚æ•°æ¥åˆ†è¾¨ä¸åŒçš„è¯·æ±‚å†…å®¹ï¼Œæ ¹æ®è¯·æ±‚çš„å†…å®¹æ¥å“åº”ä¸ä¹‹å¯¹åº”çš„å†…å®¹ã€‚ä¸€ä¸ªå®Œæ•´çš„ URL é•¿è¿™ä¸ªæ ·å­ã€‚\n```Text\nscheme://host.domain:port/path/filename?queryName=queryValue\n```\n- schemeï¼šå®šä¹‰æœåŠ¡ç±»å‹ï¼Œå¸¸è§çš„å¦‚ http\n- hostï¼šå®šä¹‰åŸŸä¸»æœºï¼Œhttp é€šå¸¸æ˜¯ www\n- domainï¼šå®šä¹‰åŸŸåï¼Œæ¯”å¦‚ google.com\n- :portï¼šå®šä¹‰ä¸»æœºçš„ç«¯å£å·ï¼Œé»˜è®¤æ˜¯80\n- pathï¼šå®šä¹‰è·¯å¾„ï¼Œçœç•¥ `/` è¡¨ç¤ºæ ¹ç›®å½•\n- filenameï¼šå®šä¹‰æ–‡ä»¶å\n- ?queryName=queryValueï¼šæŸ¥è¯¢å­—ç¬¦ä¸²\n\nå¯ä»¥çœ‹å‡ºï¼Œæƒ³è¦å“åº”ä¸åŒçš„å†…å®¹ï¼Œå°±éœ€è¦åˆ†æå‡º URL ä¸­çš„ `path` å’Œ `filename` ä»¥åŠå¯¹åº”çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\nvar http = require('http');\nvar fs = require('fs');\nvar url = require('url');// å¼•å…¥ url æ¨¡å—ç”¨äºå¤„ç†åœ°å€\nvar querystring = require('querystring'); // å¼•å…¥ querystring æ¨¡å—\n\nhttp.createServer(function (req, res) {\n    // é¦–é¡µ\n    var path = url.parse(req.url).pathname;\n    if (path == '/') {\n        fs.readFile('./html/index.html', 'utf-8', function (err, result) {\n            if (!err) {\n                res.write(result);\n                res.end();\n            }\n        });\n    }\n    // ç™»å½•\n    if (path == '/login'){\n        //{...}\n    }\n    // ç™»å½•éªŒè¯\n    if (path == '/checkLogin') {\n        var queryObj = querystring.parse(url.parse(req.url).query);\n        // querystring.parse() æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ï¼Œ{ usr: 'admin', pwd: '123' }\n        if (queryObj.usr == 'admin' && queryObj.pwd == '123') {\n            res.write('Login Success!');\n            res.end();\n        }\n    }\n}).listen(8080, function () {\n    console.log('Server running at http://127.0.0.1:8080/');\n});\n```\n\n#### HTTP å“åº”çŠ¶æ€ç \nHTTP çŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTP çŠ¶æ€ç å…±åˆ†ä¸º5ç§ç±»å‹ï¼š\n\n|åˆ†ç±»   |åˆ†ç±»æè¿°                                   |\n|:-----|:------------------------------------------|\n|1**   |ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ   |\n|2**   |æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†                   |\n|3**   |é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚            |\n|4**   |å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚     |\n|5**   |æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ |\n\néœ€è¦è®°ä½å¸¸è§çš„å‡ ç§å°±å¯ä»¥äº†ï¼Œå¦å¤–çš„å¯ä»¥[æŸ¥æ‰‹å†Œ](http://tools.jb51.net/table/http_status_code)æ‰¾åˆ°éå¸¸è¯¦ç»†çš„è§£é‡Šã€‚\n- 200\tOK\tè¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äº GET ä¸ POST è¯·æ±‚ã€‚\n- 304\tNot Modified\tæœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚\n- 404\tNot Found\tæœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚\n- 500\tInternal Server Error\tæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ã€‚\n\n#### HTTP å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\næœåŠ¡å™¨å…·æœ‰è¿”å›å„ç§æ•°æ®çš„èƒ½åŠ›ï¼Œä½†æ˜¯è¿”å›æ•°æ®æ—¶ï¼Œåº”å‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆæ–‡ä»¶ã€‚é€šè¿‡ `Content-Type` å¯ä»¥è®¾ç½®ï¼Œå“åº”çš„æ•°æ®ç±»å‹ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\nvar http = require('http');\nvar fs = require('fs');\n\nhttp.createServer(function (req, res) {\n    // è®¾ç½®å“åº”çš„çŠ¶æ€ç ï¼Œæ•°æ®ç±»å‹\n    res.writeHeader('200', {'Content-Type': 'image/png;charset=utf-8'});\n    fs.readFile('./hello.png', function (err, result) {\n        if (!err) {\n            res.write(result);\n            res.end();\n        }\n    })\n}).listen(8080, function () {\n    console.log('Server running at http://127.0.0.1:8080/');\n});\n```\nå¯ä»¥é€šè¿‡ [node-mime](https://github.com/broofa/node-mime) æ¥æŸ¥è¯¢å„ç§æ–‡ä»¶çš„æ•°æ®ç±»å‹ã€‚å…ˆç”¨ npm å®‰è£…ã€‚\n```bash\nnpm install mime --save\n```\n```js\nvar mime = require('mime');\n\nconsole.log(mime.lookup('test.txt'));   // text/plain\nconsole.log(mime.lookup('test.html'));  // text/html\nconsole.log(mime.lookup('test.css'));   // text/css\nconsole.log(mime.lookup('test.js'));    // application/javascript\nconsole.log(mime.lookup('test.mp3'));   // audio/mpeg\n```\n### Web å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\n\n#### é€šè¿‡ URL ä¼ é€’\n```Text\nscheme://host.domain:port/path/filename?queryName=queryValue\n```\nå…¶ä¸­ `?queryName=queryValue` å°±æ˜¯é€šè¿‡ URL ä¼ é€’çš„æ•°æ®ï¼Œä¸¾ä¸ªä¾‹å­ï¼š`?usr=admin&pwd=123` å°±è¡¨ç¤ºä¼ é€’ä¸€ä¸ª `usr` ä¸º `admin` ï¼Œ`pwd` ä¸º `123` çš„æ•°æ®åˆ°åå°ã€‚\n#### é€šè¿‡è¡¨å•ä¼ é€’\n```html\n<form action=\"/user\" method=\"get\">\n    ç”¨æˆ·åï¼š<input type=\"text\" name=\"username\"/><br/>\n    å¯† ç ï¼š<input type=\"password\" name=\"password\"><br/>\n    <input type=\"submit\" value=\"æäº¤\"/>\n</form>\n```\n- actionï¼šæäº¤åˆ°æœåŠ¡å™¨å¤„ç†ç¨‹åºçš„urlåœ°å€\n- methodï¼šæäº¤æ–¹å¼æœ‰ `GET` å’Œ `POST`\n- GETï¼šä¼šæŠŠè¡¨å•æ•°æ®ä½œä¸º URL çš„ä¸€éƒ¨åˆ†æ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼ŒURL é•¿åº¦æœ‰é™åˆ¶ä¸èƒ½æäº¤å¤§é‡æ•°æ®\n- POSTï¼šä¼šæŠŠè¡¨å•æ•°æ®æ”¾åˆ° HTTP è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹å®‰å…¨ï¼Œè€Œä¸”å¯ä»¥æäº¤å¤§é‡æ•°æ®ï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰\n\n#### æ•°æ®ç±»å‹\nå‰é¢è®²äº†ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿”å›ç»™æµè§ˆå™¨æ•°æ®æ—¶ï¼Œä¼šé€šè¿‡ `Content-Type` æŒ‡å®šæ•°æ®ç±»å‹ï¼ŒåŒæ ·çš„ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨ä¼ é€’æ•°æ®æ—¶ï¼Œä¹Ÿéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚åœ¨è¿™ä¸¤ç§æ•°æ®ä¼ é€’æ–¹å¼ä¸­ï¼Œè¡¨å•ä¼ é€’æ•°æ®æ—¶ï¼Œ`POST` æ–¹å¼ï¼Œå¿…é¡»æŒ‡å®šæ•°æ®ç±»å‹ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```html\n<form action=\"/user\" method=\"post\" enctype=\"multipart/form-data\">\n    <input type=\"file\">\n    <input type=\"submit\" value=\"ä¸Šä¼ \">\n</form>\n```\n`enctype` æŒ‡å®š POST çš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤æ˜¯ `application/x-www-form-urlencoded`ï¼Œä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå°±éœ€è¦ `multipart/form-data` ç±»å‹äº†ã€‚\n","slug":"Node.JS-å­¦ä¹ ç¬”è®°-[04]----HTTP","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidiv000du4q9g3wavmtu","content":"<p>æœ¬æ¬¡çš„å­¦ä¹ å†…å®¹æ˜¯ Node.js Web æ¨¡å—ï¼Œä»‹ç»äº†ä»€ä¹ˆæ˜¯ web æœåŠ¡å™¨ï¼Œä»¥åŠå¸¸è§çš„å‡ ç§æ¨¡å¼ï¼Œæ¯”å¦‚ B/S æ¨¡å¼ï¼ˆBrowser/Serverï¼Œæµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ï¼‰ï¼ŒC/S æ¨¡å¼ï¼ˆClient/Serverï¼Œå®¢æˆ·ç«¯/æœåŠ¡å™¨æ¨¡å¼ï¼‰ç­‰ã€‚Web å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨ HTTP åè®®å°±èƒ½è®¿é—®åˆ° Web æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼ŒWeb æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h3><h4 id=\"HTTP-åè®®\"><a href=\"#HTTP-åè®®\" class=\"headerlink\" title=\"HTTP åè®®\"></a>HTTP åè®®</h4><p><strong><em>HTTP</em></strong>  åè®®æ˜¯ Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,æ˜¯ç”¨äºä»ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚ç”¨äºå®šä¹‰ Web æµè§ˆå™¨ä¸ Web æœåŠ¡å™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹ä»¥åŠæ•°æ®æœ¬èº«çš„æ ¼å¼ã€‚</p>\n<p>ç®€å•ç†è§£å…¶å®å°±æ˜¯ä¸€ç§è§„èŒƒï¼Œä»¥ä½•ç§æ–¹å¼è¯·æ±‚ï¼Œä»¥ä½•ç§æ–¹å¼åº”ç­”ã€‚ç‰¹ç‚¹å˜›ï¼Œ<strong><em>ä¸€æ¬¡è¯·æ±‚ï¼ˆRequestï¼‰å¯¹åº”ä¸€æ¬¡å“åº”ï¼ˆResponseï¼‰</em></strong>ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè®¿é—® Google é¦–é¡µçš„è¯·æ±‚å’Œåº”ç­”ã€‚<br><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbb9dlv1ylj20xy0ts7ct.jpg\" alt=\"\"></p>\n<p>åœ¨ç¬¬ä¸€æ  General ä¸­å¯ä»¥çœ‹åˆ°æœ¬æ¬¡çš„è¯·æ±‚ç›®æ ‡ï¼Œæ¥è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°ä»£è¡¨å•¥æ„æ€ã€‚</p>\n<ul>\n<li>Request URL:<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"noopener\">https://www.google.com/</a>  è¯·æ±‚çš„ URLï¼Œè¿™é‡Œæˆ‘ä»¬è®¿é—®çš„æ˜¯ Google é¦–é¡µã€‚</li>\n<li>Request Method:GET è¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ GET æ–¹å¼è¯·æ±‚ã€‚</li>\n<li>Status Code:200  çŠ¶æ€ç 200 ï¼Œè¡¨ç¤º OKã€‚</li>\n<li>Remote Address:127.0.0.1:1080 è¿™é‡Œè¡¨ç¤ºè¯·æ±‚çš„è¿œç«¯ IP åœ°å€åŠç«¯å£ï¼Œå› ä¸ºæˆ‘æ˜¯ç§‘å­¦ä¸Šç½‘ï¼Œè¿™é‡Œæ‰æ˜¾ç¤ºäº†ä¸€ä¸ªå›è·¯åœ°å€ã€‚</li>\n</ul>\n<h4 id=\"Node-js-æ­å»º-http-æœåŠ¡å™¨\"><a href=\"#Node-js-æ­å»º-http-æœåŠ¡å™¨\" class=\"headerlink\" title=\"Node.js æ­å»º http æœåŠ¡å™¨\"></a>Node.js æ­å»º http æœåŠ¡å™¨</h4><p>Node.js æä¾›äº† http æ¨¡å—ï¼Œä½¿ç”¨ HTTP æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯åŠŸèƒ½å¿…é¡»è°ƒç”¨ http æ¨¡å—ï¼ŒNode.js æ­å»ºä¸€ä¸ª http æœåŠ¡å™¨éå¸¸ç®€å•ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼Œæ¥çœ‹çœ‹æŠŠã€‚:P<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥ http æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆ›å»ºæœåŠ¡ï¼Œå›è°ƒå‡½æ•°å¤„ç†è¯·æ±‚ï¼ˆRequestï¼‰å’Œå“åº”ï¼ˆResponseï¼‰ï¼Œç›‘å¬8080ç«¯å£</span></span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.write(<span class=\"string\">'hello,world!'</span>);</span><br><span class=\"line\">    res.end();</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Server running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <a href=\"http://127.0.0.1:8080/\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:8080/</a> å°±å¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„æœåŠ¡æˆåŠŸå•¦ã€‚<br><img src=\"http://ww4.sinaimg.cn/large/6057861cgw1fbbabbplavj20tg08mmyp.jpg\" alt=\"\"></p>\n<h4 id=\"HTTP-å“åº”å†…å®¹\"><a href=\"#HTTP-å“åº”å†…å®¹\" class=\"headerlink\" title=\"HTTP å“åº”å†…å®¹\"></a>HTTP å“åº”å†…å®¹</h4><p>é—®é¢˜æ¥äº†ï¼Œé‚£ä¹ˆå¦‚ä½•æ ¹æ®ä¸åŒçš„ URL æ¥å“åº”ä¸åŒçš„å†…å®¹å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œhttp æœåŠ¡å™¨åœ¨å¤„ç† URL çš„æ—¶å€™ï¼Œä¼šæ ¹æ® URL çš„å‚æ•°æ¥åˆ†è¾¨ä¸åŒçš„è¯·æ±‚å†…å®¹ï¼Œæ ¹æ®è¯·æ±‚çš„å†…å®¹æ¥å“åº”ä¸ä¹‹å¯¹åº”çš„å†…å®¹ã€‚ä¸€ä¸ªå®Œæ•´çš„ URL é•¿è¿™ä¸ªæ ·å­ã€‚<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scheme://host.domain:port/path/filename?queryName=queryValue</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>schemeï¼šå®šä¹‰æœåŠ¡ç±»å‹ï¼Œå¸¸è§çš„å¦‚ http</li>\n<li>hostï¼šå®šä¹‰åŸŸä¸»æœºï¼Œhttp é€šå¸¸æ˜¯ www</li>\n<li>domainï¼šå®šä¹‰åŸŸåï¼Œæ¯”å¦‚ google.com</li>\n<li>:portï¼šå®šä¹‰ä¸»æœºçš„ç«¯å£å·ï¼Œé»˜è®¤æ˜¯80</li>\n<li>pathï¼šå®šä¹‰è·¯å¾„ï¼Œçœç•¥ <code>/</code> è¡¨ç¤ºæ ¹ç›®å½•</li>\n<li>filenameï¼šå®šä¹‰æ–‡ä»¶å</li>\n<li>?queryName=queryValueï¼šæŸ¥è¯¢å­—ç¬¦ä¸²</li>\n</ul>\n<p>å¯ä»¥çœ‹å‡ºï¼Œæƒ³è¦å“åº”ä¸åŒçš„å†…å®¹ï¼Œå°±éœ€è¦åˆ†æå‡º URL ä¸­çš„ <code>path</code> å’Œ <code>filename</code> ä»¥åŠå¯¹åº”çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">'url'</span>);<span class=\"comment\">// å¼•å…¥ url æ¨¡å—ç”¨äºå¤„ç†åœ°å€</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">'querystring'</span>); <span class=\"comment\">// å¼•å…¥ querystring æ¨¡å—</span></span><br><span class=\"line\"></span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// é¦–é¡µ</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> path = url.parse(req.url).pathname;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (path == <span class=\"string\">'/'</span>) &#123;</span><br><span class=\"line\">        fs.readFile(<span class=\"string\">'./html/index.html'</span>, <span class=\"string\">'utf-8'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, result</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!err) &#123;</span><br><span class=\"line\">                res.write(result);</span><br><span class=\"line\">                res.end();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ç™»å½•</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (path == <span class=\"string\">'/login'</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//&#123;...&#125;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ç™»å½•éªŒè¯</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (path == <span class=\"string\">'/checkLogin'</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> queryObj = querystring.parse(url.parse(req.url).query);</span><br><span class=\"line\">        <span class=\"comment\">// querystring.parse() æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ï¼Œ&#123; usr: 'admin', pwd: '123' &#125;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (queryObj.usr == <span class=\"string\">'admin'</span> &amp;&amp; queryObj.pwd == <span class=\"string\">'123'</span>) &#123;</span><br><span class=\"line\">            res.write(<span class=\"string\">'Login Success!'</span>);</span><br><span class=\"line\">            res.end();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Server running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"HTTP-å“åº”çŠ¶æ€ç \"><a href=\"#HTTP-å“åº”çŠ¶æ€ç \" class=\"headerlink\" title=\"HTTP å“åº”çŠ¶æ€ç \"></a>HTTP å“åº”çŠ¶æ€ç </h4><p>HTTP çŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTP çŠ¶æ€ç å…±åˆ†ä¸º5ç§ç±»å‹ï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">åˆ†ç±»</th>\n<th style=\"text-align:left\">åˆ†ç±»æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1**</td>\n<td style=\"text-align:left\">ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2**</td>\n<td style=\"text-align:left\">æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">3**</td>\n<td style=\"text-align:left\">é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">4**</td>\n<td style=\"text-align:left\">å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">5**</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯</td>\n</tr>\n</tbody>\n</table>\n<p>éœ€è¦è®°ä½å¸¸è§çš„å‡ ç§å°±å¯ä»¥äº†ï¼Œå¦å¤–çš„å¯ä»¥<a href=\"http://tools.jb51.net/table/http_status_code\" target=\"_blank\" rel=\"noopener\">æŸ¥æ‰‹å†Œ</a>æ‰¾åˆ°éå¸¸è¯¦ç»†çš„è§£é‡Šã€‚</p>\n<ul>\n<li>200    OK    è¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äº GET ä¸ POST è¯·æ±‚ã€‚</li>\n<li>304    Not Modified    æœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚</li>\n<li>404    Not Found    æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚</li>\n<li>500    Internal Server Error    æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ã€‚</li>\n</ul>\n<h4 id=\"HTTP-å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\"><a href=\"#HTTP-å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"HTTP å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\"></a>HTTP å“åº”ä¸åŒçš„æ•°æ®ç±»å‹</h4><p>æœåŠ¡å™¨å…·æœ‰è¿”å›å„ç§æ•°æ®çš„èƒ½åŠ›ï¼Œä½†æ˜¯è¿”å›æ•°æ®æ—¶ï¼Œåº”å‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆæ–‡ä»¶ã€‚é€šè¿‡ <code>Content-Type</code> å¯ä»¥è®¾ç½®ï¼Œå“åº”çš„æ•°æ®ç±»å‹ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// è®¾ç½®å“åº”çš„çŠ¶æ€ç ï¼Œæ•°æ®ç±»å‹</span></span><br><span class=\"line\">    res.writeHeader(<span class=\"string\">'200'</span>, &#123;<span class=\"string\">'Content-Type'</span>: <span class=\"string\">'image/png;charset=utf-8'</span>&#125;);</span><br><span class=\"line\">    fs.readFile(<span class=\"string\">'./hello.png'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, result</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!err) &#123;</span><br><span class=\"line\">            res.write(result);</span><br><span class=\"line\">            res.end();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Server running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>å¯ä»¥é€šè¿‡ <a href=\"https://github.com/broofa/node-mime\" target=\"_blank\" rel=\"noopener\">node-mime</a> æ¥æŸ¥è¯¢å„ç§æ–‡ä»¶çš„æ•°æ®ç±»å‹ã€‚å…ˆç”¨ npm å®‰è£…ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install mime --save</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> mime = <span class=\"built_in\">require</span>(<span class=\"string\">'mime'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.txt'</span>));   <span class=\"comment\">// text/plain</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.html'</span>));  <span class=\"comment\">// text/html</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.css'</span>));   <span class=\"comment\">// text/css</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.js'</span>));    <span class=\"comment\">// application/javascript</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.mp3'</span>));   <span class=\"comment\">// audio/mpeg</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Web-å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\"><a href=\"#Web-å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\" class=\"headerlink\" title=\"Web å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\"></a>Web å®¢æˆ·ç«¯æ•°æ®ä¼ é€’</h3><h4 id=\"é€šè¿‡-URL-ä¼ é€’\"><a href=\"#é€šè¿‡-URL-ä¼ é€’\" class=\"headerlink\" title=\"é€šè¿‡ URL ä¼ é€’\"></a>é€šè¿‡ URL ä¼ é€’</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scheme://host.domain:port/path/filename?queryName=queryValue</span><br></pre></td></tr></table></figure>\n<p>å…¶ä¸­ <code>?queryName=queryValue</code> å°±æ˜¯é€šè¿‡ URL ä¼ é€’çš„æ•°æ®ï¼Œä¸¾ä¸ªä¾‹å­ï¼š<code>?usr=admin&amp;pwd=123</code> å°±è¡¨ç¤ºä¼ é€’ä¸€ä¸ª <code>usr</code> ä¸º <code>admin</code> ï¼Œ<code>pwd</code> ä¸º <code>123</code> çš„æ•°æ®åˆ°åå°ã€‚</p>\n<h4 id=\"é€šè¿‡è¡¨å•ä¼ é€’\"><a href=\"#é€šè¿‡è¡¨å•ä¼ é€’\" class=\"headerlink\" title=\"é€šè¿‡è¡¨å•ä¼ é€’\"></a>é€šè¿‡è¡¨å•ä¼ é€’</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">\"/user\"</span> <span class=\"attr\">method</span>=<span class=\"string\">\"get\"</span>&gt;</span></span><br><span class=\"line\">    ç”¨æˆ·åï¼š<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span>/&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">    å¯† ç ï¼š<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"æäº¤\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>actionï¼šæäº¤åˆ°æœåŠ¡å™¨å¤„ç†ç¨‹åºçš„urlåœ°å€</li>\n<li>methodï¼šæäº¤æ–¹å¼æœ‰ <code>GET</code> å’Œ <code>POST</code></li>\n<li>GETï¼šä¼šæŠŠè¡¨å•æ•°æ®ä½œä¸º URL çš„ä¸€éƒ¨åˆ†æ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼ŒURL é•¿åº¦æœ‰é™åˆ¶ä¸èƒ½æäº¤å¤§é‡æ•°æ®</li>\n<li>POSTï¼šä¼šæŠŠè¡¨å•æ•°æ®æ”¾åˆ° HTTP è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹å®‰å…¨ï¼Œè€Œä¸”å¯ä»¥æäº¤å¤§é‡æ•°æ®ï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰</li>\n</ul>\n<h4 id=\"æ•°æ®ç±»å‹\"><a href=\"#æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"æ•°æ®ç±»å‹\"></a>æ•°æ®ç±»å‹</h4><p>å‰é¢è®²äº†ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿”å›ç»™æµè§ˆå™¨æ•°æ®æ—¶ï¼Œä¼šé€šè¿‡ <code>Content-Type</code> æŒ‡å®šæ•°æ®ç±»å‹ï¼ŒåŒæ ·çš„ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨ä¼ é€’æ•°æ®æ—¶ï¼Œä¹Ÿéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚åœ¨è¿™ä¸¤ç§æ•°æ®ä¼ é€’æ–¹å¼ä¸­ï¼Œè¡¨å•ä¼ é€’æ•°æ®æ—¶ï¼Œ<code>POST</code> æ–¹å¼ï¼Œå¿…é¡»æŒ‡å®šæ•°æ®ç±»å‹ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">\"/user\"</span> <span class=\"attr\">method</span>=<span class=\"string\">\"post\"</span> <span class=\"attr\">enctype</span>=<span class=\"string\">\"multipart/form-data\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"file\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"ä¸Šä¼ \"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p><code>enctype</code> æŒ‡å®š POST çš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤æ˜¯ <code>application/x-www-form-urlencoded</code>ï¼Œä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå°±éœ€è¦ <code>multipart/form-data</code> ç±»å‹äº†ã€‚</p>\n","site":{"data":{}},"excerpt":"<p>æœ¬æ¬¡çš„å­¦ä¹ å†…å®¹æ˜¯ Node.js Web æ¨¡å—ï¼Œä»‹ç»äº†ä»€ä¹ˆæ˜¯ web æœåŠ¡å™¨ï¼Œä»¥åŠå¸¸è§çš„å‡ ç§æ¨¡å¼ï¼Œæ¯”å¦‚ B/S æ¨¡å¼ï¼ˆBrowser/Serverï¼Œæµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ï¼‰ï¼ŒC/S æ¨¡å¼ï¼ˆClient/Serverï¼Œå®¢æˆ·ç«¯/æœåŠ¡å™¨æ¨¡å¼ï¼‰ç­‰ã€‚Web å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨ HTTP åè®®å°±èƒ½è®¿é—®åˆ° Web æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼ŒWeb æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚<br>","more":"</p>\n<h3 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h3><h4 id=\"HTTP-åè®®\"><a href=\"#HTTP-åè®®\" class=\"headerlink\" title=\"HTTP åè®®\"></a>HTTP åè®®</h4><p><strong><em>HTTP</em></strong>  åè®®æ˜¯ Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,æ˜¯ç”¨äºä»ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚ç”¨äºå®šä¹‰ Web æµè§ˆå™¨ä¸ Web æœåŠ¡å™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹ä»¥åŠæ•°æ®æœ¬èº«çš„æ ¼å¼ã€‚</p>\n<p>ç®€å•ç†è§£å…¶å®å°±æ˜¯ä¸€ç§è§„èŒƒï¼Œä»¥ä½•ç§æ–¹å¼è¯·æ±‚ï¼Œä»¥ä½•ç§æ–¹å¼åº”ç­”ã€‚ç‰¹ç‚¹å˜›ï¼Œ<strong><em>ä¸€æ¬¡è¯·æ±‚ï¼ˆRequestï¼‰å¯¹åº”ä¸€æ¬¡å“åº”ï¼ˆResponseï¼‰</em></strong>ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè®¿é—® Google é¦–é¡µçš„è¯·æ±‚å’Œåº”ç­”ã€‚<br><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbb9dlv1ylj20xy0ts7ct.jpg\" alt=\"\"></p>\n<p>åœ¨ç¬¬ä¸€æ  General ä¸­å¯ä»¥çœ‹åˆ°æœ¬æ¬¡çš„è¯·æ±‚ç›®æ ‡ï¼Œæ¥è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°ä»£è¡¨å•¥æ„æ€ã€‚</p>\n<ul>\n<li>Request URL:<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"noopener\">https://www.google.com/</a>  è¯·æ±‚çš„ URLï¼Œè¿™é‡Œæˆ‘ä»¬è®¿é—®çš„æ˜¯ Google é¦–é¡µã€‚</li>\n<li>Request Method:GET è¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ GET æ–¹å¼è¯·æ±‚ã€‚</li>\n<li>Status Code:200  çŠ¶æ€ç 200 ï¼Œè¡¨ç¤º OKã€‚</li>\n<li>Remote Address:127.0.0.1:1080 è¿™é‡Œè¡¨ç¤ºè¯·æ±‚çš„è¿œç«¯ IP åœ°å€åŠç«¯å£ï¼Œå› ä¸ºæˆ‘æ˜¯ç§‘å­¦ä¸Šç½‘ï¼Œè¿™é‡Œæ‰æ˜¾ç¤ºäº†ä¸€ä¸ªå›è·¯åœ°å€ã€‚</li>\n</ul>\n<h4 id=\"Node-js-æ­å»º-http-æœåŠ¡å™¨\"><a href=\"#Node-js-æ­å»º-http-æœåŠ¡å™¨\" class=\"headerlink\" title=\"Node.js æ­å»º http æœåŠ¡å™¨\"></a>Node.js æ­å»º http æœåŠ¡å™¨</h4><p>Node.js æä¾›äº† http æ¨¡å—ï¼Œä½¿ç”¨ HTTP æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯åŠŸèƒ½å¿…é¡»è°ƒç”¨ http æ¨¡å—ï¼ŒNode.js æ­å»ºä¸€ä¸ª http æœåŠ¡å™¨éå¸¸ç®€å•ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼Œæ¥çœ‹çœ‹æŠŠã€‚:P<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¼•å…¥ http æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆ›å»ºæœåŠ¡ï¼Œå›è°ƒå‡½æ•°å¤„ç†è¯·æ±‚ï¼ˆRequestï¼‰å’Œå“åº”ï¼ˆResponseï¼‰ï¼Œç›‘å¬8080ç«¯å£</span></span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.write(<span class=\"string\">'hello,world!'</span>);</span><br><span class=\"line\">    res.end();</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Server running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <a href=\"http://127.0.0.1:8080/\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:8080/</a> å°±å¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„æœåŠ¡æˆåŠŸå•¦ã€‚<br><img src=\"http://ww4.sinaimg.cn/large/6057861cgw1fbbabbplavj20tg08mmyp.jpg\" alt=\"\"></p>\n<h4 id=\"HTTP-å“åº”å†…å®¹\"><a href=\"#HTTP-å“åº”å†…å®¹\" class=\"headerlink\" title=\"HTTP å“åº”å†…å®¹\"></a>HTTP å“åº”å†…å®¹</h4><p>é—®é¢˜æ¥äº†ï¼Œé‚£ä¹ˆå¦‚ä½•æ ¹æ®ä¸åŒçš„ URL æ¥å“åº”ä¸åŒçš„å†…å®¹å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œhttp æœåŠ¡å™¨åœ¨å¤„ç† URL çš„æ—¶å€™ï¼Œä¼šæ ¹æ® URL çš„å‚æ•°æ¥åˆ†è¾¨ä¸åŒçš„è¯·æ±‚å†…å®¹ï¼Œæ ¹æ®è¯·æ±‚çš„å†…å®¹æ¥å“åº”ä¸ä¹‹å¯¹åº”çš„å†…å®¹ã€‚ä¸€ä¸ªå®Œæ•´çš„ URL é•¿è¿™ä¸ªæ ·å­ã€‚<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scheme://host.domain:port/path/filename?queryName=queryValue</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>schemeï¼šå®šä¹‰æœåŠ¡ç±»å‹ï¼Œå¸¸è§çš„å¦‚ http</li>\n<li>hostï¼šå®šä¹‰åŸŸä¸»æœºï¼Œhttp é€šå¸¸æ˜¯ www</li>\n<li>domainï¼šå®šä¹‰åŸŸåï¼Œæ¯”å¦‚ google.com</li>\n<li>:portï¼šå®šä¹‰ä¸»æœºçš„ç«¯å£å·ï¼Œé»˜è®¤æ˜¯80</li>\n<li>pathï¼šå®šä¹‰è·¯å¾„ï¼Œçœç•¥ <code>/</code> è¡¨ç¤ºæ ¹ç›®å½•</li>\n<li>filenameï¼šå®šä¹‰æ–‡ä»¶å</li>\n<li>?queryName=queryValueï¼šæŸ¥è¯¢å­—ç¬¦ä¸²</li>\n</ul>\n<p>å¯ä»¥çœ‹å‡ºï¼Œæƒ³è¦å“åº”ä¸åŒçš„å†…å®¹ï¼Œå°±éœ€è¦åˆ†æå‡º URL ä¸­çš„ <code>path</code> å’Œ <code>filename</code> ä»¥åŠå¯¹åº”çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">'url'</span>);<span class=\"comment\">// å¼•å…¥ url æ¨¡å—ç”¨äºå¤„ç†åœ°å€</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">'querystring'</span>); <span class=\"comment\">// å¼•å…¥ querystring æ¨¡å—</span></span><br><span class=\"line\"></span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// é¦–é¡µ</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> path = url.parse(req.url).pathname;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (path == <span class=\"string\">'/'</span>) &#123;</span><br><span class=\"line\">        fs.readFile(<span class=\"string\">'./html/index.html'</span>, <span class=\"string\">'utf-8'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, result</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!err) &#123;</span><br><span class=\"line\">                res.write(result);</span><br><span class=\"line\">                res.end();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ç™»å½•</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (path == <span class=\"string\">'/login'</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//&#123;...&#125;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ç™»å½•éªŒè¯</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (path == <span class=\"string\">'/checkLogin'</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> queryObj = querystring.parse(url.parse(req.url).query);</span><br><span class=\"line\">        <span class=\"comment\">// querystring.parse() æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ï¼Œ&#123; usr: 'admin', pwd: '123' &#125;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (queryObj.usr == <span class=\"string\">'admin'</span> &amp;&amp; queryObj.pwd == <span class=\"string\">'123'</span>) &#123;</span><br><span class=\"line\">            res.write(<span class=\"string\">'Login Success!'</span>);</span><br><span class=\"line\">            res.end();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Server running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"HTTP-å“åº”çŠ¶æ€ç \"><a href=\"#HTTP-å“åº”çŠ¶æ€ç \" class=\"headerlink\" title=\"HTTP å“åº”çŠ¶æ€ç \"></a>HTTP å“åº”çŠ¶æ€ç </h4><p>HTTP çŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTP çŠ¶æ€ç å…±åˆ†ä¸º5ç§ç±»å‹ï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">åˆ†ç±»</th>\n<th style=\"text-align:left\">åˆ†ç±»æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1**</td>\n<td style=\"text-align:left\">ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2**</td>\n<td style=\"text-align:left\">æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">3**</td>\n<td style=\"text-align:left\">é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">4**</td>\n<td style=\"text-align:left\">å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">5**</td>\n<td style=\"text-align:left\">æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯</td>\n</tr>\n</tbody>\n</table>\n<p>éœ€è¦è®°ä½å¸¸è§çš„å‡ ç§å°±å¯ä»¥äº†ï¼Œå¦å¤–çš„å¯ä»¥<a href=\"http://tools.jb51.net/table/http_status_code\" target=\"_blank\" rel=\"noopener\">æŸ¥æ‰‹å†Œ</a>æ‰¾åˆ°éå¸¸è¯¦ç»†çš„è§£é‡Šã€‚</p>\n<ul>\n<li>200    OK    è¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äº GET ä¸ POST è¯·æ±‚ã€‚</li>\n<li>304    Not Modified    æœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚</li>\n<li>404    Not Found    æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚</li>\n<li>500    Internal Server Error    æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ã€‚</li>\n</ul>\n<h4 id=\"HTTP-å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\"><a href=\"#HTTP-å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"HTTP å“åº”ä¸åŒçš„æ•°æ®ç±»å‹\"></a>HTTP å“åº”ä¸åŒçš„æ•°æ®ç±»å‹</h4><p>æœåŠ¡å™¨å…·æœ‰è¿”å›å„ç§æ•°æ®çš„èƒ½åŠ›ï¼Œä½†æ˜¯è¿”å›æ•°æ®æ—¶ï¼Œåº”å‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆæ–‡ä»¶ã€‚é€šè¿‡ <code>Content-Type</code> å¯ä»¥è®¾ç½®ï¼Œå“åº”çš„æ•°æ®ç±»å‹ã€‚æ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// è®¾ç½®å“åº”çš„çŠ¶æ€ç ï¼Œæ•°æ®ç±»å‹</span></span><br><span class=\"line\">    res.writeHeader(<span class=\"string\">'200'</span>, &#123;<span class=\"string\">'Content-Type'</span>: <span class=\"string\">'image/png;charset=utf-8'</span>&#125;);</span><br><span class=\"line\">    fs.readFile(<span class=\"string\">'./hello.png'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, result</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!err) &#123;</span><br><span class=\"line\">            res.write(result);</span><br><span class=\"line\">            res.end();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Server running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>å¯ä»¥é€šè¿‡ <a href=\"https://github.com/broofa/node-mime\" target=\"_blank\" rel=\"noopener\">node-mime</a> æ¥æŸ¥è¯¢å„ç§æ–‡ä»¶çš„æ•°æ®ç±»å‹ã€‚å…ˆç”¨ npm å®‰è£…ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install mime --save</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> mime = <span class=\"built_in\">require</span>(<span class=\"string\">'mime'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.txt'</span>));   <span class=\"comment\">// text/plain</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.html'</span>));  <span class=\"comment\">// text/html</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.css'</span>));   <span class=\"comment\">// text/css</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.js'</span>));    <span class=\"comment\">// application/javascript</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(mime.lookup(<span class=\"string\">'test.mp3'</span>));   <span class=\"comment\">// audio/mpeg</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Web-å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\"><a href=\"#Web-å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\" class=\"headerlink\" title=\"Web å®¢æˆ·ç«¯æ•°æ®ä¼ é€’\"></a>Web å®¢æˆ·ç«¯æ•°æ®ä¼ é€’</h3><h4 id=\"é€šè¿‡-URL-ä¼ é€’\"><a href=\"#é€šè¿‡-URL-ä¼ é€’\" class=\"headerlink\" title=\"é€šè¿‡ URL ä¼ é€’\"></a>é€šè¿‡ URL ä¼ é€’</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scheme://host.domain:port/path/filename?queryName=queryValue</span><br></pre></td></tr></table></figure>\n<p>å…¶ä¸­ <code>?queryName=queryValue</code> å°±æ˜¯é€šè¿‡ URL ä¼ é€’çš„æ•°æ®ï¼Œä¸¾ä¸ªä¾‹å­ï¼š<code>?usr=admin&amp;pwd=123</code> å°±è¡¨ç¤ºä¼ é€’ä¸€ä¸ª <code>usr</code> ä¸º <code>admin</code> ï¼Œ<code>pwd</code> ä¸º <code>123</code> çš„æ•°æ®åˆ°åå°ã€‚</p>\n<h4 id=\"é€šè¿‡è¡¨å•ä¼ é€’\"><a href=\"#é€šè¿‡è¡¨å•ä¼ é€’\" class=\"headerlink\" title=\"é€šè¿‡è¡¨å•ä¼ é€’\"></a>é€šè¿‡è¡¨å•ä¼ é€’</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">\"/user\"</span> <span class=\"attr\">method</span>=<span class=\"string\">\"get\"</span>&gt;</span></span><br><span class=\"line\">    ç”¨æˆ·åï¼š<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span>/&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">    å¯† ç ï¼š<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"æäº¤\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>actionï¼šæäº¤åˆ°æœåŠ¡å™¨å¤„ç†ç¨‹åºçš„urlåœ°å€</li>\n<li>methodï¼šæäº¤æ–¹å¼æœ‰ <code>GET</code> å’Œ <code>POST</code></li>\n<li>GETï¼šä¼šæŠŠè¡¨å•æ•°æ®ä½œä¸º URL çš„ä¸€éƒ¨åˆ†æ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼ŒURL é•¿åº¦æœ‰é™åˆ¶ä¸èƒ½æäº¤å¤§é‡æ•°æ®</li>\n<li>POSTï¼šä¼šæŠŠè¡¨å•æ•°æ®æ”¾åˆ° HTTP è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹å®‰å…¨ï¼Œè€Œä¸”å¯ä»¥æäº¤å¤§é‡æ•°æ®ï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰</li>\n</ul>\n<h4 id=\"æ•°æ®ç±»å‹\"><a href=\"#æ•°æ®ç±»å‹\" class=\"headerlink\" title=\"æ•°æ®ç±»å‹\"></a>æ•°æ®ç±»å‹</h4><p>å‰é¢è®²äº†ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿”å›ç»™æµè§ˆå™¨æ•°æ®æ—¶ï¼Œä¼šé€šè¿‡ <code>Content-Type</code> æŒ‡å®šæ•°æ®ç±»å‹ï¼ŒåŒæ ·çš„ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨ä¼ é€’æ•°æ®æ—¶ï¼Œä¹Ÿéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚åœ¨è¿™ä¸¤ç§æ•°æ®ä¼ é€’æ–¹å¼ä¸­ï¼Œè¡¨å•ä¼ é€’æ•°æ®æ—¶ï¼Œ<code>POST</code> æ–¹å¼ï¼Œå¿…é¡»æŒ‡å®šæ•°æ®ç±»å‹ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">\"/user\"</span> <span class=\"attr\">method</span>=<span class=\"string\">\"post\"</span> <span class=\"attr\">enctype</span>=<span class=\"string\">\"multipart/form-data\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"file\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"ä¸Šä¼ \"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p><code>enctype</code> æŒ‡å®š POST çš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤æ˜¯ <code>application/x-www-form-urlencoded</code>ï¼Œä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå°±éœ€è¦ <code>multipart/form-data</code> ç±»å‹äº†ã€‚</p>"},{"title":"ProxyChains-NG + ShadowSocks å®ç°ç»ˆç«¯ä»£ç†","date":"2016-03-23T00:25:31.000Z","comments":0,"_content":"\nç»å¸¸åœ¨ç»ˆç«¯ä¸‹æ‰§è¡Œä¸€äº›ç½‘ç»œå‘½ä»¤ï¼Œä¾‹å¦‚ `wget` ã€`git`ã€`ssh` ç­‰å‘½ä»¤ï¼Œé€Ÿåº¦æ…¢çš„ä¸è¡Œï¼Œè¯´ç™½äº†ï¼Œæœ‰äº›æ˜¯å› ä¸º GFW çš„åŸå› ï¼Œæœ‰äº›åˆ™æ˜¯è®¿é—®å›½å¤–çš„æœåŠ¡å™¨æœ¬æ¥é€Ÿåº¦å°±å¾ˆæ…¢ï¼Œè€Œæˆ‘ä»¬çš„ ShadowSocks æä¾›çš„æ˜¯ `socks5` ä»£ç†ï¼Œç»ˆç«¯æ— æ³•äº«ç”¨ã€‚è¿™ä¸ªæ—¶å€™ **ProxyChains-NG** åº”åŠ¿è€Œç”Ÿã€‚\n<!-- more -->\n### å®‰è£…\nä½¿ç”¨ [brew](http://brew.sh/index_zh-cn.html) å¿«é€Ÿå®‰è£… ProxyChains-NGï¼Œæƒ³è¯¦ç»†äº†è§£ ProxyChains-NG å¯ä»¥å»ä»–ä»¬[é¡¹ç›®ä¸»é¡µ](https://github.com/rofl0r/proxychains-ng)ã€‚\n```bash\nbrew install proxychains-ng\n```\n\né…ç½®\n```bash\nvi /usr/local/etc/proxychains.conf\n```\n\næ·»åŠ ä»£ç†\n```bash\nsocks5  127.0.0.1 1080\n```\n\n### ä½¿ç”¨\nåˆ°æ­¤ä¸ºæ­¢ï¼Œæ•´ä¸ªå‘½ä»¤å®‰è£…å®Œæˆï¼Œç”¨æ³• `proxychains4 éœ€è¦æ‰§è¡Œçš„å‘½ä»¤`ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ ss çš„ IP äº†ã€‚\n```bash\nproxychains4 curl ip.cn\n```\n\n\n### ä¼˜åŒ–\nè¿™ä¸ªå‘½ä»¤å¤ªé•¿äº†ï¼Œæˆ‘æƒ³æ¢ä¸€ä¸ªï¼æˆ‘ä½¿ç”¨çš„æ˜¯ zshï¼Œæ¥ç»™ `proxychains4` é…ç½®ä¸€ä¸ªåˆ«åå§ï¼:P\nç¼–è¾‘ zsh é…ç½®æ–‡ä»¶\n```bash\nvi ~/.zshrc\n```\n\næ·»åŠ åˆ«å\n```bash\nalias myss='proxychains4'\n```\n\nè®©é…ç½®ç”Ÿæ•ˆ\n```bash\nsource ~/.zshrc\n```\n\nå†æ‰§è¡Œä¹‹å‰æŸ¥çœ‹ ip çš„å‘½ä»¤\n```bash\nmyss curl ip.cn\n```\n\nHave done! :)\n\n### æµ‹é€Ÿ\nä½¿ç”¨ speedtest çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¥æµ‹ä¸Šè¡Œå®½å¸¦å’Œä¸‹è¡Œå®½åº¦ã€‚\n```bash\n# ä¸‹è½½ speedtest-cli\nwget -O speedtest-cli https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py\n\n# ç»™æ‰§è¡Œæƒé™\nchmod +x speedtest-cli\n\n# è¿è¡Œ\n./speedtest-cli\n\n# æµ‹è¯•ä¸‹ä»£ç†çš„é€Ÿåº¦\nmyss ./speedtest-cli\n```\n\n#### é™„ï¼šbrew å¸¸ç”¨å‘½ä»¤\n\n|å‘½ä»¤          |å«ä¹‰                       |\n|:------------|:--------------------------|\n|å®‰è£…åŒ…        |brew install `<PackageName>`|\n|æœç´¢åŒ…        |brew search `<PackageName>` |\n|æŸ¥è¯¢åŒ…ä¿¡æ¯    |brew info `<PackageName>`   |\n|å‡çº§æŒ‡å®šåŒ…    |brew upgrade `<PackageName>`|\n|æ›´æ–°è‡ªå·±      |brew update                |\n|æ£€æŸ¥è¿‡æ—¶åŒ…    |brew outdated              |\n|å‡çº§æ‰€æœ‰åŒ…    |brew upgrade               |\n|æ¸…ç†ç¼“å­˜      |brew cleanup               |\n","source":"_posts/ProxyChains-NG + ShadowSocks å®ç°ç»ˆç«¯ä»£ç†.md","raw":"---\ntitle: ProxyChains-NG + ShadowSocks å®ç°ç»ˆç«¯ä»£ç†\ndate: 2016-03-23 08:25:31\ntags:\ncomments: false\n---\n\nç»å¸¸åœ¨ç»ˆç«¯ä¸‹æ‰§è¡Œä¸€äº›ç½‘ç»œå‘½ä»¤ï¼Œä¾‹å¦‚ `wget` ã€`git`ã€`ssh` ç­‰å‘½ä»¤ï¼Œé€Ÿåº¦æ…¢çš„ä¸è¡Œï¼Œè¯´ç™½äº†ï¼Œæœ‰äº›æ˜¯å› ä¸º GFW çš„åŸå› ï¼Œæœ‰äº›åˆ™æ˜¯è®¿é—®å›½å¤–çš„æœåŠ¡å™¨æœ¬æ¥é€Ÿåº¦å°±å¾ˆæ…¢ï¼Œè€Œæˆ‘ä»¬çš„ ShadowSocks æä¾›çš„æ˜¯ `socks5` ä»£ç†ï¼Œç»ˆç«¯æ— æ³•äº«ç”¨ã€‚è¿™ä¸ªæ—¶å€™ **ProxyChains-NG** åº”åŠ¿è€Œç”Ÿã€‚\n<!-- more -->\n### å®‰è£…\nä½¿ç”¨ [brew](http://brew.sh/index_zh-cn.html) å¿«é€Ÿå®‰è£… ProxyChains-NGï¼Œæƒ³è¯¦ç»†äº†è§£ ProxyChains-NG å¯ä»¥å»ä»–ä»¬[é¡¹ç›®ä¸»é¡µ](https://github.com/rofl0r/proxychains-ng)ã€‚\n```bash\nbrew install proxychains-ng\n```\n\né…ç½®\n```bash\nvi /usr/local/etc/proxychains.conf\n```\n\næ·»åŠ ä»£ç†\n```bash\nsocks5  127.0.0.1 1080\n```\n\n### ä½¿ç”¨\nåˆ°æ­¤ä¸ºæ­¢ï¼Œæ•´ä¸ªå‘½ä»¤å®‰è£…å®Œæˆï¼Œç”¨æ³• `proxychains4 éœ€è¦æ‰§è¡Œçš„å‘½ä»¤`ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ ss çš„ IP äº†ã€‚\n```bash\nproxychains4 curl ip.cn\n```\n\n\n### ä¼˜åŒ–\nè¿™ä¸ªå‘½ä»¤å¤ªé•¿äº†ï¼Œæˆ‘æƒ³æ¢ä¸€ä¸ªï¼æˆ‘ä½¿ç”¨çš„æ˜¯ zshï¼Œæ¥ç»™ `proxychains4` é…ç½®ä¸€ä¸ªåˆ«åå§ï¼:P\nç¼–è¾‘ zsh é…ç½®æ–‡ä»¶\n```bash\nvi ~/.zshrc\n```\n\næ·»åŠ åˆ«å\n```bash\nalias myss='proxychains4'\n```\n\nè®©é…ç½®ç”Ÿæ•ˆ\n```bash\nsource ~/.zshrc\n```\n\nå†æ‰§è¡Œä¹‹å‰æŸ¥çœ‹ ip çš„å‘½ä»¤\n```bash\nmyss curl ip.cn\n```\n\nHave done! :)\n\n### æµ‹é€Ÿ\nä½¿ç”¨ speedtest çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¥æµ‹ä¸Šè¡Œå®½å¸¦å’Œä¸‹è¡Œå®½åº¦ã€‚\n```bash\n# ä¸‹è½½ speedtest-cli\nwget -O speedtest-cli https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py\n\n# ç»™æ‰§è¡Œæƒé™\nchmod +x speedtest-cli\n\n# è¿è¡Œ\n./speedtest-cli\n\n# æµ‹è¯•ä¸‹ä»£ç†çš„é€Ÿåº¦\nmyss ./speedtest-cli\n```\n\n#### é™„ï¼šbrew å¸¸ç”¨å‘½ä»¤\n\n|å‘½ä»¤          |å«ä¹‰                       |\n|:------------|:--------------------------|\n|å®‰è£…åŒ…        |brew install `<PackageName>`|\n|æœç´¢åŒ…        |brew search `<PackageName>` |\n|æŸ¥è¯¢åŒ…ä¿¡æ¯    |brew info `<PackageName>`   |\n|å‡çº§æŒ‡å®šåŒ…    |brew upgrade `<PackageName>`|\n|æ›´æ–°è‡ªå·±      |brew update                |\n|æ£€æŸ¥è¿‡æ—¶åŒ…    |brew outdated              |\n|å‡çº§æ‰€æœ‰åŒ…    |brew upgrade               |\n|æ¸…ç†ç¼“å­˜      |brew cleanup               |\n","slug":"ProxyChains-NG + ShadowSocks å®ç°ç»ˆç«¯ä»£ç†","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidix000eu4q9szsucf65","content":"<p>ç»å¸¸åœ¨ç»ˆç«¯ä¸‹æ‰§è¡Œä¸€äº›ç½‘ç»œå‘½ä»¤ï¼Œä¾‹å¦‚ <code>wget</code> ã€<code>git</code>ã€<code>ssh</code> ç­‰å‘½ä»¤ï¼Œé€Ÿåº¦æ…¢çš„ä¸è¡Œï¼Œè¯´ç™½äº†ï¼Œæœ‰äº›æ˜¯å› ä¸º GFW çš„åŸå› ï¼Œæœ‰äº›åˆ™æ˜¯è®¿é—®å›½å¤–çš„æœåŠ¡å™¨æœ¬æ¥é€Ÿåº¦å°±å¾ˆæ…¢ï¼Œè€Œæˆ‘ä»¬çš„ ShadowSocks æä¾›çš„æ˜¯ <code>socks5</code> ä»£ç†ï¼Œç»ˆç«¯æ— æ³•äº«ç”¨ã€‚è¿™ä¸ªæ—¶å€™ <strong>ProxyChains-NG</strong> åº”åŠ¿è€Œç”Ÿã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h3><p>ä½¿ç”¨ <a href=\"http://brew.sh/index_zh-cn.html\" target=\"_blank\" rel=\"noopener\">brew</a> å¿«é€Ÿå®‰è£… ProxyChains-NGï¼Œæƒ³è¯¦ç»†äº†è§£ ProxyChains-NG å¯ä»¥å»ä»–ä»¬<a href=\"https://github.com/rofl0r/proxychains-ng\" target=\"_blank\" rel=\"noopener\">é¡¹ç›®ä¸»é¡µ</a>ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install proxychains-ng</span><br></pre></td></tr></table></figure></p>\n<p>é…ç½®<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /usr/<span class=\"built_in\">local</span>/etc/proxychains.conf</span><br></pre></td></tr></table></figure></p>\n<p>æ·»åŠ ä»£ç†<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">socks5  127.0.0.1 1080</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ä½¿ç”¨\"><a href=\"#ä½¿ç”¨\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæ•´ä¸ªå‘½ä»¤å®‰è£…å®Œæˆï¼Œç”¨æ³• <code>proxychains4 éœ€è¦æ‰§è¡Œçš„å‘½ä»¤</code>ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ ss çš„ IP äº†ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">proxychains4 curl ip.cn</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ä¼˜åŒ–\"><a href=\"#ä¼˜åŒ–\" class=\"headerlink\" title=\"ä¼˜åŒ–\"></a>ä¼˜åŒ–</h3><p>è¿™ä¸ªå‘½ä»¤å¤ªé•¿äº†ï¼Œæˆ‘æƒ³æ¢ä¸€ä¸ªï¼æˆ‘ä½¿ç”¨çš„æ˜¯ zshï¼Œæ¥ç»™ <code>proxychains4</code> é…ç½®ä¸€ä¸ªåˆ«åå§ï¼:P<br>ç¼–è¾‘ zsh é…ç½®æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi ~/.zshrc</span><br></pre></td></tr></table></figure></p>\n<p>æ·»åŠ åˆ«å<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">alias</span> myss=<span class=\"string\">'proxychains4'</span></span><br></pre></td></tr></table></figure></p>\n<p>è®©é…ç½®ç”Ÿæ•ˆ<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure></p>\n<p>å†æ‰§è¡Œä¹‹å‰æŸ¥çœ‹ ip çš„å‘½ä»¤<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">myss curl ip.cn</span><br></pre></td></tr></table></figure></p>\n<p>Have done! :)</p>\n<h3 id=\"æµ‹é€Ÿ\"><a href=\"#æµ‹é€Ÿ\" class=\"headerlink\" title=\"æµ‹é€Ÿ\"></a>æµ‹é€Ÿ</h3><p>ä½¿ç”¨ speedtest çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¥æµ‹ä¸Šè¡Œå®½å¸¦å’Œä¸‹è¡Œå®½åº¦ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ä¸‹è½½ speedtest-cli</span></span><br><span class=\"line\">wget -O speedtest-cli https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç»™æ‰§è¡Œæƒé™</span></span><br><span class=\"line\">chmod +x speedtest-cli</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿è¡Œ</span></span><br><span class=\"line\">./speedtest-cli</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•ä¸‹ä»£ç†çš„é€Ÿåº¦</span></span><br><span class=\"line\">myss ./speedtest-cli</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"é™„ï¼šbrew-å¸¸ç”¨å‘½ä»¤\"><a href=\"#é™„ï¼šbrew-å¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"é™„ï¼šbrew å¸¸ç”¨å‘½ä»¤\"></a>é™„ï¼šbrew å¸¸ç”¨å‘½ä»¤</h4><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">å‘½ä»¤</th>\n<th style=\"text-align:left\">å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">å®‰è£…åŒ…</td>\n<td style=\"text-align:left\">brew install <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœç´¢åŒ…</td>\n<td style=\"text-align:left\">brew search <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æŸ¥è¯¢åŒ…ä¿¡æ¯</td>\n<td style=\"text-align:left\">brew info <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">å‡çº§æŒ‡å®šåŒ…</td>\n<td style=\"text-align:left\">brew upgrade <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æ›´æ–°è‡ªå·±</td>\n<td style=\"text-align:left\">brew update</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æ£€æŸ¥è¿‡æ—¶åŒ…</td>\n<td style=\"text-align:left\">brew outdated</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">å‡çº§æ‰€æœ‰åŒ…</td>\n<td style=\"text-align:left\">brew upgrade</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æ¸…ç†ç¼“å­˜</td>\n<td style=\"text-align:left\">brew cleanup</td>\n</tr>\n</tbody>\n</table>\n","site":{"data":{}},"excerpt":"<p>ç»å¸¸åœ¨ç»ˆç«¯ä¸‹æ‰§è¡Œä¸€äº›ç½‘ç»œå‘½ä»¤ï¼Œä¾‹å¦‚ <code>wget</code> ã€<code>git</code>ã€<code>ssh</code> ç­‰å‘½ä»¤ï¼Œé€Ÿåº¦æ…¢çš„ä¸è¡Œï¼Œè¯´ç™½äº†ï¼Œæœ‰äº›æ˜¯å› ä¸º GFW çš„åŸå› ï¼Œæœ‰äº›åˆ™æ˜¯è®¿é—®å›½å¤–çš„æœåŠ¡å™¨æœ¬æ¥é€Ÿåº¦å°±å¾ˆæ…¢ï¼Œè€Œæˆ‘ä»¬çš„ ShadowSocks æä¾›çš„æ˜¯ <code>socks5</code> ä»£ç†ï¼Œç»ˆç«¯æ— æ³•äº«ç”¨ã€‚è¿™ä¸ªæ—¶å€™ <strong>ProxyChains-NG</strong> åº”åŠ¿è€Œç”Ÿã€‚<br>","more":"</p>\n<h3 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h3><p>ä½¿ç”¨ <a href=\"http://brew.sh/index_zh-cn.html\" target=\"_blank\" rel=\"noopener\">brew</a> å¿«é€Ÿå®‰è£… ProxyChains-NGï¼Œæƒ³è¯¦ç»†äº†è§£ ProxyChains-NG å¯ä»¥å»ä»–ä»¬<a href=\"https://github.com/rofl0r/proxychains-ng\" target=\"_blank\" rel=\"noopener\">é¡¹ç›®ä¸»é¡µ</a>ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install proxychains-ng</span><br></pre></td></tr></table></figure></p>\n<p>é…ç½®<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /usr/<span class=\"built_in\">local</span>/etc/proxychains.conf</span><br></pre></td></tr></table></figure></p>\n<p>æ·»åŠ ä»£ç†<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">socks5  127.0.0.1 1080</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ä½¿ç”¨\"><a href=\"#ä½¿ç”¨\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæ•´ä¸ªå‘½ä»¤å®‰è£…å®Œæˆï¼Œç”¨æ³• <code>proxychains4 éœ€è¦æ‰§è¡Œçš„å‘½ä»¤</code>ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ ss çš„ IP äº†ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">proxychains4 curl ip.cn</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ä¼˜åŒ–\"><a href=\"#ä¼˜åŒ–\" class=\"headerlink\" title=\"ä¼˜åŒ–\"></a>ä¼˜åŒ–</h3><p>è¿™ä¸ªå‘½ä»¤å¤ªé•¿äº†ï¼Œæˆ‘æƒ³æ¢ä¸€ä¸ªï¼æˆ‘ä½¿ç”¨çš„æ˜¯ zshï¼Œæ¥ç»™ <code>proxychains4</code> é…ç½®ä¸€ä¸ªåˆ«åå§ï¼:P<br>ç¼–è¾‘ zsh é…ç½®æ–‡ä»¶<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi ~/.zshrc</span><br></pre></td></tr></table></figure></p>\n<p>æ·»åŠ åˆ«å<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">alias</span> myss=<span class=\"string\">'proxychains4'</span></span><br></pre></td></tr></table></figure></p>\n<p>è®©é…ç½®ç”Ÿæ•ˆ<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure></p>\n<p>å†æ‰§è¡Œä¹‹å‰æŸ¥çœ‹ ip çš„å‘½ä»¤<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">myss curl ip.cn</span><br></pre></td></tr></table></figure></p>\n<p>Have done! :)</p>\n<h3 id=\"æµ‹é€Ÿ\"><a href=\"#æµ‹é€Ÿ\" class=\"headerlink\" title=\"æµ‹é€Ÿ\"></a>æµ‹é€Ÿ</h3><p>ä½¿ç”¨ speedtest çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¥æµ‹ä¸Šè¡Œå®½å¸¦å’Œä¸‹è¡Œå®½åº¦ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ä¸‹è½½ speedtest-cli</span></span><br><span class=\"line\">wget -O speedtest-cli https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç»™æ‰§è¡Œæƒé™</span></span><br><span class=\"line\">chmod +x speedtest-cli</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿è¡Œ</span></span><br><span class=\"line\">./speedtest-cli</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•ä¸‹ä»£ç†çš„é€Ÿåº¦</span></span><br><span class=\"line\">myss ./speedtest-cli</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"é™„ï¼šbrew-å¸¸ç”¨å‘½ä»¤\"><a href=\"#é™„ï¼šbrew-å¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"é™„ï¼šbrew å¸¸ç”¨å‘½ä»¤\"></a>é™„ï¼šbrew å¸¸ç”¨å‘½ä»¤</h4><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">å‘½ä»¤</th>\n<th style=\"text-align:left\">å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">å®‰è£…åŒ…</td>\n<td style=\"text-align:left\">brew install <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœç´¢åŒ…</td>\n<td style=\"text-align:left\">brew search <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æŸ¥è¯¢åŒ…ä¿¡æ¯</td>\n<td style=\"text-align:left\">brew info <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">å‡çº§æŒ‡å®šåŒ…</td>\n<td style=\"text-align:left\">brew upgrade <code>&lt;PackageName&gt;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æ›´æ–°è‡ªå·±</td>\n<td style=\"text-align:left\">brew update</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æ£€æŸ¥è¿‡æ—¶åŒ…</td>\n<td style=\"text-align:left\">brew outdated</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">å‡çº§æ‰€æœ‰åŒ…</td>\n<td style=\"text-align:left\">brew upgrade</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æ¸…ç†ç¼“å­˜</td>\n<td style=\"text-align:left\">brew cleanup</td>\n</tr>\n</tbody>\n</table>"},{"title":"Node.JS å­¦ä¹ ç¬”è®° [05] -- Express","date":"2015-01-06T13:24:40.000Z","comments":0,"_content":"\n***Express*** æ˜¯ä¸€ä¸ªåŸºäº Node.js å¹³å°çš„æç®€ã€çµæ´»çš„ Web åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œå®ƒæä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„ç‰¹æ€§ï¼Œå¸®åŠ©ä½ åˆ›å»ºå„ç§ Web å’Œç§»åŠ¨è®¾å¤‡åº”ç”¨ã€‚Expressçš„æ ¸å¿ƒç‰¹æ€§å¯ä»¥æ¦‚æ‹¬ä»¥ä¸‹ä¸‰ç‚¹ã€‚\n<!-- more -->\n\n- å¯ä»¥è®¾ç½®ä¸­é—´ä»¶æ¥å“åº” HTTP è¯·æ±‚ã€‚\n- å®šä¹‰äº†è·¯ç”±è¡¨ç”¨äºæ‰§è¡Œä¸åŒçš„ HTTP è¯·æ±‚åŠ¨ä½œã€‚\n- å¯ä»¥é€šè¿‡å‘æ¨¡æ¿ä¼ é€’å‚æ•°æ¥åŠ¨æ€æ¸²æŸ“ HTML é¡µé¢ã€‚\n\nä¸‹é¢å­¦ä¹ çš„çŸ¥è¯†ç‚¹ï¼Œéƒ½ä¼šå›´ç»•è¿™å‡ ä¸ªç‰¹æ€§å±•å¼€ã€‚\n\n### Express å®‰è£…\n#### åœ¨é¡¹ç›®ä¸­å¼•å…¥ Express\n```bash\ncd projectName              # è¿›å…¥æ–°å»ºçš„ Node.js é¡¹ç›®\nnpm init                    # åˆå§‹åŒ–é¡¹ç›®é…ç½®æ–‡ä»¶\nnpm install express --save  # å®‰è£… Express æ¨¡å—åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­\n```\né€šè¿‡ä¸Šé—¨çš„å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆ Express çš„å®‰è£…ï¼Œä¸‹é¢åœ¨ `app.js` ä¸­ä½¿ç”¨ Express å§ï¼\n```js\nvar express = require('express');\nvar app = express();\n\napp.get('/', function (req, res) {\n    res.send('Hello,Express!');\n});\n\napp.listen(8080, function () {\n    console.log('Express running at http://127.0.0.1:8080/');\n});\n```\n\n#### ä½¿ç”¨ Express-generator\nä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ï¼Œæ›´ä¾¿æ·çš„ä½¿ç”¨ Express ç”Ÿæˆé¡¹ç›®ï¼Œå®˜æ–¹æä¾›çš„å¿«é€Ÿçš„ç”Ÿæˆå·¥å…· `Express-generator`ï¼Œè™½ç„¶ç”Ÿæˆéå¸¸å¿«é€Ÿæ–¹ä¾¿ï¼Œä½†æ˜¯ä½œä¸ºåˆå­¦è€…ï¼Œè¿˜æ˜¯è¦å¼„æ¸…æ¥šé‡Œé¢æ¯æ¡å‘½ä»¤æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œæœ€åå†ä½¿ç”¨å®˜æ–¹æä¾›çš„å·¥å…·å¿«é€Ÿç”Ÿæˆã€‚æ‰“å¼€ç»ˆç«¯ï¼Œå› ä¸ºæˆ‘æ˜¯ MacOSï¼Œæ‰€ä»¥å®‰è£…çš„æ—¶å€™è¦åŠ ä¸Š `sudo` å¦åˆ™ä¼šæŠ¥é”™æç¤ºæƒé™ä¸å¤Ÿã€‚\n```bash\nsudo npm install express-generator -g  # å…¨å±€å®‰è£…\nexpress mywebapp                       # åˆ›å»º mywebapp é¡¹ç›®\ncd mywebapp && npm install             # å®‰è£…ä¾èµ–æ–‡ä»¶\nnpm start                              # å¯åŠ¨é¡¹ç›®\n```\nå¯åŠ¨é¡¹ç›®åï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆäº†ï¼Œè®¿é—®åœ°å€ï¼šhttp://127.0.0.1:3000/ ã€‚\n\n<div class=\"tip\">\nå¯åŠ¨å‰éœ€è¦å…³é—­å…¶å®ƒå·²ç»å¯ç”¨çš„ Web æœåŠ¡ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´ç«¯å£å ç”¨å¯åŠ¨ä¸æˆåŠŸã€‚\n</div>\n\n### Express è·¯ç”±\n> è·¯ç”±æ˜¯æŒ‡å¦‚ä½•å®šä¹‰åº”ç”¨çš„ç«¯ç‚¹ï¼ˆURLsï¼‰ä»¥åŠå¦‚ä½•å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚\n\n#### åŸºç¡€ç”¨æ³•\nç®€å•ç†è§£ï¼Œå…¶å®å°±æ˜¯æ ¹æ®ä¸åŒçš„è¯·æ±‚ï¼Œæ¥å“åº”ä¸ä¹‹å¯¹åº”çš„é¡µé¢ã€‚æ¯”å¦‚ï¼Œå½“ç”¨æˆ·è®¿é—® http://localhost/images/ æ—¶ï¼Œæ ¹æ® URL å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚çš„æ˜¯ `/images` è¿™ä¸ªç›®å½•ï¼Œé‚£ä¹ˆé€šè¿‡è·¯ç”±ï¼Œæ‰¾åˆ°è¿™ä¸ªé¡µé¢å¹¶è¿”å›ç»™è¯·æ±‚çš„ç”¨æˆ·ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«è·¯ç”±ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\nvar express = require('express');\nvar app = express();\n\n// å½“ç”¨æˆ·è¯·æ±‚è®¿é—® / æ—¶ï¼Œå“åº”ä¸€ä¸ª Hello,Express! å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç®€å•è·¯ç”±\napp.get('/', function (req, res) {\n    res.send('Hello,Express!');\n});\n```\nè¿™é‡Œéœ€è¦æ³¨æ„ `app.all()` ,å®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è·¯ç”±æ–¹æ³•ï¼Œæ²¡æœ‰ä»»ä½• HTTP æ–¹æ³•ä¸å…¶å¯¹åº”ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹äºä¸€ä¸ªè·¯å¾„ä¸Šçš„æ‰€æœ‰è¯·æ±‚åŠ è½½ä¸­é—´ä»¶ã€‚ all ç›¸å½“äºæ—¢å¯ä»¥å¤„ç† `GET`ï¼Œä¹Ÿå¯ä»¥å¤„ç† `POST` ã€‚\n\n#### Router æ–¹æ³•\né€šè¿‡ `express.Router` ç±»å¯ä»¥åˆ›å»ºç‹¬ç«‹æ¨¡å—çš„è·¯ç”±æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥æŒ‚è½½çš„è·¯ç”±å¯¹è±¡ï¼ŒæŠŠè·¯ç”±æ¨¡å—åˆ†ç¦»å‡ºé¡¹ç›®ï¼Œè®©æ•´ä¸ªé¡¹ç›®ç»“æ„æ¸…æ™°ã€æ–¹ä¾¿ç®¡ç†ï¼Œè¿™é‡Œå…‰è¯´è¿˜æ˜¯æŒºæŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­ã€‚\n```bash\n# ç›®å½•ç»“æ„\n.\nâ”œâ”€â”€ index.js\nâ”œâ”€â”€ node_modules\nâ”‚Â Â  â”œâ”€â”€ body-parser\nâ”‚Â Â  â””â”€â”€ express\nâ”œâ”€â”€ package.json\nâ”œâ”€â”€ router\nâ”‚Â Â  â”œâ”€â”€ admin.js\nâ”‚Â Â  â””â”€â”€ home.js\nâ””â”€â”€ views\n    â”œâ”€â”€ admin\n    â””â”€â”€ home\n```\n```js\n// index.js\nvar express = require('express');\nvar bodyparser = require('body-parser');\n// å¼•å…¥å¤–éƒ¨è·¯ç”±æ¨¡å—\nvar home = require('./router/home');\nvar admin = require('./router/admin');\nvar app = express();\n\n// ä½¿ç”¨ä¸­é—´ä»¶ bodyparser ï¼Œåé¢å¯ä»¥åœ¨ req.body ä¸­åˆ†æå‡º POST è¯·æ±‚ä½“çš„å†…å®¹\napp.use(bodyparser.urlencoded({extended:false}));\n\n// ä½¿ç”¨å¤–éƒ¨è·¯ç”±æ¨¡å—\napp.use('/',home);\napp.use('/admin',admin);\n\napp.listen(8080,function () {\n   console.log('visit http://127.0.0.1:8080/');\n});\n```\n\n```js\n// admin.js\nvar express = require('express');\nvar router = express.Router();// ç”¨ Router æ„é€ å‡½æ•°å®ä¾‹åŒ– router å¯¹è±¡\nvar path = require('path');\n\nrouter.get('/login.html', function (req, res) {\n    res.sendFile(path.resolve(__dirname + '/../views/admin/' + 'login.html'));\n});\n\nrouter.get('/user.html', function (req, res) {\n    res.sendFile(path.resolve(__dirname + '/../views/admin/' + 'user.html'));\n});\n\nrouter.post('/login.html', function (req, res) {// /admin/login.html\n    res.sendFile(path.resolve(__dirname + '/../views/admin/' + 'login.html'));\n});\n\nmodule.exports = router;// æš´éœ²ç»™å¤–éƒ¨è°ƒç”¨è¯¥è·¯ç”±\n```\n\n### Express å“åº”å¯¹è±¡\né€šè¿‡å“åº”ï¼ˆResponseï¼‰å¯¹è±¡ï¼ŒæœåŠ¡å™¨å¯ä»¥è¿”å›ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ `Request` ,æœ€ç»ˆè¿”å›ç»™ç”¨æˆ·çš„å…¶å®å°±æ˜¯ä¸€ä¸ªç»è¿‡ä¸šåŠ¡é€»è¾‘å±‚å¤„ç†çš„ `res` å¯¹è±¡ã€‚æ¥äº†è§£ä¸‹ Express çš„å“åº”å¯¹è±¡å§ã€‚\n\n#### send()\nExpress å·²ç»å°è£…è¿‡äº†åŸç”Ÿ Node.js çš„å“åº”æ–¹æ³•ï¼Œåœ¨åŸç”Ÿ Node.js ä¸­ï¼Œé€šè¿‡ `res.write()` æ–¹æ³•å¯ä»¥è¿”å›å­—ç¬¦ä¸²å’Œ Bufferã€‚è€Œ Express ä¸­çš„ `send()` å¯ä»¥è¿”å›ä»»æ„æ•°æ®ç±»å‹ï¼Œå¦‚æµã€æ•°æ®ã€æ™®é€šæ–‡æœ¬ç­‰ï¼Œæ¥çœ‹ä¸ªä¾‹å­ã€‚\n```js\nres.send(new Buffer('ifyour')); // Buffer\nres.send({\"name\": \"ifyour\"});   // JSON\nres.send('<p>some html</p>');   // HTML\nres.status(404).send('404 Not Find'); // è®¾ç½®çŠ¶æ€ç å¹¶è¿”å›æç¤º\n//...\n```\n\n#### json()\né€šè¿‡ `json()` æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ª `JSON` å¯¹è±¡ï¼Œç”¨äº Ajax ç­‰ã€‚\n```js\nres.json(null);\nres.json({\"user\": \"ifyour\"});\nres.status(500).json({\"error\": \"message\"});\n```\n\n#### render()\n`render` ç”¨äºæ¸²æŸ“æ¨¡æ¿å¼•æ“ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ [ejs](https://github.com/tj/ejs) æ¨¡æ¿å¼•æ“æ—¶ï¼Œå“åº”ç”¨æˆ·è¯·æ±‚å°±å¯ä»¥ä½¿ç”¨ `res.render()` è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªæ¸²æŸ“å¥½çš„é¡µé¢ã€‚è¿™ä¸ªç”¨çš„æ¯”è¾ƒå¤šï¼Œæˆ‘æ¥ä¸¾ä¸ªä¾‹å­ã€‚\n```bash\n# ç›®å½•ç»“æ„\n.\nâ”œâ”€â”€ index.js\nâ”œâ”€â”€ node_modules\nâ”‚Â Â  â”œâ”€â”€ ejs\nâ”‚Â Â  â””â”€â”€ express\nâ”œâ”€â”€ package.json\nâ””â”€â”€ views\n    â””â”€â”€ login.html\n```\n```html\n<!-- ejs æ¨¡æ¿å¼•æ“ï¼Œå®šä¹‰äº† /login.html -->\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Title</title>\n</head>\n<body>\n<!-- æ³¨æ„ ejs æ¨¡æ¿ä¸­å˜é‡çš„å†™æ³• -->\n<h1>æ¬¢è¿ä½ ï¼Œ<%=name%></h1>\n</body>\n</html>\n```\n```js\n// index.js\nvar express = require('express');\nvar ejs = require('ejs'); // å¼•å…¥ ejs æ¨¡æ¿å¼•æ“\nvar path = require('path');\nvar app = express();\n\nvar viewsPath = path.join(__dirname, 'views');// views æ˜¯æ¨¡æ¿ç›®å½•\n// è®¾ç½® express views å±‚ï¼Œæ¨¡æ¿æ ¹è·¯å¾„\napp.set('views', viewsPath);\n\n// è®¾ç½® express å®ä¾‹çš„æ¨¡æ¿è¯­è¨€\napp.set('view engine', 'html');\n\n// æŠŠ express å®ä¾‹çš„æ¨¡æ¿å¼•æ“å’Œ ejs æ¨¡æ¿å¼•æ“å…³è”\napp.engine('html', ejs.__express);\n\napp.get('/login.html', function (req, res) {\n    res.render('login', {name: \"ifyour\"});// æ›¿æ¢åˆ°æ¨¡æ¿å˜é‡ä¸­çš„ name ä¸º ifyour\n});\n\napp.listen(8080, function () {\n    console.log('visit http://127.0.0.1:8080/');\n});\n```\n<div class=\"tip\">\n`__dirname` æ˜¯ Node.js ä¸­å®šä¹‰çš„ `global` å…¨å±€å˜é‡ï¼Œè·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œè¿”å› `string` ç±»å‹ã€‚\n</div>\n\n#### download()\n```js\nres.download('./123.doc'); // ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ã€‚\nres.download('./123.doc','books.doc'); // ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ï¼Œé‡å‘½åä¸º books.doc\n```\n#### redirect()\n```js\n// é‡å®šå‘åˆ°æŒ‡å®šçš„ URL è·¯å¾„\nres.redirect('/404.html');\nres.redirect('https://www.google.com/');\n```\n\næ›´å¤šå“åº”å¯¹è±¡çš„æ–¹æ³•ï¼Œå‚è€ƒ [Express å®˜æ–¹API](http://www.expressjs.com.cn/4x/api.html#res)ã€‚\n### Express è¯·æ±‚å¯¹è±¡\nExpress ä¸­çš„ `Request` å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€æ¬¡è¯·æ±‚ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ¯”å¦‚è¯·æ±‚å¤´ã€è·¯å¾„ã€Cookies ç­‰ï¼Œè·å–è¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™äº›ä¿¡æ¯å¤„ç†ä¸šåŠ¡é€»è¾‘å±‚ï¼Œæœ€ç»ˆå°†å¤„ç†è¿‡åçš„æ•°æ®è¿”å›ç»™ç”¨æˆ·ã€‚è¿™é‡Œæ€»ç»“äº†å¸¸ç”¨çš„è¯·æ±‚å¯¹è±¡æ–¹æ³•ã€‚\n\n#### URL ä¸­çš„å‚æ•°\n```js\n// æ–¹å¼ä¸€ï¼š req.query.å‚æ•°å\n// e.g.  http://localhost:3000/user?name=ifyour\nconsole.log(req.query.name);\n// => ifyour\n\n// æ–¹å¼äºŒï¼šreq.params.å‚æ•°å\n//e.g.  http://localhost/post/123123\nrouter.get('/post/:id', function (req, res) {\n    console.log(req.params.id);\n    // => 123123\n});\n```\n\n#### è¡¨å•ä¸­çš„å‚æ•°\n```js\n// æ–¹å¼ä¸€ï¼šè¯­æ³•ï¼šreq.param.å‚æ•°å  æ³¨æ„è¿™é‡Œæ²¡åŠ  s\n// e.g. <input type=\"text\" name=\"user\">\nconsole.log(req.param('user'));\n\n\n// æ–¹å¼äºŒï¼šä½¿ç”¨ body-parser ä¸­é—´ä»¶\n// e.g. <input type=\"text\" name=\"user\">\nvar bodyparser = require('body-parser');\nconsole.console.log(req.boy.user);\n```\n\n### Express ä¸­é—´ä»¶\nExpress æ˜¯ä¸€ä¸ªè‡ªèº«åŠŸèƒ½æç®€ï¼Œå®Œå…¨æ˜¯ç”±è·¯ç”±å’Œä¸­é—´ä»¶æ„æˆä¸€ä¸ªçš„ Web å¼€å‘æ¡†æ¶ï¼šä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œä¸€ä¸ª Express åº”ç”¨å°±æ˜¯åœ¨è°ƒç”¨å„ç§ä¸­é—´ä»¶ã€‚\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbcrpk71zxj20sg03kaaa.jpg)\nå¦‚å›¾ï¼Œä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰ä½äºå®¢æˆ·ç«¯å’Œè·¯ç”±ä¹‹é—´ï¼Œå®ƒå¥½æ¯”æ˜¯ä¸€ä¸ªæ¼æ–—ï¼Œç»è¿‡è¿™ä¸ªæ¼æ–—çš„ `Request` å¯¹è±¡å’Œ `Response` å¯¹è±¡ä»¥åŠå¾ªç¯æµç¨‹ä¸­çš„ `Next` ä¼šè¢«å¤„ç†ï¼Œæ¯”å¦‚æ­£ç¡®æ€§æ ¡éªŒã€ä¸šåŠ¡é€»è¾‘å¤„ç†ç­‰ã€‚\n\n- æ‰§è¡Œä»»ä½•ä»£ç \n- ä¿®æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡\n- ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯\n- è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶\n\n<div class=\"tip\">\nå¦‚æœå½“å‰ä¸­é—´ä»¶æ²¡æœ‰ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯ï¼Œåˆ™å¿…é¡»è°ƒç”¨ next() æ–¹æ³•å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¦åˆ™è¯·æ±‚å°±ä¼šæŒ‚èµ·ã€‚\n</div>\nä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚ä½•é€šè¿‡ `next()` æ–¹æ³•æŠŠæ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚\n```js\nvar app = express();\napp.use(function (req, res, next) {\n   var accessToken = req.query.accessToken;\n   //æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦å«æœ‰â€œè®¤è¯ç‰Œâ€ï¼Œå­˜åœ¨å°±ç»§ç»­æ‰§è¡Œã€‚\n   if(accessToken){\n       next(); // æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶\n       }else{\n          res.send(â€œè¯·æ±‚å¿…é¡»åŒ…å«tokenâ€);\n        }\n});\n// ...\n```\n\n#### åº”ç”¨çº§ä¸­é—´ä»¶\nåº”ç”¨çº§ä¸­é—´ä»¶å°±æ˜¯ç»‘å®šåˆ°ç”¨ `express()` ç”Ÿæˆçš„å¯¹è±¡ `app` èº«ä¸Šçš„ï¼Œæ¯”å¦‚ `app.use()` ä¸­çš„ `use` æ–¹æ³•ï¼Œä»¥åŠ `app.post()` ã€`app.get()` ä¸­çš„ `POST` å’Œ `GET` æ–¹æ³•ç­‰ã€‚\n#### å†…ç½®ä¸­é—´ä»¶\n```js\n// è®¾ç½®å…¬å…±é™æ€ç›®å½•ï¼Œç”¨äºå­˜æ”¾ css js image ç­‰æ–‡ä»¶ï¼Œé¡¹ç›®ç›®å½•é‡Œæœ‰ images ç›®å½•å­˜æ”¾ 1.png\n// é‚£ä¹ˆè®¿é—®ï¼šhttp://localhost/images/1.png è·å–\napp.use(express.static('public'));\n```\n#### ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\nä¸­é—´ä»¶å¯ä»¥è¯´æ˜¯æ•´ä¸ª Express çš„ç²¾åæ‰€åœ¨äº†ï¼Œä½¿ç”¨ä¸­é—´ä»¶å¯ä»¥å‡ å¤§çš„æ‰©å±•é¡¹ç›®çš„åŠŸèƒ½ã€‚ä½¿ç”¨æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œè¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„ï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼éœ€è¦çœ‹å®˜æ–¹çš„æ–‡æ¡£äº†ã€‚\n- è§£æå®¢æˆ·ç«¯è¯·æ±‚çš„ body ä¸­çš„å†…å®¹ï¼šbody-parser\n- cookie è§£æä¸­é—´ä»¶ï¼šcookie-parser\n- æ–‡ä»¶ä¸Šä¼ ä¸­é—´ä»¶ï¼šmulter\n\nä½¿ç”¨å‘½ä»¤ `npm i åŒ…åç§° --save` å®‰è£…åˆ°é¡¹ç›®ä¸­ï¼Œç„¶åå¼•å…¥é¡¹ç›®ä½¿ç”¨å³å¯ã€‚\n","source":"_posts/Node.JS-å­¦ä¹ ç¬”è®°-[05]----Express.md","raw":"---\ntitle: 'Node.JS å­¦ä¹ ç¬”è®° [05] -- Express'\ndate: 2015-01-06 21:24:40\ntags:\ncomments: false\n---\n\n***Express*** æ˜¯ä¸€ä¸ªåŸºäº Node.js å¹³å°çš„æç®€ã€çµæ´»çš„ Web åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œå®ƒæä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„ç‰¹æ€§ï¼Œå¸®åŠ©ä½ åˆ›å»ºå„ç§ Web å’Œç§»åŠ¨è®¾å¤‡åº”ç”¨ã€‚Expressçš„æ ¸å¿ƒç‰¹æ€§å¯ä»¥æ¦‚æ‹¬ä»¥ä¸‹ä¸‰ç‚¹ã€‚\n<!-- more -->\n\n- å¯ä»¥è®¾ç½®ä¸­é—´ä»¶æ¥å“åº” HTTP è¯·æ±‚ã€‚\n- å®šä¹‰äº†è·¯ç”±è¡¨ç”¨äºæ‰§è¡Œä¸åŒçš„ HTTP è¯·æ±‚åŠ¨ä½œã€‚\n- å¯ä»¥é€šè¿‡å‘æ¨¡æ¿ä¼ é€’å‚æ•°æ¥åŠ¨æ€æ¸²æŸ“ HTML é¡µé¢ã€‚\n\nä¸‹é¢å­¦ä¹ çš„çŸ¥è¯†ç‚¹ï¼Œéƒ½ä¼šå›´ç»•è¿™å‡ ä¸ªç‰¹æ€§å±•å¼€ã€‚\n\n### Express å®‰è£…\n#### åœ¨é¡¹ç›®ä¸­å¼•å…¥ Express\n```bash\ncd projectName              # è¿›å…¥æ–°å»ºçš„ Node.js é¡¹ç›®\nnpm init                    # åˆå§‹åŒ–é¡¹ç›®é…ç½®æ–‡ä»¶\nnpm install express --save  # å®‰è£… Express æ¨¡å—åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­\n```\né€šè¿‡ä¸Šé—¨çš„å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆ Express çš„å®‰è£…ï¼Œä¸‹é¢åœ¨ `app.js` ä¸­ä½¿ç”¨ Express å§ï¼\n```js\nvar express = require('express');\nvar app = express();\n\napp.get('/', function (req, res) {\n    res.send('Hello,Express!');\n});\n\napp.listen(8080, function () {\n    console.log('Express running at http://127.0.0.1:8080/');\n});\n```\n\n#### ä½¿ç”¨ Express-generator\nä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ï¼Œæ›´ä¾¿æ·çš„ä½¿ç”¨ Express ç”Ÿæˆé¡¹ç›®ï¼Œå®˜æ–¹æä¾›çš„å¿«é€Ÿçš„ç”Ÿæˆå·¥å…· `Express-generator`ï¼Œè™½ç„¶ç”Ÿæˆéå¸¸å¿«é€Ÿæ–¹ä¾¿ï¼Œä½†æ˜¯ä½œä¸ºåˆå­¦è€…ï¼Œè¿˜æ˜¯è¦å¼„æ¸…æ¥šé‡Œé¢æ¯æ¡å‘½ä»¤æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œæœ€åå†ä½¿ç”¨å®˜æ–¹æä¾›çš„å·¥å…·å¿«é€Ÿç”Ÿæˆã€‚æ‰“å¼€ç»ˆç«¯ï¼Œå› ä¸ºæˆ‘æ˜¯ MacOSï¼Œæ‰€ä»¥å®‰è£…çš„æ—¶å€™è¦åŠ ä¸Š `sudo` å¦åˆ™ä¼šæŠ¥é”™æç¤ºæƒé™ä¸å¤Ÿã€‚\n```bash\nsudo npm install express-generator -g  # å…¨å±€å®‰è£…\nexpress mywebapp                       # åˆ›å»º mywebapp é¡¹ç›®\ncd mywebapp && npm install             # å®‰è£…ä¾èµ–æ–‡ä»¶\nnpm start                              # å¯åŠ¨é¡¹ç›®\n```\nå¯åŠ¨é¡¹ç›®åï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆäº†ï¼Œè®¿é—®åœ°å€ï¼šhttp://127.0.0.1:3000/ ã€‚\n\n<div class=\"tip\">\nå¯åŠ¨å‰éœ€è¦å…³é—­å…¶å®ƒå·²ç»å¯ç”¨çš„ Web æœåŠ¡ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´ç«¯å£å ç”¨å¯åŠ¨ä¸æˆåŠŸã€‚\n</div>\n\n### Express è·¯ç”±\n> è·¯ç”±æ˜¯æŒ‡å¦‚ä½•å®šä¹‰åº”ç”¨çš„ç«¯ç‚¹ï¼ˆURLsï¼‰ä»¥åŠå¦‚ä½•å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚\n\n#### åŸºç¡€ç”¨æ³•\nç®€å•ç†è§£ï¼Œå…¶å®å°±æ˜¯æ ¹æ®ä¸åŒçš„è¯·æ±‚ï¼Œæ¥å“åº”ä¸ä¹‹å¯¹åº”çš„é¡µé¢ã€‚æ¯”å¦‚ï¼Œå½“ç”¨æˆ·è®¿é—® http://localhost/images/ æ—¶ï¼Œæ ¹æ® URL å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚çš„æ˜¯ `/images` è¿™ä¸ªç›®å½•ï¼Œé‚£ä¹ˆé€šè¿‡è·¯ç”±ï¼Œæ‰¾åˆ°è¿™ä¸ªé¡µé¢å¹¶è¿”å›ç»™è¯·æ±‚çš„ç”¨æˆ·ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«è·¯ç”±ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\nvar express = require('express');\nvar app = express();\n\n// å½“ç”¨æˆ·è¯·æ±‚è®¿é—® / æ—¶ï¼Œå“åº”ä¸€ä¸ª Hello,Express! å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç®€å•è·¯ç”±\napp.get('/', function (req, res) {\n    res.send('Hello,Express!');\n});\n```\nè¿™é‡Œéœ€è¦æ³¨æ„ `app.all()` ,å®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è·¯ç”±æ–¹æ³•ï¼Œæ²¡æœ‰ä»»ä½• HTTP æ–¹æ³•ä¸å…¶å¯¹åº”ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹äºä¸€ä¸ªè·¯å¾„ä¸Šçš„æ‰€æœ‰è¯·æ±‚åŠ è½½ä¸­é—´ä»¶ã€‚ all ç›¸å½“äºæ—¢å¯ä»¥å¤„ç† `GET`ï¼Œä¹Ÿå¯ä»¥å¤„ç† `POST` ã€‚\n\n#### Router æ–¹æ³•\né€šè¿‡ `express.Router` ç±»å¯ä»¥åˆ›å»ºç‹¬ç«‹æ¨¡å—çš„è·¯ç”±æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥æŒ‚è½½çš„è·¯ç”±å¯¹è±¡ï¼ŒæŠŠè·¯ç”±æ¨¡å—åˆ†ç¦»å‡ºé¡¹ç›®ï¼Œè®©æ•´ä¸ªé¡¹ç›®ç»“æ„æ¸…æ™°ã€æ–¹ä¾¿ç®¡ç†ï¼Œè¿™é‡Œå…‰è¯´è¿˜æ˜¯æŒºæŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­ã€‚\n```bash\n# ç›®å½•ç»“æ„\n.\nâ”œâ”€â”€ index.js\nâ”œâ”€â”€ node_modules\nâ”‚Â Â  â”œâ”€â”€ body-parser\nâ”‚Â Â  â””â”€â”€ express\nâ”œâ”€â”€ package.json\nâ”œâ”€â”€ router\nâ”‚Â Â  â”œâ”€â”€ admin.js\nâ”‚Â Â  â””â”€â”€ home.js\nâ””â”€â”€ views\n    â”œâ”€â”€ admin\n    â””â”€â”€ home\n```\n```js\n// index.js\nvar express = require('express');\nvar bodyparser = require('body-parser');\n// å¼•å…¥å¤–éƒ¨è·¯ç”±æ¨¡å—\nvar home = require('./router/home');\nvar admin = require('./router/admin');\nvar app = express();\n\n// ä½¿ç”¨ä¸­é—´ä»¶ bodyparser ï¼Œåé¢å¯ä»¥åœ¨ req.body ä¸­åˆ†æå‡º POST è¯·æ±‚ä½“çš„å†…å®¹\napp.use(bodyparser.urlencoded({extended:false}));\n\n// ä½¿ç”¨å¤–éƒ¨è·¯ç”±æ¨¡å—\napp.use('/',home);\napp.use('/admin',admin);\n\napp.listen(8080,function () {\n   console.log('visit http://127.0.0.1:8080/');\n});\n```\n\n```js\n// admin.js\nvar express = require('express');\nvar router = express.Router();// ç”¨ Router æ„é€ å‡½æ•°å®ä¾‹åŒ– router å¯¹è±¡\nvar path = require('path');\n\nrouter.get('/login.html', function (req, res) {\n    res.sendFile(path.resolve(__dirname + '/../views/admin/' + 'login.html'));\n});\n\nrouter.get('/user.html', function (req, res) {\n    res.sendFile(path.resolve(__dirname + '/../views/admin/' + 'user.html'));\n});\n\nrouter.post('/login.html', function (req, res) {// /admin/login.html\n    res.sendFile(path.resolve(__dirname + '/../views/admin/' + 'login.html'));\n});\n\nmodule.exports = router;// æš´éœ²ç»™å¤–éƒ¨è°ƒç”¨è¯¥è·¯ç”±\n```\n\n### Express å“åº”å¯¹è±¡\né€šè¿‡å“åº”ï¼ˆResponseï¼‰å¯¹è±¡ï¼ŒæœåŠ¡å™¨å¯ä»¥è¿”å›ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ `Request` ,æœ€ç»ˆè¿”å›ç»™ç”¨æˆ·çš„å…¶å®å°±æ˜¯ä¸€ä¸ªç»è¿‡ä¸šåŠ¡é€»è¾‘å±‚å¤„ç†çš„ `res` å¯¹è±¡ã€‚æ¥äº†è§£ä¸‹ Express çš„å“åº”å¯¹è±¡å§ã€‚\n\n#### send()\nExpress å·²ç»å°è£…è¿‡äº†åŸç”Ÿ Node.js çš„å“åº”æ–¹æ³•ï¼Œåœ¨åŸç”Ÿ Node.js ä¸­ï¼Œé€šè¿‡ `res.write()` æ–¹æ³•å¯ä»¥è¿”å›å­—ç¬¦ä¸²å’Œ Bufferã€‚è€Œ Express ä¸­çš„ `send()` å¯ä»¥è¿”å›ä»»æ„æ•°æ®ç±»å‹ï¼Œå¦‚æµã€æ•°æ®ã€æ™®é€šæ–‡æœ¬ç­‰ï¼Œæ¥çœ‹ä¸ªä¾‹å­ã€‚\n```js\nres.send(new Buffer('ifyour')); // Buffer\nres.send({\"name\": \"ifyour\"});   // JSON\nres.send('<p>some html</p>');   // HTML\nres.status(404).send('404 Not Find'); // è®¾ç½®çŠ¶æ€ç å¹¶è¿”å›æç¤º\n//...\n```\n\n#### json()\né€šè¿‡ `json()` æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ª `JSON` å¯¹è±¡ï¼Œç”¨äº Ajax ç­‰ã€‚\n```js\nres.json(null);\nres.json({\"user\": \"ifyour\"});\nres.status(500).json({\"error\": \"message\"});\n```\n\n#### render()\n`render` ç”¨äºæ¸²æŸ“æ¨¡æ¿å¼•æ“ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ [ejs](https://github.com/tj/ejs) æ¨¡æ¿å¼•æ“æ—¶ï¼Œå“åº”ç”¨æˆ·è¯·æ±‚å°±å¯ä»¥ä½¿ç”¨ `res.render()` è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªæ¸²æŸ“å¥½çš„é¡µé¢ã€‚è¿™ä¸ªç”¨çš„æ¯”è¾ƒå¤šï¼Œæˆ‘æ¥ä¸¾ä¸ªä¾‹å­ã€‚\n```bash\n# ç›®å½•ç»“æ„\n.\nâ”œâ”€â”€ index.js\nâ”œâ”€â”€ node_modules\nâ”‚Â Â  â”œâ”€â”€ ejs\nâ”‚Â Â  â””â”€â”€ express\nâ”œâ”€â”€ package.json\nâ””â”€â”€ views\n    â””â”€â”€ login.html\n```\n```html\n<!-- ejs æ¨¡æ¿å¼•æ“ï¼Œå®šä¹‰äº† /login.html -->\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Title</title>\n</head>\n<body>\n<!-- æ³¨æ„ ejs æ¨¡æ¿ä¸­å˜é‡çš„å†™æ³• -->\n<h1>æ¬¢è¿ä½ ï¼Œ<%=name%></h1>\n</body>\n</html>\n```\n```js\n// index.js\nvar express = require('express');\nvar ejs = require('ejs'); // å¼•å…¥ ejs æ¨¡æ¿å¼•æ“\nvar path = require('path');\nvar app = express();\n\nvar viewsPath = path.join(__dirname, 'views');// views æ˜¯æ¨¡æ¿ç›®å½•\n// è®¾ç½® express views å±‚ï¼Œæ¨¡æ¿æ ¹è·¯å¾„\napp.set('views', viewsPath);\n\n// è®¾ç½® express å®ä¾‹çš„æ¨¡æ¿è¯­è¨€\napp.set('view engine', 'html');\n\n// æŠŠ express å®ä¾‹çš„æ¨¡æ¿å¼•æ“å’Œ ejs æ¨¡æ¿å¼•æ“å…³è”\napp.engine('html', ejs.__express);\n\napp.get('/login.html', function (req, res) {\n    res.render('login', {name: \"ifyour\"});// æ›¿æ¢åˆ°æ¨¡æ¿å˜é‡ä¸­çš„ name ä¸º ifyour\n});\n\napp.listen(8080, function () {\n    console.log('visit http://127.0.0.1:8080/');\n});\n```\n<div class=\"tip\">\n`__dirname` æ˜¯ Node.js ä¸­å®šä¹‰çš„ `global` å…¨å±€å˜é‡ï¼Œè·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œè¿”å› `string` ç±»å‹ã€‚\n</div>\n\n#### download()\n```js\nres.download('./123.doc'); // ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ã€‚\nres.download('./123.doc','books.doc'); // ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ï¼Œé‡å‘½åä¸º books.doc\n```\n#### redirect()\n```js\n// é‡å®šå‘åˆ°æŒ‡å®šçš„ URL è·¯å¾„\nres.redirect('/404.html');\nres.redirect('https://www.google.com/');\n```\n\næ›´å¤šå“åº”å¯¹è±¡çš„æ–¹æ³•ï¼Œå‚è€ƒ [Express å®˜æ–¹API](http://www.expressjs.com.cn/4x/api.html#res)ã€‚\n### Express è¯·æ±‚å¯¹è±¡\nExpress ä¸­çš„ `Request` å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€æ¬¡è¯·æ±‚ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ¯”å¦‚è¯·æ±‚å¤´ã€è·¯å¾„ã€Cookies ç­‰ï¼Œè·å–è¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™äº›ä¿¡æ¯å¤„ç†ä¸šåŠ¡é€»è¾‘å±‚ï¼Œæœ€ç»ˆå°†å¤„ç†è¿‡åçš„æ•°æ®è¿”å›ç»™ç”¨æˆ·ã€‚è¿™é‡Œæ€»ç»“äº†å¸¸ç”¨çš„è¯·æ±‚å¯¹è±¡æ–¹æ³•ã€‚\n\n#### URL ä¸­çš„å‚æ•°\n```js\n// æ–¹å¼ä¸€ï¼š req.query.å‚æ•°å\n// e.g.  http://localhost:3000/user?name=ifyour\nconsole.log(req.query.name);\n// => ifyour\n\n// æ–¹å¼äºŒï¼šreq.params.å‚æ•°å\n//e.g.  http://localhost/post/123123\nrouter.get('/post/:id', function (req, res) {\n    console.log(req.params.id);\n    // => 123123\n});\n```\n\n#### è¡¨å•ä¸­çš„å‚æ•°\n```js\n// æ–¹å¼ä¸€ï¼šè¯­æ³•ï¼šreq.param.å‚æ•°å  æ³¨æ„è¿™é‡Œæ²¡åŠ  s\n// e.g. <input type=\"text\" name=\"user\">\nconsole.log(req.param('user'));\n\n\n// æ–¹å¼äºŒï¼šä½¿ç”¨ body-parser ä¸­é—´ä»¶\n// e.g. <input type=\"text\" name=\"user\">\nvar bodyparser = require('body-parser');\nconsole.console.log(req.boy.user);\n```\n\n### Express ä¸­é—´ä»¶\nExpress æ˜¯ä¸€ä¸ªè‡ªèº«åŠŸèƒ½æç®€ï¼Œå®Œå…¨æ˜¯ç”±è·¯ç”±å’Œä¸­é—´ä»¶æ„æˆä¸€ä¸ªçš„ Web å¼€å‘æ¡†æ¶ï¼šä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œä¸€ä¸ª Express åº”ç”¨å°±æ˜¯åœ¨è°ƒç”¨å„ç§ä¸­é—´ä»¶ã€‚\n![](http://ww3.sinaimg.cn/large/6057861cgw1fbcrpk71zxj20sg03kaaa.jpg)\nå¦‚å›¾ï¼Œä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰ä½äºå®¢æˆ·ç«¯å’Œè·¯ç”±ä¹‹é—´ï¼Œå®ƒå¥½æ¯”æ˜¯ä¸€ä¸ªæ¼æ–—ï¼Œç»è¿‡è¿™ä¸ªæ¼æ–—çš„ `Request` å¯¹è±¡å’Œ `Response` å¯¹è±¡ä»¥åŠå¾ªç¯æµç¨‹ä¸­çš„ `Next` ä¼šè¢«å¤„ç†ï¼Œæ¯”å¦‚æ­£ç¡®æ€§æ ¡éªŒã€ä¸šåŠ¡é€»è¾‘å¤„ç†ç­‰ã€‚\n\n- æ‰§è¡Œä»»ä½•ä»£ç \n- ä¿®æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡\n- ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯\n- è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶\n\n<div class=\"tip\">\nå¦‚æœå½“å‰ä¸­é—´ä»¶æ²¡æœ‰ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯ï¼Œåˆ™å¿…é¡»è°ƒç”¨ next() æ–¹æ³•å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¦åˆ™è¯·æ±‚å°±ä¼šæŒ‚èµ·ã€‚\n</div>\nä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚ä½•é€šè¿‡ `next()` æ–¹æ³•æŠŠæ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚\n```js\nvar app = express();\napp.use(function (req, res, next) {\n   var accessToken = req.query.accessToken;\n   //æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦å«æœ‰â€œè®¤è¯ç‰Œâ€ï¼Œå­˜åœ¨å°±ç»§ç»­æ‰§è¡Œã€‚\n   if(accessToken){\n       next(); // æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶\n       }else{\n          res.send(â€œè¯·æ±‚å¿…é¡»åŒ…å«tokenâ€);\n        }\n});\n// ...\n```\n\n#### åº”ç”¨çº§ä¸­é—´ä»¶\nåº”ç”¨çº§ä¸­é—´ä»¶å°±æ˜¯ç»‘å®šåˆ°ç”¨ `express()` ç”Ÿæˆçš„å¯¹è±¡ `app` èº«ä¸Šçš„ï¼Œæ¯”å¦‚ `app.use()` ä¸­çš„ `use` æ–¹æ³•ï¼Œä»¥åŠ `app.post()` ã€`app.get()` ä¸­çš„ `POST` å’Œ `GET` æ–¹æ³•ç­‰ã€‚\n#### å†…ç½®ä¸­é—´ä»¶\n```js\n// è®¾ç½®å…¬å…±é™æ€ç›®å½•ï¼Œç”¨äºå­˜æ”¾ css js image ç­‰æ–‡ä»¶ï¼Œé¡¹ç›®ç›®å½•é‡Œæœ‰ images ç›®å½•å­˜æ”¾ 1.png\n// é‚£ä¹ˆè®¿é—®ï¼šhttp://localhost/images/1.png è·å–\napp.use(express.static('public'));\n```\n#### ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\nä¸­é—´ä»¶å¯ä»¥è¯´æ˜¯æ•´ä¸ª Express çš„ç²¾åæ‰€åœ¨äº†ï¼Œä½¿ç”¨ä¸­é—´ä»¶å¯ä»¥å‡ å¤§çš„æ‰©å±•é¡¹ç›®çš„åŠŸèƒ½ã€‚ä½¿ç”¨æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œè¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„ï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼éœ€è¦çœ‹å®˜æ–¹çš„æ–‡æ¡£äº†ã€‚\n- è§£æå®¢æˆ·ç«¯è¯·æ±‚çš„ body ä¸­çš„å†…å®¹ï¼šbody-parser\n- cookie è§£æä¸­é—´ä»¶ï¼šcookie-parser\n- æ–‡ä»¶ä¸Šä¼ ä¸­é—´ä»¶ï¼šmulter\n\nä½¿ç”¨å‘½ä»¤ `npm i åŒ…åç§° --save` å®‰è£…åˆ°é¡¹ç›®ä¸­ï¼Œç„¶åå¼•å…¥é¡¹ç›®ä½¿ç”¨å³å¯ã€‚\n","slug":"Node.JS-å­¦ä¹ ç¬”è®°-[05]----Express","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidiz000fu4q9c5kjfze9","content":"<p><strong><em>Express</em></strong> æ˜¯ä¸€ä¸ªåŸºäº Node.js å¹³å°çš„æç®€ã€çµæ´»çš„ Web åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œå®ƒæä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„ç‰¹æ€§ï¼Œå¸®åŠ©ä½ åˆ›å»ºå„ç§ Web å’Œç§»åŠ¨è®¾å¤‡åº”ç”¨ã€‚Expressçš„æ ¸å¿ƒç‰¹æ€§å¯ä»¥æ¦‚æ‹¬ä»¥ä¸‹ä¸‰ç‚¹ã€‚<br><a id=\"more\"></a></p>\n<ul>\n<li>å¯ä»¥è®¾ç½®ä¸­é—´ä»¶æ¥å“åº” HTTP è¯·æ±‚ã€‚</li>\n<li>å®šä¹‰äº†è·¯ç”±è¡¨ç”¨äºæ‰§è¡Œä¸åŒçš„ HTTP è¯·æ±‚åŠ¨ä½œã€‚</li>\n<li>å¯ä»¥é€šè¿‡å‘æ¨¡æ¿ä¼ é€’å‚æ•°æ¥åŠ¨æ€æ¸²æŸ“ HTML é¡µé¢ã€‚</li>\n</ul>\n<p>ä¸‹é¢å­¦ä¹ çš„çŸ¥è¯†ç‚¹ï¼Œéƒ½ä¼šå›´ç»•è¿™å‡ ä¸ªç‰¹æ€§å±•å¼€ã€‚</p>\n<h3 id=\"Express-å®‰è£…\"><a href=\"#Express-å®‰è£…\" class=\"headerlink\" title=\"Express å®‰è£…\"></a>Express å®‰è£…</h3><h4 id=\"åœ¨é¡¹ç›®ä¸­å¼•å…¥-Express\"><a href=\"#åœ¨é¡¹ç›®ä¸­å¼•å…¥-Express\" class=\"headerlink\" title=\"åœ¨é¡¹ç›®ä¸­å¼•å…¥ Express\"></a>åœ¨é¡¹ç›®ä¸­å¼•å…¥ Express</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> projectName              <span class=\"comment\"># è¿›å…¥æ–°å»ºçš„ Node.js é¡¹ç›®</span></span><br><span class=\"line\">npm init                    <span class=\"comment\"># åˆå§‹åŒ–é¡¹ç›®é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">npm install express --save  <span class=\"comment\"># å®‰è£… Express æ¨¡å—åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­</span></span><br></pre></td></tr></table></figure>\n<p>é€šè¿‡ä¸Šé—¨çš„å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆ Express çš„å®‰è£…ï¼Œä¸‹é¢åœ¨ <code>app.js</code> ä¸­ä½¿ç”¨ Express å§ï¼<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.send(<span class=\"string\">'Hello,Express!'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Express running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"ä½¿ç”¨-Express-generator\"><a href=\"#ä½¿ç”¨-Express-generator\" class=\"headerlink\" title=\"ä½¿ç”¨ Express-generator\"></a>ä½¿ç”¨ Express-generator</h4><p>ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ï¼Œæ›´ä¾¿æ·çš„ä½¿ç”¨ Express ç”Ÿæˆé¡¹ç›®ï¼Œå®˜æ–¹æä¾›çš„å¿«é€Ÿçš„ç”Ÿæˆå·¥å…· <code>Express-generator</code>ï¼Œè™½ç„¶ç”Ÿæˆéå¸¸å¿«é€Ÿæ–¹ä¾¿ï¼Œä½†æ˜¯ä½œä¸ºåˆå­¦è€…ï¼Œè¿˜æ˜¯è¦å¼„æ¸…æ¥šé‡Œé¢æ¯æ¡å‘½ä»¤æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œæœ€åå†ä½¿ç”¨å®˜æ–¹æä¾›çš„å·¥å…·å¿«é€Ÿç”Ÿæˆã€‚æ‰“å¼€ç»ˆç«¯ï¼Œå› ä¸ºæˆ‘æ˜¯ MacOSï¼Œæ‰€ä»¥å®‰è£…çš„æ—¶å€™è¦åŠ ä¸Š <code>sudo</code> å¦åˆ™ä¼šæŠ¥é”™æç¤ºæƒé™ä¸å¤Ÿã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm install express-generator -g  <span class=\"comment\"># å…¨å±€å®‰è£…</span></span><br><span class=\"line\">express mywebapp                       <span class=\"comment\"># åˆ›å»º mywebapp é¡¹ç›®</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> mywebapp &amp;&amp; npm install             <span class=\"comment\"># å®‰è£…ä¾èµ–æ–‡ä»¶</span></span><br><span class=\"line\">npm start                              <span class=\"comment\"># å¯åŠ¨é¡¹ç›®</span></span><br></pre></td></tr></table></figure></p>\n<p>å¯åŠ¨é¡¹ç›®åï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆäº†ï¼Œè®¿é—®åœ°å€ï¼š<a href=\"http://127.0.0.1:3000/\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:3000/</a> ã€‚</p>\n<div class=\"tip\"><br>å¯åŠ¨å‰éœ€è¦å…³é—­å…¶å®ƒå·²ç»å¯ç”¨çš„ Web æœåŠ¡ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´ç«¯å£å ç”¨å¯åŠ¨ä¸æˆåŠŸã€‚<br></div>\n\n<h3 id=\"Express-è·¯ç”±\"><a href=\"#Express-è·¯ç”±\" class=\"headerlink\" title=\"Express è·¯ç”±\"></a>Express è·¯ç”±</h3><blockquote>\n<p>è·¯ç”±æ˜¯æŒ‡å¦‚ä½•å®šä¹‰åº”ç”¨çš„ç«¯ç‚¹ï¼ˆURLsï¼‰ä»¥åŠå¦‚ä½•å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p>\n</blockquote>\n<h4 id=\"åŸºç¡€ç”¨æ³•\"><a href=\"#åŸºç¡€ç”¨æ³•\" class=\"headerlink\" title=\"åŸºç¡€ç”¨æ³•\"></a>åŸºç¡€ç”¨æ³•</h4><p>ç®€å•ç†è§£ï¼Œå…¶å®å°±æ˜¯æ ¹æ®ä¸åŒçš„è¯·æ±‚ï¼Œæ¥å“åº”ä¸ä¹‹å¯¹åº”çš„é¡µé¢ã€‚æ¯”å¦‚ï¼Œå½“ç”¨æˆ·è®¿é—® <a href=\"http://localhost/images/\" target=\"_blank\" rel=\"noopener\">http://localhost/images/</a> æ—¶ï¼Œæ ¹æ® URL å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚çš„æ˜¯ <code>/images</code> è¿™ä¸ªç›®å½•ï¼Œé‚£ä¹ˆé€šè¿‡è·¯ç”±ï¼Œæ‰¾åˆ°è¿™ä¸ªé¡µé¢å¹¶è¿”å›ç»™è¯·æ±‚çš„ç”¨æˆ·ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«è·¯ç”±ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å½“ç”¨æˆ·è¯·æ±‚è®¿é—® / æ—¶ï¼Œå“åº”ä¸€ä¸ª Hello,Express! å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç®€å•è·¯ç”±</span></span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.send(<span class=\"string\">'Hello,Express!'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„ <code>app.all()</code> ,å®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è·¯ç”±æ–¹æ³•ï¼Œæ²¡æœ‰ä»»ä½• HTTP æ–¹æ³•ä¸å…¶å¯¹åº”ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹äºä¸€ä¸ªè·¯å¾„ä¸Šçš„æ‰€æœ‰è¯·æ±‚åŠ è½½ä¸­é—´ä»¶ã€‚ all ç›¸å½“äºæ—¢å¯ä»¥å¤„ç† <code>GET</code>ï¼Œä¹Ÿå¯ä»¥å¤„ç† <code>POST</code> ã€‚</p>\n<h4 id=\"Router-æ–¹æ³•\"><a href=\"#Router-æ–¹æ³•\" class=\"headerlink\" title=\"Router æ–¹æ³•\"></a>Router æ–¹æ³•</h4><p>é€šè¿‡ <code>express.Router</code> ç±»å¯ä»¥åˆ›å»ºç‹¬ç«‹æ¨¡å—çš„è·¯ç”±æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥æŒ‚è½½çš„è·¯ç”±å¯¹è±¡ï¼ŒæŠŠè·¯ç”±æ¨¡å—åˆ†ç¦»å‡ºé¡¹ç›®ï¼Œè®©æ•´ä¸ªé¡¹ç›®ç»“æ„æ¸…æ™°ã€æ–¹ä¾¿ç®¡ç†ï¼Œè¿™é‡Œå…‰è¯´è¿˜æ˜¯æŒºæŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç›®å½•ç»“æ„</span></span><br><span class=\"line\">.</span><br><span class=\"line\">â”œâ”€â”€ index.js</span><br><span class=\"line\">â”œâ”€â”€ node_modules</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ body-parser</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ express</span><br><span class=\"line\">â”œâ”€â”€ package.json</span><br><span class=\"line\">â”œâ”€â”€ router</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ admin.js</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ home.js</span><br><span class=\"line\">â””â”€â”€ views</span><br><span class=\"line\">    â”œâ”€â”€ admin</span><br><span class=\"line\">    â””â”€â”€ home</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> bodyparser = <span class=\"built_in\">require</span>(<span class=\"string\">'body-parser'</span>);</span><br><span class=\"line\"><span class=\"comment\">// å¼•å…¥å¤–éƒ¨è·¯ç”±æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> home = <span class=\"built_in\">require</span>(<span class=\"string\">'./router/home'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> admin = <span class=\"built_in\">require</span>(<span class=\"string\">'./router/admin'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨ä¸­é—´ä»¶ bodyparser ï¼Œåé¢å¯ä»¥åœ¨ req.body ä¸­åˆ†æå‡º POST è¯·æ±‚ä½“çš„å†…å®¹</span></span><br><span class=\"line\">app.use(bodyparser.urlencoded(&#123;<span class=\"attr\">extended</span>:<span class=\"literal\">false</span>&#125;));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨å¤–éƒ¨è·¯ç”±æ¨¡å—</span></span><br><span class=\"line\">app.use(<span class=\"string\">'/'</span>,home);</span><br><span class=\"line\">app.use(<span class=\"string\">'/admin'</span>,admin);</span><br><span class=\"line\"></span><br><span class=\"line\">app.listen(<span class=\"number\">8080</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(<span class=\"string\">'visit http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// admin.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> router = express.Router();<span class=\"comment\">// ç”¨ Router æ„é€ å‡½æ•°å®ä¾‹åŒ– router å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">router.get(<span class=\"string\">'/login.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.sendFile(path.resolve(__dirname + <span class=\"string\">'/../views/admin/'</span> + <span class=\"string\">'login.html'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">router.get(<span class=\"string\">'/user.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.sendFile(path.resolve(__dirname + <span class=\"string\">'/../views/admin/'</span> + <span class=\"string\">'user.html'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">router.post(<span class=\"string\">'/login.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;<span class=\"comment\">// /admin/login.html</span></span><br><span class=\"line\">    res.sendFile(path.resolve(__dirname + <span class=\"string\">'/../views/admin/'</span> + <span class=\"string\">'login.html'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = router;<span class=\"comment\">// æš´éœ²ç»™å¤–éƒ¨è°ƒç”¨è¯¥è·¯ç”±</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Express-å“åº”å¯¹è±¡\"><a href=\"#Express-å“åº”å¯¹è±¡\" class=\"headerlink\" title=\"Express å“åº”å¯¹è±¡\"></a>Express å“åº”å¯¹è±¡</h3><p>é€šè¿‡å“åº”ï¼ˆResponseï¼‰å¯¹è±¡ï¼ŒæœåŠ¡å™¨å¯ä»¥è¿”å›ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ <code>Request</code> ,æœ€ç»ˆè¿”å›ç»™ç”¨æˆ·çš„å…¶å®å°±æ˜¯ä¸€ä¸ªç»è¿‡ä¸šåŠ¡é€»è¾‘å±‚å¤„ç†çš„ <code>res</code> å¯¹è±¡ã€‚æ¥äº†è§£ä¸‹ Express çš„å“åº”å¯¹è±¡å§ã€‚</p>\n<h4 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send()\"></a>send()</h4><p>Express å·²ç»å°è£…è¿‡äº†åŸç”Ÿ Node.js çš„å“åº”æ–¹æ³•ï¼Œåœ¨åŸç”Ÿ Node.js ä¸­ï¼Œé€šè¿‡ <code>res.write()</code> æ–¹æ³•å¯ä»¥è¿”å›å­—ç¬¦ä¸²å’Œ Bufferã€‚è€Œ Express ä¸­çš„ <code>send()</code> å¯ä»¥è¿”å›ä»»æ„æ•°æ®ç±»å‹ï¼Œå¦‚æµã€æ•°æ®ã€æ™®é€šæ–‡æœ¬ç­‰ï¼Œæ¥çœ‹ä¸ªä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res.send(<span class=\"keyword\">new</span> Buffer(<span class=\"string\">'ifyour'</span>)); <span class=\"comment\">// Buffer</span></span><br><span class=\"line\">res.send(&#123;<span class=\"string\">\"name\"</span>: <span class=\"string\">\"ifyour\"</span>&#125;);   <span class=\"comment\">// JSON</span></span><br><span class=\"line\">res.send(<span class=\"string\">'&lt;p&gt;some html&lt;/p&gt;'</span>);   <span class=\"comment\">// HTML</span></span><br><span class=\"line\">res.status(<span class=\"number\">404</span>).send(<span class=\"string\">'404 Not Find'</span>); <span class=\"comment\">// è®¾ç½®çŠ¶æ€ç å¹¶è¿”å›æç¤º</span></span><br><span class=\"line\"><span class=\"comment\">//...</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"json\"><a href=\"#json\" class=\"headerlink\" title=\"json()\"></a>json()</h4><p>é€šè¿‡ <code>json()</code> æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ª <code>JSON</code> å¯¹è±¡ï¼Œç”¨äº Ajax ç­‰ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res.json(<span class=\"literal\">null</span>);</span><br><span class=\"line\">res.json(&#123;<span class=\"string\">\"user\"</span>: <span class=\"string\">\"ifyour\"</span>&#125;);</span><br><span class=\"line\">res.status(<span class=\"number\">500</span>).json(&#123;<span class=\"string\">\"error\"</span>: <span class=\"string\">\"message\"</span>&#125;);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"render\"><a href=\"#render\" class=\"headerlink\" title=\"render()\"></a>render()</h4><p><code>render</code> ç”¨äºæ¸²æŸ“æ¨¡æ¿å¼•æ“ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ <a href=\"https://github.com/tj/ejs\" target=\"_blank\" rel=\"noopener\">ejs</a> æ¨¡æ¿å¼•æ“æ—¶ï¼Œå“åº”ç”¨æˆ·è¯·æ±‚å°±å¯ä»¥ä½¿ç”¨ <code>res.render()</code> è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªæ¸²æŸ“å¥½çš„é¡µé¢ã€‚è¿™ä¸ªç”¨çš„æ¯”è¾ƒå¤šï¼Œæˆ‘æ¥ä¸¾ä¸ªä¾‹å­ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç›®å½•ç»“æ„</span></span><br><span class=\"line\">.</span><br><span class=\"line\">â”œâ”€â”€ index.js</span><br><span class=\"line\">â”œâ”€â”€ node_modules</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ ejs</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ express</span><br><span class=\"line\">â”œâ”€â”€ package.json</span><br><span class=\"line\">â””â”€â”€ views</span><br><span class=\"line\">    â””â”€â”€ login.html</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- ejs æ¨¡æ¿å¼•æ“ï¼Œå®šä¹‰äº† /login.html --&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Title<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- æ³¨æ„ ejs æ¨¡æ¿ä¸­å˜é‡çš„å†™æ³• --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>æ¬¢è¿ä½ ï¼Œ<span class=\"tag\">&lt;<span class=\"name\">%=name%</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> ejs = <span class=\"built_in\">require</span>(<span class=\"string\">'ejs'</span>); <span class=\"comment\">// å¼•å…¥ ejs æ¨¡æ¿å¼•æ“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> viewsPath = path.join(__dirname, <span class=\"string\">'views'</span>);<span class=\"comment\">// views æ˜¯æ¨¡æ¿ç›®å½•</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½® express views å±‚ï¼Œæ¨¡æ¿æ ¹è·¯å¾„</span></span><br><span class=\"line\">app.set(<span class=\"string\">'views'</span>, viewsPath);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½® express å®ä¾‹çš„æ¨¡æ¿è¯­è¨€</span></span><br><span class=\"line\">app.set(<span class=\"string\">'view engine'</span>, <span class=\"string\">'html'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŠŠ express å®ä¾‹çš„æ¨¡æ¿å¼•æ“å’Œ ejs æ¨¡æ¿å¼•æ“å…³è”</span></span><br><span class=\"line\">app.engine(<span class=\"string\">'html'</span>, ejs.__express);</span><br><span class=\"line\"></span><br><span class=\"line\">app.get(<span class=\"string\">'/login.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.render(<span class=\"string\">'login'</span>, &#123;<span class=\"attr\">name</span>: <span class=\"string\">\"ifyour\"</span>&#125;);<span class=\"comment\">// æ›¿æ¢åˆ°æ¨¡æ¿å˜é‡ä¸­çš„ name ä¸º ifyour</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'visit http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br><code>__dirname</code> æ˜¯ Node.js ä¸­å®šä¹‰çš„ <code>global</code> å…¨å±€å˜é‡ï¼Œè·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œè¿”å› <code>string</code> ç±»å‹ã€‚<br></div>\n\n<h4 id=\"download\"><a href=\"#download\" class=\"headerlink\" title=\"download()\"></a>download()</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res.download(<span class=\"string\">'./123.doc'</span>); <span class=\"comment\">// ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ã€‚</span></span><br><span class=\"line\">res.download(<span class=\"string\">'./123.doc'</span>,<span class=\"string\">'books.doc'</span>); <span class=\"comment\">// ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ï¼Œé‡å‘½åä¸º books.doc</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"redirect\"><a href=\"#redirect\" class=\"headerlink\" title=\"redirect()\"></a>redirect()</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é‡å®šå‘åˆ°æŒ‡å®šçš„ URL è·¯å¾„</span></span><br><span class=\"line\">res.redirect(<span class=\"string\">'/404.html'</span>);</span><br><span class=\"line\">res.redirect(<span class=\"string\">'https://www.google.com/'</span>);</span><br></pre></td></tr></table></figure>\n<p>æ›´å¤šå“åº”å¯¹è±¡çš„æ–¹æ³•ï¼Œå‚è€ƒ <a href=\"http://www.expressjs.com.cn/4x/api.html#res\" target=\"_blank\" rel=\"noopener\">Express å®˜æ–¹API</a>ã€‚</p>\n<h3 id=\"Express-è¯·æ±‚å¯¹è±¡\"><a href=\"#Express-è¯·æ±‚å¯¹è±¡\" class=\"headerlink\" title=\"Express è¯·æ±‚å¯¹è±¡\"></a>Express è¯·æ±‚å¯¹è±¡</h3><p>Express ä¸­çš„ <code>Request</code> å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€æ¬¡è¯·æ±‚ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ¯”å¦‚è¯·æ±‚å¤´ã€è·¯å¾„ã€Cookies ç­‰ï¼Œè·å–è¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™äº›ä¿¡æ¯å¤„ç†ä¸šåŠ¡é€»è¾‘å±‚ï¼Œæœ€ç»ˆå°†å¤„ç†è¿‡åçš„æ•°æ®è¿”å›ç»™ç”¨æˆ·ã€‚è¿™é‡Œæ€»ç»“äº†å¸¸ç”¨çš„è¯·æ±‚å¯¹è±¡æ–¹æ³•ã€‚</p>\n<h4 id=\"URL-ä¸­çš„å‚æ•°\"><a href=\"#URL-ä¸­çš„å‚æ•°\" class=\"headerlink\" title=\"URL ä¸­çš„å‚æ•°\"></a>URL ä¸­çš„å‚æ•°</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–¹å¼ä¸€ï¼š req.query.å‚æ•°å</span></span><br><span class=\"line\"><span class=\"comment\">// e.g.  http://localhost:3000/user?name=ifyour</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(req.query.name);</span><br><span class=\"line\"><span class=\"comment\">// =&gt; ifyour</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹å¼äºŒï¼šreq.params.å‚æ•°å</span></span><br><span class=\"line\"><span class=\"comment\">//e.g.  http://localhost/post/123123</span></span><br><span class=\"line\">router.get(<span class=\"string\">'/post/:id'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(req.params.id);</span><br><span class=\"line\">    <span class=\"comment\">// =&gt; 123123</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"è¡¨å•ä¸­çš„å‚æ•°\"><a href=\"#è¡¨å•ä¸­çš„å‚æ•°\" class=\"headerlink\" title=\"è¡¨å•ä¸­çš„å‚æ•°\"></a>è¡¨å•ä¸­çš„å‚æ•°</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–¹å¼ä¸€ï¼šè¯­æ³•ï¼šreq.param.å‚æ•°å  æ³¨æ„è¿™é‡Œæ²¡åŠ  s</span></span><br><span class=\"line\"><span class=\"comment\">// e.g. &lt;input type=\"text\" name=\"user\"&gt;</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(req.param(<span class=\"string\">'user'</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹å¼äºŒï¼šä½¿ç”¨ body-parser ä¸­é—´ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">// e.g. &lt;input type=\"text\" name=\"user\"&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> bodyparser = <span class=\"built_in\">require</span>(<span class=\"string\">'body-parser'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.console.log(req.boy.user);</span><br></pre></td></tr></table></figure>\n<h3 id=\"Express-ä¸­é—´ä»¶\"><a href=\"#Express-ä¸­é—´ä»¶\" class=\"headerlink\" title=\"Express ä¸­é—´ä»¶\"></a>Express ä¸­é—´ä»¶</h3><p>Express æ˜¯ä¸€ä¸ªè‡ªèº«åŠŸèƒ½æç®€ï¼Œå®Œå…¨æ˜¯ç”±è·¯ç”±å’Œä¸­é—´ä»¶æ„æˆä¸€ä¸ªçš„ Web å¼€å‘æ¡†æ¶ï¼šä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œä¸€ä¸ª Express åº”ç”¨å°±æ˜¯åœ¨è°ƒç”¨å„ç§ä¸­é—´ä»¶ã€‚<br><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbcrpk71zxj20sg03kaaa.jpg\" alt=\"\"><br>å¦‚å›¾ï¼Œä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰ä½äºå®¢æˆ·ç«¯å’Œè·¯ç”±ä¹‹é—´ï¼Œå®ƒå¥½æ¯”æ˜¯ä¸€ä¸ªæ¼æ–—ï¼Œç»è¿‡è¿™ä¸ªæ¼æ–—çš„ <code>Request</code> å¯¹è±¡å’Œ <code>Response</code> å¯¹è±¡ä»¥åŠå¾ªç¯æµç¨‹ä¸­çš„ <code>Next</code> ä¼šè¢«å¤„ç†ï¼Œæ¯”å¦‚æ­£ç¡®æ€§æ ¡éªŒã€ä¸šåŠ¡é€»è¾‘å¤„ç†ç­‰ã€‚</p>\n<ul>\n<li>æ‰§è¡Œä»»ä½•ä»£ç </li>\n<li>ä¿®æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡</li>\n<li>ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯</li>\n<li>è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</li>\n</ul>\n<p><div class=\"tip\"><br>å¦‚æœå½“å‰ä¸­é—´ä»¶æ²¡æœ‰ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯ï¼Œåˆ™å¿…é¡»è°ƒç”¨ next() æ–¹æ³•å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¦åˆ™è¯·æ±‚å°±ä¼šæŒ‚èµ·ã€‚<br></div><br>ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚ä½•é€šè¿‡ <code>next()</code> æ–¹æ³•æŠŠæ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\">app.use(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res, next</span>) </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">var</span> accessToken = req.query.accessToken;</span><br><span class=\"line\">   <span class=\"comment\">//æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦å«æœ‰â€œè®¤è¯ç‰Œâ€ï¼Œå­˜åœ¨å°±ç»§ç»­æ‰§è¡Œã€‚</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(accessToken)&#123;</span><br><span class=\"line\">       next(); <span class=\"comment\">// æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class=\"line\">       &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">          res.send(â€œè¯·æ±‚å¿…é¡»åŒ…å«tokenâ€);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"åº”ç”¨çº§ä¸­é—´ä»¶\"><a href=\"#åº”ç”¨çº§ä¸­é—´ä»¶\" class=\"headerlink\" title=\"åº”ç”¨çº§ä¸­é—´ä»¶\"></a>åº”ç”¨çº§ä¸­é—´ä»¶</h4><p>åº”ç”¨çº§ä¸­é—´ä»¶å°±æ˜¯ç»‘å®šåˆ°ç”¨ <code>express()</code> ç”Ÿæˆçš„å¯¹è±¡ <code>app</code> èº«ä¸Šçš„ï¼Œæ¯”å¦‚ <code>app.use()</code> ä¸­çš„ <code>use</code> æ–¹æ³•ï¼Œä»¥åŠ <code>app.post()</code> ã€<code>app.get()</code> ä¸­çš„ <code>POST</code> å’Œ <code>GET</code> æ–¹æ³•ç­‰ã€‚</p>\n<h4 id=\"å†…ç½®ä¸­é—´ä»¶\"><a href=\"#å†…ç½®ä¸­é—´ä»¶\" class=\"headerlink\" title=\"å†…ç½®ä¸­é—´ä»¶\"></a>å†…ç½®ä¸­é—´ä»¶</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è®¾ç½®å…¬å…±é™æ€ç›®å½•ï¼Œç”¨äºå­˜æ”¾ css js image ç­‰æ–‡ä»¶ï¼Œé¡¹ç›®ç›®å½•é‡Œæœ‰ images ç›®å½•å­˜æ”¾ 1.png</span></span><br><span class=\"line\"><span class=\"comment\">// é‚£ä¹ˆè®¿é—®ï¼šhttp://localhost/images/1.png è·å–</span></span><br><span class=\"line\">app.use(express.static(<span class=\"string\">'public'</span>));</span><br></pre></td></tr></table></figure>\n<h4 id=\"ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\"><a href=\"#ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\" class=\"headerlink\" title=\"ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\"></a>ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</h4><p>ä¸­é—´ä»¶å¯ä»¥è¯´æ˜¯æ•´ä¸ª Express çš„ç²¾åæ‰€åœ¨äº†ï¼Œä½¿ç”¨ä¸­é—´ä»¶å¯ä»¥å‡ å¤§çš„æ‰©å±•é¡¹ç›®çš„åŠŸèƒ½ã€‚ä½¿ç”¨æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œè¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„ï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼éœ€è¦çœ‹å®˜æ–¹çš„æ–‡æ¡£äº†ã€‚</p>\n<ul>\n<li>è§£æå®¢æˆ·ç«¯è¯·æ±‚çš„ body ä¸­çš„å†…å®¹ï¼šbody-parser</li>\n<li>cookie è§£æä¸­é—´ä»¶ï¼šcookie-parser</li>\n<li>æ–‡ä»¶ä¸Šä¼ ä¸­é—´ä»¶ï¼šmulter</li>\n</ul>\n<p>ä½¿ç”¨å‘½ä»¤ <code>npm i åŒ…åç§° --save</code> å®‰è£…åˆ°é¡¹ç›®ä¸­ï¼Œç„¶åå¼•å…¥é¡¹ç›®ä½¿ç”¨å³å¯ã€‚</p>\n","site":{"data":{}},"excerpt":"<p><strong><em>Express</em></strong> æ˜¯ä¸€ä¸ªåŸºäº Node.js å¹³å°çš„æç®€ã€çµæ´»çš„ Web åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œå®ƒæä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„ç‰¹æ€§ï¼Œå¸®åŠ©ä½ åˆ›å»ºå„ç§ Web å’Œç§»åŠ¨è®¾å¤‡åº”ç”¨ã€‚Expressçš„æ ¸å¿ƒç‰¹æ€§å¯ä»¥æ¦‚æ‹¬ä»¥ä¸‹ä¸‰ç‚¹ã€‚<br>","more":"</p>\n<ul>\n<li>å¯ä»¥è®¾ç½®ä¸­é—´ä»¶æ¥å“åº” HTTP è¯·æ±‚ã€‚</li>\n<li>å®šä¹‰äº†è·¯ç”±è¡¨ç”¨äºæ‰§è¡Œä¸åŒçš„ HTTP è¯·æ±‚åŠ¨ä½œã€‚</li>\n<li>å¯ä»¥é€šè¿‡å‘æ¨¡æ¿ä¼ é€’å‚æ•°æ¥åŠ¨æ€æ¸²æŸ“ HTML é¡µé¢ã€‚</li>\n</ul>\n<p>ä¸‹é¢å­¦ä¹ çš„çŸ¥è¯†ç‚¹ï¼Œéƒ½ä¼šå›´ç»•è¿™å‡ ä¸ªç‰¹æ€§å±•å¼€ã€‚</p>\n<h3 id=\"Express-å®‰è£…\"><a href=\"#Express-å®‰è£…\" class=\"headerlink\" title=\"Express å®‰è£…\"></a>Express å®‰è£…</h3><h4 id=\"åœ¨é¡¹ç›®ä¸­å¼•å…¥-Express\"><a href=\"#åœ¨é¡¹ç›®ä¸­å¼•å…¥-Express\" class=\"headerlink\" title=\"åœ¨é¡¹ç›®ä¸­å¼•å…¥ Express\"></a>åœ¨é¡¹ç›®ä¸­å¼•å…¥ Express</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> projectName              <span class=\"comment\"># è¿›å…¥æ–°å»ºçš„ Node.js é¡¹ç›®</span></span><br><span class=\"line\">npm init                    <span class=\"comment\"># åˆå§‹åŒ–é¡¹ç›®é…ç½®æ–‡ä»¶</span></span><br><span class=\"line\">npm install express --save  <span class=\"comment\"># å®‰è£… Express æ¨¡å—åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­</span></span><br></pre></td></tr></table></figure>\n<p>é€šè¿‡ä¸Šé—¨çš„å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆ Express çš„å®‰è£…ï¼Œä¸‹é¢åœ¨ <code>app.js</code> ä¸­ä½¿ç”¨ Express å§ï¼<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.send(<span class=\"string\">'Hello,Express!'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Express running at http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"ä½¿ç”¨-Express-generator\"><a href=\"#ä½¿ç”¨-Express-generator\" class=\"headerlink\" title=\"ä½¿ç”¨ Express-generator\"></a>ä½¿ç”¨ Express-generator</h4><p>ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ï¼Œæ›´ä¾¿æ·çš„ä½¿ç”¨ Express ç”Ÿæˆé¡¹ç›®ï¼Œå®˜æ–¹æä¾›çš„å¿«é€Ÿçš„ç”Ÿæˆå·¥å…· <code>Express-generator</code>ï¼Œè™½ç„¶ç”Ÿæˆéå¸¸å¿«é€Ÿæ–¹ä¾¿ï¼Œä½†æ˜¯ä½œä¸ºåˆå­¦è€…ï¼Œè¿˜æ˜¯è¦å¼„æ¸…æ¥šé‡Œé¢æ¯æ¡å‘½ä»¤æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œæœ€åå†ä½¿ç”¨å®˜æ–¹æä¾›çš„å·¥å…·å¿«é€Ÿç”Ÿæˆã€‚æ‰“å¼€ç»ˆç«¯ï¼Œå› ä¸ºæˆ‘æ˜¯ MacOSï¼Œæ‰€ä»¥å®‰è£…çš„æ—¶å€™è¦åŠ ä¸Š <code>sudo</code> å¦åˆ™ä¼šæŠ¥é”™æç¤ºæƒé™ä¸å¤Ÿã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm install express-generator -g  <span class=\"comment\"># å…¨å±€å®‰è£…</span></span><br><span class=\"line\">express mywebapp                       <span class=\"comment\"># åˆ›å»º mywebapp é¡¹ç›®</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> mywebapp &amp;&amp; npm install             <span class=\"comment\"># å®‰è£…ä¾èµ–æ–‡ä»¶</span></span><br><span class=\"line\">npm start                              <span class=\"comment\"># å¯åŠ¨é¡¹ç›®</span></span><br></pre></td></tr></table></figure></p>\n<p>å¯åŠ¨é¡¹ç›®åï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆäº†ï¼Œè®¿é—®åœ°å€ï¼š<a href=\"http://127.0.0.1:3000/\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:3000/</a> ã€‚</p>\n<div class=\"tip\"><br>å¯åŠ¨å‰éœ€è¦å…³é—­å…¶å®ƒå·²ç»å¯ç”¨çš„ Web æœåŠ¡ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´ç«¯å£å ç”¨å¯åŠ¨ä¸æˆåŠŸã€‚<br></div>\n\n<h3 id=\"Express-è·¯ç”±\"><a href=\"#Express-è·¯ç”±\" class=\"headerlink\" title=\"Express è·¯ç”±\"></a>Express è·¯ç”±</h3><blockquote>\n<p>è·¯ç”±æ˜¯æŒ‡å¦‚ä½•å®šä¹‰åº”ç”¨çš„ç«¯ç‚¹ï¼ˆURLsï¼‰ä»¥åŠå¦‚ä½•å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p>\n</blockquote>\n<h4 id=\"åŸºç¡€ç”¨æ³•\"><a href=\"#åŸºç¡€ç”¨æ³•\" class=\"headerlink\" title=\"åŸºç¡€ç”¨æ³•\"></a>åŸºç¡€ç”¨æ³•</h4><p>ç®€å•ç†è§£ï¼Œå…¶å®å°±æ˜¯æ ¹æ®ä¸åŒçš„è¯·æ±‚ï¼Œæ¥å“åº”ä¸ä¹‹å¯¹åº”çš„é¡µé¢ã€‚æ¯”å¦‚ï¼Œå½“ç”¨æˆ·è®¿é—® <a href=\"http://localhost/images/\" target=\"_blank\" rel=\"noopener\">http://localhost/images/</a> æ—¶ï¼Œæ ¹æ® URL å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚çš„æ˜¯ <code>/images</code> è¿™ä¸ªç›®å½•ï¼Œé‚£ä¹ˆé€šè¿‡è·¯ç”±ï¼Œæ‰¾åˆ°è¿™ä¸ªé¡µé¢å¹¶è¿”å›ç»™è¯·æ±‚çš„ç”¨æˆ·ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«è·¯ç”±ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å½“ç”¨æˆ·è¯·æ±‚è®¿é—® / æ—¶ï¼Œå“åº”ä¸€ä¸ª Hello,Express! å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç®€å•è·¯ç”±</span></span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.send(<span class=\"string\">'Hello,Express!'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„ <code>app.all()</code> ,å®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è·¯ç”±æ–¹æ³•ï¼Œæ²¡æœ‰ä»»ä½• HTTP æ–¹æ³•ä¸å…¶å¯¹åº”ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹äºä¸€ä¸ªè·¯å¾„ä¸Šçš„æ‰€æœ‰è¯·æ±‚åŠ è½½ä¸­é—´ä»¶ã€‚ all ç›¸å½“äºæ—¢å¯ä»¥å¤„ç† <code>GET</code>ï¼Œä¹Ÿå¯ä»¥å¤„ç† <code>POST</code> ã€‚</p>\n<h4 id=\"Router-æ–¹æ³•\"><a href=\"#Router-æ–¹æ³•\" class=\"headerlink\" title=\"Router æ–¹æ³•\"></a>Router æ–¹æ³•</h4><p>é€šè¿‡ <code>express.Router</code> ç±»å¯ä»¥åˆ›å»ºç‹¬ç«‹æ¨¡å—çš„è·¯ç”±æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥æŒ‚è½½çš„è·¯ç”±å¯¹è±¡ï¼ŒæŠŠè·¯ç”±æ¨¡å—åˆ†ç¦»å‡ºé¡¹ç›®ï¼Œè®©æ•´ä¸ªé¡¹ç›®ç»“æ„æ¸…æ™°ã€æ–¹ä¾¿ç®¡ç†ï¼Œè¿™é‡Œå…‰è¯´è¿˜æ˜¯æŒºæŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç›®å½•ç»“æ„</span></span><br><span class=\"line\">.</span><br><span class=\"line\">â”œâ”€â”€ index.js</span><br><span class=\"line\">â”œâ”€â”€ node_modules</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ body-parser</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ express</span><br><span class=\"line\">â”œâ”€â”€ package.json</span><br><span class=\"line\">â”œâ”€â”€ router</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ admin.js</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ home.js</span><br><span class=\"line\">â””â”€â”€ views</span><br><span class=\"line\">    â”œâ”€â”€ admin</span><br><span class=\"line\">    â””â”€â”€ home</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> bodyparser = <span class=\"built_in\">require</span>(<span class=\"string\">'body-parser'</span>);</span><br><span class=\"line\"><span class=\"comment\">// å¼•å…¥å¤–éƒ¨è·¯ç”±æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> home = <span class=\"built_in\">require</span>(<span class=\"string\">'./router/home'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> admin = <span class=\"built_in\">require</span>(<span class=\"string\">'./router/admin'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨ä¸­é—´ä»¶ bodyparser ï¼Œåé¢å¯ä»¥åœ¨ req.body ä¸­åˆ†æå‡º POST è¯·æ±‚ä½“çš„å†…å®¹</span></span><br><span class=\"line\">app.use(bodyparser.urlencoded(&#123;<span class=\"attr\">extended</span>:<span class=\"literal\">false</span>&#125;));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½¿ç”¨å¤–éƒ¨è·¯ç”±æ¨¡å—</span></span><br><span class=\"line\">app.use(<span class=\"string\">'/'</span>,home);</span><br><span class=\"line\">app.use(<span class=\"string\">'/admin'</span>,admin);</span><br><span class=\"line\"></span><br><span class=\"line\">app.listen(<span class=\"number\">8080</span>,<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(<span class=\"string\">'visit http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// admin.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> router = express.Router();<span class=\"comment\">// ç”¨ Router æ„é€ å‡½æ•°å®ä¾‹åŒ– router å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">router.get(<span class=\"string\">'/login.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.sendFile(path.resolve(__dirname + <span class=\"string\">'/../views/admin/'</span> + <span class=\"string\">'login.html'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">router.get(<span class=\"string\">'/user.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.sendFile(path.resolve(__dirname + <span class=\"string\">'/../views/admin/'</span> + <span class=\"string\">'user.html'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">router.post(<span class=\"string\">'/login.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;<span class=\"comment\">// /admin/login.html</span></span><br><span class=\"line\">    res.sendFile(path.resolve(__dirname + <span class=\"string\">'/../views/admin/'</span> + <span class=\"string\">'login.html'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = router;<span class=\"comment\">// æš´éœ²ç»™å¤–éƒ¨è°ƒç”¨è¯¥è·¯ç”±</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Express-å“åº”å¯¹è±¡\"><a href=\"#Express-å“åº”å¯¹è±¡\" class=\"headerlink\" title=\"Express å“åº”å¯¹è±¡\"></a>Express å“åº”å¯¹è±¡</h3><p>é€šè¿‡å“åº”ï¼ˆResponseï¼‰å¯¹è±¡ï¼ŒæœåŠ¡å™¨å¯ä»¥è¿”å›ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ <code>Request</code> ,æœ€ç»ˆè¿”å›ç»™ç”¨æˆ·çš„å…¶å®å°±æ˜¯ä¸€ä¸ªç»è¿‡ä¸šåŠ¡é€»è¾‘å±‚å¤„ç†çš„ <code>res</code> å¯¹è±¡ã€‚æ¥äº†è§£ä¸‹ Express çš„å“åº”å¯¹è±¡å§ã€‚</p>\n<h4 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send()\"></a>send()</h4><p>Express å·²ç»å°è£…è¿‡äº†åŸç”Ÿ Node.js çš„å“åº”æ–¹æ³•ï¼Œåœ¨åŸç”Ÿ Node.js ä¸­ï¼Œé€šè¿‡ <code>res.write()</code> æ–¹æ³•å¯ä»¥è¿”å›å­—ç¬¦ä¸²å’Œ Bufferã€‚è€Œ Express ä¸­çš„ <code>send()</code> å¯ä»¥è¿”å›ä»»æ„æ•°æ®ç±»å‹ï¼Œå¦‚æµã€æ•°æ®ã€æ™®é€šæ–‡æœ¬ç­‰ï¼Œæ¥çœ‹ä¸ªä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res.send(<span class=\"keyword\">new</span> Buffer(<span class=\"string\">'ifyour'</span>)); <span class=\"comment\">// Buffer</span></span><br><span class=\"line\">res.send(&#123;<span class=\"string\">\"name\"</span>: <span class=\"string\">\"ifyour\"</span>&#125;);   <span class=\"comment\">// JSON</span></span><br><span class=\"line\">res.send(<span class=\"string\">'&lt;p&gt;some html&lt;/p&gt;'</span>);   <span class=\"comment\">// HTML</span></span><br><span class=\"line\">res.status(<span class=\"number\">404</span>).send(<span class=\"string\">'404 Not Find'</span>); <span class=\"comment\">// è®¾ç½®çŠ¶æ€ç å¹¶è¿”å›æç¤º</span></span><br><span class=\"line\"><span class=\"comment\">//...</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"json\"><a href=\"#json\" class=\"headerlink\" title=\"json()\"></a>json()</h4><p>é€šè¿‡ <code>json()</code> æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ª <code>JSON</code> å¯¹è±¡ï¼Œç”¨äº Ajax ç­‰ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res.json(<span class=\"literal\">null</span>);</span><br><span class=\"line\">res.json(&#123;<span class=\"string\">\"user\"</span>: <span class=\"string\">\"ifyour\"</span>&#125;);</span><br><span class=\"line\">res.status(<span class=\"number\">500</span>).json(&#123;<span class=\"string\">\"error\"</span>: <span class=\"string\">\"message\"</span>&#125;);</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"render\"><a href=\"#render\" class=\"headerlink\" title=\"render()\"></a>render()</h4><p><code>render</code> ç”¨äºæ¸²æŸ“æ¨¡æ¿å¼•æ“ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ <a href=\"https://github.com/tj/ejs\" target=\"_blank\" rel=\"noopener\">ejs</a> æ¨¡æ¿å¼•æ“æ—¶ï¼Œå“åº”ç”¨æˆ·è¯·æ±‚å°±å¯ä»¥ä½¿ç”¨ <code>res.render()</code> è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªæ¸²æŸ“å¥½çš„é¡µé¢ã€‚è¿™ä¸ªç”¨çš„æ¯”è¾ƒå¤šï¼Œæˆ‘æ¥ä¸¾ä¸ªä¾‹å­ã€‚<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç›®å½•ç»“æ„</span></span><br><span class=\"line\">.</span><br><span class=\"line\">â”œâ”€â”€ index.js</span><br><span class=\"line\">â”œâ”€â”€ node_modules</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ ejs</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ express</span><br><span class=\"line\">â”œâ”€â”€ package.json</span><br><span class=\"line\">â””â”€â”€ views</span><br><span class=\"line\">    â””â”€â”€ login.html</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- ejs æ¨¡æ¿å¼•æ“ï¼Œå®šä¹‰äº† /login.html --&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Title<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- æ³¨æ„ ejs æ¨¡æ¿ä¸­å˜é‡çš„å†™æ³• --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>æ¬¢è¿ä½ ï¼Œ<span class=\"tag\">&lt;<span class=\"name\">%=name%</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> ejs = <span class=\"built_in\">require</span>(<span class=\"string\">'ejs'</span>); <span class=\"comment\">// å¼•å…¥ ejs æ¨¡æ¿å¼•æ“</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> viewsPath = path.join(__dirname, <span class=\"string\">'views'</span>);<span class=\"comment\">// views æ˜¯æ¨¡æ¿ç›®å½•</span></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½® express views å±‚ï¼Œæ¨¡æ¿æ ¹è·¯å¾„</span></span><br><span class=\"line\">app.set(<span class=\"string\">'views'</span>, viewsPath);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è®¾ç½® express å®ä¾‹çš„æ¨¡æ¿è¯­è¨€</span></span><br><span class=\"line\">app.set(<span class=\"string\">'view engine'</span>, <span class=\"string\">'html'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æŠŠ express å®ä¾‹çš„æ¨¡æ¿å¼•æ“å’Œ ejs æ¨¡æ¿å¼•æ“å…³è”</span></span><br><span class=\"line\">app.engine(<span class=\"string\">'html'</span>, ejs.__express);</span><br><span class=\"line\"></span><br><span class=\"line\">app.get(<span class=\"string\">'/login.html'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.render(<span class=\"string\">'login'</span>, &#123;<span class=\"attr\">name</span>: <span class=\"string\">\"ifyour\"</span>&#125;);<span class=\"comment\">// æ›¿æ¢åˆ°æ¨¡æ¿å˜é‡ä¸­çš„ name ä¸º ifyour</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.listen(<span class=\"number\">8080</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'visit http://127.0.0.1:8080/'</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<div class=\"tip\"><br><code>__dirname</code> æ˜¯ Node.js ä¸­å®šä¹‰çš„ <code>global</code> å…¨å±€å˜é‡ï¼Œè·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œè¿”å› <code>string</code> ç±»å‹ã€‚<br></div>\n\n<h4 id=\"download\"><a href=\"#download\" class=\"headerlink\" title=\"download()\"></a>download()</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res.download(<span class=\"string\">'./123.doc'</span>); <span class=\"comment\">// ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ã€‚</span></span><br><span class=\"line\">res.download(<span class=\"string\">'./123.doc'</span>,<span class=\"string\">'books.doc'</span>); <span class=\"comment\">// ä¸‹è½½å½“å‰ç›®å½•ä¸‹é¢çš„123.docæ–‡ä»¶ï¼Œé‡å‘½åä¸º books.doc</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"redirect\"><a href=\"#redirect\" class=\"headerlink\" title=\"redirect()\"></a>redirect()</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é‡å®šå‘åˆ°æŒ‡å®šçš„ URL è·¯å¾„</span></span><br><span class=\"line\">res.redirect(<span class=\"string\">'/404.html'</span>);</span><br><span class=\"line\">res.redirect(<span class=\"string\">'https://www.google.com/'</span>);</span><br></pre></td></tr></table></figure>\n<p>æ›´å¤šå“åº”å¯¹è±¡çš„æ–¹æ³•ï¼Œå‚è€ƒ <a href=\"http://www.expressjs.com.cn/4x/api.html#res\" target=\"_blank\" rel=\"noopener\">Express å®˜æ–¹API</a>ã€‚</p>\n<h3 id=\"Express-è¯·æ±‚å¯¹è±¡\"><a href=\"#Express-è¯·æ±‚å¯¹è±¡\" class=\"headerlink\" title=\"Express è¯·æ±‚å¯¹è±¡\"></a>Express è¯·æ±‚å¯¹è±¡</h3><p>Express ä¸­çš„ <code>Request</code> å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€æ¬¡è¯·æ±‚ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ¯”å¦‚è¯·æ±‚å¤´ã€è·¯å¾„ã€Cookies ç­‰ï¼Œè·å–è¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™äº›ä¿¡æ¯å¤„ç†ä¸šåŠ¡é€»è¾‘å±‚ï¼Œæœ€ç»ˆå°†å¤„ç†è¿‡åçš„æ•°æ®è¿”å›ç»™ç”¨æˆ·ã€‚è¿™é‡Œæ€»ç»“äº†å¸¸ç”¨çš„è¯·æ±‚å¯¹è±¡æ–¹æ³•ã€‚</p>\n<h4 id=\"URL-ä¸­çš„å‚æ•°\"><a href=\"#URL-ä¸­çš„å‚æ•°\" class=\"headerlink\" title=\"URL ä¸­çš„å‚æ•°\"></a>URL ä¸­çš„å‚æ•°</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–¹å¼ä¸€ï¼š req.query.å‚æ•°å</span></span><br><span class=\"line\"><span class=\"comment\">// e.g.  http://localhost:3000/user?name=ifyour</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(req.query.name);</span><br><span class=\"line\"><span class=\"comment\">// =&gt; ifyour</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹å¼äºŒï¼šreq.params.å‚æ•°å</span></span><br><span class=\"line\"><span class=\"comment\">//e.g.  http://localhost/post/123123</span></span><br><span class=\"line\">router.get(<span class=\"string\">'/post/:id'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(req.params.id);</span><br><span class=\"line\">    <span class=\"comment\">// =&gt; 123123</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"è¡¨å•ä¸­çš„å‚æ•°\"><a href=\"#è¡¨å•ä¸­çš„å‚æ•°\" class=\"headerlink\" title=\"è¡¨å•ä¸­çš„å‚æ•°\"></a>è¡¨å•ä¸­çš„å‚æ•°</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ–¹å¼ä¸€ï¼šè¯­æ³•ï¼šreq.param.å‚æ•°å  æ³¨æ„è¿™é‡Œæ²¡åŠ  s</span></span><br><span class=\"line\"><span class=\"comment\">// e.g. &lt;input type=\"text\" name=\"user\"&gt;</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(req.param(<span class=\"string\">'user'</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ–¹å¼äºŒï¼šä½¿ç”¨ body-parser ä¸­é—´ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">// e.g. &lt;input type=\"text\" name=\"user\"&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> bodyparser = <span class=\"built_in\">require</span>(<span class=\"string\">'body-parser'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.console.log(req.boy.user);</span><br></pre></td></tr></table></figure>\n<h3 id=\"Express-ä¸­é—´ä»¶\"><a href=\"#Express-ä¸­é—´ä»¶\" class=\"headerlink\" title=\"Express ä¸­é—´ä»¶\"></a>Express ä¸­é—´ä»¶</h3><p>Express æ˜¯ä¸€ä¸ªè‡ªèº«åŠŸèƒ½æç®€ï¼Œå®Œå…¨æ˜¯ç”±è·¯ç”±å’Œä¸­é—´ä»¶æ„æˆä¸€ä¸ªçš„ Web å¼€å‘æ¡†æ¶ï¼šä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œä¸€ä¸ª Express åº”ç”¨å°±æ˜¯åœ¨è°ƒç”¨å„ç§ä¸­é—´ä»¶ã€‚<br><img src=\"http://ww3.sinaimg.cn/large/6057861cgw1fbcrpk71zxj20sg03kaaa.jpg\" alt=\"\"><br>å¦‚å›¾ï¼Œä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰ä½äºå®¢æˆ·ç«¯å’Œè·¯ç”±ä¹‹é—´ï¼Œå®ƒå¥½æ¯”æ˜¯ä¸€ä¸ªæ¼æ–—ï¼Œç»è¿‡è¿™ä¸ªæ¼æ–—çš„ <code>Request</code> å¯¹è±¡å’Œ <code>Response</code> å¯¹è±¡ä»¥åŠå¾ªç¯æµç¨‹ä¸­çš„ <code>Next</code> ä¼šè¢«å¤„ç†ï¼Œæ¯”å¦‚æ­£ç¡®æ€§æ ¡éªŒã€ä¸šåŠ¡é€»è¾‘å¤„ç†ç­‰ã€‚</p>\n<ul>\n<li>æ‰§è¡Œä»»ä½•ä»£ç </li>\n<li>ä¿®æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡</li>\n<li>ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯</li>\n<li>è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</li>\n</ul>\n<p><div class=\"tip\"><br>å¦‚æœå½“å‰ä¸­é—´ä»¶æ²¡æœ‰ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯ï¼Œåˆ™å¿…é¡»è°ƒç”¨ next() æ–¹æ³•å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¦åˆ™è¯·æ±‚å°±ä¼šæŒ‚èµ·ã€‚<br></div><br>ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚ä½•é€šè¿‡ <code>next()</code> æ–¹æ³•æŠŠæ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> app = express();</span><br><span class=\"line\">app.use(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res, next</span>) </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">var</span> accessToken = req.query.accessToken;</span><br><span class=\"line\">   <span class=\"comment\">//æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦å«æœ‰â€œè®¤è¯ç‰Œâ€ï¼Œå­˜åœ¨å°±ç»§ç»­æ‰§è¡Œã€‚</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(accessToken)&#123;</span><br><span class=\"line\">       next(); <span class=\"comment\">// æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class=\"line\">       &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">          res.send(â€œè¯·æ±‚å¿…é¡»åŒ…å«tokenâ€);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"åº”ç”¨çº§ä¸­é—´ä»¶\"><a href=\"#åº”ç”¨çº§ä¸­é—´ä»¶\" class=\"headerlink\" title=\"åº”ç”¨çº§ä¸­é—´ä»¶\"></a>åº”ç”¨çº§ä¸­é—´ä»¶</h4><p>åº”ç”¨çº§ä¸­é—´ä»¶å°±æ˜¯ç»‘å®šåˆ°ç”¨ <code>express()</code> ç”Ÿæˆçš„å¯¹è±¡ <code>app</code> èº«ä¸Šçš„ï¼Œæ¯”å¦‚ <code>app.use()</code> ä¸­çš„ <code>use</code> æ–¹æ³•ï¼Œä»¥åŠ <code>app.post()</code> ã€<code>app.get()</code> ä¸­çš„ <code>POST</code> å’Œ <code>GET</code> æ–¹æ³•ç­‰ã€‚</p>\n<h4 id=\"å†…ç½®ä¸­é—´ä»¶\"><a href=\"#å†…ç½®ä¸­é—´ä»¶\" class=\"headerlink\" title=\"å†…ç½®ä¸­é—´ä»¶\"></a>å†…ç½®ä¸­é—´ä»¶</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è®¾ç½®å…¬å…±é™æ€ç›®å½•ï¼Œç”¨äºå­˜æ”¾ css js image ç­‰æ–‡ä»¶ï¼Œé¡¹ç›®ç›®å½•é‡Œæœ‰ images ç›®å½•å­˜æ”¾ 1.png</span></span><br><span class=\"line\"><span class=\"comment\">// é‚£ä¹ˆè®¿é—®ï¼šhttp://localhost/images/1.png è·å–</span></span><br><span class=\"line\">app.use(express.static(<span class=\"string\">'public'</span>));</span><br></pre></td></tr></table></figure>\n<h4 id=\"ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\"><a href=\"#ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\" class=\"headerlink\" title=\"ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶\"></a>ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</h4><p>ä¸­é—´ä»¶å¯ä»¥è¯´æ˜¯æ•´ä¸ª Express çš„ç²¾åæ‰€åœ¨äº†ï¼Œä½¿ç”¨ä¸­é—´ä»¶å¯ä»¥å‡ å¤§çš„æ‰©å±•é¡¹ç›®çš„åŠŸèƒ½ã€‚ä½¿ç”¨æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œè¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„ï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼éœ€è¦çœ‹å®˜æ–¹çš„æ–‡æ¡£äº†ã€‚</p>\n<ul>\n<li>è§£æå®¢æˆ·ç«¯è¯·æ±‚çš„ body ä¸­çš„å†…å®¹ï¼šbody-parser</li>\n<li>cookie è§£æä¸­é—´ä»¶ï¼šcookie-parser</li>\n<li>æ–‡ä»¶ä¸Šä¼ ä¸­é—´ä»¶ï¼šmulter</li>\n</ul>\n<p>ä½¿ç”¨å‘½ä»¤ <code>npm i åŒ…åç§° --save</code> å®‰è£…åˆ°é¡¹ç›®ä¸­ï¼Œç„¶åå¼•å…¥é¡¹ç›®ä½¿ç”¨å³å¯ã€‚</p>"},{"title":"React ç»„ä»¶æ¨¡å¼","comments":1,"date":"2018-05-15T16:33:40.000Z","from":"https://levelup.gitconnected.com/react-component-patterns-ab1f09be2c82","_content":"\nä½¿ç”¨ React å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œ React æ˜¯ Facebook å…¬å¸å¼€å‘çš„ç”¨äºæ„å»ºç½‘é¡µç•Œé¢çš„ UI åº“ã€‚æœ¬æ–‡è¯•å›¾æ€»ç»“å®è·µä¸­æ‰€å­¦åˆ°çš„ä¸€äº›æ¨¡å¼ï¼ŒåŒæ—¶å¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°å³å°†è¿ˆå…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…ã€‚\n\n<!-- more -->\n\n### æ¦‚è¦\n\n* æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶\n* å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶\n* é«˜é˜¶ç»„ä»¶ vs å›è°ƒæ¸²æŸ“ç»„ä»¶\n\n![image](https://user-images.githubusercontent.com/15377484/40128970-a333542c-5965-11e8-8505-d1284d2759b1.png)\n\n### æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶\n\næ­£å¦‚ WEB æœåŠ¡æœ‰é™æ€å’ŒåŠ¨æ€ä¹‹åˆ†ï¼ŒReact ç»„ä»¶ä¹Ÿæœ‰æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€çš„åŒºåˆ†ã€‚\n\n* æœ‰çŠ¶æ€ç»„ä»¶ï¼šåœ¨åº”ç”¨ä¸­ç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªèº«çŠ¶æ€å¹¶æ“çºµå®ƒï¼›\n* æ— çŠ¶æ€ç»„ä»¶ï¼šåªæ¥æ”¶å±æ€§è¿›è¡Œæ•ˆæœå‘ˆç°ã€‚\n\nä¸€ä¸ªç®€å•çš„æ— çŠ¶æ€ç»„ä»¶ï¼Œåªå—å±æ€§æ§åˆ¶:\n\n```jsx\nconst Button = props => (\n  <button onClick={props.onClick}>\n    {props.text}\n  </button>\n);\n```\n\nä¸€ä¸ªå…·æœ‰è®¡æ•°åŠŸèƒ½çš„æŒ‰é’®ç»„ä»¶ (å¤ç”¨ä¸Šé¢ Button ç»„ä»¶)\n\n```jsx\nclass ButtonCounter extends React.Component {\n  constructor() {\n    super()\n    this.state = {clicks: 0}\n    this.handleClick = this.handleClick.bind(this)\n  }\n\n  handleClick() {\n    this.setState({clicks: this.state.clicks + 1})\n  }\n\n  render() {\n    return (\n      <Button\n        onClick={this.handleClick}\n        text={`You've clicked me ${this.state.clicks} times!`}\n      />\n    )\n  }\n}\n```\n\næ­£å¦‚ä¸Šé¢ä¸¤ä¸ª Demo æ‰€ç¤ºï¼Œç¬¬äºŒä¸ªç»„ä»¶çš„ `constructor` å…·æœ‰çŠ¶æ€çš„å®šä¹‰ï¼Œç¬¬ä¸€ä¸ªç»„ä»¶åªæ˜¯å•çº¯åœ°æ¸²æŸ“å±æ€§æ–‡å­—ã€‚æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„åˆ’åˆ†çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å®ƒå¯¹äºç»„ä»¶å¤ç”¨å…·æœ‰é‡å¤§æ„ä¹‰ã€‚\n\n### å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶\n\nå½“ç»„ä»¶éœ€è¦è·å–å¤–éƒ¨æ•°æ®æ—¶ï¼Œæˆ‘ä»¬åˆå¯ä»¥å°†ç»„ä»¶åˆ’åˆ†ä¸ºä¸¤ç§æ–°çš„ç±»å‹ã€‚å®¹å™¨ç»„ä»¶è´Ÿè´£è·å–æ•°æ®ï¼Œå®ƒå¸¸å¸¸æ˜¯è¶…å‡ºäº† React èŒƒç•´çš„ï¼Œå¦‚ä½¿ç”¨ Redux æˆ– Relay è¿›è¡Œäº†ç»‘å®šã€‚å¯¹æ¯”è€Œè¨€ï¼Œå±•ç¤ºå‹ç»„ä»¶ä¸ä¾èµ–äºç¨‹åºå…¶ä»–éƒ¨åˆ†ï¼Œå®ƒåªå’Œè‡ªèº«çŠ¶æ€æˆ–å±æ€§æœ‰å…³ã€‚ä¸‹é¢æˆ‘ä»¬å®ç°ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨çš„å±•ç¤ºç»„ä»¶:\n\n```jsx\nconst UserList = props =>\n  <ul>\n    {props.users.map(u => (\n      <li>{u.name} â€” {u.age} years old</li>\n    ))}\n  </ul>\n```\n\nå®¹å™¨ç»„ä»¶å¯ä»¥ç”¨æ¥æ›´æ–°ç”¨æˆ·åˆ—è¡¨çš„å±•ç¤º:\n\n```jsx\nclass UserListContainer extends React.Component {\n  constructor() {\n    super()\n    this.state = {users: [] }\n  }\n\n  componentDidMount() {\n    fetchUsers(users => this.setState({ users }))\n  }\n\n  render() {\n    return <UserList users={this.state.users} />\n  }\n}\n```\n\nè¿™ç§åˆ†ç±»å°†æ•°æ®è·å–å’Œæ¸²æŸ“çš„é€»è¾‘åˆ†å¼€ï¼Œè¿›è€Œä½¿ç”¨æˆ·åˆ—è¡¨ç»„ä»¶å¯ä»¥å¤ç”¨ã€‚\n\nå¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¯¥æ¨¡å¼çš„ä¿¡æ¯ï¼Œ[è¿™ç¯‡æ–‡ç« ](https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0)å¯¹å®ƒè¿›è¡Œäº†è¯¦ç»†çš„è§£é‡Šã€‚\n\n### é«˜é˜¶ç»„ä»¶\n\nå½“ä½ æƒ³å¤ç”¨ç»„ä»¶é€»è¾‘æ—¶ï¼Œé«˜é˜¶ç»„ä»¶éå¸¸æœ‰ç”¨ã€‚é«˜é˜¶ç»„ä»¶ï¼šæ˜¯å°†ç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›æ–°ç»„ä»¶çš„ JS å‡½æ•°ã€‚\n\nå‡è®¾ä½ éœ€è¦æ„å»ºä¸€ä¸ªå¯æ‰©å±•èœå•ç»„ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºéšè—å­ç»„ä»¶å†…å®¹ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¥å®ç°:\n\n```jsx\nfunction makeToggleable(Clickable) {\n  return class extends React.Component {\n    constructor() {\n      super()\n      this.toggle = this.toggle.bind(this)\n      this.state = {show: false}\n    }\n\n    toggle() {\n      this.setState(prevState => ({ show: !prevState.show }))\n    }\n\n    render() {\n      return (\n        <div>\n          <Clickable\n            {...this.props}\n            onClick={this.toggle}\n          />\n          {this.state.show && this.props.children}\n        </div>\n      )\n    }\n  }\n}\n```\n\nè¿™ç§æ–¹æ³•å…è®¸æˆ‘ä»¬ä½¿ç”¨ ES7 è£…é¥°å™¨è¯­æ³•å°†é€»è¾‘åº”ç”¨äº ToggleableMenu ç»„ä»¶:\n\n```jsx\n@makeToggleable\nclass ToggleableMenu extends React.Component {\n  render() {\n    return (\n      <div onClick={this.props.onClick}>\n        <h1>{this.props.title}</h1>\n      </div>\n    )\n  }\n}\n```\n\nç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å­ç»„ä»¶ä¼ é€’ç»™ ToggleableMenu ç»„ä»¶:\n\n```jsx\nclass Menu extends React.Component {\n  render() {\n    return (\n      <div>\n        <ToggleableMenu title=\"First Menu\">\n          <p>Some content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Second Menu\">\n          <p>Another content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Third Menu\">\n          <p>More content</p>\n        </ToggleableMenu>\n      </div>\n    )\n  }\n}\n```\n\nå¦‚æœä½ ç†Ÿæ‚‰ Redux çš„ connect å‡½æ•°æˆ–è€… React Router çš„ withRouter å‡½æ•°ï¼Œé‚£ä¹ˆä½ å·²ç»ä½¿ç”¨è¿‡é«˜é˜¶ç»„ä»¶äº†ã€‚\n\n### å›è°ƒæ¸²æŸ“ç»„ä»¶\n\nå¦ä¸€ä¸ªæ¯”è¾ƒé«˜ç«¯çš„å¤ç”¨ç»„ä»¶é€»è¾‘çš„æ–¹æ³•æ˜¯å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„ `props.children`ï¼Œè¯¥æ–¹æ³•ä¹Ÿç§°ä¸º **Function as Child Components**ã€‚æˆ‘ä»¬å°†ä½¿ç”¨** æ¸²æŸ“å›è°ƒ **æ¥é‡æ–°å®ç°ä¸Šé¢çš„å¯æ‰©å±• Menu:\n\n```jsx\nclass Toggleable extends React.Component {\n  constructor() {\n    super()\n    this.toggle = this.toggle.bind(this)\n    this.state = {show: false}\n  }\n\n  toggle() {\n    this.setState(prevState => ({ show: !prevState.show }))\n  }\n\n  render() {\n    return this.props.children(this.state.show, this.toggle)\n  }\n}\n```\n\nç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„å­çº§è¿›è¡Œä¼ é€’:\n\n```jsx\n<Toggleable>\n  {(show, onClick) => (\n    <div>\n      <div onClick={onClick}>\n        <h1>{props.title}</h1>\n      </div>\n      {show && props.children}\n    </div>\n  )}\n</Toggleable>\n```\n\nä¸Šé¢çš„ä»£ç å·²ç»å°†ä¸€ä¸ªå‡½æ•°ä½œä¸º** å­ç»„ä»¶ **ï¼Œä½†æ˜¯ï¼Œè‹¥æˆ‘ä»¬æƒ³å¤ç”¨ä¸Šè¿°é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè½¬æ¢é€»è¾‘çš„æ–°ç»„ä»¶ï¼š\n\n```jsx\nconst ToggleableMenu = props =>\n  <Toggleable>\n    {(show, onClick) => (\n      <div>\n        <div onClick={onClick}>\n          <h1>{props.title}</h1>\n        </div>\n        {show && props.children}\n      </div>\n    )}\n  </Toggleable>\n```\n\næˆ‘ä»¬ä½¿ç”¨ Render Callbacks å®ç°çš„å¯æ‰©å±•çš„ Menu ç»„ä»¶å¦‚ä¸‹:\n\n```jsx\nclass Menu extends React.Component {\n  render() {\n    return (\n      <div>\n        <ToggleableMenu title=\"First Menu\">\n          <p>Some content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Second Menu\">\n          <p>Another content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Third Menu\">\n          <p>More content</p>\n        </ToggleableMenu>\n      </div>\n    )\n  }\n}\n```\n\nå›è°ƒæ¸²æŸ“ç»„ä»¶ (Render Callbacks) å’Œé«˜é˜¶å‡½æ•°ä½¿æˆ‘ä»¬çš„ç»„ä»¶æ›´åŠ çµæ´»ï¼ŒæŒæ¡å’Œé€‚åº”èµ·æ¥å…·æœ‰ä¸€å®šçš„éš¾åº¦ï¼Œéœ€è¦åå¤å­¦ä¹ å’Œæ¶ˆåŒ–ã€‚\n","source":"_posts/React-ç»„ä»¶æ¨¡å¼.md","raw":"---\ntitle: React ç»„ä»¶æ¨¡å¼\ncomments: true\ndate: 2018-05-16 00:33:40\ntags:\nfrom: https://levelup.gitconnected.com/react-component-patterns-ab1f09be2c82\n---\n\nä½¿ç”¨ React å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œ React æ˜¯ Facebook å…¬å¸å¼€å‘çš„ç”¨äºæ„å»ºç½‘é¡µç•Œé¢çš„ UI åº“ã€‚æœ¬æ–‡è¯•å›¾æ€»ç»“å®è·µä¸­æ‰€å­¦åˆ°çš„ä¸€äº›æ¨¡å¼ï¼ŒåŒæ—¶å¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°å³å°†è¿ˆå…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…ã€‚\n\n<!-- more -->\n\n### æ¦‚è¦\n\n* æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶\n* å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶\n* é«˜é˜¶ç»„ä»¶ vs å›è°ƒæ¸²æŸ“ç»„ä»¶\n\n![image](https://user-images.githubusercontent.com/15377484/40128970-a333542c-5965-11e8-8505-d1284d2759b1.png)\n\n### æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶\n\næ­£å¦‚ WEB æœåŠ¡æœ‰é™æ€å’ŒåŠ¨æ€ä¹‹åˆ†ï¼ŒReact ç»„ä»¶ä¹Ÿæœ‰æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€çš„åŒºåˆ†ã€‚\n\n* æœ‰çŠ¶æ€ç»„ä»¶ï¼šåœ¨åº”ç”¨ä¸­ç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªèº«çŠ¶æ€å¹¶æ“çºµå®ƒï¼›\n* æ— çŠ¶æ€ç»„ä»¶ï¼šåªæ¥æ”¶å±æ€§è¿›è¡Œæ•ˆæœå‘ˆç°ã€‚\n\nä¸€ä¸ªç®€å•çš„æ— çŠ¶æ€ç»„ä»¶ï¼Œåªå—å±æ€§æ§åˆ¶:\n\n```jsx\nconst Button = props => (\n  <button onClick={props.onClick}>\n    {props.text}\n  </button>\n);\n```\n\nä¸€ä¸ªå…·æœ‰è®¡æ•°åŠŸèƒ½çš„æŒ‰é’®ç»„ä»¶ (å¤ç”¨ä¸Šé¢ Button ç»„ä»¶)\n\n```jsx\nclass ButtonCounter extends React.Component {\n  constructor() {\n    super()\n    this.state = {clicks: 0}\n    this.handleClick = this.handleClick.bind(this)\n  }\n\n  handleClick() {\n    this.setState({clicks: this.state.clicks + 1})\n  }\n\n  render() {\n    return (\n      <Button\n        onClick={this.handleClick}\n        text={`You've clicked me ${this.state.clicks} times!`}\n      />\n    )\n  }\n}\n```\n\næ­£å¦‚ä¸Šé¢ä¸¤ä¸ª Demo æ‰€ç¤ºï¼Œç¬¬äºŒä¸ªç»„ä»¶çš„ `constructor` å…·æœ‰çŠ¶æ€çš„å®šä¹‰ï¼Œç¬¬ä¸€ä¸ªç»„ä»¶åªæ˜¯å•çº¯åœ°æ¸²æŸ“å±æ€§æ–‡å­—ã€‚æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„åˆ’åˆ†çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å®ƒå¯¹äºç»„ä»¶å¤ç”¨å…·æœ‰é‡å¤§æ„ä¹‰ã€‚\n\n### å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶\n\nå½“ç»„ä»¶éœ€è¦è·å–å¤–éƒ¨æ•°æ®æ—¶ï¼Œæˆ‘ä»¬åˆå¯ä»¥å°†ç»„ä»¶åˆ’åˆ†ä¸ºä¸¤ç§æ–°çš„ç±»å‹ã€‚å®¹å™¨ç»„ä»¶è´Ÿè´£è·å–æ•°æ®ï¼Œå®ƒå¸¸å¸¸æ˜¯è¶…å‡ºäº† React èŒƒç•´çš„ï¼Œå¦‚ä½¿ç”¨ Redux æˆ– Relay è¿›è¡Œäº†ç»‘å®šã€‚å¯¹æ¯”è€Œè¨€ï¼Œå±•ç¤ºå‹ç»„ä»¶ä¸ä¾èµ–äºç¨‹åºå…¶ä»–éƒ¨åˆ†ï¼Œå®ƒåªå’Œè‡ªèº«çŠ¶æ€æˆ–å±æ€§æœ‰å…³ã€‚ä¸‹é¢æˆ‘ä»¬å®ç°ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨çš„å±•ç¤ºç»„ä»¶:\n\n```jsx\nconst UserList = props =>\n  <ul>\n    {props.users.map(u => (\n      <li>{u.name} â€” {u.age} years old</li>\n    ))}\n  </ul>\n```\n\nå®¹å™¨ç»„ä»¶å¯ä»¥ç”¨æ¥æ›´æ–°ç”¨æˆ·åˆ—è¡¨çš„å±•ç¤º:\n\n```jsx\nclass UserListContainer extends React.Component {\n  constructor() {\n    super()\n    this.state = {users: [] }\n  }\n\n  componentDidMount() {\n    fetchUsers(users => this.setState({ users }))\n  }\n\n  render() {\n    return <UserList users={this.state.users} />\n  }\n}\n```\n\nè¿™ç§åˆ†ç±»å°†æ•°æ®è·å–å’Œæ¸²æŸ“çš„é€»è¾‘åˆ†å¼€ï¼Œè¿›è€Œä½¿ç”¨æˆ·åˆ—è¡¨ç»„ä»¶å¯ä»¥å¤ç”¨ã€‚\n\nå¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¯¥æ¨¡å¼çš„ä¿¡æ¯ï¼Œ[è¿™ç¯‡æ–‡ç« ](https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0)å¯¹å®ƒè¿›è¡Œäº†è¯¦ç»†çš„è§£é‡Šã€‚\n\n### é«˜é˜¶ç»„ä»¶\n\nå½“ä½ æƒ³å¤ç”¨ç»„ä»¶é€»è¾‘æ—¶ï¼Œé«˜é˜¶ç»„ä»¶éå¸¸æœ‰ç”¨ã€‚é«˜é˜¶ç»„ä»¶ï¼šæ˜¯å°†ç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›æ–°ç»„ä»¶çš„ JS å‡½æ•°ã€‚\n\nå‡è®¾ä½ éœ€è¦æ„å»ºä¸€ä¸ªå¯æ‰©å±•èœå•ç»„ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºéšè—å­ç»„ä»¶å†…å®¹ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¥å®ç°:\n\n```jsx\nfunction makeToggleable(Clickable) {\n  return class extends React.Component {\n    constructor() {\n      super()\n      this.toggle = this.toggle.bind(this)\n      this.state = {show: false}\n    }\n\n    toggle() {\n      this.setState(prevState => ({ show: !prevState.show }))\n    }\n\n    render() {\n      return (\n        <div>\n          <Clickable\n            {...this.props}\n            onClick={this.toggle}\n          />\n          {this.state.show && this.props.children}\n        </div>\n      )\n    }\n  }\n}\n```\n\nè¿™ç§æ–¹æ³•å…è®¸æˆ‘ä»¬ä½¿ç”¨ ES7 è£…é¥°å™¨è¯­æ³•å°†é€»è¾‘åº”ç”¨äº ToggleableMenu ç»„ä»¶:\n\n```jsx\n@makeToggleable\nclass ToggleableMenu extends React.Component {\n  render() {\n    return (\n      <div onClick={this.props.onClick}>\n        <h1>{this.props.title}</h1>\n      </div>\n    )\n  }\n}\n```\n\nç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å­ç»„ä»¶ä¼ é€’ç»™ ToggleableMenu ç»„ä»¶:\n\n```jsx\nclass Menu extends React.Component {\n  render() {\n    return (\n      <div>\n        <ToggleableMenu title=\"First Menu\">\n          <p>Some content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Second Menu\">\n          <p>Another content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Third Menu\">\n          <p>More content</p>\n        </ToggleableMenu>\n      </div>\n    )\n  }\n}\n```\n\nå¦‚æœä½ ç†Ÿæ‚‰ Redux çš„ connect å‡½æ•°æˆ–è€… React Router çš„ withRouter å‡½æ•°ï¼Œé‚£ä¹ˆä½ å·²ç»ä½¿ç”¨è¿‡é«˜é˜¶ç»„ä»¶äº†ã€‚\n\n### å›è°ƒæ¸²æŸ“ç»„ä»¶\n\nå¦ä¸€ä¸ªæ¯”è¾ƒé«˜ç«¯çš„å¤ç”¨ç»„ä»¶é€»è¾‘çš„æ–¹æ³•æ˜¯å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„ `props.children`ï¼Œè¯¥æ–¹æ³•ä¹Ÿç§°ä¸º **Function as Child Components**ã€‚æˆ‘ä»¬å°†ä½¿ç”¨** æ¸²æŸ“å›è°ƒ **æ¥é‡æ–°å®ç°ä¸Šé¢çš„å¯æ‰©å±• Menu:\n\n```jsx\nclass Toggleable extends React.Component {\n  constructor() {\n    super()\n    this.toggle = this.toggle.bind(this)\n    this.state = {show: false}\n  }\n\n  toggle() {\n    this.setState(prevState => ({ show: !prevState.show }))\n  }\n\n  render() {\n    return this.props.children(this.state.show, this.toggle)\n  }\n}\n```\n\nç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„å­çº§è¿›è¡Œä¼ é€’:\n\n```jsx\n<Toggleable>\n  {(show, onClick) => (\n    <div>\n      <div onClick={onClick}>\n        <h1>{props.title}</h1>\n      </div>\n      {show && props.children}\n    </div>\n  )}\n</Toggleable>\n```\n\nä¸Šé¢çš„ä»£ç å·²ç»å°†ä¸€ä¸ªå‡½æ•°ä½œä¸º** å­ç»„ä»¶ **ï¼Œä½†æ˜¯ï¼Œè‹¥æˆ‘ä»¬æƒ³å¤ç”¨ä¸Šè¿°é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè½¬æ¢é€»è¾‘çš„æ–°ç»„ä»¶ï¼š\n\n```jsx\nconst ToggleableMenu = props =>\n  <Toggleable>\n    {(show, onClick) => (\n      <div>\n        <div onClick={onClick}>\n          <h1>{props.title}</h1>\n        </div>\n        {show && props.children}\n      </div>\n    )}\n  </Toggleable>\n```\n\næˆ‘ä»¬ä½¿ç”¨ Render Callbacks å®ç°çš„å¯æ‰©å±•çš„ Menu ç»„ä»¶å¦‚ä¸‹:\n\n```jsx\nclass Menu extends React.Component {\n  render() {\n    return (\n      <div>\n        <ToggleableMenu title=\"First Menu\">\n          <p>Some content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Second Menu\">\n          <p>Another content</p>\n        </ToggleableMenu>\n        <ToggleableMenu title=\"Third Menu\">\n          <p>More content</p>\n        </ToggleableMenu>\n      </div>\n    )\n  }\n}\n```\n\nå›è°ƒæ¸²æŸ“ç»„ä»¶ (Render Callbacks) å’Œé«˜é˜¶å‡½æ•°ä½¿æˆ‘ä»¬çš„ç»„ä»¶æ›´åŠ çµæ´»ï¼ŒæŒæ¡å’Œé€‚åº”èµ·æ¥å…·æœ‰ä¸€å®šçš„éš¾åº¦ï¼Œéœ€è¦åå¤å­¦ä¹ å’Œæ¶ˆåŒ–ã€‚\n","slug":"React-ç»„ä»¶æ¨¡å¼","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidj3000gu4q9ne5hmg1x","content":"<p>ä½¿ç”¨ React å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œ React æ˜¯ Facebook å…¬å¸å¼€å‘çš„ç”¨äºæ„å»ºç½‘é¡µç•Œé¢çš„ UI åº“ã€‚æœ¬æ–‡è¯•å›¾æ€»ç»“å®è·µä¸­æ‰€å­¦åˆ°çš„ä¸€äº›æ¨¡å¼ï¼ŒåŒæ—¶å¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°å³å°†è¿ˆå…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…ã€‚</p>\n<a id=\"more\"></a>\n<h3 id=\"æ¦‚è¦\"><a href=\"#æ¦‚è¦\" class=\"headerlink\" title=\"æ¦‚è¦\"></a>æ¦‚è¦</h3><ul>\n<li>æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶</li>\n<li>å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶</li>\n<li>é«˜é˜¶ç»„ä»¶ vs å›è°ƒæ¸²æŸ“ç»„ä»¶</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/40128970-a333542c-5965-11e8-8505-d1284d2759b1.png\" alt=\"image\"></p>\n<h3 id=\"æœ‰çŠ¶æ€ç»„ä»¶-vs-æ— çŠ¶æ€ç»„ä»¶\"><a href=\"#æœ‰çŠ¶æ€ç»„ä»¶-vs-æ— çŠ¶æ€ç»„ä»¶\" class=\"headerlink\" title=\"æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶\"></a>æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶</h3><p>æ­£å¦‚ WEB æœåŠ¡æœ‰é™æ€å’ŒåŠ¨æ€ä¹‹åˆ†ï¼ŒReact ç»„ä»¶ä¹Ÿæœ‰æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€çš„åŒºåˆ†ã€‚</p>\n<ul>\n<li>æœ‰çŠ¶æ€ç»„ä»¶ï¼šåœ¨åº”ç”¨ä¸­ç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªèº«çŠ¶æ€å¹¶æ“çºµå®ƒï¼›</li>\n<li>æ— çŠ¶æ€ç»„ä»¶ï¼šåªæ¥æ”¶å±æ€§è¿›è¡Œæ•ˆæœå‘ˆç°ã€‚</li>\n</ul>\n<p>ä¸€ä¸ªç®€å•çš„æ— çŠ¶æ€ç»„ä»¶ï¼Œåªå—å±æ€§æ§åˆ¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Button = <span class=\"function\"><span class=\"params\">props</span> =&gt;</span> (</span><br><span class=\"line\">  &lt;button onClick=&#123;props.onClick&#125;&gt;</span><br><span class=\"line\">    &#123;props.text&#125;</span><br><span class=\"line\">  &lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">);</span></span><br></pre></td></tr></table></figure>\n<p>ä¸€ä¸ªå…·æœ‰è®¡æ•°åŠŸèƒ½çš„æŒ‰é’®ç»„ä»¶ (å¤ç”¨ä¸Šé¢ Button ç»„ä»¶)</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ButtonCounter</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>()</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">clicks</span>: <span class=\"number\">0</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.handleClick = <span class=\"keyword\">this</span>.handleClick.bind(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  handleClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.setState(&#123;<span class=\"attr\">clicks</span>: <span class=\"keyword\">this</span>.state.clicks + <span class=\"number\">1</span>&#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;Button</span><br><span class=\"line\">        onClick=&#123;<span class=\"keyword\">this</span>.handleClick&#125;</span><br><span class=\"line\">        text=&#123;<span class=\"string\">`You've clicked me <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.state.clicks&#125;</span> times!`</span>&#125;</span><br><span class=\"line\">      /&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ­£å¦‚ä¸Šé¢ä¸¤ä¸ª Demo æ‰€ç¤ºï¼Œç¬¬äºŒä¸ªç»„ä»¶çš„ <code>constructor</code> å…·æœ‰çŠ¶æ€çš„å®šä¹‰ï¼Œç¬¬ä¸€ä¸ªç»„ä»¶åªæ˜¯å•çº¯åœ°æ¸²æŸ“å±æ€§æ–‡å­—ã€‚æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„åˆ’åˆ†çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å®ƒå¯¹äºç»„ä»¶å¤ç”¨å…·æœ‰é‡å¤§æ„ä¹‰ã€‚</p>\n<h3 id=\"å®¹å™¨ç»„ä»¶-vs-å±•ç¤ºç»„ä»¶\"><a href=\"#å®¹å™¨ç»„ä»¶-vs-å±•ç¤ºç»„ä»¶\" class=\"headerlink\" title=\"å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶\"></a>å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶</h3><p>å½“ç»„ä»¶éœ€è¦è·å–å¤–éƒ¨æ•°æ®æ—¶ï¼Œæˆ‘ä»¬åˆå¯ä»¥å°†ç»„ä»¶åˆ’åˆ†ä¸ºä¸¤ç§æ–°çš„ç±»å‹ã€‚å®¹å™¨ç»„ä»¶è´Ÿè´£è·å–æ•°æ®ï¼Œå®ƒå¸¸å¸¸æ˜¯è¶…å‡ºäº† React èŒƒç•´çš„ï¼Œå¦‚ä½¿ç”¨ Redux æˆ– Relay è¿›è¡Œäº†ç»‘å®šã€‚å¯¹æ¯”è€Œè¨€ï¼Œå±•ç¤ºå‹ç»„ä»¶ä¸ä¾èµ–äºç¨‹åºå…¶ä»–éƒ¨åˆ†ï¼Œå®ƒåªå’Œè‡ªèº«çŠ¶æ€æˆ–å±æ€§æœ‰å…³ã€‚ä¸‹é¢æˆ‘ä»¬å®ç°ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨çš„å±•ç¤ºç»„ä»¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> UserList = <span class=\"function\"><span class=\"params\">props</span> =&gt;</span></span><br><span class=\"line\">  &lt;ul&gt;</span><br><span class=\"line\">    &#123;props.users.map(<span class=\"function\"><span class=\"params\">u</span> =&gt;</span> (</span><br><span class=\"line\">      &lt;li&gt;&#123;u.name&#125; â€” &#123;u.age&#125; years old&lt;<span class=\"regexp\">/li&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    ))&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;/u</span>l&gt;</span><br></pre></td></tr></table></figure>\n<p>å®¹å™¨ç»„ä»¶å¯ä»¥ç”¨æ¥æ›´æ–°ç”¨æˆ·åˆ—è¡¨çš„å±•ç¤º:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserListContainer</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>()</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">users</span>: [] &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  componentDidMount() &#123;</span><br><span class=\"line\">    fetchUsers(<span class=\"function\"><span class=\"params\">users</span> =&gt;</span> <span class=\"keyword\">this</span>.setState(&#123; users &#125;))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">UserList</span> <span class=\"attr\">users</span>=<span class=\"string\">&#123;this.state.users&#125;</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">  &#125;</span></span><br><span class=\"line\"><span class=\"xml\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ç§åˆ†ç±»å°†æ•°æ®è·å–å’Œæ¸²æŸ“çš„é€»è¾‘åˆ†å¼€ï¼Œè¿›è€Œä½¿ç”¨æˆ·åˆ—è¡¨ç»„ä»¶å¯ä»¥å¤ç”¨ã€‚</p>\n<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¯¥æ¨¡å¼çš„ä¿¡æ¯ï¼Œ<a href=\"https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡æ–‡ç« </a>å¯¹å®ƒè¿›è¡Œäº†è¯¦ç»†çš„è§£é‡Šã€‚</p>\n<h3 id=\"é«˜é˜¶ç»„ä»¶\"><a href=\"#é«˜é˜¶ç»„ä»¶\" class=\"headerlink\" title=\"é«˜é˜¶ç»„ä»¶\"></a>é«˜é˜¶ç»„ä»¶</h3><p>å½“ä½ æƒ³å¤ç”¨ç»„ä»¶é€»è¾‘æ—¶ï¼Œé«˜é˜¶ç»„ä»¶éå¸¸æœ‰ç”¨ã€‚é«˜é˜¶ç»„ä»¶ï¼šæ˜¯å°†ç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›æ–°ç»„ä»¶çš„ JS å‡½æ•°ã€‚</p>\n<p>å‡è®¾ä½ éœ€è¦æ„å»ºä¸€ä¸ªå¯æ‰©å±•èœå•ç»„ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºéšè—å­ç»„ä»¶å†…å®¹ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¥å®ç°:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">makeToggleable</span>(<span class=\"params\">Clickable</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">super</span>()</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.toggle = <span class=\"keyword\">this</span>.toggle.bind(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">show</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    toggle() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.setState(<span class=\"function\"><span class=\"params\">prevState</span> =&gt;</span> (&#123; <span class=\"attr\">show</span>: !prevState.show &#125;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    render() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (</span><br><span class=\"line\">        &lt;div&gt;</span><br><span class=\"line\">          &lt;Clickable</span><br><span class=\"line\">            &#123;...this.props&#125;</span><br><span class=\"line\">            onClick=&#123;<span class=\"keyword\">this</span>.toggle&#125;</span><br><span class=\"line\">          /&gt;</span><br><span class=\"line\">          &#123;<span class=\"keyword\">this</span>.state.show &amp;&amp; <span class=\"keyword\">this</span>.props.children&#125;</span><br><span class=\"line\">        &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      )</span></span><br><span class=\"line\"><span class=\"regexp\">    &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ç§æ–¹æ³•å…è®¸æˆ‘ä»¬ä½¿ç”¨ ES7 è£…é¥°å™¨è¯­æ³•å°†é€»è¾‘åº”ç”¨äº ToggleableMenu ç»„ä»¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@makeToggleable</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ToggleableMenu</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div onClick=&#123;<span class=\"keyword\">this</span>.props.onClick&#125;&gt;</span><br><span class=\"line\">        &lt;h1&gt;&#123;<span class=\"keyword\">this</span>.props.title&#125;&lt;<span class=\"regexp\">/h1&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;/</span>div&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å­ç»„ä»¶ä¼ é€’ç»™ ToggleableMenu ç»„ä»¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Menu</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"First Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Some content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Second Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Another content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Third Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;More content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    )</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>å¦‚æœä½ ç†Ÿæ‚‰ Redux çš„ connect å‡½æ•°æˆ–è€… React Router çš„ withRouter å‡½æ•°ï¼Œé‚£ä¹ˆä½ å·²ç»ä½¿ç”¨è¿‡é«˜é˜¶ç»„ä»¶äº†ã€‚</p>\n<h3 id=\"å›è°ƒæ¸²æŸ“ç»„ä»¶\"><a href=\"#å›è°ƒæ¸²æŸ“ç»„ä»¶\" class=\"headerlink\" title=\"å›è°ƒæ¸²æŸ“ç»„ä»¶\"></a>å›è°ƒæ¸²æŸ“ç»„ä»¶</h3><p>å¦ä¸€ä¸ªæ¯”è¾ƒé«˜ç«¯çš„å¤ç”¨ç»„ä»¶é€»è¾‘çš„æ–¹æ³•æ˜¯å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„ <code>props.children</code>ï¼Œè¯¥æ–¹æ³•ä¹Ÿç§°ä¸º <strong>Function as Child Components</strong>ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<strong> æ¸²æŸ“å›è°ƒ </strong>æ¥é‡æ–°å®ç°ä¸Šé¢çš„å¯æ‰©å±• Menu:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Toggleable</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>()</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.toggle = <span class=\"keyword\">this</span>.toggle.bind(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">show</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  toggle() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.setState(<span class=\"function\"><span class=\"params\">prevState</span> =&gt;</span> (&#123; <span class=\"attr\">show</span>: !prevState.show &#125;))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.props.children(<span class=\"keyword\">this</span>.state.show, <span class=\"keyword\">this</span>.toggle)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„å­çº§è¿›è¡Œä¼ é€’:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Toggleable&gt;</span><br><span class=\"line\">  &#123;(show, onClick) =&gt; (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;div onClick=&#123;onClick&#125;&gt;</span><br><span class=\"line\">        &lt;h1&gt;&#123;props.title&#125;&lt;<span class=\"regexp\">/h1&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;/</span>div&gt;</span><br><span class=\"line\">      &#123;show &amp;&amp; props.children&#125;</span><br><span class=\"line\">    &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  )&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>Toggleable&gt;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„ä»£ç å·²ç»å°†ä¸€ä¸ªå‡½æ•°ä½œä¸º<strong> å­ç»„ä»¶ </strong>ï¼Œä½†æ˜¯ï¼Œè‹¥æˆ‘ä»¬æƒ³å¤ç”¨ä¸Šè¿°é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè½¬æ¢é€»è¾‘çš„æ–°ç»„ä»¶ï¼š</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ToggleableMenu = <span class=\"function\"><span class=\"params\">props</span> =&gt;</span></span><br><span class=\"line\">  &lt;Toggleable&gt;</span><br><span class=\"line\">    &#123;(show, onClick) =&gt; (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;div onClick=&#123;onClick&#125;&gt;</span><br><span class=\"line\">          &lt;h1&gt;&#123;props.title&#125;&lt;<span class=\"regexp\">/h1&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>div&gt;</span><br><span class=\"line\">        &#123;show &amp;&amp; props.children&#125;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    )&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;/</span>Toggleable&gt;</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬ä½¿ç”¨ Render Callbacks å®ç°çš„å¯æ‰©å±•çš„ Menu ç»„ä»¶å¦‚ä¸‹:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Menu</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"First Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Some content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Second Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Another content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Third Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;More content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    )</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>å›è°ƒæ¸²æŸ“ç»„ä»¶ (Render Callbacks) å’Œé«˜é˜¶å‡½æ•°ä½¿æˆ‘ä»¬çš„ç»„ä»¶æ›´åŠ çµæ´»ï¼ŒæŒæ¡å’Œé€‚åº”èµ·æ¥å…·æœ‰ä¸€å®šçš„éš¾åº¦ï¼Œéœ€è¦åå¤å­¦ä¹ å’Œæ¶ˆåŒ–ã€‚</p>\n","site":{"data":{}},"excerpt":"<p>ä½¿ç”¨ React å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œ React æ˜¯ Facebook å…¬å¸å¼€å‘çš„ç”¨äºæ„å»ºç½‘é¡µç•Œé¢çš„ UI åº“ã€‚æœ¬æ–‡è¯•å›¾æ€»ç»“å®è·µä¸­æ‰€å­¦åˆ°çš„ä¸€äº›æ¨¡å¼ï¼ŒåŒæ—¶å¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°å³å°†è¿ˆå…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…ã€‚</p>","more":"<h3 id=\"æ¦‚è¦\"><a href=\"#æ¦‚è¦\" class=\"headerlink\" title=\"æ¦‚è¦\"></a>æ¦‚è¦</h3><ul>\n<li>æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶</li>\n<li>å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶</li>\n<li>é«˜é˜¶ç»„ä»¶ vs å›è°ƒæ¸²æŸ“ç»„ä»¶</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/40128970-a333542c-5965-11e8-8505-d1284d2759b1.png\" alt=\"image\"></p>\n<h3 id=\"æœ‰çŠ¶æ€ç»„ä»¶-vs-æ— çŠ¶æ€ç»„ä»¶\"><a href=\"#æœ‰çŠ¶æ€ç»„ä»¶-vs-æ— çŠ¶æ€ç»„ä»¶\" class=\"headerlink\" title=\"æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶\"></a>æœ‰çŠ¶æ€ç»„ä»¶ vs æ— çŠ¶æ€ç»„ä»¶</h3><p>æ­£å¦‚ WEB æœåŠ¡æœ‰é™æ€å’ŒåŠ¨æ€ä¹‹åˆ†ï¼ŒReact ç»„ä»¶ä¹Ÿæœ‰æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€çš„åŒºåˆ†ã€‚</p>\n<ul>\n<li>æœ‰çŠ¶æ€ç»„ä»¶ï¼šåœ¨åº”ç”¨ä¸­ç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªèº«çŠ¶æ€å¹¶æ“çºµå®ƒï¼›</li>\n<li>æ— çŠ¶æ€ç»„ä»¶ï¼šåªæ¥æ”¶å±æ€§è¿›è¡Œæ•ˆæœå‘ˆç°ã€‚</li>\n</ul>\n<p>ä¸€ä¸ªç®€å•çš„æ— çŠ¶æ€ç»„ä»¶ï¼Œåªå—å±æ€§æ§åˆ¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Button = <span class=\"function\"><span class=\"params\">props</span> =&gt;</span> (</span><br><span class=\"line\">  &lt;button onClick=&#123;props.onClick&#125;&gt;</span><br><span class=\"line\">    &#123;props.text&#125;</span><br><span class=\"line\">  &lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">);</span></span><br></pre></td></tr></table></figure>\n<p>ä¸€ä¸ªå…·æœ‰è®¡æ•°åŠŸèƒ½çš„æŒ‰é’®ç»„ä»¶ (å¤ç”¨ä¸Šé¢ Button ç»„ä»¶)</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ButtonCounter</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>()</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">clicks</span>: <span class=\"number\">0</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.handleClick = <span class=\"keyword\">this</span>.handleClick.bind(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  handleClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.setState(&#123;<span class=\"attr\">clicks</span>: <span class=\"keyword\">this</span>.state.clicks + <span class=\"number\">1</span>&#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;Button</span><br><span class=\"line\">        onClick=&#123;<span class=\"keyword\">this</span>.handleClick&#125;</span><br><span class=\"line\">        text=&#123;<span class=\"string\">`You've clicked me <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.state.clicks&#125;</span> times!`</span>&#125;</span><br><span class=\"line\">      /&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ­£å¦‚ä¸Šé¢ä¸¤ä¸ª Demo æ‰€ç¤ºï¼Œç¬¬äºŒä¸ªç»„ä»¶çš„ <code>constructor</code> å…·æœ‰çŠ¶æ€çš„å®šä¹‰ï¼Œç¬¬ä¸€ä¸ªç»„ä»¶åªæ˜¯å•çº¯åœ°æ¸²æŸ“å±æ€§æ–‡å­—ã€‚æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„åˆ’åˆ†çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å®ƒå¯¹äºç»„ä»¶å¤ç”¨å…·æœ‰é‡å¤§æ„ä¹‰ã€‚</p>\n<h3 id=\"å®¹å™¨ç»„ä»¶-vs-å±•ç¤ºç»„ä»¶\"><a href=\"#å®¹å™¨ç»„ä»¶-vs-å±•ç¤ºç»„ä»¶\" class=\"headerlink\" title=\"å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶\"></a>å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶</h3><p>å½“ç»„ä»¶éœ€è¦è·å–å¤–éƒ¨æ•°æ®æ—¶ï¼Œæˆ‘ä»¬åˆå¯ä»¥å°†ç»„ä»¶åˆ’åˆ†ä¸ºä¸¤ç§æ–°çš„ç±»å‹ã€‚å®¹å™¨ç»„ä»¶è´Ÿè´£è·å–æ•°æ®ï¼Œå®ƒå¸¸å¸¸æ˜¯è¶…å‡ºäº† React èŒƒç•´çš„ï¼Œå¦‚ä½¿ç”¨ Redux æˆ– Relay è¿›è¡Œäº†ç»‘å®šã€‚å¯¹æ¯”è€Œè¨€ï¼Œå±•ç¤ºå‹ç»„ä»¶ä¸ä¾èµ–äºç¨‹åºå…¶ä»–éƒ¨åˆ†ï¼Œå®ƒåªå’Œè‡ªèº«çŠ¶æ€æˆ–å±æ€§æœ‰å…³ã€‚ä¸‹é¢æˆ‘ä»¬å®ç°ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨çš„å±•ç¤ºç»„ä»¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> UserList = <span class=\"function\"><span class=\"params\">props</span> =&gt;</span></span><br><span class=\"line\">  &lt;ul&gt;</span><br><span class=\"line\">    &#123;props.users.map(<span class=\"function\"><span class=\"params\">u</span> =&gt;</span> (</span><br><span class=\"line\">      &lt;li&gt;&#123;u.name&#125; â€” &#123;u.age&#125; years old&lt;<span class=\"regexp\">/li&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    ))&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;/u</span>l&gt;</span><br></pre></td></tr></table></figure>\n<p>å®¹å™¨ç»„ä»¶å¯ä»¥ç”¨æ¥æ›´æ–°ç”¨æˆ·åˆ—è¡¨çš„å±•ç¤º:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserListContainer</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>()</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">users</span>: [] &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  componentDidMount() &#123;</span><br><span class=\"line\">    fetchUsers(<span class=\"function\"><span class=\"params\">users</span> =&gt;</span> <span class=\"keyword\">this</span>.setState(&#123; users &#125;))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">UserList</span> <span class=\"attr\">users</span>=<span class=\"string\">&#123;this.state.users&#125;</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">  &#125;</span></span><br><span class=\"line\"><span class=\"xml\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ç§åˆ†ç±»å°†æ•°æ®è·å–å’Œæ¸²æŸ“çš„é€»è¾‘åˆ†å¼€ï¼Œè¿›è€Œä½¿ç”¨æˆ·åˆ—è¡¨ç»„ä»¶å¯ä»¥å¤ç”¨ã€‚</p>\n<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¯¥æ¨¡å¼çš„ä¿¡æ¯ï¼Œ<a href=\"https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0\" target=\"_blank\" rel=\"noopener\">è¿™ç¯‡æ–‡ç« </a>å¯¹å®ƒè¿›è¡Œäº†è¯¦ç»†çš„è§£é‡Šã€‚</p>\n<h3 id=\"é«˜é˜¶ç»„ä»¶\"><a href=\"#é«˜é˜¶ç»„ä»¶\" class=\"headerlink\" title=\"é«˜é˜¶ç»„ä»¶\"></a>é«˜é˜¶ç»„ä»¶</h3><p>å½“ä½ æƒ³å¤ç”¨ç»„ä»¶é€»è¾‘æ—¶ï¼Œé«˜é˜¶ç»„ä»¶éå¸¸æœ‰ç”¨ã€‚é«˜é˜¶ç»„ä»¶ï¼šæ˜¯å°†ç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›æ–°ç»„ä»¶çš„ JS å‡½æ•°ã€‚</p>\n<p>å‡è®¾ä½ éœ€è¦æ„å»ºä¸€ä¸ªå¯æ‰©å±•èœå•ç»„ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºéšè—å­ç»„ä»¶å†…å®¹ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¥å®ç°:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">makeToggleable</span>(<span class=\"params\">Clickable</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">super</span>()</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.toggle = <span class=\"keyword\">this</span>.toggle.bind(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">show</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    toggle() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.setState(<span class=\"function\"><span class=\"params\">prevState</span> =&gt;</span> (&#123; <span class=\"attr\">show</span>: !prevState.show &#125;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    render() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (</span><br><span class=\"line\">        &lt;div&gt;</span><br><span class=\"line\">          &lt;Clickable</span><br><span class=\"line\">            &#123;...this.props&#125;</span><br><span class=\"line\">            onClick=&#123;<span class=\"keyword\">this</span>.toggle&#125;</span><br><span class=\"line\">          /&gt;</span><br><span class=\"line\">          &#123;<span class=\"keyword\">this</span>.state.show &amp;&amp; <span class=\"keyword\">this</span>.props.children&#125;</span><br><span class=\"line\">        &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      )</span></span><br><span class=\"line\"><span class=\"regexp\">    &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>è¿™ç§æ–¹æ³•å…è®¸æˆ‘ä»¬ä½¿ç”¨ ES7 è£…é¥°å™¨è¯­æ³•å°†é€»è¾‘åº”ç”¨äº ToggleableMenu ç»„ä»¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@makeToggleable</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ToggleableMenu</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div onClick=&#123;<span class=\"keyword\">this</span>.props.onClick&#125;&gt;</span><br><span class=\"line\">        &lt;h1&gt;&#123;<span class=\"keyword\">this</span>.props.title&#125;&lt;<span class=\"regexp\">/h1&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;/</span>div&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å­ç»„ä»¶ä¼ é€’ç»™ ToggleableMenu ç»„ä»¶:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Menu</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"First Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Some content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Second Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Another content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Third Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;More content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    )</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>å¦‚æœä½ ç†Ÿæ‚‰ Redux çš„ connect å‡½æ•°æˆ–è€… React Router çš„ withRouter å‡½æ•°ï¼Œé‚£ä¹ˆä½ å·²ç»ä½¿ç”¨è¿‡é«˜é˜¶ç»„ä»¶äº†ã€‚</p>\n<h3 id=\"å›è°ƒæ¸²æŸ“ç»„ä»¶\"><a href=\"#å›è°ƒæ¸²æŸ“ç»„ä»¶\" class=\"headerlink\" title=\"å›è°ƒæ¸²æŸ“ç»„ä»¶\"></a>å›è°ƒæ¸²æŸ“ç»„ä»¶</h3><p>å¦ä¸€ä¸ªæ¯”è¾ƒé«˜ç«¯çš„å¤ç”¨ç»„ä»¶é€»è¾‘çš„æ–¹æ³•æ˜¯å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„ <code>props.children</code>ï¼Œè¯¥æ–¹æ³•ä¹Ÿç§°ä¸º <strong>Function as Child Components</strong>ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<strong> æ¸²æŸ“å›è°ƒ </strong>æ¥é‡æ–°å®ç°ä¸Šé¢çš„å¯æ‰©å±• Menu:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Toggleable</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>()</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.toggle = <span class=\"keyword\">this</span>.toggle.bind(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;<span class=\"attr\">show</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  toggle() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.setState(<span class=\"function\"><span class=\"params\">prevState</span> =&gt;</span> (&#123; <span class=\"attr\">show</span>: !prevState.show &#125;))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.props.children(<span class=\"keyword\">this</span>.state.show, <span class=\"keyword\">this</span>.toggle)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•°ä½œä¸ºç»„ä»¶çš„å­çº§è¿›è¡Œä¼ é€’:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Toggleable&gt;</span><br><span class=\"line\">  &#123;(show, onClick) =&gt; (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;div onClick=&#123;onClick&#125;&gt;</span><br><span class=\"line\">        &lt;h1&gt;&#123;props.title&#125;&lt;<span class=\"regexp\">/h1&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;/</span>div&gt;</span><br><span class=\"line\">      &#123;show &amp;&amp; props.children&#125;</span><br><span class=\"line\">    &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  )&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>Toggleable&gt;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„ä»£ç å·²ç»å°†ä¸€ä¸ªå‡½æ•°ä½œä¸º<strong> å­ç»„ä»¶ </strong>ï¼Œä½†æ˜¯ï¼Œè‹¥æˆ‘ä»¬æƒ³å¤ç”¨ä¸Šè¿°é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè½¬æ¢é€»è¾‘çš„æ–°ç»„ä»¶ï¼š</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ToggleableMenu = <span class=\"function\"><span class=\"params\">props</span> =&gt;</span></span><br><span class=\"line\">  &lt;Toggleable&gt;</span><br><span class=\"line\">    &#123;(show, onClick) =&gt; (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;div onClick=&#123;onClick&#125;&gt;</span><br><span class=\"line\">          &lt;h1&gt;&#123;props.title&#125;&lt;<span class=\"regexp\">/h1&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>div&gt;</span><br><span class=\"line\">        &#123;show &amp;&amp; props.children&#125;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    )&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;/</span>Toggleable&gt;</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬ä½¿ç”¨ Render Callbacks å®ç°çš„å¯æ‰©å±•çš„ Menu ç»„ä»¶å¦‚ä¸‹:</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Menu</span> <span class=\"keyword\">extends</span> <span class=\"title\">React</span>.<span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"First Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Some content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Second Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;Another content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">        &lt;ToggleableMenu title=<span class=\"string\">\"Third Menu\"</span>&gt;</span><br><span class=\"line\">          &lt;p&gt;More content&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">        &lt;/</span>ToggleableMenu&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    )</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>å›è°ƒæ¸²æŸ“ç»„ä»¶ (Render Callbacks) å’Œé«˜é˜¶å‡½æ•°ä½¿æˆ‘ä»¬çš„ç»„ä»¶æ›´åŠ çµæ´»ï¼ŒæŒæ¡å’Œé€‚åº”èµ·æ¥å…·æœ‰ä¸€å®šçš„éš¾åº¦ï¼Œéœ€è¦åå¤å­¦ä¹ å’Œæ¶ˆåŒ–ã€‚</p>"},{"title":"Why Immutable Data?","date":"2018-05-05T13:14:23.000Z","comments":1,"_content":"ä»€ä¹ˆæ˜¯ä¸å¯å˜æ•°æ®, å¦‚ä½•ç†è§£ä¸å¯å˜æ•°æ®, ä¸å¯å˜æ•°æ®åœ¨é¡¹ç›®ä¸­çš„å®è·µ. å¼„æ¸…æ¥šäº†è¿™äº›é—®é¢˜, ä½ æ‰èƒ½æ›´å¥½çš„å¤„ç†é¡¹ç›®ä¸­ä¸€äº›è°ƒä¼˜é—®é¢˜. æ¯”å¦‚ React æ€§èƒ½ä¼˜åŒ–ç­‰. ä¸€èµ·æ¥å­¦ä¹ ä¸‹å§! ğŸ‘¨ğŸ¼â€ğŸ’»\n\n<!-- more -->\n## What\n\n> ***Immutable Data*** æ˜¯æŒ‡ä¸€æ—¦è¢«åˆ›é€ åå°±ä¸å¯ä»¥è¢«æ”¹å˜çš„æ•°æ®, é€šè¿‡ä½¿ç”¨ Immutable Data, å¯ä»¥è®©æˆ‘ä»¬æ›´å®¹æ˜“çš„å»å¤„ç†ç¼“å­˜ã€å›é€€ã€æ•°æ®å˜åŒ–æ£€æµ‹ç­‰é—®é¢˜, ç®€åŒ–æˆ‘ä»¬çš„å¼€å‘.\n\n\n![image](https://user-images.githubusercontent.com/15377484/39663322-c4bb61ae-50a3-11e8-8267-4c2a80c00af7.png)\n\n\n## Why\nåœ¨åŸç”Ÿ JS ä¸­, å­˜åœ¨ä¸¤ç§æ•°æ®ç±»å‹:\n\n- é™æ€æ•°æ®ç±»å‹\n- å¼•ç”¨æ•°æ®ç±»å‹\n\nå¼•ç”¨ç±»å‹æ•°æ®ç»“æ„éå¸¸çµæ´», èŠ‚çº¦å†…å­˜, èƒ½ç»™å¼€å‘å¸¦æ¥ä¸å°‘ä¾¿åˆ©. ä½†ä¸æ­¤åŒæ—¶ä¹Ÿäº§ç”Ÿäº†ä¸€äº›å‰¯ä½œç”¨:\n\n#### Case 1:\n```js\nlet obj = { count: 1 };\nlet copyObj = obj;\ncopyObj.count = 2;\n\nconsole.log(copyObj.count); // => 2\nconsole.log(obj.count); // => 2, è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„\n```\n#### Case 2:\n```js\nlet obj2 = { count: 1 };\n\n// å›¢é˜Ÿåä½œ, å¤§å®¶éƒ½åœ¨ç”¨è¿™ä¸ª obj2\nunKnowFunction(obj2);\nconsole.log(obj2.count); // èƒ½ä¿è¯è¿™ä¸ªç»“æœä¸€å®šæ˜¯1å—?\n```\n\né’ˆå¯¹ä»¥ä¸Šå¼•ç”¨ç±»å‹äº§ç”Ÿçš„å‰¯ä½œç”¨, æœ‰äººæå‡ºäº† ***æ·±åº¦æ‹·è´*** (Deep Clone)çš„æ–¹æ³•, å®ç°ä»£ç å¦‚ä¸‹:\n```js\nfunction isObject(obj) {\n  return typeof obj === 'object';\n}\n\nfunction isArray(arr) {\n  return Array.isArray(arr);\n}\n\nfunction deepClone(obj) {\n  if (!isObject(obj))  return obj;\n  var cloneObj = isArray(obj) ? [] : {};\n\n  for(var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      var value = obj[key];\n      var copy = value;\n\n      if (isObject(value)) {\n        // è¿™é‡Œä½¿ç”¨äº†é€’å½’\n        cloneObj[key] = deepClone(value);\n      } else {\n        cloneObj[key] = value;\n      }\n    }\n  }\n  return cloneObj;\n}\n```\n\nç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `deepClone` è¿™ä¸ªæ–¹æ³•æ¥è§£å†³æ–‡ç« ä¸€å¼€å¤´çš„é—®é¢˜äº†:\n```js\nlet obj = {\n  age: 5,\n  list: [1, 2, 3]\n}\n\n// æ·±æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, ä¸¤è€…äº’ç›¸ç‹¬ç«‹, ä¸å­˜åœ¨å¼•ç”¨å…³ç³»\nlet trueCopyObj = deepClone(obj);\nconsole.log(obj.list === trueCopyObj.list); // => false, è¿™æ˜¯æˆ‘ä»¬æœŸæœ›çš„\n\n// ä½†æ˜¯åˆæœ‰ä¸€ä¸ªé—®é¢˜, æˆ‘åªæ˜¯æƒ³æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, æ”¹ä¸€ä¸‹ `age`\nlet obj2 = deepClone(obj);\nobj2.age = 6;\n// éš¾ä¸æˆå‰©ä¸‹çš„ä¸€å †å¼•ç”¨ç±»å‹çš„å±æ€§éƒ½è¦é€’å½’åšä¸€æ¬¡æ·±æ‹·è´?\n// æ‰€ä»¥è¿™æ˜æ˜¾æ˜¯å¤šä½™çš„, å¹¶ä¸”å­˜åœ¨ä¸¥é‡çš„æ€§èƒ½é—®é¢˜\n```\n\nåœ¨åŸç”Ÿ JavaScript ä¸­å®ç°æ•°æ®ä¸å¯å˜, æœ‰2ä¸ªåŠæ³•:\n\n- ES6: `const`\n- ES5: `Object.freeze`\n\nä½†æ˜¯è¿™ä¸¤ç§éƒ½æ˜¯æµ…å¤„ç†, é‡åˆ°æ·±å±‚æ¬¡çš„æ•°æ®ç»“æ„, å°±éœ€è¦é€’å½’å¤„ç†, åˆä¼šå­˜åœ¨æ€§èƒ½ä¸Šçš„é—®é¢˜.\n\n## How\n\né’ˆå¯¹ä»¥ä¸Šä¸€ç³»åˆ—éœ€æ±‚, æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„æ¥å¤„ç†, å¯¹åº”çš„å®ç°åº“æœ‰:\n- [facebook/immutable-js](https://github.com/facebook/immutable-js)\n- [rtfeldman/seamless-immutable](https://github.com/rtfeldman/seamless-immutable)\n\n\nImmutable.js ä¸»è¦ç‰¹ç‚¹:\n- ç¨³å®šæ•°æ®ç»“æ„ (Persistent Data Structure), æ¯æ¬¡è¿”å›æ–°çš„å¯¹è±¡, ä¸å­˜åœ¨å¼•ç”¨\n- ç»“æ„å…±äº« (Structural Sharing), åŸºäºå“ˆå¸Œæ˜ å°„æ ‘, å¯ä»¥å®ç°éƒ¨åˆ†ç»“æ„å…±äº«\n- æ”¯æŒå»¶è¿Ÿæ“ä½œ (Support Lazy Operation)\n- å¼ºå¤§çš„ API (Power API)\n\né’ˆå¯¹ä»¥ä¸Šç‰¹ç‚¹, æˆ‘ä»¬ç”¨ä¸€äº›ä»£ç å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹:\n```js\n/**\n * ç¨³å®šæ•°æ®ç»“æ„\n */\n\nlet obj = {count: 1};\nlet map = Immutable.fromJS(obj);\nlet map2 = map.set('count', 2);\n\nconsole.log(map.get('count')); // => 1\nconsole.log(map2.get('count')); // => 2\n```\n\n```js\n/**\n * ç»“æ„å…±äº«\n */\n\nlet obj = {\n  count: 1,\n  list: [1, 2, 3, 4, 5]\n}\nlet map1 = Immutable.fromJS(obj);\nlet map2 = map1.set('count', 2);\n\nconsole.log(map1.list === map2.list); // true\n```\n\n<div style=\"width: 300px; \">![image](https://user-images.githubusercontent.com/15377484/39665040-d92a0764-50bf-11e8-84e3-ad83cf758acd.gif)</div>\n\nè¿™å¼  GIF å¾ˆå½¢è±¡çš„è§£é‡Šäº† `ç»“æ„å…±äº«` ğŸ‘\n\n```js\n/**\n * å¼ºå¤§çš„ API\n */\n\nlet obj = {\n  a: {\n    b: {\n      list: [1, 2, 3]\n    }\n  }\n};\nlet map = Immutable.fromJS(obj);\nlet map2 = Immutable.updateIn(['a', 'b', 'list'], (list) => {\n  return list.push(4);\n});\n\nconsole.log(map2.getIn(['a', 'b', 'list'])); // => List [ 1, 2, 3, 4 ]\n```\n\nè¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±ä¸ä¸¾ä¾‹å­äº†, è¶…çº²! ğŸ˜\n\n## å‚è€ƒ\n- [Immutable è¯¦è§£åŠ React ä¸­å®è·µ](https://github.com/camsong/blog/issues/3)\n- [æµ…åˆå¹¶ (shallow merge) ä¾‹å­](https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge/28248548)\n- [Lodash merge æ–¹æ³•](https://lodash.com/docs/4.17.10#merge)\n","source":"_posts/Why-Immutable-Data.md","raw":"---\ntitle: Why Immutable Data?\ndate: 2018-05-05 21:14:23\ntags:\ncomments: true\n---\nä»€ä¹ˆæ˜¯ä¸å¯å˜æ•°æ®, å¦‚ä½•ç†è§£ä¸å¯å˜æ•°æ®, ä¸å¯å˜æ•°æ®åœ¨é¡¹ç›®ä¸­çš„å®è·µ. å¼„æ¸…æ¥šäº†è¿™äº›é—®é¢˜, ä½ æ‰èƒ½æ›´å¥½çš„å¤„ç†é¡¹ç›®ä¸­ä¸€äº›è°ƒä¼˜é—®é¢˜. æ¯”å¦‚ React æ€§èƒ½ä¼˜åŒ–ç­‰. ä¸€èµ·æ¥å­¦ä¹ ä¸‹å§! ğŸ‘¨ğŸ¼â€ğŸ’»\n\n<!-- more -->\n## What\n\n> ***Immutable Data*** æ˜¯æŒ‡ä¸€æ—¦è¢«åˆ›é€ åå°±ä¸å¯ä»¥è¢«æ”¹å˜çš„æ•°æ®, é€šè¿‡ä½¿ç”¨ Immutable Data, å¯ä»¥è®©æˆ‘ä»¬æ›´å®¹æ˜“çš„å»å¤„ç†ç¼“å­˜ã€å›é€€ã€æ•°æ®å˜åŒ–æ£€æµ‹ç­‰é—®é¢˜, ç®€åŒ–æˆ‘ä»¬çš„å¼€å‘.\n\n\n![image](https://user-images.githubusercontent.com/15377484/39663322-c4bb61ae-50a3-11e8-8267-4c2a80c00af7.png)\n\n\n## Why\nåœ¨åŸç”Ÿ JS ä¸­, å­˜åœ¨ä¸¤ç§æ•°æ®ç±»å‹:\n\n- é™æ€æ•°æ®ç±»å‹\n- å¼•ç”¨æ•°æ®ç±»å‹\n\nå¼•ç”¨ç±»å‹æ•°æ®ç»“æ„éå¸¸çµæ´», èŠ‚çº¦å†…å­˜, èƒ½ç»™å¼€å‘å¸¦æ¥ä¸å°‘ä¾¿åˆ©. ä½†ä¸æ­¤åŒæ—¶ä¹Ÿäº§ç”Ÿäº†ä¸€äº›å‰¯ä½œç”¨:\n\n#### Case 1:\n```js\nlet obj = { count: 1 };\nlet copyObj = obj;\ncopyObj.count = 2;\n\nconsole.log(copyObj.count); // => 2\nconsole.log(obj.count); // => 2, è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„\n```\n#### Case 2:\n```js\nlet obj2 = { count: 1 };\n\n// å›¢é˜Ÿåä½œ, å¤§å®¶éƒ½åœ¨ç”¨è¿™ä¸ª obj2\nunKnowFunction(obj2);\nconsole.log(obj2.count); // èƒ½ä¿è¯è¿™ä¸ªç»“æœä¸€å®šæ˜¯1å—?\n```\n\né’ˆå¯¹ä»¥ä¸Šå¼•ç”¨ç±»å‹äº§ç”Ÿçš„å‰¯ä½œç”¨, æœ‰äººæå‡ºäº† ***æ·±åº¦æ‹·è´*** (Deep Clone)çš„æ–¹æ³•, å®ç°ä»£ç å¦‚ä¸‹:\n```js\nfunction isObject(obj) {\n  return typeof obj === 'object';\n}\n\nfunction isArray(arr) {\n  return Array.isArray(arr);\n}\n\nfunction deepClone(obj) {\n  if (!isObject(obj))  return obj;\n  var cloneObj = isArray(obj) ? [] : {};\n\n  for(var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      var value = obj[key];\n      var copy = value;\n\n      if (isObject(value)) {\n        // è¿™é‡Œä½¿ç”¨äº†é€’å½’\n        cloneObj[key] = deepClone(value);\n      } else {\n        cloneObj[key] = value;\n      }\n    }\n  }\n  return cloneObj;\n}\n```\n\nç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `deepClone` è¿™ä¸ªæ–¹æ³•æ¥è§£å†³æ–‡ç« ä¸€å¼€å¤´çš„é—®é¢˜äº†:\n```js\nlet obj = {\n  age: 5,\n  list: [1, 2, 3]\n}\n\n// æ·±æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, ä¸¤è€…äº’ç›¸ç‹¬ç«‹, ä¸å­˜åœ¨å¼•ç”¨å…³ç³»\nlet trueCopyObj = deepClone(obj);\nconsole.log(obj.list === trueCopyObj.list); // => false, è¿™æ˜¯æˆ‘ä»¬æœŸæœ›çš„\n\n// ä½†æ˜¯åˆæœ‰ä¸€ä¸ªé—®é¢˜, æˆ‘åªæ˜¯æƒ³æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, æ”¹ä¸€ä¸‹ `age`\nlet obj2 = deepClone(obj);\nobj2.age = 6;\n// éš¾ä¸æˆå‰©ä¸‹çš„ä¸€å †å¼•ç”¨ç±»å‹çš„å±æ€§éƒ½è¦é€’å½’åšä¸€æ¬¡æ·±æ‹·è´?\n// æ‰€ä»¥è¿™æ˜æ˜¾æ˜¯å¤šä½™çš„, å¹¶ä¸”å­˜åœ¨ä¸¥é‡çš„æ€§èƒ½é—®é¢˜\n```\n\nåœ¨åŸç”Ÿ JavaScript ä¸­å®ç°æ•°æ®ä¸å¯å˜, æœ‰2ä¸ªåŠæ³•:\n\n- ES6: `const`\n- ES5: `Object.freeze`\n\nä½†æ˜¯è¿™ä¸¤ç§éƒ½æ˜¯æµ…å¤„ç†, é‡åˆ°æ·±å±‚æ¬¡çš„æ•°æ®ç»“æ„, å°±éœ€è¦é€’å½’å¤„ç†, åˆä¼šå­˜åœ¨æ€§èƒ½ä¸Šçš„é—®é¢˜.\n\n## How\n\né’ˆå¯¹ä»¥ä¸Šä¸€ç³»åˆ—éœ€æ±‚, æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„æ¥å¤„ç†, å¯¹åº”çš„å®ç°åº“æœ‰:\n- [facebook/immutable-js](https://github.com/facebook/immutable-js)\n- [rtfeldman/seamless-immutable](https://github.com/rtfeldman/seamless-immutable)\n\n\nImmutable.js ä¸»è¦ç‰¹ç‚¹:\n- ç¨³å®šæ•°æ®ç»“æ„ (Persistent Data Structure), æ¯æ¬¡è¿”å›æ–°çš„å¯¹è±¡, ä¸å­˜åœ¨å¼•ç”¨\n- ç»“æ„å…±äº« (Structural Sharing), åŸºäºå“ˆå¸Œæ˜ å°„æ ‘, å¯ä»¥å®ç°éƒ¨åˆ†ç»“æ„å…±äº«\n- æ”¯æŒå»¶è¿Ÿæ“ä½œ (Support Lazy Operation)\n- å¼ºå¤§çš„ API (Power API)\n\né’ˆå¯¹ä»¥ä¸Šç‰¹ç‚¹, æˆ‘ä»¬ç”¨ä¸€äº›ä»£ç å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹:\n```js\n/**\n * ç¨³å®šæ•°æ®ç»“æ„\n */\n\nlet obj = {count: 1};\nlet map = Immutable.fromJS(obj);\nlet map2 = map.set('count', 2);\n\nconsole.log(map.get('count')); // => 1\nconsole.log(map2.get('count')); // => 2\n```\n\n```js\n/**\n * ç»“æ„å…±äº«\n */\n\nlet obj = {\n  count: 1,\n  list: [1, 2, 3, 4, 5]\n}\nlet map1 = Immutable.fromJS(obj);\nlet map2 = map1.set('count', 2);\n\nconsole.log(map1.list === map2.list); // true\n```\n\n<div style=\"width: 300px; \">![image](https://user-images.githubusercontent.com/15377484/39665040-d92a0764-50bf-11e8-84e3-ad83cf758acd.gif)</div>\n\nè¿™å¼  GIF å¾ˆå½¢è±¡çš„è§£é‡Šäº† `ç»“æ„å…±äº«` ğŸ‘\n\n```js\n/**\n * å¼ºå¤§çš„ API\n */\n\nlet obj = {\n  a: {\n    b: {\n      list: [1, 2, 3]\n    }\n  }\n};\nlet map = Immutable.fromJS(obj);\nlet map2 = Immutable.updateIn(['a', 'b', 'list'], (list) => {\n  return list.push(4);\n});\n\nconsole.log(map2.getIn(['a', 'b', 'list'])); // => List [ 1, 2, 3, 4 ]\n```\n\nè¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±ä¸ä¸¾ä¾‹å­äº†, è¶…çº²! ğŸ˜\n\n## å‚è€ƒ\n- [Immutable è¯¦è§£åŠ React ä¸­å®è·µ](https://github.com/camsong/blog/issues/3)\n- [æµ…åˆå¹¶ (shallow merge) ä¾‹å­](https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge/28248548)\n- [Lodash merge æ–¹æ³•](https://lodash.com/docs/4.17.10#merge)\n","slug":"Why-Immutable-Data","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidj5000hu4q9rsgkw9sf","content":"<p>ä»€ä¹ˆæ˜¯ä¸å¯å˜æ•°æ®, å¦‚ä½•ç†è§£ä¸å¯å˜æ•°æ®, ä¸å¯å˜æ•°æ®åœ¨é¡¹ç›®ä¸­çš„å®è·µ. å¼„æ¸…æ¥šäº†è¿™äº›é—®é¢˜, ä½ æ‰èƒ½æ›´å¥½çš„å¤„ç†é¡¹ç›®ä¸­ä¸€äº›è°ƒä¼˜é—®é¢˜. æ¯”å¦‚ React æ€§èƒ½ä¼˜åŒ–ç­‰. ä¸€èµ·æ¥å­¦ä¹ ä¸‹å§! ğŸ‘¨ğŸ¼â€ğŸ’»</p>\n<a id=\"more\"></a>\n<h2 id=\"What\"><a href=\"#What\" class=\"headerlink\" title=\"What\"></a>What</h2><blockquote>\n<p><strong><em>Immutable Data</em></strong> æ˜¯æŒ‡ä¸€æ—¦è¢«åˆ›é€ åå°±ä¸å¯ä»¥è¢«æ”¹å˜çš„æ•°æ®, é€šè¿‡ä½¿ç”¨ Immutable Data, å¯ä»¥è®©æˆ‘ä»¬æ›´å®¹æ˜“çš„å»å¤„ç†ç¼“å­˜ã€å›é€€ã€æ•°æ®å˜åŒ–æ£€æµ‹ç­‰é—®é¢˜, ç®€åŒ–æˆ‘ä»¬çš„å¼€å‘.</p>\n</blockquote>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39663322-c4bb61ae-50a3-11e8-8267-4c2a80c00af7.png\" alt=\"image\"></p>\n<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why\"></a>Why</h2><p>åœ¨åŸç”Ÿ JS ä¸­, å­˜åœ¨ä¸¤ç§æ•°æ®ç±»å‹:</p>\n<ul>\n<li>é™æ€æ•°æ®ç±»å‹</li>\n<li>å¼•ç”¨æ•°æ®ç±»å‹</li>\n</ul>\n<p>å¼•ç”¨ç±»å‹æ•°æ®ç»“æ„éå¸¸çµæ´», èŠ‚çº¦å†…å­˜, èƒ½ç»™å¼€å‘å¸¦æ¥ä¸å°‘ä¾¿åˆ©. ä½†ä¸æ­¤åŒæ—¶ä¹Ÿäº§ç”Ÿäº†ä¸€äº›å‰¯ä½œç”¨:</p>\n<h4 id=\"Case-1\"><a href=\"#Case-1\" class=\"headerlink\" title=\"Case 1:\"></a>Case 1:</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123; <span class=\"attr\">count</span>: <span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> copyObj = obj;</span><br><span class=\"line\">copyObj.count = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(copyObj.count); <span class=\"comment\">// =&gt; 2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.count); <span class=\"comment\">// =&gt; 2, è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"Case-2\"><a href=\"#Case-2\" class=\"headerlink\" title=\"Case 2:\"></a>Case 2:</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123; <span class=\"attr\">count</span>: <span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å›¢é˜Ÿåä½œ, å¤§å®¶éƒ½åœ¨ç”¨è¿™ä¸ª obj2</span></span><br><span class=\"line\">unKnowFunction(obj2);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj2.count); <span class=\"comment\">// èƒ½ä¿è¯è¿™ä¸ªç»“æœä¸€å®šæ˜¯1å—?</span></span><br></pre></td></tr></table></figure>\n<p>é’ˆå¯¹ä»¥ä¸Šå¼•ç”¨ç±»å‹äº§ç”Ÿçš„å‰¯ä½œç”¨, æœ‰äººæå‡ºäº† <strong><em>æ·±åº¦æ‹·è´</em></strong> (Deep Clone)çš„æ–¹æ³•, å®ç°ä»£ç å¦‚ä¸‹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isObject</span>(<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> obj === <span class=\"string\">'object'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isArray</span>(<span class=\"params\">arr</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">Array</span>.isArray(arr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">deepClone</span>(<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!isObject(obj))  <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> cloneObj = isArray(obj) ? [] : &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> obj) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> value = obj[key];</span><br><span class=\"line\">      <span class=\"keyword\">var</span> copy = value;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (isObject(value)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è¿™é‡Œä½¿ç”¨äº†é€’å½’</span></span><br><span class=\"line\">        cloneObj[key] = deepClone(value);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        cloneObj[key] = value;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> cloneObj;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>deepClone</code> è¿™ä¸ªæ–¹æ³•æ¥è§£å†³æ–‡ç« ä¸€å¼€å¤´çš„é—®é¢˜äº†:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">  age: <span class=\"number\">5</span>,</span><br><span class=\"line\">  list: [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ·±æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, ä¸¤è€…äº’ç›¸ç‹¬ç«‹, ä¸å­˜åœ¨å¼•ç”¨å…³ç³»</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> trueCopyObj = deepClone(obj);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.list === trueCopyObj.list); <span class=\"comment\">// =&gt; false, è¿™æ˜¯æˆ‘ä»¬æœŸæœ›çš„</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½†æ˜¯åˆæœ‰ä¸€ä¸ªé—®é¢˜, æˆ‘åªæ˜¯æƒ³æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, æ”¹ä¸€ä¸‹ `age`</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = deepClone(obj);</span><br><span class=\"line\">obj2.age = <span class=\"number\">6</span>;</span><br><span class=\"line\"><span class=\"comment\">// éš¾ä¸æˆå‰©ä¸‹çš„ä¸€å †å¼•ç”¨ç±»å‹çš„å±æ€§éƒ½è¦é€’å½’åšä¸€æ¬¡æ·±æ‹·è´?</span></span><br><span class=\"line\"><span class=\"comment\">// æ‰€ä»¥è¿™æ˜æ˜¾æ˜¯å¤šä½™çš„, å¹¶ä¸”å­˜åœ¨ä¸¥é‡çš„æ€§èƒ½é—®é¢˜</span></span><br></pre></td></tr></table></figure></p>\n<p>åœ¨åŸç”Ÿ JavaScript ä¸­å®ç°æ•°æ®ä¸å¯å˜, æœ‰2ä¸ªåŠæ³•:</p>\n<ul>\n<li>ES6: <code>const</code></li>\n<li>ES5: <code>Object.freeze</code></li>\n</ul>\n<p>ä½†æ˜¯è¿™ä¸¤ç§éƒ½æ˜¯æµ…å¤„ç†, é‡åˆ°æ·±å±‚æ¬¡çš„æ•°æ®ç»“æ„, å°±éœ€è¦é€’å½’å¤„ç†, åˆä¼šå­˜åœ¨æ€§èƒ½ä¸Šçš„é—®é¢˜.</p>\n<h2 id=\"How\"><a href=\"#How\" class=\"headerlink\" title=\"How\"></a>How</h2><p>é’ˆå¯¹ä»¥ä¸Šä¸€ç³»åˆ—éœ€æ±‚, æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„æ¥å¤„ç†, å¯¹åº”çš„å®ç°åº“æœ‰:</p>\n<ul>\n<li><a href=\"https://github.com/facebook/immutable-js\" target=\"_blank\" rel=\"noopener\">facebook/immutable-js</a></li>\n<li><a href=\"https://github.com/rtfeldman/seamless-immutable\" target=\"_blank\" rel=\"noopener\">rtfeldman/seamless-immutable</a></li>\n</ul>\n<p>Immutable.js ä¸»è¦ç‰¹ç‚¹:</p>\n<ul>\n<li>ç¨³å®šæ•°æ®ç»“æ„ (Persistent Data Structure), æ¯æ¬¡è¿”å›æ–°çš„å¯¹è±¡, ä¸å­˜åœ¨å¼•ç”¨</li>\n<li>ç»“æ„å…±äº« (Structural Sharing), åŸºäºå“ˆå¸Œæ˜ å°„æ ‘, å¯ä»¥å®ç°éƒ¨åˆ†ç»“æ„å…±äº«</li>\n<li>æ”¯æŒå»¶è¿Ÿæ“ä½œ (Support Lazy Operation)</li>\n<li>å¼ºå¤§çš„ API (Power API)</li>\n</ul>\n<p>é’ˆå¯¹ä»¥ä¸Šç‰¹ç‚¹, æˆ‘ä»¬ç”¨ä¸€äº›ä»£ç å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç¨³å®šæ•°æ®ç»“æ„</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;<span class=\"attr\">count</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> map = Immutable.fromJS(obj);</span><br><span class=\"line\"><span class=\"keyword\">let</span> map2 = map.set(<span class=\"string\">'count'</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map.get(<span class=\"string\">'count'</span>)); <span class=\"comment\">// =&gt; 1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map2.get(<span class=\"string\">'count'</span>)); <span class=\"comment\">// =&gt; 2</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç»“æ„å…±äº«</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">  count: <span class=\"number\">1</span>,</span><br><span class=\"line\">  list: [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> map1 = Immutable.fromJS(obj);</span><br><span class=\"line\"><span class=\"keyword\">let</span> map2 = map1.set(<span class=\"string\">'count'</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map1.list === map2.list); <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<div style=\"width: 300px; \"><img src=\"https://user-images.githubusercontent.com/15377484/39665040-d92a0764-50bf-11e8-84e3-ad83cf758acd.gif\" alt=\"image\"></div>\n\n<p>è¿™å¼  GIF å¾ˆå½¢è±¡çš„è§£é‡Šäº† <code>ç»“æ„å…±äº«</code> ğŸ‘</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¼ºå¤§çš„ API</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">  a: &#123;</span><br><span class=\"line\">    b: &#123;</span><br><span class=\"line\">      list: [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> map = Immutable.fromJS(obj);</span><br><span class=\"line\"><span class=\"keyword\">let</span> map2 = Immutable.updateIn([<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'list'</span>], (list) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> list.push(<span class=\"number\">4</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map2.getIn([<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'list'</span>])); <span class=\"comment\">// =&gt; List [ 1, 2, 3, 4 ]</span></span><br></pre></td></tr></table></figure>\n<p>è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±ä¸ä¸¾ä¾‹å­äº†, è¶…çº²! ğŸ˜</p>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><ul>\n<li><a href=\"https://github.com/camsong/blog/issues/3\" target=\"_blank\" rel=\"noopener\">Immutable è¯¦è§£åŠ React ä¸­å®è·µ</a></li>\n<li><a href=\"https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge/28248548\" target=\"_blank\" rel=\"noopener\">æµ…åˆå¹¶ (shallow merge) ä¾‹å­</a></li>\n<li><a href=\"https://lodash.com/docs/4.17.10#merge\" target=\"_blank\" rel=\"noopener\">Lodash merge æ–¹æ³•</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>ä»€ä¹ˆæ˜¯ä¸å¯å˜æ•°æ®, å¦‚ä½•ç†è§£ä¸å¯å˜æ•°æ®, ä¸å¯å˜æ•°æ®åœ¨é¡¹ç›®ä¸­çš„å®è·µ. å¼„æ¸…æ¥šäº†è¿™äº›é—®é¢˜, ä½ æ‰èƒ½æ›´å¥½çš„å¤„ç†é¡¹ç›®ä¸­ä¸€äº›è°ƒä¼˜é—®é¢˜. æ¯”å¦‚ React æ€§èƒ½ä¼˜åŒ–ç­‰. ä¸€èµ·æ¥å­¦ä¹ ä¸‹å§! ğŸ‘¨ğŸ¼â€ğŸ’»</p>","more":"<h2 id=\"What\"><a href=\"#What\" class=\"headerlink\" title=\"What\"></a>What</h2><blockquote>\n<p><strong><em>Immutable Data</em></strong> æ˜¯æŒ‡ä¸€æ—¦è¢«åˆ›é€ åå°±ä¸å¯ä»¥è¢«æ”¹å˜çš„æ•°æ®, é€šè¿‡ä½¿ç”¨ Immutable Data, å¯ä»¥è®©æˆ‘ä»¬æ›´å®¹æ˜“çš„å»å¤„ç†ç¼“å­˜ã€å›é€€ã€æ•°æ®å˜åŒ–æ£€æµ‹ç­‰é—®é¢˜, ç®€åŒ–æˆ‘ä»¬çš„å¼€å‘.</p>\n</blockquote>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39663322-c4bb61ae-50a3-11e8-8267-4c2a80c00af7.png\" alt=\"image\"></p>\n<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why\"></a>Why</h2><p>åœ¨åŸç”Ÿ JS ä¸­, å­˜åœ¨ä¸¤ç§æ•°æ®ç±»å‹:</p>\n<ul>\n<li>é™æ€æ•°æ®ç±»å‹</li>\n<li>å¼•ç”¨æ•°æ®ç±»å‹</li>\n</ul>\n<p>å¼•ç”¨ç±»å‹æ•°æ®ç»“æ„éå¸¸çµæ´», èŠ‚çº¦å†…å­˜, èƒ½ç»™å¼€å‘å¸¦æ¥ä¸å°‘ä¾¿åˆ©. ä½†ä¸æ­¤åŒæ—¶ä¹Ÿäº§ç”Ÿäº†ä¸€äº›å‰¯ä½œç”¨:</p>\n<h4 id=\"Case-1\"><a href=\"#Case-1\" class=\"headerlink\" title=\"Case 1:\"></a>Case 1:</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123; <span class=\"attr\">count</span>: <span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> copyObj = obj;</span><br><span class=\"line\">copyObj.count = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(copyObj.count); <span class=\"comment\">// =&gt; 2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.count); <span class=\"comment\">// =&gt; 2, è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"Case-2\"><a href=\"#Case-2\" class=\"headerlink\" title=\"Case 2:\"></a>Case 2:</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123; <span class=\"attr\">count</span>: <span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å›¢é˜Ÿåä½œ, å¤§å®¶éƒ½åœ¨ç”¨è¿™ä¸ª obj2</span></span><br><span class=\"line\">unKnowFunction(obj2);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj2.count); <span class=\"comment\">// èƒ½ä¿è¯è¿™ä¸ªç»“æœä¸€å®šæ˜¯1å—?</span></span><br></pre></td></tr></table></figure>\n<p>é’ˆå¯¹ä»¥ä¸Šå¼•ç”¨ç±»å‹äº§ç”Ÿçš„å‰¯ä½œç”¨, æœ‰äººæå‡ºäº† <strong><em>æ·±åº¦æ‹·è´</em></strong> (Deep Clone)çš„æ–¹æ³•, å®ç°ä»£ç å¦‚ä¸‹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isObject</span>(<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> obj === <span class=\"string\">'object'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isArray</span>(<span class=\"params\">arr</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">Array</span>.isArray(arr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">deepClone</span>(<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!isObject(obj))  <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> cloneObj = isArray(obj) ? [] : &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> obj) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> value = obj[key];</span><br><span class=\"line\">      <span class=\"keyword\">var</span> copy = value;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (isObject(value)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è¿™é‡Œä½¿ç”¨äº†é€’å½’</span></span><br><span class=\"line\">        cloneObj[key] = deepClone(value);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        cloneObj[key] = value;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> cloneObj;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>deepClone</code> è¿™ä¸ªæ–¹æ³•æ¥è§£å†³æ–‡ç« ä¸€å¼€å¤´çš„é—®é¢˜äº†:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">  age: <span class=\"number\">5</span>,</span><br><span class=\"line\">  list: [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ·±æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, ä¸¤è€…äº’ç›¸ç‹¬ç«‹, ä¸å­˜åœ¨å¼•ç”¨å…³ç³»</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> trueCopyObj = deepClone(obj);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(obj.list === trueCopyObj.list); <span class=\"comment\">// =&gt; false, è¿™æ˜¯æˆ‘ä»¬æœŸæœ›çš„</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½†æ˜¯åˆæœ‰ä¸€ä¸ªé—®é¢˜, æˆ‘åªæ˜¯æƒ³æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡, æ”¹ä¸€ä¸‹ `age`</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = deepClone(obj);</span><br><span class=\"line\">obj2.age = <span class=\"number\">6</span>;</span><br><span class=\"line\"><span class=\"comment\">// éš¾ä¸æˆå‰©ä¸‹çš„ä¸€å †å¼•ç”¨ç±»å‹çš„å±æ€§éƒ½è¦é€’å½’åšä¸€æ¬¡æ·±æ‹·è´?</span></span><br><span class=\"line\"><span class=\"comment\">// æ‰€ä»¥è¿™æ˜æ˜¾æ˜¯å¤šä½™çš„, å¹¶ä¸”å­˜åœ¨ä¸¥é‡çš„æ€§èƒ½é—®é¢˜</span></span><br></pre></td></tr></table></figure></p>\n<p>åœ¨åŸç”Ÿ JavaScript ä¸­å®ç°æ•°æ®ä¸å¯å˜, æœ‰2ä¸ªåŠæ³•:</p>\n<ul>\n<li>ES6: <code>const</code></li>\n<li>ES5: <code>Object.freeze</code></li>\n</ul>\n<p>ä½†æ˜¯è¿™ä¸¤ç§éƒ½æ˜¯æµ…å¤„ç†, é‡åˆ°æ·±å±‚æ¬¡çš„æ•°æ®ç»“æ„, å°±éœ€è¦é€’å½’å¤„ç†, åˆä¼šå­˜åœ¨æ€§èƒ½ä¸Šçš„é—®é¢˜.</p>\n<h2 id=\"How\"><a href=\"#How\" class=\"headerlink\" title=\"How\"></a>How</h2><p>é’ˆå¯¹ä»¥ä¸Šä¸€ç³»åˆ—éœ€æ±‚, æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„æ¥å¤„ç†, å¯¹åº”çš„å®ç°åº“æœ‰:</p>\n<ul>\n<li><a href=\"https://github.com/facebook/immutable-js\" target=\"_blank\" rel=\"noopener\">facebook/immutable-js</a></li>\n<li><a href=\"https://github.com/rtfeldman/seamless-immutable\" target=\"_blank\" rel=\"noopener\">rtfeldman/seamless-immutable</a></li>\n</ul>\n<p>Immutable.js ä¸»è¦ç‰¹ç‚¹:</p>\n<ul>\n<li>ç¨³å®šæ•°æ®ç»“æ„ (Persistent Data Structure), æ¯æ¬¡è¿”å›æ–°çš„å¯¹è±¡, ä¸å­˜åœ¨å¼•ç”¨</li>\n<li>ç»“æ„å…±äº« (Structural Sharing), åŸºäºå“ˆå¸Œæ˜ å°„æ ‘, å¯ä»¥å®ç°éƒ¨åˆ†ç»“æ„å…±äº«</li>\n<li>æ”¯æŒå»¶è¿Ÿæ“ä½œ (Support Lazy Operation)</li>\n<li>å¼ºå¤§çš„ API (Power API)</li>\n</ul>\n<p>é’ˆå¯¹ä»¥ä¸Šç‰¹ç‚¹, æˆ‘ä»¬ç”¨ä¸€äº›ä»£ç å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹:<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç¨³å®šæ•°æ®ç»“æ„</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;<span class=\"attr\">count</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> map = Immutable.fromJS(obj);</span><br><span class=\"line\"><span class=\"keyword\">let</span> map2 = map.set(<span class=\"string\">'count'</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map.get(<span class=\"string\">'count'</span>)); <span class=\"comment\">// =&gt; 1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map2.get(<span class=\"string\">'count'</span>)); <span class=\"comment\">// =&gt; 2</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç»“æ„å…±äº«</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">  count: <span class=\"number\">1</span>,</span><br><span class=\"line\">  list: [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> map1 = Immutable.fromJS(obj);</span><br><span class=\"line\"><span class=\"keyword\">let</span> map2 = map1.set(<span class=\"string\">'count'</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map1.list === map2.list); <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<div style=\"width: 300px; \"><img src=\"https://user-images.githubusercontent.com/15377484/39665040-d92a0764-50bf-11e8-84e3-ad83cf758acd.gif\" alt=\"image\"></div>\n\n<p>è¿™å¼  GIF å¾ˆå½¢è±¡çš„è§£é‡Šäº† <code>ç»“æ„å…±äº«</code> ğŸ‘</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¼ºå¤§çš„ API</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;</span><br><span class=\"line\">  a: &#123;</span><br><span class=\"line\">    b: &#123;</span><br><span class=\"line\">      list: [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">let</span> map = Immutable.fromJS(obj);</span><br><span class=\"line\"><span class=\"keyword\">let</span> map2 = Immutable.updateIn([<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'list'</span>], (list) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> list.push(<span class=\"number\">4</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(map2.getIn([<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'list'</span>])); <span class=\"comment\">// =&gt; List [ 1, 2, 3, 4 ]</span></span><br></pre></td></tr></table></figure>\n<p>è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±ä¸ä¸¾ä¾‹å­äº†, è¶…çº²! ğŸ˜</p>\n<h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><ul>\n<li><a href=\"https://github.com/camsong/blog/issues/3\" target=\"_blank\" rel=\"noopener\">Immutable è¯¦è§£åŠ React ä¸­å®è·µ</a></li>\n<li><a href=\"https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge/28248548\" target=\"_blank\" rel=\"noopener\">æµ…åˆå¹¶ (shallow merge) ä¾‹å­</a></li>\n<li><a href=\"https://lodash.com/docs/4.17.10#merge\" target=\"_blank\" rel=\"noopener\">Lodash merge æ–¹æ³•</a></li>\n</ul>"},{"title":"ä»£ç é‡æ„","comments":1,"date":"2018-06-16T14:46:36.000Z","from":null,"_content":"\nä»Šå¤©è¯»äº†æ›¾æ¢çš„[ã€Šè®¾è®¡æ¨¡å¼ã€‹](https://book.douban.com/subject/26382780/)ä¸­çš„ä»£ç é‡æ„è¿™ä¸€ç« èŠ‚, çŸ¥è¯†ç‚¹ä¸å¤šå´éå¸¸ä½¿ç”¨, åœ¨å®é™…é¡¹ç›®ä¸­é™¤äº†ä½¿ç”¨è®¾è®¡æ¨¡å¼é‡æ„ä»£ç å¤–, è¿˜æœ‰ä¸€äº›å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚. è¿™äº›ç»†èŠ‚ä¹Ÿæ˜¯é‡æ„çš„é‡è¦æ‰‹æ®µ. å†™è¿™ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹.\n\n<!-- more -->\n\n> ä»£ç æ˜¯å†™ç»™äººçœ‹çš„, é¡ºä¾¿ç»™æœºå™¨è¿è¡Œ. ä¼˜é›…çš„ä»£ç åº”è¯¥æ˜¯ç®€å•ã€æ˜“ç»´æŠ¤ã€å¯æ‰©å±•çš„.\n\n### æ¦‚è¿°\n\n1. [æç‚¼å‡½æ•°](#æç‚¼å‡½æ•°)\n2. [åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ](#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ)\n3. [æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°](#æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°)\n4. [åˆç†çš„ä½¿ç”¨å¾ªç¯](#åˆç†çš„ä½¿ç”¨å¾ªç¯)\n5. [æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯](#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯)\n6. [ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨](#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨)\n7. [å°½é‡å‡å°‘å‚æ•°æ•°é‡](#å°½é‡å‡å°‘å‚æ•°æ•°é‡)\n8. [å°‘ç”¨ä¸‰ç›®è¿ç®—](#å°‘ç”¨ä¸‰ç›®è¿ç®—)\n9. [åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨](#åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨)\n10. [åˆ†è§£å¤§å‹ç±»](#åˆ†è§£å¤§å‹ç±»)\n11. [é€€å‡ºå¤šé‡å¾ªç¯](#é€€å‡ºå¤šé‡å¾ªç¯)\n\n### æç‚¼å‡½æ•°\n\nå¦‚æœä¸€ä¸ªå‡½æ•°è¿‡é•¿, è€Œä¸”éœ€è¦æ³¨é‡Šæ‰æ¸…æ¥šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„, é‚£ä¹ˆéœ€è¦è€ƒè™‘æŠŠå®ƒç‹¬ç«‹å‡ºæ¥. è¿™æ ·åšçš„å¥½å¤„æ˜¯:\n\n* é¿å…è¶…å¤§å‡½æ•°, ä½œç”¨åŸŸè¿‡å¤§å˜é‡ä¸å¥½ç»´æŠ¤\n* æŠ½ç¦»å…¬å…±é€»è¾‘, æ˜“äºå¤ç”¨å’Œè¦†å†™\n* è‰¯å¥½çš„å‘½åèµ·åˆ°äº†æ³¨é‡Šä½œç”¨\n\n**ä¾‹å­:**\n\n```js\nconst getUserInfo = () => {\n  fetch('https://xxx.com/userInfo', (data) => {\n    console.log(`\n      userId: ${data.userId}\\n\n      userName: ${data.userName}\\n\n      nickName: ${data.NickName}\n    `);\n  });\n};\n```\n\né‡æ„å¦‚ä¸‹:\n\n```js\nconst printDetail = (data) => {\n    console.log(`\n    userId: ${data.userId}\\n\n    userName: ${data.userName}\\n\n    nickName: ${data.NickName}\n  `);\n}\n\nconst getUserInfo = () => {\n  fetch('https://xxx.com/userInfo', (data) => {\n    printDetail(data);\n  });\n};\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\n\nå¦‚æœä¸€ä¸ªå‡½æ•°ä½“å†…æœ‰ä¸€äº›æ¡ä»¶åˆ†æ”¯, è€Œä¸”è¿™äº›æ¡ä»¶åˆ†æ”¯å†…æ•£å¸ƒäº†ä¸€äº›é‡å¤çš„ä»£ç , è¿™ä¸ªæ—¶å€™å°±æœ‰å¿…è¦è¿›è¡Œåˆå¹¶å»é‡æ“ä½œ.\n\n**ä¾‹å­:**\n\n```js\nconst paging = (currPage) => {\n  if (currPage <= 0) {\n    currPage = 0;\n    jump(currPage); // è·³è½¬\n  } else if (currPage >= totalPage) {\n    currPage = totalPage;\n    jump(currPage); // è·³è½¬\n  } else {\n    jump(currPage); // è·³è½¬\n  }\n};\n```\n\nå¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ `jump(currPage)` é‡å¤äº†, å®Œå…¨å¯ä»¥æŠŠå®ƒç‹¬ç«‹å‡ºæ¥:\n\n```js\nconst paging = (currPage) => {\n  if (currPage <= 0) {\n    currPage = 0;\n  } else if (currPage >= totalPage) {\n    currPage = totalPage;\n  }\n  jump(currPage);\n}\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\n\nå¤æ‚çš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯å¯¼è‡´ç¨‹åºéš¾ä»¥é˜…è¯»å’Œç†è§£çš„é‡è¦åŸå› , è€Œä¸”å¾ˆå®¹æ˜“å¯¼è‡´ä¸€ä¸ªåºå¤§çš„å‡½æ•°. è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼å‡ºæ¥.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: å¦‚æœå½“å­£æ˜¯å¤„äºå¤å­£, é‚£ä¹ˆæ‰€æœ‰çš„å•†å“ 8 æŠ˜å‡ºå”®\n\nconst getPrice = (price) => {\n  const date = new Date();\n  if (date.getMonth() >= 6 && date.getMonth() <= 9) { // å¤å­£\n    return price * 0.8;\n  }\n  return price;\n};\n```\n\nè§‚å¯Ÿè¿™æ®µä»£ç :\n\n```js\nif (date.getMonth() >= 6 && date.getMonth() <= 9) { // å¤å­£\n  // ...\n}\n```\n\næˆ‘ä»¬éœ€è¦è®©å®ƒæ›´ç¬¦åˆè¯­ä¹‰, è¿™æ ·è¯»ä»£ç çš„äººèƒ½å¾ˆè½»æ¾ç†è§£æ„å›¾, è¿™é‡Œå°±å¯ä»¥æç‚¼æˆä¸€ä¸ªå•ç‹¬å‡½æ•°.\n\n```js\nconst isSummer = () => {\n  const date = new Date();\n  return date.getMonth() >= 6 && date.getMonth() <= 9;\n};\n\nconst getPrice = (price) => {\n  const date = new Date();\n  if (isSummer()) {\n    return price * 0.8;\n  }\n  return price;\n};\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆç†çš„ä½¿ç”¨å¾ªç¯\n\nåœ¨å‡½æ•°ä½“å†…, å¦‚æœä¸€äº›ä»£ç åªæ˜¯å®Œæˆä¸€äº›é‡å¤çš„å·¥ä½œ, é‚£ä¹ˆå¯ä»¥åˆç†åˆ©ç”¨å¾ªç¯å®ŒæˆåŒæ ·çš„åŠŸèƒ½, è¿™æ ·å¯ä»¥ä¿æŒä»£ç é‡æ›´å°‘.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: IE9 ä»¥ä¸‹åˆ›å»ºä¸€ä¸ª XHR å¯¹è±¡\n\nvar createXHR = function() {\n  var xhr;\n  try {\n    xhr = new ActiveXObject('MSXML2.XMLHttp.6.0');\n  } catch(e) {\n    try {\n      xhr = new ActiveXObject('MSXML2.XMLHttp.3.0')\n    } catch(e) {\n      xhr = new ActiveXObject('MSXML2.XMLHttp');\n    }\n  }\n  return xhr;\n};\n\nvar xhr = createXHR();\n```\n\nè¿™ä¸ªæ—¶å€™, ä½¿ç”¨å¾ªç¯æ¥ä¼˜åŒ–ä¸Šé¢çš„ä»£ç :\n\n<div class=\"tip\">å¤ä¹ ä¸€ä¸‹ **for** å¾ªç¯: `for(åˆå§‹å€¼; å¾ªç¯æ¡ä»¶; æ­¥é•¿;) {}` </div>\n\n```js\n// è¿™æ®µä»£ç å°±çœ‹ç€ç¬¦åˆè¯­ä¹‰äº†, è€Œä¸”å¥½ç†è§£ ğŸ¤¡\n\nvar createXHR = function() {\n  var versions = ['MSXML2.XMLHttp.6.0', 'MSXML2.XMLHttp.3.0', 'MSXML2.XMLHttp'];\n  for (var i = 0, version; version = versions[i++];) {\n    try {\n      return new ActiveXObject(version);\n    } catch(e) {};\n  }\n};\n\nvar xhr = createXHR();\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\n\nå¾ˆå¤šç¨‹åºå‘˜ğŸ‘¨â€ğŸ’»â€éƒ½æœ‰è¿™ç§è§‚å¿µ \"æ¯ä¸ªå‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£\", ä½†æ˜¯å…³äº \"å‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£\" å¾€å¾€æœ‰ä¸€äº›ä¸åŒçš„çœ‹æ³•, ä¸‹é¢ç”¨ä»£ç æ¥è¯´æ˜ä¸€ä¸‹, å…‰è®²æ¦‚å¿µæœ‰ç‚¹æ™¦æ¶©.\n\n**ä¾‹å­:**\n\n```js\n// ä¸‹é¢æ˜¯ \"å‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£\" çš„å…¸å‹ä»£ç \n\nconst del = (obj) => {\n  let ret;\n  if (!obj.isReadOnly) {\n    if (obj.isFolder) {\n      ret = delFolder(obj);\n    } else if (obj.isFile) {\n      ret = delFile(obj);\n    }\n  }\n  return ret;\n};\n```\n\nåµŒå¥—çš„æ¡ä»¶åˆ†æ”¯ç»å¯¹æ˜¯ä»£ç ç»´æŠ¤è€…çš„å™©æ¢¦, å¤šå±‚åµŒå¥—çš„æ¡ä»¶æ›´åŠ ä¸å®¹æ˜“ç†è§£, æœ‰æ—¶å€™å¦‚æœä»£ç è¿‡é•¿, ä¸Šä¸€ä¸ª `if ()` è¯­å¥å¯èƒ½ç›¸éš”å¾ˆè¿œ. ä¸¥é‡å½±å“äº†é˜…è¯»ä½“éªŒå•Š. é‡æ„çš„ `del` å‡½æ•°å¦‚ä¸‹:\n\n```js\nconst del = (obj) => {\n  if (obj.isReadOnly) { // åè½¬ if\n    return;\n  }\n  if (obj.isFolder) {\n    return delFolder(obj);\n  }\n  if (obj.isFile) {\n    return delFile(obj);\n  }\n};\n\n// ç¬é—´æ¸…çˆ½ ğŸ‘Œ\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\n\næœ‰æ—¶å€™ä¸€ä¸ªå‡½æ•°å¯èƒ½æ¥æ”¶å¤šä¸ªå‚æ•°, è€Œä¸”å‚æ•°é˜…è¯», å°±è¶Šéš¾ç†è§£å’Œä½¿ç”¨. æœ€é‡è¦çš„ä¸€ç‚¹éœ€è¦æ³¨æ„å‚æ•°çš„é¡ºåº, å¦‚æœä¸ä¼ çš„æƒ…å†µè¦ä½¿ç”¨å ä½ç¬¦ä»£æ›¿. å¦‚æœå‚æ•°è¶…è¿‡ 3 ä¸ª, è¯·ä½¿ç”¨å¯¹è±¡å§.\n\n**ä¾‹å­:**\n\n```js\nconst setUserInfo = (id, name, address, sex, mobile, qq) => {\n  // ...\n}\n\n// è°ƒç”¨ â˜¹ï¸:\nsetUserInfo(1, 'ifyour', undefined, 'male', undefined, '123456');\n\n\n// é‡æ„ ğŸ˜:\nsetUserInfo({\n  id: 1,\n  name: 'ifyour',\n  sex: 'male',\n  qq: '123456',\n})\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### å°½é‡å‡å°‘å‚æ•°æ•°é‡\n\nå¦‚æœè°ƒç”¨ä¸€ä¸ªå‡½æ•°, éœ€è¦ä¼ é€’å¾ˆå¤šå‚æ•°, è¿™æ ·çš„å‡½æ•°ç”¨èµ·æ¥å°±è¦å°å¿ƒäº†, å¿…é¡»ææ¸…æ¥šæ¯ä¸ªå‚æ•°çš„å«ä¹‰, æ‰€ä»¥, å¦‚æœèƒ½å°½é‡å°‘ä¼ å‚æ•°å°±å°‘ä¼ å‚æ•°. æŠŠå¤æ‚çš„é€»è¾‘å°è£…åˆ°å‡½æ•°å†…éƒ¨.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: æœ‰ä¸€ä¸ªç”»å›¾å‡½æ•° draw\n\nconst draw = (width, height, square) => {\n  // ...\n};\n\n// ä¼˜åŒ–å¦‚ä¸‹:\nconst draw = (width, height) => {\n  const square = width * height;\n  // ...\n}\n```\n\nè¿™é‡Œçš„ `square` å‚æ•°æ²¡å¿…è¦, å¯ä»¥é€šè¿‡ `width` å’Œ `height` è®¡ç®—è·å¾—, è¿˜æœ‰ä¸€ç§æƒ…å†µ, è¿™ä¸ªç”»å›¾å‡½æ•°, å¦‚æœå¯ä»¥ç”»å¤šç§å›¾å½¢å‘¢? æ‰€ä»¥éœ€è¦åœ¨å†…éƒ¨å»å¤„ç†, ä»€ä¹ˆæ—¶å€™éœ€è¦ `square` ä»€ä¹ˆæ—¶å€™éœ€è¦ `radius`, ç„¶åå¯ä»¥ä½¿ç”¨ **ç­–ç•¥æ¨¡å¼** è®©å®ƒæ”¯æŒç”»å¤šç§å›¾å½¢.\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### å°‘ç”¨ä¸‰ç›®è¿ç®—\n\nä¸‰ç›®è¿ç®—èƒ½å‡å°‘ä»£ç é‡, ä½†æ˜¯ä¸èƒ½æ»¥ç”¨, å¦‚æœä»¥ç‰ºç‰²ä»£ç å¯è¯»æ€§ä¸ºä»£ä»·, é‚£å°±å¾—ä¸å¿å¤±äº†.\n\n```js\nconst global = typeof window !== 'undefined' ? window : this;\n\n// ä½†æ˜¯è¿™ç§æƒ…å†µå°±å®Œå…¨æ²¡å¿…è¦äº†, è€å®å†™ if..else...\n\nif (!aup || !bup) {\n  return a === doc ? -1 :\n    b === doc ? 1 :\n    aup ? -1 :\n    bup ? 1 :\n    sortInput ?\n    (indexOf.call(sortInput, a) - indexOf.call(sortInput, b)) :\n    0;\n}\n\n// ğŸ˜¡ è¿™æ˜¯äººçœ‹çš„å—\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\n\njQuery ä¸­çš„é“¾å¼è°ƒç”¨ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆçˆ½çš„, å®ƒçš„å®ç°ä¹Ÿéå¸¸ç®€å•, æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä¸€ä¸ªé“¾å¼è°ƒç”¨. ä½¿ç”¨çš„å‰æå°±æ˜¯é“¾æ¡çš„ç»“æ„ç›¸å¯¹æ¥è¯´ç¨³å®š, ä¸å®¹æ˜“å‘ç”Ÿä¿®æ”¹, å¦‚æœæ˜¯ç»å¸¸å‘ç”Ÿä¿®æ”¹çš„è¯, è¿˜æ˜¯å»ºè®®ä½¿ç”¨æ™®é€šçš„è°ƒç”¨. å› ä¸ºå®ƒè°ƒè¯•çš„æ—¶å€™éœ€è¦æŠŠè¿™ä¸ªé“¾å­æ‹†å¼€, æ‰çŸ¥é“æ˜¯å“ªä¸ªç¯èŠ‚æœ‰ Bug.\n\n**ä¾‹å­:**\n\n```js\n// ES5\n\nvar User = function() {\n  this.id = null;\n  this.name = null;\n};\n\nUser.prototype.setId = function (id) {\n  this.id = id;\n  return this; // è¿”å›å®ä¾‹æœ¬èº«\n}\n\nUser.prototype.setName = function (name) {\n  this.name = name;\n  return this;\n}\n\n// é“¾å¼è°ƒç”¨\nnew User()\n  .setId(1)\n  .setNmae('ifyour');\n```\n\næˆ–è€…è¿™æ ·:\n\n```js\nvar User = {\n  id: null,\n  name: null,\n  setId: function(id) {\n    this.id = id;\n    return this;\n  },\n  setName: function(name) {\n    this.name = name;\n    return this;\n  }\n};\n\nUser.setId(1).setName('ifyour');\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆ†è§£å¤§å‹ç±»\n\nä»å­—é¢æ„æ€æˆ‘ä»¬å°±èƒ½ç†è§£, å¦‚æœä¸€ä¸ªç±»é‡Œé¢æœ‰å¤ªå¤šçš„æ–¹æ³•, æˆ‘ä»¬è¦è€ƒè™‘æŠŠå…¶ä¸­åŒä¸€ç±»å‹ç›¸å…³çš„æ–¹æ³•æŠ½ç¦»å‡ºæ¥. æ¨¡å—åŒ–çš„å¥½å¤„ä¸è¨€è€Œå–», æŠŠé€»è¾‘å¤æ‚çš„åˆ†ç¦»æˆå°çš„å•å…ƒ, è¿™æ ·æ›´ä¾¿äºç»´æŠ¤, å‡ºç° bug äº†ä¹Ÿå¥½å®šä½é—®é¢˜. æ¥çœ‹ä¸€æ®µä»£ç .\n\n**ä¾‹å­:**\n\n```js\n// è‹±é›„ç±»\nvar Spirit = function() {\n  this.name = name;\n};\n\n// åŸå‹ä¸Šçš„æ”»å‡»æ–¹æ³•\nSpirit.prototype.attack = function (type) {\n  if (type === 'waveBoxing') {\n    console.log(this.name + ': ä½¿ç”¨æ³¢åŠ¨æ‹³');\n  } else if (type === 'whirlKick') {\n    console.log(this.name + ': ä½¿ç”¨æ—‹é£è…¿');\n  }\n  // ... è¿˜æœ‰å¾ˆå¤šæ”»å‡»æ–¹æ³•\n}\n\nvar spirit = new Spirit('RYU');\nspirit.attack('waveBoxing'); // RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³\nspirit.attack('whirlKick'); // RYU: ä½¿ç”¨æ—‹é£è…¿\n```\n\né¢å‘å¯¹è±¡çš„è®¾è®¡é¼“åŠ±å°† **è¡Œä¸º** åˆ†è§£åˆ°åˆç†æ•°é‡çš„æ›´å°çš„å¯¹è±¡ä¸­:\n\n```js\nvar Attack = function (spirit) {\n  this.spirit = spirit;\n};\n\nAttack.prototype.start = function (type) {\n  return this.list[type].call(this);\n}\n\nAttack.prototype.list = function () {\n  waveBoxing: function () {\n    console.log(this.sprite.name + ': ä½¿ç”¨æ³¢åŠ¨æ‹³')\n  },\n  whirlKick: function () {\n    console.log(this.sprite.name + ': ä½¿ç”¨æ—‹é£è…¿')\n  },\n}\n```\n\nç°åœ¨ Sprite ç±»ç²¾ç®€äº†å¾ˆå¤š, ä¸å†ç›´æ¥åŒ…å«æ”»å‡»ç›¸å…³çš„æ–¹æ³•, è€Œæ˜¯æŠŠæ–¹æ³•å§”æ‰˜ç»™ Attack ç±»æ¥æ‰§è¡Œ. è¿™æ®µä»£ç ä¹Ÿæ˜¯ **ç­–ç•¥æ¨¡å¼** çš„è¿ç”¨ä¹‹ä¸€, çœ‹ä»£ç :\n\n```js\nvar Spirit = function() {\n  this.name = name;\n  this.attackObj = new Attack(this);\n};\n\nSpirit.prototype.attack = function (type) {\n  this.attackObj.start(type);\n}\n\nvar spirit = new Spirit('RYU');\nspirit.attack('waveBoxing'); // RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³\nspirit.attack('whirlKick'); // RYU: ä½¿ç”¨æ—‹é£è…¿\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### é€€å‡ºå¤šé‡å¾ªç¯\n\nä½¿ç”¨ `return` é€€å‡ºå¤šé‡å¾ªç¯. ä¸€å®šç¨‹åº¦ä¸Šèƒ½ç®€åŒ–ä»£ç , ä½¿ä»£ç æ›´å®¹æ˜“ç†è§£.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: å‡è®¾åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…çš„å¤šé‡å¾ªç¯å†…, è¾¾åˆ°æŸä¸ªä¸´ç•Œæ¡ä»¶æ—¶é€€å‡ºå¾ªç¯\n\nvar func = function () {\n  var flag = false;\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        flag = true;\n        break;\n      }\n    }\n  }\n};\n\n// è¿™ç§ä»£ç çœ‹ç€å°±å¤´æ™•ç›®çœ©, é‡æ„å¦‚ä¸‹:\n\nvar func = function () {\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        return;\n      }\n    }\n  }\n};\n```\n\nç›´æ¥ä½¿ç”¨ `return` å, åé¢çš„ä»£ç æ— æ³•æ‰§è¡Œ, è¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜çš„:\n\n```js\nvar func = function () {\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        return;\n      }\n    }\n  }\n  console.log(i) // æ— æ³•æ‰§è¡Œ\n};\n```\n\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å¯ä»¥æŠŠç›¸å…³çš„ä»£ç æ”¾åˆ° `return` åé¢. å¦‚æœéœ€è¦æ‰§è¡Œçš„ä»£ç è¾ƒå¤š, å¯ä»¥æå–æˆä¸€ä¸ªå‡½æ•°:\n\n```js\nvar print = function (i) {\n  console.log(i)\n};\n\nvar func = function () {\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        return print(i); // æ‰§è¡Œ\n      }\n    }\n  }\n};\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n","source":"_posts/ä»£ç é‡æ„.md","raw":"---\ntitle: ä»£ç é‡æ„\ncomments: true\ndate: 2018-06-16 22:46:36\ntags:\nfrom:\n---\n\nä»Šå¤©è¯»äº†æ›¾æ¢çš„[ã€Šè®¾è®¡æ¨¡å¼ã€‹](https://book.douban.com/subject/26382780/)ä¸­çš„ä»£ç é‡æ„è¿™ä¸€ç« èŠ‚, çŸ¥è¯†ç‚¹ä¸å¤šå´éå¸¸ä½¿ç”¨, åœ¨å®é™…é¡¹ç›®ä¸­é™¤äº†ä½¿ç”¨è®¾è®¡æ¨¡å¼é‡æ„ä»£ç å¤–, è¿˜æœ‰ä¸€äº›å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚. è¿™äº›ç»†èŠ‚ä¹Ÿæ˜¯é‡æ„çš„é‡è¦æ‰‹æ®µ. å†™è¿™ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹.\n\n<!-- more -->\n\n> ä»£ç æ˜¯å†™ç»™äººçœ‹çš„, é¡ºä¾¿ç»™æœºå™¨è¿è¡Œ. ä¼˜é›…çš„ä»£ç åº”è¯¥æ˜¯ç®€å•ã€æ˜“ç»´æŠ¤ã€å¯æ‰©å±•çš„.\n\n### æ¦‚è¿°\n\n1. [æç‚¼å‡½æ•°](#æç‚¼å‡½æ•°)\n2. [åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ](#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ)\n3. [æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°](#æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°)\n4. [åˆç†çš„ä½¿ç”¨å¾ªç¯](#åˆç†çš„ä½¿ç”¨å¾ªç¯)\n5. [æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯](#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯)\n6. [ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨](#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨)\n7. [å°½é‡å‡å°‘å‚æ•°æ•°é‡](#å°½é‡å‡å°‘å‚æ•°æ•°é‡)\n8. [å°‘ç”¨ä¸‰ç›®è¿ç®—](#å°‘ç”¨ä¸‰ç›®è¿ç®—)\n9. [åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨](#åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨)\n10. [åˆ†è§£å¤§å‹ç±»](#åˆ†è§£å¤§å‹ç±»)\n11. [é€€å‡ºå¤šé‡å¾ªç¯](#é€€å‡ºå¤šé‡å¾ªç¯)\n\n### æç‚¼å‡½æ•°\n\nå¦‚æœä¸€ä¸ªå‡½æ•°è¿‡é•¿, è€Œä¸”éœ€è¦æ³¨é‡Šæ‰æ¸…æ¥šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„, é‚£ä¹ˆéœ€è¦è€ƒè™‘æŠŠå®ƒç‹¬ç«‹å‡ºæ¥. è¿™æ ·åšçš„å¥½å¤„æ˜¯:\n\n* é¿å…è¶…å¤§å‡½æ•°, ä½œç”¨åŸŸè¿‡å¤§å˜é‡ä¸å¥½ç»´æŠ¤\n* æŠ½ç¦»å…¬å…±é€»è¾‘, æ˜“äºå¤ç”¨å’Œè¦†å†™\n* è‰¯å¥½çš„å‘½åèµ·åˆ°äº†æ³¨é‡Šä½œç”¨\n\n**ä¾‹å­:**\n\n```js\nconst getUserInfo = () => {\n  fetch('https://xxx.com/userInfo', (data) => {\n    console.log(`\n      userId: ${data.userId}\\n\n      userName: ${data.userName}\\n\n      nickName: ${data.NickName}\n    `);\n  });\n};\n```\n\né‡æ„å¦‚ä¸‹:\n\n```js\nconst printDetail = (data) => {\n    console.log(`\n    userId: ${data.userId}\\n\n    userName: ${data.userName}\\n\n    nickName: ${data.NickName}\n  `);\n}\n\nconst getUserInfo = () => {\n  fetch('https://xxx.com/userInfo', (data) => {\n    printDetail(data);\n  });\n};\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\n\nå¦‚æœä¸€ä¸ªå‡½æ•°ä½“å†…æœ‰ä¸€äº›æ¡ä»¶åˆ†æ”¯, è€Œä¸”è¿™äº›æ¡ä»¶åˆ†æ”¯å†…æ•£å¸ƒäº†ä¸€äº›é‡å¤çš„ä»£ç , è¿™ä¸ªæ—¶å€™å°±æœ‰å¿…è¦è¿›è¡Œåˆå¹¶å»é‡æ“ä½œ.\n\n**ä¾‹å­:**\n\n```js\nconst paging = (currPage) => {\n  if (currPage <= 0) {\n    currPage = 0;\n    jump(currPage); // è·³è½¬\n  } else if (currPage >= totalPage) {\n    currPage = totalPage;\n    jump(currPage); // è·³è½¬\n  } else {\n    jump(currPage); // è·³è½¬\n  }\n};\n```\n\nå¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ `jump(currPage)` é‡å¤äº†, å®Œå…¨å¯ä»¥æŠŠå®ƒç‹¬ç«‹å‡ºæ¥:\n\n```js\nconst paging = (currPage) => {\n  if (currPage <= 0) {\n    currPage = 0;\n  } else if (currPage >= totalPage) {\n    currPage = totalPage;\n  }\n  jump(currPage);\n}\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\n\nå¤æ‚çš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯å¯¼è‡´ç¨‹åºéš¾ä»¥é˜…è¯»å’Œç†è§£çš„é‡è¦åŸå› , è€Œä¸”å¾ˆå®¹æ˜“å¯¼è‡´ä¸€ä¸ªåºå¤§çš„å‡½æ•°. è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼å‡ºæ¥.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: å¦‚æœå½“å­£æ˜¯å¤„äºå¤å­£, é‚£ä¹ˆæ‰€æœ‰çš„å•†å“ 8 æŠ˜å‡ºå”®\n\nconst getPrice = (price) => {\n  const date = new Date();\n  if (date.getMonth() >= 6 && date.getMonth() <= 9) { // å¤å­£\n    return price * 0.8;\n  }\n  return price;\n};\n```\n\nè§‚å¯Ÿè¿™æ®µä»£ç :\n\n```js\nif (date.getMonth() >= 6 && date.getMonth() <= 9) { // å¤å­£\n  // ...\n}\n```\n\næˆ‘ä»¬éœ€è¦è®©å®ƒæ›´ç¬¦åˆè¯­ä¹‰, è¿™æ ·è¯»ä»£ç çš„äººèƒ½å¾ˆè½»æ¾ç†è§£æ„å›¾, è¿™é‡Œå°±å¯ä»¥æç‚¼æˆä¸€ä¸ªå•ç‹¬å‡½æ•°.\n\n```js\nconst isSummer = () => {\n  const date = new Date();\n  return date.getMonth() >= 6 && date.getMonth() <= 9;\n};\n\nconst getPrice = (price) => {\n  const date = new Date();\n  if (isSummer()) {\n    return price * 0.8;\n  }\n  return price;\n};\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆç†çš„ä½¿ç”¨å¾ªç¯\n\nåœ¨å‡½æ•°ä½“å†…, å¦‚æœä¸€äº›ä»£ç åªæ˜¯å®Œæˆä¸€äº›é‡å¤çš„å·¥ä½œ, é‚£ä¹ˆå¯ä»¥åˆç†åˆ©ç”¨å¾ªç¯å®ŒæˆåŒæ ·çš„åŠŸèƒ½, è¿™æ ·å¯ä»¥ä¿æŒä»£ç é‡æ›´å°‘.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: IE9 ä»¥ä¸‹åˆ›å»ºä¸€ä¸ª XHR å¯¹è±¡\n\nvar createXHR = function() {\n  var xhr;\n  try {\n    xhr = new ActiveXObject('MSXML2.XMLHttp.6.0');\n  } catch(e) {\n    try {\n      xhr = new ActiveXObject('MSXML2.XMLHttp.3.0')\n    } catch(e) {\n      xhr = new ActiveXObject('MSXML2.XMLHttp');\n    }\n  }\n  return xhr;\n};\n\nvar xhr = createXHR();\n```\n\nè¿™ä¸ªæ—¶å€™, ä½¿ç”¨å¾ªç¯æ¥ä¼˜åŒ–ä¸Šé¢çš„ä»£ç :\n\n<div class=\"tip\">å¤ä¹ ä¸€ä¸‹ **for** å¾ªç¯: `for(åˆå§‹å€¼; å¾ªç¯æ¡ä»¶; æ­¥é•¿;) {}` </div>\n\n```js\n// è¿™æ®µä»£ç å°±çœ‹ç€ç¬¦åˆè¯­ä¹‰äº†, è€Œä¸”å¥½ç†è§£ ğŸ¤¡\n\nvar createXHR = function() {\n  var versions = ['MSXML2.XMLHttp.6.0', 'MSXML2.XMLHttp.3.0', 'MSXML2.XMLHttp'];\n  for (var i = 0, version; version = versions[i++];) {\n    try {\n      return new ActiveXObject(version);\n    } catch(e) {};\n  }\n};\n\nvar xhr = createXHR();\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\n\nå¾ˆå¤šç¨‹åºå‘˜ğŸ‘¨â€ğŸ’»â€éƒ½æœ‰è¿™ç§è§‚å¿µ \"æ¯ä¸ªå‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£\", ä½†æ˜¯å…³äº \"å‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£\" å¾€å¾€æœ‰ä¸€äº›ä¸åŒçš„çœ‹æ³•, ä¸‹é¢ç”¨ä»£ç æ¥è¯´æ˜ä¸€ä¸‹, å…‰è®²æ¦‚å¿µæœ‰ç‚¹æ™¦æ¶©.\n\n**ä¾‹å­:**\n\n```js\n// ä¸‹é¢æ˜¯ \"å‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£\" çš„å…¸å‹ä»£ç \n\nconst del = (obj) => {\n  let ret;\n  if (!obj.isReadOnly) {\n    if (obj.isFolder) {\n      ret = delFolder(obj);\n    } else if (obj.isFile) {\n      ret = delFile(obj);\n    }\n  }\n  return ret;\n};\n```\n\nåµŒå¥—çš„æ¡ä»¶åˆ†æ”¯ç»å¯¹æ˜¯ä»£ç ç»´æŠ¤è€…çš„å™©æ¢¦, å¤šå±‚åµŒå¥—çš„æ¡ä»¶æ›´åŠ ä¸å®¹æ˜“ç†è§£, æœ‰æ—¶å€™å¦‚æœä»£ç è¿‡é•¿, ä¸Šä¸€ä¸ª `if ()` è¯­å¥å¯èƒ½ç›¸éš”å¾ˆè¿œ. ä¸¥é‡å½±å“äº†é˜…è¯»ä½“éªŒå•Š. é‡æ„çš„ `del` å‡½æ•°å¦‚ä¸‹:\n\n```js\nconst del = (obj) => {\n  if (obj.isReadOnly) { // åè½¬ if\n    return;\n  }\n  if (obj.isFolder) {\n    return delFolder(obj);\n  }\n  if (obj.isFile) {\n    return delFile(obj);\n  }\n};\n\n// ç¬é—´æ¸…çˆ½ ğŸ‘Œ\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\n\næœ‰æ—¶å€™ä¸€ä¸ªå‡½æ•°å¯èƒ½æ¥æ”¶å¤šä¸ªå‚æ•°, è€Œä¸”å‚æ•°é˜…è¯», å°±è¶Šéš¾ç†è§£å’Œä½¿ç”¨. æœ€é‡è¦çš„ä¸€ç‚¹éœ€è¦æ³¨æ„å‚æ•°çš„é¡ºåº, å¦‚æœä¸ä¼ çš„æƒ…å†µè¦ä½¿ç”¨å ä½ç¬¦ä»£æ›¿. å¦‚æœå‚æ•°è¶…è¿‡ 3 ä¸ª, è¯·ä½¿ç”¨å¯¹è±¡å§.\n\n**ä¾‹å­:**\n\n```js\nconst setUserInfo = (id, name, address, sex, mobile, qq) => {\n  // ...\n}\n\n// è°ƒç”¨ â˜¹ï¸:\nsetUserInfo(1, 'ifyour', undefined, 'male', undefined, '123456');\n\n\n// é‡æ„ ğŸ˜:\nsetUserInfo({\n  id: 1,\n  name: 'ifyour',\n  sex: 'male',\n  qq: '123456',\n})\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### å°½é‡å‡å°‘å‚æ•°æ•°é‡\n\nå¦‚æœè°ƒç”¨ä¸€ä¸ªå‡½æ•°, éœ€è¦ä¼ é€’å¾ˆå¤šå‚æ•°, è¿™æ ·çš„å‡½æ•°ç”¨èµ·æ¥å°±è¦å°å¿ƒäº†, å¿…é¡»ææ¸…æ¥šæ¯ä¸ªå‚æ•°çš„å«ä¹‰, æ‰€ä»¥, å¦‚æœèƒ½å°½é‡å°‘ä¼ å‚æ•°å°±å°‘ä¼ å‚æ•°. æŠŠå¤æ‚çš„é€»è¾‘å°è£…åˆ°å‡½æ•°å†…éƒ¨.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: æœ‰ä¸€ä¸ªç”»å›¾å‡½æ•° draw\n\nconst draw = (width, height, square) => {\n  // ...\n};\n\n// ä¼˜åŒ–å¦‚ä¸‹:\nconst draw = (width, height) => {\n  const square = width * height;\n  // ...\n}\n```\n\nè¿™é‡Œçš„ `square` å‚æ•°æ²¡å¿…è¦, å¯ä»¥é€šè¿‡ `width` å’Œ `height` è®¡ç®—è·å¾—, è¿˜æœ‰ä¸€ç§æƒ…å†µ, è¿™ä¸ªç”»å›¾å‡½æ•°, å¦‚æœå¯ä»¥ç”»å¤šç§å›¾å½¢å‘¢? æ‰€ä»¥éœ€è¦åœ¨å†…éƒ¨å»å¤„ç†, ä»€ä¹ˆæ—¶å€™éœ€è¦ `square` ä»€ä¹ˆæ—¶å€™éœ€è¦ `radius`, ç„¶åå¯ä»¥ä½¿ç”¨ **ç­–ç•¥æ¨¡å¼** è®©å®ƒæ”¯æŒç”»å¤šç§å›¾å½¢.\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### å°‘ç”¨ä¸‰ç›®è¿ç®—\n\nä¸‰ç›®è¿ç®—èƒ½å‡å°‘ä»£ç é‡, ä½†æ˜¯ä¸èƒ½æ»¥ç”¨, å¦‚æœä»¥ç‰ºç‰²ä»£ç å¯è¯»æ€§ä¸ºä»£ä»·, é‚£å°±å¾—ä¸å¿å¤±äº†.\n\n```js\nconst global = typeof window !== 'undefined' ? window : this;\n\n// ä½†æ˜¯è¿™ç§æƒ…å†µå°±å®Œå…¨æ²¡å¿…è¦äº†, è€å®å†™ if..else...\n\nif (!aup || !bup) {\n  return a === doc ? -1 :\n    b === doc ? 1 :\n    aup ? -1 :\n    bup ? 1 :\n    sortInput ?\n    (indexOf.call(sortInput, a) - indexOf.call(sortInput, b)) :\n    0;\n}\n\n// ğŸ˜¡ è¿™æ˜¯äººçœ‹çš„å—\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\n\njQuery ä¸­çš„é“¾å¼è°ƒç”¨ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆçˆ½çš„, å®ƒçš„å®ç°ä¹Ÿéå¸¸ç®€å•, æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä¸€ä¸ªé“¾å¼è°ƒç”¨. ä½¿ç”¨çš„å‰æå°±æ˜¯é“¾æ¡çš„ç»“æ„ç›¸å¯¹æ¥è¯´ç¨³å®š, ä¸å®¹æ˜“å‘ç”Ÿä¿®æ”¹, å¦‚æœæ˜¯ç»å¸¸å‘ç”Ÿä¿®æ”¹çš„è¯, è¿˜æ˜¯å»ºè®®ä½¿ç”¨æ™®é€šçš„è°ƒç”¨. å› ä¸ºå®ƒè°ƒè¯•çš„æ—¶å€™éœ€è¦æŠŠè¿™ä¸ªé“¾å­æ‹†å¼€, æ‰çŸ¥é“æ˜¯å“ªä¸ªç¯èŠ‚æœ‰ Bug.\n\n**ä¾‹å­:**\n\n```js\n// ES5\n\nvar User = function() {\n  this.id = null;\n  this.name = null;\n};\n\nUser.prototype.setId = function (id) {\n  this.id = id;\n  return this; // è¿”å›å®ä¾‹æœ¬èº«\n}\n\nUser.prototype.setName = function (name) {\n  this.name = name;\n  return this;\n}\n\n// é“¾å¼è°ƒç”¨\nnew User()\n  .setId(1)\n  .setNmae('ifyour');\n```\n\næˆ–è€…è¿™æ ·:\n\n```js\nvar User = {\n  id: null,\n  name: null,\n  setId: function(id) {\n    this.id = id;\n    return this;\n  },\n  setName: function(name) {\n    this.name = name;\n    return this;\n  }\n};\n\nUser.setId(1).setName('ifyour');\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### åˆ†è§£å¤§å‹ç±»\n\nä»å­—é¢æ„æ€æˆ‘ä»¬å°±èƒ½ç†è§£, å¦‚æœä¸€ä¸ªç±»é‡Œé¢æœ‰å¤ªå¤šçš„æ–¹æ³•, æˆ‘ä»¬è¦è€ƒè™‘æŠŠå…¶ä¸­åŒä¸€ç±»å‹ç›¸å…³çš„æ–¹æ³•æŠ½ç¦»å‡ºæ¥. æ¨¡å—åŒ–çš„å¥½å¤„ä¸è¨€è€Œå–», æŠŠé€»è¾‘å¤æ‚çš„åˆ†ç¦»æˆå°çš„å•å…ƒ, è¿™æ ·æ›´ä¾¿äºç»´æŠ¤, å‡ºç° bug äº†ä¹Ÿå¥½å®šä½é—®é¢˜. æ¥çœ‹ä¸€æ®µä»£ç .\n\n**ä¾‹å­:**\n\n```js\n// è‹±é›„ç±»\nvar Spirit = function() {\n  this.name = name;\n};\n\n// åŸå‹ä¸Šçš„æ”»å‡»æ–¹æ³•\nSpirit.prototype.attack = function (type) {\n  if (type === 'waveBoxing') {\n    console.log(this.name + ': ä½¿ç”¨æ³¢åŠ¨æ‹³');\n  } else if (type === 'whirlKick') {\n    console.log(this.name + ': ä½¿ç”¨æ—‹é£è…¿');\n  }\n  // ... è¿˜æœ‰å¾ˆå¤šæ”»å‡»æ–¹æ³•\n}\n\nvar spirit = new Spirit('RYU');\nspirit.attack('waveBoxing'); // RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³\nspirit.attack('whirlKick'); // RYU: ä½¿ç”¨æ—‹é£è…¿\n```\n\né¢å‘å¯¹è±¡çš„è®¾è®¡é¼“åŠ±å°† **è¡Œä¸º** åˆ†è§£åˆ°åˆç†æ•°é‡çš„æ›´å°çš„å¯¹è±¡ä¸­:\n\n```js\nvar Attack = function (spirit) {\n  this.spirit = spirit;\n};\n\nAttack.prototype.start = function (type) {\n  return this.list[type].call(this);\n}\n\nAttack.prototype.list = function () {\n  waveBoxing: function () {\n    console.log(this.sprite.name + ': ä½¿ç”¨æ³¢åŠ¨æ‹³')\n  },\n  whirlKick: function () {\n    console.log(this.sprite.name + ': ä½¿ç”¨æ—‹é£è…¿')\n  },\n}\n```\n\nç°åœ¨ Sprite ç±»ç²¾ç®€äº†å¾ˆå¤š, ä¸å†ç›´æ¥åŒ…å«æ”»å‡»ç›¸å…³çš„æ–¹æ³•, è€Œæ˜¯æŠŠæ–¹æ³•å§”æ‰˜ç»™ Attack ç±»æ¥æ‰§è¡Œ. è¿™æ®µä»£ç ä¹Ÿæ˜¯ **ç­–ç•¥æ¨¡å¼** çš„è¿ç”¨ä¹‹ä¸€, çœ‹ä»£ç :\n\n```js\nvar Spirit = function() {\n  this.name = name;\n  this.attackObj = new Attack(this);\n};\n\nSpirit.prototype.attack = function (type) {\n  this.attackObj.start(type);\n}\n\nvar spirit = new Spirit('RYU');\nspirit.attack('waveBoxing'); // RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³\nspirit.attack('whirlKick'); // RYU: ä½¿ç”¨æ—‹é£è…¿\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n\n### é€€å‡ºå¤šé‡å¾ªç¯\n\nä½¿ç”¨ `return` é€€å‡ºå¤šé‡å¾ªç¯. ä¸€å®šç¨‹åº¦ä¸Šèƒ½ç®€åŒ–ä»£ç , ä½¿ä»£ç æ›´å®¹æ˜“ç†è§£.\n\n**ä¾‹å­:**\n\n```js\n// éœ€æ±‚: å‡è®¾åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…çš„å¤šé‡å¾ªç¯å†…, è¾¾åˆ°æŸä¸ªä¸´ç•Œæ¡ä»¶æ—¶é€€å‡ºå¾ªç¯\n\nvar func = function () {\n  var flag = false;\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        flag = true;\n        break;\n      }\n    }\n  }\n};\n\n// è¿™ç§ä»£ç çœ‹ç€å°±å¤´æ™•ç›®çœ©, é‡æ„å¦‚ä¸‹:\n\nvar func = function () {\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        return;\n      }\n    }\n  }\n};\n```\n\nç›´æ¥ä½¿ç”¨ `return` å, åé¢çš„ä»£ç æ— æ³•æ‰§è¡Œ, è¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜çš„:\n\n```js\nvar func = function () {\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        return;\n      }\n    }\n  }\n  console.log(i) // æ— æ³•æ‰§è¡Œ\n};\n```\n\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å¯ä»¥æŠŠç›¸å…³çš„ä»£ç æ”¾åˆ° `return` åé¢. å¦‚æœéœ€è¦æ‰§è¡Œçš„ä»£ç è¾ƒå¤š, å¯ä»¥æå–æˆä¸€ä¸ªå‡½æ•°:\n\n```js\nvar print = function (i) {\n  console.log(i)\n};\n\nvar func = function () {\n  for (var i = 0; i < 10; i++) {\n    for (var j = 0; j < 10; j++) {\n      if (i * j > 30) {\n        return print(i); // æ‰§è¡Œ\n      }\n    }\n  }\n};\n```\n\n[â¤´ï¸Go Top](#æ¦‚è¿°)\n","slug":"ä»£ç é‡æ„","published":1,"updated":"2018-06-17T12:50:41.000Z","_id":"cjiitidj7000iu4q9dqo99rfo","layout":"post","photos":[],"link":"","content":"<p>ä»Šå¤©è¯»äº†æ›¾æ¢çš„<a href=\"https://book.douban.com/subject/26382780/\" target=\"_blank\" rel=\"noopener\">ã€Šè®¾è®¡æ¨¡å¼ã€‹</a>ä¸­çš„ä»£ç é‡æ„è¿™ä¸€ç« èŠ‚, çŸ¥è¯†ç‚¹ä¸å¤šå´éå¸¸ä½¿ç”¨, åœ¨å®é™…é¡¹ç›®ä¸­é™¤äº†ä½¿ç”¨è®¾è®¡æ¨¡å¼é‡æ„ä»£ç å¤–, è¿˜æœ‰ä¸€äº›å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚. è¿™äº›ç»†èŠ‚ä¹Ÿæ˜¯é‡æ„çš„é‡è¦æ‰‹æ®µ. å†™è¿™ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹.</p>\n<a id=\"more\"></a>\n<blockquote>\n<p>ä»£ç æ˜¯å†™ç»™äººçœ‹çš„, é¡ºä¾¿ç»™æœºå™¨è¿è¡Œ. ä¼˜é›…çš„ä»£ç åº”è¯¥æ˜¯ç®€å•ã€æ˜“ç»´æŠ¤ã€å¯æ‰©å±•çš„.</p>\n</blockquote>\n<h3 id=\"æ¦‚è¿°\"><a href=\"#æ¦‚è¿°\" class=\"headerlink\" title=\"æ¦‚è¿°\"></a>æ¦‚è¿°</h3><ol>\n<li><a href=\"#æç‚¼å‡½æ•°\">æç‚¼å‡½æ•°</a></li>\n<li><a href=\"#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\">åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</a></li>\n<li><a href=\"#æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\">æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°</a></li>\n<li><a href=\"#åˆç†çš„ä½¿ç”¨å¾ªç¯\">åˆç†çš„ä½¿ç”¨å¾ªç¯</a></li>\n<li><a href=\"#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\">æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯</a></li>\n<li><a href=\"#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\">ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</a></li>\n<li><a href=\"#å°½é‡å‡å°‘å‚æ•°æ•°é‡\">å°½é‡å‡å°‘å‚æ•°æ•°é‡</a></li>\n<li><a href=\"#å°‘ç”¨ä¸‰ç›®è¿ç®—\">å°‘ç”¨ä¸‰ç›®è¿ç®—</a></li>\n<li><a href=\"#åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\">åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨</a></li>\n<li><a href=\"#åˆ†è§£å¤§å‹ç±»\">åˆ†è§£å¤§å‹ç±»</a></li>\n<li><a href=\"#é€€å‡ºå¤šé‡å¾ªç¯\">é€€å‡ºå¤šé‡å¾ªç¯</a></li>\n</ol>\n<h3 id=\"æç‚¼å‡½æ•°\"><a href=\"#æç‚¼å‡½æ•°\" class=\"headerlink\" title=\"æç‚¼å‡½æ•°\"></a>æç‚¼å‡½æ•°</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°è¿‡é•¿, è€Œä¸”éœ€è¦æ³¨é‡Šæ‰æ¸…æ¥šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„, é‚£ä¹ˆéœ€è¦è€ƒè™‘æŠŠå®ƒç‹¬ç«‹å‡ºæ¥. è¿™æ ·åšçš„å¥½å¤„æ˜¯:</p>\n<ul>\n<li>é¿å…è¶…å¤§å‡½æ•°, ä½œç”¨åŸŸè¿‡å¤§å˜é‡ä¸å¥½ç»´æŠ¤</li>\n<li>æŠ½ç¦»å…¬å…±é€»è¾‘, æ˜“äºå¤ç”¨å’Œè¦†å†™</li>\n<li>è‰¯å¥½çš„å‘½åèµ·åˆ°äº†æ³¨é‡Šä½œç”¨</li>\n</ul>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> getUserInfo = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  fetch(<span class=\"string\">'https://xxx.com/userInfo'</span>, (data) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">      userId: <span class=\"subst\">$&#123;data.userId&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">      userName: <span class=\"subst\">$&#123;data.userName&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">      nickName: <span class=\"subst\">$&#123;data.NickName&#125;</span></span></span><br><span class=\"line\"><span class=\"string\">    `</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>é‡æ„å¦‚ä¸‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> printDetail = <span class=\"function\">(<span class=\"params\">data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    userId: <span class=\"subst\">$&#123;data.userId&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">    userName: <span class=\"subst\">$&#123;data.userName&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">    nickName: <span class=\"subst\">$&#123;data.NickName&#125;</span></span></span><br><span class=\"line\"><span class=\"string\">  `</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserInfo = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  fetch(<span class=\"string\">'https://xxx.com/userInfo'</span>, (data) =&gt; &#123;</span><br><span class=\"line\">    printDetail(data);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\"><a href=\"#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\" class=\"headerlink\" title=\"åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\"></a>åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°ä½“å†…æœ‰ä¸€äº›æ¡ä»¶åˆ†æ”¯, è€Œä¸”è¿™äº›æ¡ä»¶åˆ†æ”¯å†…æ•£å¸ƒäº†ä¸€äº›é‡å¤çš„ä»£ç , è¿™ä¸ªæ—¶å€™å°±æœ‰å¿…è¦è¿›è¡Œåˆå¹¶å»é‡æ“ä½œ.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> paging = <span class=\"function\">(<span class=\"params\">currPage</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (currPage &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    currPage = <span class=\"number\">0</span>;</span><br><span class=\"line\">    jump(currPage); <span class=\"comment\">// è·³è½¬</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (currPage &gt;= totalPage) &#123;</span><br><span class=\"line\">    currPage = totalPage;</span><br><span class=\"line\">    jump(currPage); <span class=\"comment\">// è·³è½¬</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    jump(currPage); <span class=\"comment\">// è·³è½¬</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ <code>jump(currPage)</code> é‡å¤äº†, å®Œå…¨å¯ä»¥æŠŠå®ƒç‹¬ç«‹å‡ºæ¥:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> paging = <span class=\"function\">(<span class=\"params\">currPage</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (currPage &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    currPage = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (currPage &gt;= totalPage) &#123;</span><br><span class=\"line\">    currPage = totalPage;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  jump(currPage);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\"><a href=\"#æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\" class=\"headerlink\" title=\"æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\"></a>æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°</h3><p>å¤æ‚çš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯å¯¼è‡´ç¨‹åºéš¾ä»¥é˜…è¯»å’Œç†è§£çš„é‡è¦åŸå› , è€Œä¸”å¾ˆå®¹æ˜“å¯¼è‡´ä¸€ä¸ªåºå¤§çš„å‡½æ•°. è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼å‡ºæ¥.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: å¦‚æœå½“å­£æ˜¯å¤„äºå¤å­£, é‚£ä¹ˆæ‰€æœ‰çš„å•†å“ 8 æŠ˜å‡ºå”®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getPrice = <span class=\"function\">(<span class=\"params\">price</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (date.getMonth() &gt;= <span class=\"number\">6</span> &amp;&amp; date.getMonth() &lt;= <span class=\"number\">9</span>) &#123; <span class=\"comment\">// å¤å­£</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> price * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> price;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>è§‚å¯Ÿè¿™æ®µä»£ç :</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (date.getMonth() &gt;= <span class=\"number\">6</span> &amp;&amp; date.getMonth() &lt;= <span class=\"number\">9</span>) &#123; <span class=\"comment\">// å¤å­£</span></span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬éœ€è¦è®©å®ƒæ›´ç¬¦åˆè¯­ä¹‰, è¿™æ ·è¯»ä»£ç çš„äººèƒ½å¾ˆè½»æ¾ç†è§£æ„å›¾, è¿™é‡Œå°±å¯ä»¥æç‚¼æˆä¸€ä¸ªå•ç‹¬å‡½æ•°.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> isSummer = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">  <span class=\"keyword\">return</span> date.getMonth() &gt;= <span class=\"number\">6</span> &amp;&amp; date.getMonth() &lt;= <span class=\"number\">9</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getPrice = <span class=\"function\">(<span class=\"params\">price</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (isSummer()) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> price * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> price;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆç†çš„ä½¿ç”¨å¾ªç¯\"><a href=\"#åˆç†çš„ä½¿ç”¨å¾ªç¯\" class=\"headerlink\" title=\"åˆç†çš„ä½¿ç”¨å¾ªç¯\"></a>åˆç†çš„ä½¿ç”¨å¾ªç¯</h3><p>åœ¨å‡½æ•°ä½“å†…, å¦‚æœä¸€äº›ä»£ç åªæ˜¯å®Œæˆä¸€äº›é‡å¤çš„å·¥ä½œ, é‚£ä¹ˆå¯ä»¥åˆç†åˆ©ç”¨å¾ªç¯å®ŒæˆåŒæ ·çš„åŠŸèƒ½, è¿™æ ·å¯ä»¥ä¿æŒä»£ç é‡æ›´å°‘.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: IE9 ä»¥ä¸‹åˆ›å»ºä¸€ä¸ª XHR å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> createXHR = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> xhr;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'MSXML2.XMLHttp.6.0'</span>);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span>(e) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'MSXML2.XMLHttp.3.0'</span>)</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span>(e) &#123;</span><br><span class=\"line\">      xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'MSXML2.XMLHttp'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> xhr;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> xhr = createXHR();</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ—¶å€™, ä½¿ç”¨å¾ªç¯æ¥ä¼˜åŒ–ä¸Šé¢çš„ä»£ç :</p>\n<div class=\"tip\">å¤ä¹ ä¸€ä¸‹ <strong>for</strong> å¾ªç¯: <code>for(åˆå§‹å€¼; å¾ªç¯æ¡ä»¶; æ­¥é•¿;) {}</code> </div>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿™æ®µä»£ç å°±çœ‹ç€ç¬¦åˆè¯­ä¹‰äº†, è€Œä¸”å¥½ç†è§£ ğŸ¤¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> createXHR = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> versions = [<span class=\"string\">'MSXML2.XMLHttp.6.0'</span>, <span class=\"string\">'MSXML2.XMLHttp.3.0'</span>, <span class=\"string\">'MSXML2.XMLHttp'</span>];</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>, version; version = versions[i++];) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ActiveXObject(version);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span>(e) &#123;&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> xhr = createXHR();</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\"><a href=\"#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\" class=\"headerlink\" title=\"æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\"></a>æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯</h3><p>å¾ˆå¤šç¨‹åºå‘˜ğŸ‘¨â€ğŸ’»â€éƒ½æœ‰è¿™ç§è§‚å¿µ â€œæ¯ä¸ªå‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£â€, ä½†æ˜¯å…³äº â€œå‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£â€ å¾€å¾€æœ‰ä¸€äº›ä¸åŒçš„çœ‹æ³•, ä¸‹é¢ç”¨ä»£ç æ¥è¯´æ˜ä¸€ä¸‹, å…‰è®²æ¦‚å¿µæœ‰ç‚¹æ™¦æ¶©.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ä¸‹é¢æ˜¯ \"å‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£\" çš„å…¸å‹ä»£ç </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> del = <span class=\"function\">(<span class=\"params\">obj</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> ret;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!obj.isReadOnly) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (obj.isFolder) &#123;</span><br><span class=\"line\">      ret = delFolder(obj);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (obj.isFile) &#123;</span><br><span class=\"line\">      ret = delFile(obj);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>åµŒå¥—çš„æ¡ä»¶åˆ†æ”¯ç»å¯¹æ˜¯ä»£ç ç»´æŠ¤è€…çš„å™©æ¢¦, å¤šå±‚åµŒå¥—çš„æ¡ä»¶æ›´åŠ ä¸å®¹æ˜“ç†è§£, æœ‰æ—¶å€™å¦‚æœä»£ç è¿‡é•¿, ä¸Šä¸€ä¸ª <code>if ()</code> è¯­å¥å¯èƒ½ç›¸éš”å¾ˆè¿œ. ä¸¥é‡å½±å“äº†é˜…è¯»ä½“éªŒå•Š. é‡æ„çš„ <code>del</code> å‡½æ•°å¦‚ä¸‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> del = <span class=\"function\">(<span class=\"params\">obj</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (obj.isReadOnly) &#123; <span class=\"comment\">// åè½¬ if</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (obj.isFolder) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delFolder(obj);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (obj.isFile) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delFile(obj);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç¬é—´æ¸…çˆ½ ğŸ‘Œ</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\"><a href=\"#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\" class=\"headerlink\" title=\"ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\"></a>ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</h3><p>æœ‰æ—¶å€™ä¸€ä¸ªå‡½æ•°å¯èƒ½æ¥æ”¶å¤šä¸ªå‚æ•°, è€Œä¸”å‚æ•°é˜…è¯», å°±è¶Šéš¾ç†è§£å’Œä½¿ç”¨. æœ€é‡è¦çš„ä¸€ç‚¹éœ€è¦æ³¨æ„å‚æ•°çš„é¡ºåº, å¦‚æœä¸ä¼ çš„æƒ…å†µè¦ä½¿ç”¨å ä½ç¬¦ä»£æ›¿. å¦‚æœå‚æ•°è¶…è¿‡ 3 ä¸ª, è¯·ä½¿ç”¨å¯¹è±¡å§.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> setUserInfo = <span class=\"function\">(<span class=\"params\">id, name, address, sex, mobile, qq</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è°ƒç”¨ â˜¹ï¸:</span></span><br><span class=\"line\">setUserInfo(<span class=\"number\">1</span>, <span class=\"string\">'ifyour'</span>, <span class=\"literal\">undefined</span>, <span class=\"string\">'male'</span>, <span class=\"literal\">undefined</span>, <span class=\"string\">'123456'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é‡æ„ ğŸ˜:</span></span><br><span class=\"line\">setUserInfo(&#123;</span><br><span class=\"line\">  id: <span class=\"number\">1</span>,</span><br><span class=\"line\">  name: <span class=\"string\">'ifyour'</span>,</span><br><span class=\"line\">  sex: <span class=\"string\">'male'</span>,</span><br><span class=\"line\">  qq: <span class=\"string\">'123456'</span>,</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"å°½é‡å‡å°‘å‚æ•°æ•°é‡\"><a href=\"#å°½é‡å‡å°‘å‚æ•°æ•°é‡\" class=\"headerlink\" title=\"å°½é‡å‡å°‘å‚æ•°æ•°é‡\"></a>å°½é‡å‡å°‘å‚æ•°æ•°é‡</h3><p>å¦‚æœè°ƒç”¨ä¸€ä¸ªå‡½æ•°, éœ€è¦ä¼ é€’å¾ˆå¤šå‚æ•°, è¿™æ ·çš„å‡½æ•°ç”¨èµ·æ¥å°±è¦å°å¿ƒäº†, å¿…é¡»ææ¸…æ¥šæ¯ä¸ªå‚æ•°çš„å«ä¹‰, æ‰€ä»¥, å¦‚æœèƒ½å°½é‡å°‘ä¼ å‚æ•°å°±å°‘ä¼ å‚æ•°. æŠŠå¤æ‚çš„é€»è¾‘å°è£…åˆ°å‡½æ•°å†…éƒ¨.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: æœ‰ä¸€ä¸ªç”»å›¾å‡½æ•° draw</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> draw = <span class=\"function\">(<span class=\"params\">width, height, square</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼˜åŒ–å¦‚ä¸‹:</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> draw = <span class=\"function\">(<span class=\"params\">width, height</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> square = width * height;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œçš„ <code>square</code> å‚æ•°æ²¡å¿…è¦, å¯ä»¥é€šè¿‡ <code>width</code> å’Œ <code>height</code> è®¡ç®—è·å¾—, è¿˜æœ‰ä¸€ç§æƒ…å†µ, è¿™ä¸ªç”»å›¾å‡½æ•°, å¦‚æœå¯ä»¥ç”»å¤šç§å›¾å½¢å‘¢? æ‰€ä»¥éœ€è¦åœ¨å†…éƒ¨å»å¤„ç†, ä»€ä¹ˆæ—¶å€™éœ€è¦ <code>square</code> ä»€ä¹ˆæ—¶å€™éœ€è¦ <code>radius</code>, ç„¶åå¯ä»¥ä½¿ç”¨ <strong>ç­–ç•¥æ¨¡å¼</strong> è®©å®ƒæ”¯æŒç”»å¤šç§å›¾å½¢.</p>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"å°‘ç”¨ä¸‰ç›®è¿ç®—\"><a href=\"#å°‘ç”¨ä¸‰ç›®è¿ç®—\" class=\"headerlink\" title=\"å°‘ç”¨ä¸‰ç›®è¿ç®—\"></a>å°‘ç”¨ä¸‰ç›®è¿ç®—</h3><p>ä¸‰ç›®è¿ç®—èƒ½å‡å°‘ä»£ç é‡, ä½†æ˜¯ä¸èƒ½æ»¥ç”¨, å¦‚æœä»¥ç‰ºç‰²ä»£ç å¯è¯»æ€§ä¸ºä»£ä»·, é‚£å°±å¾—ä¸å¿å¤±äº†.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> global = <span class=\"keyword\">typeof</span> <span class=\"built_in\">window</span> !== <span class=\"string\">'undefined'</span> ? <span class=\"built_in\">window</span> : <span class=\"keyword\">this</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½†æ˜¯è¿™ç§æƒ…å†µå°±å®Œå…¨æ²¡å¿…è¦äº†, è€å®å†™ if..else...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!aup || !bup) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> a === doc ? <span class=\"number\">-1</span> :</span><br><span class=\"line\">    b === doc ? <span class=\"number\">1</span> :</span><br><span class=\"line\">    aup ? <span class=\"number\">-1</span> :</span><br><span class=\"line\">    bup ? <span class=\"number\">1</span> :</span><br><span class=\"line\">    sortInput ?</span><br><span class=\"line\">    (indexOf.call(sortInput, a) - indexOf.call(sortInput, b)) :</span><br><span class=\"line\">    <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ğŸ˜¡ è¿™æ˜¯äººçœ‹çš„å—</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\"><a href=\"#åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\" class=\"headerlink\" title=\"åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\"></a>åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨</h3><p>jQuery ä¸­çš„é“¾å¼è°ƒç”¨ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆçˆ½çš„, å®ƒçš„å®ç°ä¹Ÿéå¸¸ç®€å•, æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä¸€ä¸ªé“¾å¼è°ƒç”¨. ä½¿ç”¨çš„å‰æå°±æ˜¯é“¾æ¡çš„ç»“æ„ç›¸å¯¹æ¥è¯´ç¨³å®š, ä¸å®¹æ˜“å‘ç”Ÿä¿®æ”¹, å¦‚æœæ˜¯ç»å¸¸å‘ç”Ÿä¿®æ”¹çš„è¯, è¿˜æ˜¯å»ºè®®ä½¿ç”¨æ™®é€šçš„è°ƒç”¨. å› ä¸ºå®ƒè°ƒè¯•çš„æ—¶å€™éœ€è¦æŠŠè¿™ä¸ªé“¾å­æ‹†å¼€, æ‰çŸ¥é“æ˜¯å“ªä¸ªç¯èŠ‚æœ‰ Bug.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ES5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> User = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.id = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">User.prototype.setId = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">id</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>; <span class=\"comment\">// è¿”å›å®ä¾‹æœ¬èº«</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">User.prototype.setName = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é“¾å¼è°ƒç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> User()</span><br><span class=\"line\">  .setId(<span class=\"number\">1</span>)</span><br><span class=\"line\">  .setNmae(<span class=\"string\">'ifyour'</span>);</span><br></pre></td></tr></table></figure>\n<p>æˆ–è€…è¿™æ ·:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> User = &#123;</span><br><span class=\"line\">  id: <span class=\"literal\">null</span>,</span><br><span class=\"line\">  name: <span class=\"literal\">null</span>,</span><br><span class=\"line\">  setId: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">id</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  setName: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">User.setId(<span class=\"number\">1</span>).setName(<span class=\"string\">'ifyour'</span>);</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆ†è§£å¤§å‹ç±»\"><a href=\"#åˆ†è§£å¤§å‹ç±»\" class=\"headerlink\" title=\"åˆ†è§£å¤§å‹ç±»\"></a>åˆ†è§£å¤§å‹ç±»</h3><p>ä»å­—é¢æ„æ€æˆ‘ä»¬å°±èƒ½ç†è§£, å¦‚æœä¸€ä¸ªç±»é‡Œé¢æœ‰å¤ªå¤šçš„æ–¹æ³•, æˆ‘ä»¬è¦è€ƒè™‘æŠŠå…¶ä¸­åŒä¸€ç±»å‹ç›¸å…³çš„æ–¹æ³•æŠ½ç¦»å‡ºæ¥. æ¨¡å—åŒ–çš„å¥½å¤„ä¸è¨€è€Œå–», æŠŠé€»è¾‘å¤æ‚çš„åˆ†ç¦»æˆå°çš„å•å…ƒ, è¿™æ ·æ›´ä¾¿äºç»´æŠ¤, å‡ºç° bug äº†ä¹Ÿå¥½å®šä½é—®é¢˜. æ¥çœ‹ä¸€æ®µä»£ç .</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è‹±é›„ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Spirit = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åŸå‹ä¸Šçš„æ”»å‡»æ–¹æ³•</span></span><br><span class=\"line\">Spirit.prototype.attack = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">type</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (type === <span class=\"string\">'waveBoxing'</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name + <span class=\"string\">': ä½¿ç”¨æ³¢åŠ¨æ‹³'</span>);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (type === <span class=\"string\">'whirlKick'</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name + <span class=\"string\">': ä½¿ç”¨æ—‹é£è…¿'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// ... è¿˜æœ‰å¾ˆå¤šæ”»å‡»æ–¹æ³•</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> spirit = <span class=\"keyword\">new</span> Spirit(<span class=\"string\">'RYU'</span>);</span><br><span class=\"line\">spirit.attack(<span class=\"string\">'waveBoxing'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³</span></span><br><span class=\"line\">spirit.attack(<span class=\"string\">'whirlKick'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ—‹é£è…¿</span></span><br></pre></td></tr></table></figure>\n<p>é¢å‘å¯¹è±¡çš„è®¾è®¡é¼“åŠ±å°† <strong>è¡Œä¸º</strong> åˆ†è§£åˆ°åˆç†æ•°é‡çš„æ›´å°çš„å¯¹è±¡ä¸­:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> Attack = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">spirit</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.spirit = spirit;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Attack.prototype.start = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">type</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.list[type].call(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Attack.prototype.list = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  waveBoxing: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.sprite.name + <span class=\"string\">': ä½¿ç”¨æ³¢åŠ¨æ‹³'</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  whirlKick: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.sprite.name + <span class=\"string\">': ä½¿ç”¨æ—‹é£è…¿'</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ Sprite ç±»ç²¾ç®€äº†å¾ˆå¤š, ä¸å†ç›´æ¥åŒ…å«æ”»å‡»ç›¸å…³çš„æ–¹æ³•, è€Œæ˜¯æŠŠæ–¹æ³•å§”æ‰˜ç»™ Attack ç±»æ¥æ‰§è¡Œ. è¿™æ®µä»£ç ä¹Ÿæ˜¯ <strong>ç­–ç•¥æ¨¡å¼</strong> çš„è¿ç”¨ä¹‹ä¸€, çœ‹ä»£ç :</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> Spirit = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.attackObj = <span class=\"keyword\">new</span> Attack(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Spirit.prototype.attack = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">type</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.attackObj.start(type);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> spirit = <span class=\"keyword\">new</span> Spirit(<span class=\"string\">'RYU'</span>);</span><br><span class=\"line\">spirit.attack(<span class=\"string\">'waveBoxing'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³</span></span><br><span class=\"line\">spirit.attack(<span class=\"string\">'whirlKick'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ—‹é£è…¿</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"é€€å‡ºå¤šé‡å¾ªç¯\"><a href=\"#é€€å‡ºå¤šé‡å¾ªç¯\" class=\"headerlink\" title=\"é€€å‡ºå¤šé‡å¾ªç¯\"></a>é€€å‡ºå¤šé‡å¾ªç¯</h3><p>ä½¿ç”¨ <code>return</code> é€€å‡ºå¤šé‡å¾ªç¯. ä¸€å®šç¨‹åº¦ä¸Šèƒ½ç®€åŒ–ä»£ç , ä½¿ä»£ç æ›´å®¹æ˜“ç†è§£.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: å‡è®¾åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…çš„å¤šé‡å¾ªç¯å†…, è¾¾åˆ°æŸä¸ªä¸´ç•Œæ¡ä»¶æ—¶é€€å‡ºå¾ªç¯</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¿™ç§ä»£ç çœ‹ç€å°±å¤´æ™•ç›®çœ©, é‡æ„å¦‚ä¸‹:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>ç›´æ¥ä½¿ç”¨ <code>return</code> å, åé¢çš„ä»£ç æ— æ³•æ‰§è¡Œ, è¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜çš„:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(i) <span class=\"comment\">// æ— æ³•æ‰§è¡Œ</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å¯ä»¥æŠŠç›¸å…³çš„ä»£ç æ”¾åˆ° <code>return</code> åé¢. å¦‚æœéœ€è¦æ‰§è¡Œçš„ä»£ç è¾ƒå¤š, å¯ä»¥æå–æˆä¸€ä¸ªå‡½æ•°:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> print = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">i</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(i)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> print(i); <span class=\"comment\">// æ‰§è¡Œ</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n","site":{"data":{}},"excerpt":"<p>ä»Šå¤©è¯»äº†æ›¾æ¢çš„<a href=\"https://book.douban.com/subject/26382780/\" target=\"_blank\" rel=\"noopener\">ã€Šè®¾è®¡æ¨¡å¼ã€‹</a>ä¸­çš„ä»£ç é‡æ„è¿™ä¸€ç« èŠ‚, çŸ¥è¯†ç‚¹ä¸å¤šå´éå¸¸ä½¿ç”¨, åœ¨å®é™…é¡¹ç›®ä¸­é™¤äº†ä½¿ç”¨è®¾è®¡æ¨¡å¼é‡æ„ä»£ç å¤–, è¿˜æœ‰ä¸€äº›å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚. è¿™äº›ç»†èŠ‚ä¹Ÿæ˜¯é‡æ„çš„é‡è¦æ‰‹æ®µ. å†™è¿™ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹.</p>","more":"<blockquote>\n<p>ä»£ç æ˜¯å†™ç»™äººçœ‹çš„, é¡ºä¾¿ç»™æœºå™¨è¿è¡Œ. ä¼˜é›…çš„ä»£ç åº”è¯¥æ˜¯ç®€å•ã€æ˜“ç»´æŠ¤ã€å¯æ‰©å±•çš„.</p>\n</blockquote>\n<h3 id=\"æ¦‚è¿°\"><a href=\"#æ¦‚è¿°\" class=\"headerlink\" title=\"æ¦‚è¿°\"></a>æ¦‚è¿°</h3><ol>\n<li><a href=\"#æç‚¼å‡½æ•°\">æç‚¼å‡½æ•°</a></li>\n<li><a href=\"#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\">åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</a></li>\n<li><a href=\"#æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\">æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°</a></li>\n<li><a href=\"#åˆç†çš„ä½¿ç”¨å¾ªç¯\">åˆç†çš„ä½¿ç”¨å¾ªç¯</a></li>\n<li><a href=\"#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\">æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯</a></li>\n<li><a href=\"#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\">ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</a></li>\n<li><a href=\"#å°½é‡å‡å°‘å‚æ•°æ•°é‡\">å°½é‡å‡å°‘å‚æ•°æ•°é‡</a></li>\n<li><a href=\"#å°‘ç”¨ä¸‰ç›®è¿ç®—\">å°‘ç”¨ä¸‰ç›®è¿ç®—</a></li>\n<li><a href=\"#åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\">åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨</a></li>\n<li><a href=\"#åˆ†è§£å¤§å‹ç±»\">åˆ†è§£å¤§å‹ç±»</a></li>\n<li><a href=\"#é€€å‡ºå¤šé‡å¾ªç¯\">é€€å‡ºå¤šé‡å¾ªç¯</a></li>\n</ol>\n<h3 id=\"æç‚¼å‡½æ•°\"><a href=\"#æç‚¼å‡½æ•°\" class=\"headerlink\" title=\"æç‚¼å‡½æ•°\"></a>æç‚¼å‡½æ•°</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°è¿‡é•¿, è€Œä¸”éœ€è¦æ³¨é‡Šæ‰æ¸…æ¥šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„, é‚£ä¹ˆéœ€è¦è€ƒè™‘æŠŠå®ƒç‹¬ç«‹å‡ºæ¥. è¿™æ ·åšçš„å¥½å¤„æ˜¯:</p>\n<ul>\n<li>é¿å…è¶…å¤§å‡½æ•°, ä½œç”¨åŸŸè¿‡å¤§å˜é‡ä¸å¥½ç»´æŠ¤</li>\n<li>æŠ½ç¦»å…¬å…±é€»è¾‘, æ˜“äºå¤ç”¨å’Œè¦†å†™</li>\n<li>è‰¯å¥½çš„å‘½åèµ·åˆ°äº†æ³¨é‡Šä½œç”¨</li>\n</ul>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> getUserInfo = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  fetch(<span class=\"string\">'https://xxx.com/userInfo'</span>, (data) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">      userId: <span class=\"subst\">$&#123;data.userId&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">      userName: <span class=\"subst\">$&#123;data.userName&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">      nickName: <span class=\"subst\">$&#123;data.NickName&#125;</span></span></span><br><span class=\"line\"><span class=\"string\">    `</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>é‡æ„å¦‚ä¸‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> printDetail = <span class=\"function\">(<span class=\"params\">data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    userId: <span class=\"subst\">$&#123;data.userId&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">    userName: <span class=\"subst\">$&#123;data.userName&#125;</span>\\n</span></span><br><span class=\"line\"><span class=\"string\">    nickName: <span class=\"subst\">$&#123;data.NickName&#125;</span></span></span><br><span class=\"line\"><span class=\"string\">  `</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getUserInfo = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  fetch(<span class=\"string\">'https://xxx.com/userInfo'</span>, (data) =&gt; &#123;</span><br><span class=\"line\">    printDetail(data);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\"><a href=\"#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\" class=\"headerlink\" title=\"åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ\"></a>åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°ä½“å†…æœ‰ä¸€äº›æ¡ä»¶åˆ†æ”¯, è€Œä¸”è¿™äº›æ¡ä»¶åˆ†æ”¯å†…æ•£å¸ƒäº†ä¸€äº›é‡å¤çš„ä»£ç , è¿™ä¸ªæ—¶å€™å°±æœ‰å¿…è¦è¿›è¡Œåˆå¹¶å»é‡æ“ä½œ.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> paging = <span class=\"function\">(<span class=\"params\">currPage</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (currPage &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    currPage = <span class=\"number\">0</span>;</span><br><span class=\"line\">    jump(currPage); <span class=\"comment\">// è·³è½¬</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (currPage &gt;= totalPage) &#123;</span><br><span class=\"line\">    currPage = totalPage;</span><br><span class=\"line\">    jump(currPage); <span class=\"comment\">// è·³è½¬</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    jump(currPage); <span class=\"comment\">// è·³è½¬</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ <code>jump(currPage)</code> é‡å¤äº†, å®Œå…¨å¯ä»¥æŠŠå®ƒç‹¬ç«‹å‡ºæ¥:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> paging = <span class=\"function\">(<span class=\"params\">currPage</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (currPage &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    currPage = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (currPage &gt;= totalPage) &#123;</span><br><span class=\"line\">    currPage = totalPage;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  jump(currPage);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\"><a href=\"#æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\" class=\"headerlink\" title=\"æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°\"></a>æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•°</h3><p>å¤æ‚çš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯å¯¼è‡´ç¨‹åºéš¾ä»¥é˜…è¯»å’Œç†è§£çš„é‡è¦åŸå› , è€Œä¸”å¾ˆå®¹æ˜“å¯¼è‡´ä¸€ä¸ªåºå¤§çš„å‡½æ•°. è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼å‡ºæ¥.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: å¦‚æœå½“å­£æ˜¯å¤„äºå¤å­£, é‚£ä¹ˆæ‰€æœ‰çš„å•†å“ 8 æŠ˜å‡ºå”®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getPrice = <span class=\"function\">(<span class=\"params\">price</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (date.getMonth() &gt;= <span class=\"number\">6</span> &amp;&amp; date.getMonth() &lt;= <span class=\"number\">9</span>) &#123; <span class=\"comment\">// å¤å­£</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> price * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> price;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>è§‚å¯Ÿè¿™æ®µä»£ç :</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (date.getMonth() &gt;= <span class=\"number\">6</span> &amp;&amp; date.getMonth() &lt;= <span class=\"number\">9</span>) &#123; <span class=\"comment\">// å¤å­£</span></span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬éœ€è¦è®©å®ƒæ›´ç¬¦åˆè¯­ä¹‰, è¿™æ ·è¯»ä»£ç çš„äººèƒ½å¾ˆè½»æ¾ç†è§£æ„å›¾, è¿™é‡Œå°±å¯ä»¥æç‚¼æˆä¸€ä¸ªå•ç‹¬å‡½æ•°.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> isSummer = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">  <span class=\"keyword\">return</span> date.getMonth() &gt;= <span class=\"number\">6</span> &amp;&amp; date.getMonth() &lt;= <span class=\"number\">9</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> getPrice = <span class=\"function\">(<span class=\"params\">price</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (isSummer()) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> price * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> price;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆç†çš„ä½¿ç”¨å¾ªç¯\"><a href=\"#åˆç†çš„ä½¿ç”¨å¾ªç¯\" class=\"headerlink\" title=\"åˆç†çš„ä½¿ç”¨å¾ªç¯\"></a>åˆç†çš„ä½¿ç”¨å¾ªç¯</h3><p>åœ¨å‡½æ•°ä½“å†…, å¦‚æœä¸€äº›ä»£ç åªæ˜¯å®Œæˆä¸€äº›é‡å¤çš„å·¥ä½œ, é‚£ä¹ˆå¯ä»¥åˆç†åˆ©ç”¨å¾ªç¯å®ŒæˆåŒæ ·çš„åŠŸèƒ½, è¿™æ ·å¯ä»¥ä¿æŒä»£ç é‡æ›´å°‘.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: IE9 ä»¥ä¸‹åˆ›å»ºä¸€ä¸ª XHR å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> createXHR = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> xhr;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'MSXML2.XMLHttp.6.0'</span>);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span>(e) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'MSXML2.XMLHttp.3.0'</span>)</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span>(e) &#123;</span><br><span class=\"line\">      xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'MSXML2.XMLHttp'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> xhr;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> xhr = createXHR();</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ—¶å€™, ä½¿ç”¨å¾ªç¯æ¥ä¼˜åŒ–ä¸Šé¢çš„ä»£ç :</p>\n<div class=\"tip\">å¤ä¹ ä¸€ä¸‹ <strong>for</strong> å¾ªç¯: <code>for(åˆå§‹å€¼; å¾ªç¯æ¡ä»¶; æ­¥é•¿;) {}</code> </div>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿™æ®µä»£ç å°±çœ‹ç€ç¬¦åˆè¯­ä¹‰äº†, è€Œä¸”å¥½ç†è§£ ğŸ¤¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> createXHR = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> versions = [<span class=\"string\">'MSXML2.XMLHttp.6.0'</span>, <span class=\"string\">'MSXML2.XMLHttp.3.0'</span>, <span class=\"string\">'MSXML2.XMLHttp'</span>];</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>, version; version = versions[i++];) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ActiveXObject(version);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span>(e) &#123;&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> xhr = createXHR();</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\"><a href=\"#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\" class=\"headerlink\" title=\"æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯\"></a>æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯</h3><p>å¾ˆå¤šç¨‹åºå‘˜ğŸ‘¨â€ğŸ’»â€éƒ½æœ‰è¿™ç§è§‚å¿µ â€œæ¯ä¸ªå‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£â€, ä½†æ˜¯å…³äº â€œå‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£â€ å¾€å¾€æœ‰ä¸€äº›ä¸åŒçš„çœ‹æ³•, ä¸‹é¢ç”¨ä»£ç æ¥è¯´æ˜ä¸€ä¸‹, å…‰è®²æ¦‚å¿µæœ‰ç‚¹æ™¦æ¶©.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ä¸‹é¢æ˜¯ \"å‡½æ•°åªæœ‰ä¸€ä¸ªå‡ºå£\" çš„å…¸å‹ä»£ç </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> del = <span class=\"function\">(<span class=\"params\">obj</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> ret;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!obj.isReadOnly) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (obj.isFolder) &#123;</span><br><span class=\"line\">      ret = delFolder(obj);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (obj.isFile) &#123;</span><br><span class=\"line\">      ret = delFile(obj);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>åµŒå¥—çš„æ¡ä»¶åˆ†æ”¯ç»å¯¹æ˜¯ä»£ç ç»´æŠ¤è€…çš„å™©æ¢¦, å¤šå±‚åµŒå¥—çš„æ¡ä»¶æ›´åŠ ä¸å®¹æ˜“ç†è§£, æœ‰æ—¶å€™å¦‚æœä»£ç è¿‡é•¿, ä¸Šä¸€ä¸ª <code>if ()</code> è¯­å¥å¯èƒ½ç›¸éš”å¾ˆè¿œ. ä¸¥é‡å½±å“äº†é˜…è¯»ä½“éªŒå•Š. é‡æ„çš„ <code>del</code> å‡½æ•°å¦‚ä¸‹:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> del = <span class=\"function\">(<span class=\"params\">obj</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (obj.isReadOnly) &#123; <span class=\"comment\">// åè½¬ if</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (obj.isFolder) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delFolder(obj);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (obj.isFile) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> delFile(obj);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç¬é—´æ¸…çˆ½ ğŸ‘Œ</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\"><a href=\"#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\" class=\"headerlink\" title=\"ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨\"></a>ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</h3><p>æœ‰æ—¶å€™ä¸€ä¸ªå‡½æ•°å¯èƒ½æ¥æ”¶å¤šä¸ªå‚æ•°, è€Œä¸”å‚æ•°é˜…è¯», å°±è¶Šéš¾ç†è§£å’Œä½¿ç”¨. æœ€é‡è¦çš„ä¸€ç‚¹éœ€è¦æ³¨æ„å‚æ•°çš„é¡ºåº, å¦‚æœä¸ä¼ çš„æƒ…å†µè¦ä½¿ç”¨å ä½ç¬¦ä»£æ›¿. å¦‚æœå‚æ•°è¶…è¿‡ 3 ä¸ª, è¯·ä½¿ç”¨å¯¹è±¡å§.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> setUserInfo = <span class=\"function\">(<span class=\"params\">id, name, address, sex, mobile, qq</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è°ƒç”¨ â˜¹ï¸:</span></span><br><span class=\"line\">setUserInfo(<span class=\"number\">1</span>, <span class=\"string\">'ifyour'</span>, <span class=\"literal\">undefined</span>, <span class=\"string\">'male'</span>, <span class=\"literal\">undefined</span>, <span class=\"string\">'123456'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é‡æ„ ğŸ˜:</span></span><br><span class=\"line\">setUserInfo(&#123;</span><br><span class=\"line\">  id: <span class=\"number\">1</span>,</span><br><span class=\"line\">  name: <span class=\"string\">'ifyour'</span>,</span><br><span class=\"line\">  sex: <span class=\"string\">'male'</span>,</span><br><span class=\"line\">  qq: <span class=\"string\">'123456'</span>,</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"å°½é‡å‡å°‘å‚æ•°æ•°é‡\"><a href=\"#å°½é‡å‡å°‘å‚æ•°æ•°é‡\" class=\"headerlink\" title=\"å°½é‡å‡å°‘å‚æ•°æ•°é‡\"></a>å°½é‡å‡å°‘å‚æ•°æ•°é‡</h3><p>å¦‚æœè°ƒç”¨ä¸€ä¸ªå‡½æ•°, éœ€è¦ä¼ é€’å¾ˆå¤šå‚æ•°, è¿™æ ·çš„å‡½æ•°ç”¨èµ·æ¥å°±è¦å°å¿ƒäº†, å¿…é¡»ææ¸…æ¥šæ¯ä¸ªå‚æ•°çš„å«ä¹‰, æ‰€ä»¥, å¦‚æœèƒ½å°½é‡å°‘ä¼ å‚æ•°å°±å°‘ä¼ å‚æ•°. æŠŠå¤æ‚çš„é€»è¾‘å°è£…åˆ°å‡½æ•°å†…éƒ¨.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: æœ‰ä¸€ä¸ªç”»å›¾å‡½æ•° draw</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> draw = <span class=\"function\">(<span class=\"params\">width, height, square</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¼˜åŒ–å¦‚ä¸‹:</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> draw = <span class=\"function\">(<span class=\"params\">width, height</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> square = width * height;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œçš„ <code>square</code> å‚æ•°æ²¡å¿…è¦, å¯ä»¥é€šè¿‡ <code>width</code> å’Œ <code>height</code> è®¡ç®—è·å¾—, è¿˜æœ‰ä¸€ç§æƒ…å†µ, è¿™ä¸ªç”»å›¾å‡½æ•°, å¦‚æœå¯ä»¥ç”»å¤šç§å›¾å½¢å‘¢? æ‰€ä»¥éœ€è¦åœ¨å†…éƒ¨å»å¤„ç†, ä»€ä¹ˆæ—¶å€™éœ€è¦ <code>square</code> ä»€ä¹ˆæ—¶å€™éœ€è¦ <code>radius</code>, ç„¶åå¯ä»¥ä½¿ç”¨ <strong>ç­–ç•¥æ¨¡å¼</strong> è®©å®ƒæ”¯æŒç”»å¤šç§å›¾å½¢.</p>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"å°‘ç”¨ä¸‰ç›®è¿ç®—\"><a href=\"#å°‘ç”¨ä¸‰ç›®è¿ç®—\" class=\"headerlink\" title=\"å°‘ç”¨ä¸‰ç›®è¿ç®—\"></a>å°‘ç”¨ä¸‰ç›®è¿ç®—</h3><p>ä¸‰ç›®è¿ç®—èƒ½å‡å°‘ä»£ç é‡, ä½†æ˜¯ä¸èƒ½æ»¥ç”¨, å¦‚æœä»¥ç‰ºç‰²ä»£ç å¯è¯»æ€§ä¸ºä»£ä»·, é‚£å°±å¾—ä¸å¿å¤±äº†.</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> global = <span class=\"keyword\">typeof</span> <span class=\"built_in\">window</span> !== <span class=\"string\">'undefined'</span> ? <span class=\"built_in\">window</span> : <span class=\"keyword\">this</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä½†æ˜¯è¿™ç§æƒ…å†µå°±å®Œå…¨æ²¡å¿…è¦äº†, è€å®å†™ if..else...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!aup || !bup) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> a === doc ? <span class=\"number\">-1</span> :</span><br><span class=\"line\">    b === doc ? <span class=\"number\">1</span> :</span><br><span class=\"line\">    aup ? <span class=\"number\">-1</span> :</span><br><span class=\"line\">    bup ? <span class=\"number\">1</span> :</span><br><span class=\"line\">    sortInput ?</span><br><span class=\"line\">    (indexOf.call(sortInput, a) - indexOf.call(sortInput, b)) :</span><br><span class=\"line\">    <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ğŸ˜¡ è¿™æ˜¯äººçœ‹çš„å—</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\"><a href=\"#åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\" class=\"headerlink\" title=\"åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨\"></a>åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨</h3><p>jQuery ä¸­çš„é“¾å¼è°ƒç”¨ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆçˆ½çš„, å®ƒçš„å®ç°ä¹Ÿéå¸¸ç®€å•, æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä¸€ä¸ªé“¾å¼è°ƒç”¨. ä½¿ç”¨çš„å‰æå°±æ˜¯é“¾æ¡çš„ç»“æ„ç›¸å¯¹æ¥è¯´ç¨³å®š, ä¸å®¹æ˜“å‘ç”Ÿä¿®æ”¹, å¦‚æœæ˜¯ç»å¸¸å‘ç”Ÿä¿®æ”¹çš„è¯, è¿˜æ˜¯å»ºè®®ä½¿ç”¨æ™®é€šçš„è°ƒç”¨. å› ä¸ºå®ƒè°ƒè¯•çš„æ—¶å€™éœ€è¦æŠŠè¿™ä¸ªé“¾å­æ‹†å¼€, æ‰çŸ¥é“æ˜¯å“ªä¸ªç¯èŠ‚æœ‰ Bug.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ES5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> User = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.id = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">User.prototype.setId = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">id</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>; <span class=\"comment\">// è¿”å›å®ä¾‹æœ¬èº«</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">User.prototype.setName = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// é“¾å¼è°ƒç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> User()</span><br><span class=\"line\">  .setId(<span class=\"number\">1</span>)</span><br><span class=\"line\">  .setNmae(<span class=\"string\">'ifyour'</span>);</span><br></pre></td></tr></table></figure>\n<p>æˆ–è€…è¿™æ ·:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> User = &#123;</span><br><span class=\"line\">  id: <span class=\"literal\">null</span>,</span><br><span class=\"line\">  name: <span class=\"literal\">null</span>,</span><br><span class=\"line\">  setId: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">id</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  setName: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">User.setId(<span class=\"number\">1</span>).setName(<span class=\"string\">'ifyour'</span>);</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"åˆ†è§£å¤§å‹ç±»\"><a href=\"#åˆ†è§£å¤§å‹ç±»\" class=\"headerlink\" title=\"åˆ†è§£å¤§å‹ç±»\"></a>åˆ†è§£å¤§å‹ç±»</h3><p>ä»å­—é¢æ„æ€æˆ‘ä»¬å°±èƒ½ç†è§£, å¦‚æœä¸€ä¸ªç±»é‡Œé¢æœ‰å¤ªå¤šçš„æ–¹æ³•, æˆ‘ä»¬è¦è€ƒè™‘æŠŠå…¶ä¸­åŒä¸€ç±»å‹ç›¸å…³çš„æ–¹æ³•æŠ½ç¦»å‡ºæ¥. æ¨¡å—åŒ–çš„å¥½å¤„ä¸è¨€è€Œå–», æŠŠé€»è¾‘å¤æ‚çš„åˆ†ç¦»æˆå°çš„å•å…ƒ, è¿™æ ·æ›´ä¾¿äºç»´æŠ¤, å‡ºç° bug äº†ä¹Ÿå¥½å®šä½é—®é¢˜. æ¥çœ‹ä¸€æ®µä»£ç .</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è‹±é›„ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Spirit = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åŸå‹ä¸Šçš„æ”»å‡»æ–¹æ³•</span></span><br><span class=\"line\">Spirit.prototype.attack = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">type</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (type === <span class=\"string\">'waveBoxing'</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name + <span class=\"string\">': ä½¿ç”¨æ³¢åŠ¨æ‹³'</span>);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (type === <span class=\"string\">'whirlKick'</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name + <span class=\"string\">': ä½¿ç”¨æ—‹é£è…¿'</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// ... è¿˜æœ‰å¾ˆå¤šæ”»å‡»æ–¹æ³•</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> spirit = <span class=\"keyword\">new</span> Spirit(<span class=\"string\">'RYU'</span>);</span><br><span class=\"line\">spirit.attack(<span class=\"string\">'waveBoxing'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³</span></span><br><span class=\"line\">spirit.attack(<span class=\"string\">'whirlKick'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ—‹é£è…¿</span></span><br></pre></td></tr></table></figure>\n<p>é¢å‘å¯¹è±¡çš„è®¾è®¡é¼“åŠ±å°† <strong>è¡Œä¸º</strong> åˆ†è§£åˆ°åˆç†æ•°é‡çš„æ›´å°çš„å¯¹è±¡ä¸­:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> Attack = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">spirit</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.spirit = spirit;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Attack.prototype.start = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">type</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.list[type].call(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Attack.prototype.list = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  waveBoxing: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.sprite.name + <span class=\"string\">': ä½¿ç”¨æ³¢åŠ¨æ‹³'</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  whirlKick: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.sprite.name + <span class=\"string\">': ä½¿ç”¨æ—‹é£è…¿'</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç°åœ¨ Sprite ç±»ç²¾ç®€äº†å¾ˆå¤š, ä¸å†ç›´æ¥åŒ…å«æ”»å‡»ç›¸å…³çš„æ–¹æ³•, è€Œæ˜¯æŠŠæ–¹æ³•å§”æ‰˜ç»™ Attack ç±»æ¥æ‰§è¡Œ. è¿™æ®µä»£ç ä¹Ÿæ˜¯ <strong>ç­–ç•¥æ¨¡å¼</strong> çš„è¿ç”¨ä¹‹ä¸€, çœ‹ä»£ç :</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> Spirit = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.attackObj = <span class=\"keyword\">new</span> Attack(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Spirit.prototype.attack = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">type</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.attackObj.start(type);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> spirit = <span class=\"keyword\">new</span> Spirit(<span class=\"string\">'RYU'</span>);</span><br><span class=\"line\">spirit.attack(<span class=\"string\">'waveBoxing'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ³¢åŠ¨æ‹³</span></span><br><span class=\"line\">spirit.attack(<span class=\"string\">'whirlKick'</span>); <span class=\"comment\">// RYU: ä½¿ç”¨æ—‹é£è…¿</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>\n<h3 id=\"é€€å‡ºå¤šé‡å¾ªç¯\"><a href=\"#é€€å‡ºå¤šé‡å¾ªç¯\" class=\"headerlink\" title=\"é€€å‡ºå¤šé‡å¾ªç¯\"></a>é€€å‡ºå¤šé‡å¾ªç¯</h3><p>ä½¿ç”¨ <code>return</code> é€€å‡ºå¤šé‡å¾ªç¯. ä¸€å®šç¨‹åº¦ä¸Šèƒ½ç®€åŒ–ä»£ç , ä½¿ä»£ç æ›´å®¹æ˜“ç†è§£.</p>\n<p><strong>ä¾‹å­:</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// éœ€æ±‚: å‡è®¾åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…çš„å¤šé‡å¾ªç¯å†…, è¾¾åˆ°æŸä¸ªä¸´ç•Œæ¡ä»¶æ—¶é€€å‡ºå¾ªç¯</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¿™ç§ä»£ç çœ‹ç€å°±å¤´æ™•ç›®çœ©, é‡æ„å¦‚ä¸‹:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>ç›´æ¥ä½¿ç”¨ <code>return</code> å, åé¢çš„ä»£ç æ— æ³•æ‰§è¡Œ, è¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜çš„:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(i) <span class=\"comment\">// æ— æ³•æ‰§è¡Œ</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å¯ä»¥æŠŠç›¸å…³çš„ä»£ç æ”¾åˆ° <code>return</code> åé¢. å¦‚æœéœ€è¦æ‰§è¡Œçš„ä»£ç è¾ƒå¤š, å¯ä»¥æå–æˆä¸€ä¸ªå‡½æ•°:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> print = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">i</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(i)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> func = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i * j &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> print(i); <span class=\"comment\">// æ‰§è¡Œ</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><a href=\"#æ¦‚è¿°\">â¤´ï¸Go Top</a></p>"},{"title":"ä¸€æ®µç¥å¥‡çš„ CSS è°ƒè¯•ä»£ç ","date":"2016-03-22T08:32:52.000Z","comments":0,"_content":"\nç°åœ¨åˆ°å¤„éƒ½æ˜¯ JavaScriptï¼Œå€˜è‹¥èŠ±ç‚¹æ—¶é—´å»æ·±å…¥åˆ†æï¼Œæ¯æ¬¡éƒ½èƒ½å­¦åˆ°ç‚¹æ–°çš„ä¸œè¥¿ã€‚å½“æˆ‘å‘ç°äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼Œä¹ æƒ¯å…ˆæ”¶è—èµ·æ¥ã€‚ç­‰æ—¶æŠ€ï¼ˆæ—¶é—´ï¼‹æŠ€æœ¯ï¼‰æˆç†Ÿï¼Œå†å» Review ä»–ä»¬çš„ä»£ç ï¼Œçœ‹ä¸€çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œè§ˆä¸€è§ˆå¤§ç‰›ä»¬çš„ â€œå¥‡æŠ€æ·«å·§â€ã€‚\n<!-- more -->\n### ä»£ç ç‰‡æ®µ\n\n```js\n[].forEach.call($$(\"*\"),function(a){\n    a.style.outline=\"1px solid #\"+(~~(Math.random()*(1<<24))).toString(16);\n})\n```\nåœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œæ­¤æ®µä»£ç ï¼Œä¼šç»™é¡µé¢é‡Œæ‰€æœ‰çš„ DOM å…ƒç´ æ·»åŠ ä¸€ä¸ª 1px çš„æè¾¹ï¼ˆoutlineï¼‰ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨è°ƒè¯• CSS è¿‡ç¨‹ä¸­åˆ†æã€æ’æŸ¥é—®é¢˜ã€‚\n![](http://ww1.sinaimg.cn/large/6057861cgy1fbzi0vggl6j21kw0vyq8s.jpg)\n\n\n### ä»£ç åˆ†æ\nè¿™æ®µä»£ç æ˜¯ Github ä¸Šçš„ 140 Bytes æ´»åŠ¨ä¸­çš„ä»£ç ï¼Œç®€å•åˆ†æä¸‹è¿™æ®µ JS ä»£ç ï¼Œä½œè€…ä½¿ç”¨äº†ä¸å°‘æŠ€å·§ï¼š\n\né¦–å…ˆæ˜¯éœ€è¦é€‰æ‹©é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œä½¿ç”¨äº†åªèƒ½åœ¨ Console è°ƒè¯•å·¥å…·ä¸­ä½¿ç”¨çš„ `$$` å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨ Console ä¸­è¾“å…¥ `$$('a')` è‡ªå·±è¯•ä¸€ä¸‹ã€‚å®ƒä¼šè¿”å›å½“å‰é¡µé¢çš„æ‰€æœ‰ anchorï¼ˆé“¾æ¥ï¼‰å…ƒç´ ã€‚`$$` ä¸ `document.querySelectorAll` æ˜¯ç­‰ä»·çš„ï¼Œæœ‰å…´è¶£å¯[æŸ¥çœ‹](http://ourjs.com/detail/54ab768a5695544119000007) $$ å’Œ $ é€‰æ‹©å™¨çš„å†å²ã€‚\n\nå…¶æ¬¡éå†æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œç”¨çš„æ˜¯ `[].forEach.call(...)`ï¼Œä½¿ç”¨ forEach æ›¿ä»£ for ä¹‹ç±»å¾ªç¯èƒ½å‡å°‘ä¸å°‘ä»£ç é‡ï¼Œè€Œ forEach æ˜¯ Array å¯¹è±¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç”¨äº†ä¸ª `[]` ç©ºæ•°ç»„æ¥ä»£æ›¿ `Array.prototype` æ›´æ˜¾ç®€æ´ï¼Œå¾—åˆ°æ‰€æœ‰å…ƒç´ çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ˆNodeListï¼‰ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰å®ç° Array çš„æ‰€æœ‰æ¥å£ï¼Œå› æ­¤ä½¿ç”¨ `$$(\"*\").forEach` ä¼šè¿”å›é”™è¯¯ï¼Œè¿™é‡Œä½¿ç”¨ `call` æ–¹æ³•æ¥æ›´æ”¹ forEach å†…éƒ¨ `this` æŒ‡å‘ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ `apply`ã€‚\n\nä¹‹åå°±æ˜¯è®©å…ƒç´ æœ‰ä¸€ä¸ªæ¼‚äº®çš„è¾¹æ¡†ï¼Œå¹¶æ‹¥æœ‰ä¸åŒçš„é¢œè‰²äº†ã€‚åœ¨ CSS æ¸²æŸ“çš„ç›’å­æ¨¡å‹ï¼ˆBox Modelï¼‰ä¸­ï¼Œ`outline` ***å¹¶ä¸ä¼šæ”¹å˜å…ƒç´ åŠå…¶å¸ƒå±€çš„ä½ç½®***ã€‚è¿™é‡Œè¾ƒæœ‰æ„æ€çš„æ˜¯å®šä¹‰ä¸åŒçš„é¢œè‰²çš„è‰²å€¼ï¼š\n```js\n~~(Math.random()*(1<<24))).toString(16)\n```\nè¿™é‡Œæƒ³æ„é€ çš„å…¶å®æ˜¯ä¸€ä¸ª16è¿›åˆ¶çš„é¢œè‰²å€¼ï¼Œå³ `000000ï½ffffff`ï¼Œä¹Ÿå°±æ˜¯ `parseInt('0',16)` åˆ° `parseInt('ffffff',16)` ä¹‹é—´çš„ä¸€ä¸ªå€¼ã€‚\n\n```js\nparseInt('ffffff',16) == 16777215 == (2^24-1) == (1<<24 - 1)\n```\n\nè€Œ `Math.random()`ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª 0~1 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œ`(Math.random()*(1<<24)`ï¼Œå³å¾—åˆ° 0~16777215 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œè€Œè‰²å€¼æ˜¯éœ€è¦æ•´æ•°çš„ï¼Œæ‰€ä»¥å°±éœ€è¦å°†æµ®ç‚¹æ•°è¿›è¡Œ int è½¬æ¢ã€‚è¿™é‡Œç”¨åˆ°äº† `~~`ï¼Œå¯[å‚è§](http://www.jeffjade.com/2015/05/31/2015-05-31-javascript-operational%EF%BC%8Dsymbol/)ç†è§£ JavaScript éè¿ç®—ç¬¦(~/~~ )ã€‚å½“ç„¶å¯ä»¥å°† `~~` è§†ä¸º `parseInt` çš„ç®€å†™ã€‚å¹¶ä¸”ä½¿ç”¨æŒ‰ä½æˆ– `|` æ“ä½œç¬¦ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼š\n\n```js\nvar a = 1.234567890;\nvar b = 0.000000001;\n~~a == 0|a == parseInt(a, 10) == 1\n~~b == 0|b == parseInt(b, 10) == 0\n```\n`toString(16)` ä½¿ç”¨æ•°å­—ç±»å‹çš„ `toString` æ–¹æ³•è¿›è¡Œåè¿›åˆ¶åˆ°16è¿›åˆ¶çš„è½¬æ¢ã€‚è‡³æ­¤æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª 0 åˆ° 16777215ä¹‹é—´çš„éšæœºæ•°ï¼Œç„¶åä½¿ç”¨ `toString(16)` è½¬æ¢æˆ16è¿›åˆ¶ï¼Œå°†æ­¤å€¼èµ‹äºˆåˆ°é¡µé¢ä¸Šæ‰€æœ‰å…ƒç´ èŠ‚ç‚¹çš„ `outline` é™„åŠ å±æ€§ä¸Šã€‚å®ƒå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚ç²¾è‡´å·§å¦™è€Œä¸”éå¸¸å®ç”¨ï¼Œé¡¶ä¸€ä¸ªï¼\n","source":"_posts/ä¸€æ®µç¥å¥‡çš„-CSS-è°ƒè¯•ä»£ç .md","raw":"---\ntitle: ä¸€æ®µç¥å¥‡çš„ CSS è°ƒè¯•ä»£ç \ndate: 2016-03-22 16:32:52\ntags:\ncomments: false\n---\n\nç°åœ¨åˆ°å¤„éƒ½æ˜¯ JavaScriptï¼Œå€˜è‹¥èŠ±ç‚¹æ—¶é—´å»æ·±å…¥åˆ†æï¼Œæ¯æ¬¡éƒ½èƒ½å­¦åˆ°ç‚¹æ–°çš„ä¸œè¥¿ã€‚å½“æˆ‘å‘ç°äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼Œä¹ æƒ¯å…ˆæ”¶è—èµ·æ¥ã€‚ç­‰æ—¶æŠ€ï¼ˆæ—¶é—´ï¼‹æŠ€æœ¯ï¼‰æˆç†Ÿï¼Œå†å» Review ä»–ä»¬çš„ä»£ç ï¼Œçœ‹ä¸€çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œè§ˆä¸€è§ˆå¤§ç‰›ä»¬çš„ â€œå¥‡æŠ€æ·«å·§â€ã€‚\n<!-- more -->\n### ä»£ç ç‰‡æ®µ\n\n```js\n[].forEach.call($$(\"*\"),function(a){\n    a.style.outline=\"1px solid #\"+(~~(Math.random()*(1<<24))).toString(16);\n})\n```\nåœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œæ­¤æ®µä»£ç ï¼Œä¼šç»™é¡µé¢é‡Œæ‰€æœ‰çš„ DOM å…ƒç´ æ·»åŠ ä¸€ä¸ª 1px çš„æè¾¹ï¼ˆoutlineï¼‰ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨è°ƒè¯• CSS è¿‡ç¨‹ä¸­åˆ†æã€æ’æŸ¥é—®é¢˜ã€‚\n![](http://ww1.sinaimg.cn/large/6057861cgy1fbzi0vggl6j21kw0vyq8s.jpg)\n\n\n### ä»£ç åˆ†æ\nè¿™æ®µä»£ç æ˜¯ Github ä¸Šçš„ 140 Bytes æ´»åŠ¨ä¸­çš„ä»£ç ï¼Œç®€å•åˆ†æä¸‹è¿™æ®µ JS ä»£ç ï¼Œä½œè€…ä½¿ç”¨äº†ä¸å°‘æŠ€å·§ï¼š\n\né¦–å…ˆæ˜¯éœ€è¦é€‰æ‹©é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œä½¿ç”¨äº†åªèƒ½åœ¨ Console è°ƒè¯•å·¥å…·ä¸­ä½¿ç”¨çš„ `$$` å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨ Console ä¸­è¾“å…¥ `$$('a')` è‡ªå·±è¯•ä¸€ä¸‹ã€‚å®ƒä¼šè¿”å›å½“å‰é¡µé¢çš„æ‰€æœ‰ anchorï¼ˆé“¾æ¥ï¼‰å…ƒç´ ã€‚`$$` ä¸ `document.querySelectorAll` æ˜¯ç­‰ä»·çš„ï¼Œæœ‰å…´è¶£å¯[æŸ¥çœ‹](http://ourjs.com/detail/54ab768a5695544119000007) $$ å’Œ $ é€‰æ‹©å™¨çš„å†å²ã€‚\n\nå…¶æ¬¡éå†æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œç”¨çš„æ˜¯ `[].forEach.call(...)`ï¼Œä½¿ç”¨ forEach æ›¿ä»£ for ä¹‹ç±»å¾ªç¯èƒ½å‡å°‘ä¸å°‘ä»£ç é‡ï¼Œè€Œ forEach æ˜¯ Array å¯¹è±¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç”¨äº†ä¸ª `[]` ç©ºæ•°ç»„æ¥ä»£æ›¿ `Array.prototype` æ›´æ˜¾ç®€æ´ï¼Œå¾—åˆ°æ‰€æœ‰å…ƒç´ çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ˆNodeListï¼‰ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰å®ç° Array çš„æ‰€æœ‰æ¥å£ï¼Œå› æ­¤ä½¿ç”¨ `$$(\"*\").forEach` ä¼šè¿”å›é”™è¯¯ï¼Œè¿™é‡Œä½¿ç”¨ `call` æ–¹æ³•æ¥æ›´æ”¹ forEach å†…éƒ¨ `this` æŒ‡å‘ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ `apply`ã€‚\n\nä¹‹åå°±æ˜¯è®©å…ƒç´ æœ‰ä¸€ä¸ªæ¼‚äº®çš„è¾¹æ¡†ï¼Œå¹¶æ‹¥æœ‰ä¸åŒçš„é¢œè‰²äº†ã€‚åœ¨ CSS æ¸²æŸ“çš„ç›’å­æ¨¡å‹ï¼ˆBox Modelï¼‰ä¸­ï¼Œ`outline` ***å¹¶ä¸ä¼šæ”¹å˜å…ƒç´ åŠå…¶å¸ƒå±€çš„ä½ç½®***ã€‚è¿™é‡Œè¾ƒæœ‰æ„æ€çš„æ˜¯å®šä¹‰ä¸åŒçš„é¢œè‰²çš„è‰²å€¼ï¼š\n```js\n~~(Math.random()*(1<<24))).toString(16)\n```\nè¿™é‡Œæƒ³æ„é€ çš„å…¶å®æ˜¯ä¸€ä¸ª16è¿›åˆ¶çš„é¢œè‰²å€¼ï¼Œå³ `000000ï½ffffff`ï¼Œä¹Ÿå°±æ˜¯ `parseInt('0',16)` åˆ° `parseInt('ffffff',16)` ä¹‹é—´çš„ä¸€ä¸ªå€¼ã€‚\n\n```js\nparseInt('ffffff',16) == 16777215 == (2^24-1) == (1<<24 - 1)\n```\n\nè€Œ `Math.random()`ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª 0~1 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œ`(Math.random()*(1<<24)`ï¼Œå³å¾—åˆ° 0~16777215 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œè€Œè‰²å€¼æ˜¯éœ€è¦æ•´æ•°çš„ï¼Œæ‰€ä»¥å°±éœ€è¦å°†æµ®ç‚¹æ•°è¿›è¡Œ int è½¬æ¢ã€‚è¿™é‡Œç”¨åˆ°äº† `~~`ï¼Œå¯[å‚è§](http://www.jeffjade.com/2015/05/31/2015-05-31-javascript-operational%EF%BC%8Dsymbol/)ç†è§£ JavaScript éè¿ç®—ç¬¦(~/~~ )ã€‚å½“ç„¶å¯ä»¥å°† `~~` è§†ä¸º `parseInt` çš„ç®€å†™ã€‚å¹¶ä¸”ä½¿ç”¨æŒ‰ä½æˆ– `|` æ“ä½œç¬¦ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼š\n\n```js\nvar a = 1.234567890;\nvar b = 0.000000001;\n~~a == 0|a == parseInt(a, 10) == 1\n~~b == 0|b == parseInt(b, 10) == 0\n```\n`toString(16)` ä½¿ç”¨æ•°å­—ç±»å‹çš„ `toString` æ–¹æ³•è¿›è¡Œåè¿›åˆ¶åˆ°16è¿›åˆ¶çš„è½¬æ¢ã€‚è‡³æ­¤æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª 0 åˆ° 16777215ä¹‹é—´çš„éšæœºæ•°ï¼Œç„¶åä½¿ç”¨ `toString(16)` è½¬æ¢æˆ16è¿›åˆ¶ï¼Œå°†æ­¤å€¼èµ‹äºˆåˆ°é¡µé¢ä¸Šæ‰€æœ‰å…ƒç´ èŠ‚ç‚¹çš„ `outline` é™„åŠ å±æ€§ä¸Šã€‚å®ƒå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚ç²¾è‡´å·§å¦™è€Œä¸”éå¸¸å®ç”¨ï¼Œé¡¶ä¸€ä¸ªï¼\n","slug":"ä¸€æ®µç¥å¥‡çš„-CSS-è°ƒè¯•ä»£ç ","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidj8000ju4q97rhmeeib","content":"<p>ç°åœ¨åˆ°å¤„éƒ½æ˜¯ JavaScriptï¼Œå€˜è‹¥èŠ±ç‚¹æ—¶é—´å»æ·±å…¥åˆ†æï¼Œæ¯æ¬¡éƒ½èƒ½å­¦åˆ°ç‚¹æ–°çš„ä¸œè¥¿ã€‚å½“æˆ‘å‘ç°äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼Œä¹ æƒ¯å…ˆæ”¶è—èµ·æ¥ã€‚ç­‰æ—¶æŠ€ï¼ˆæ—¶é—´ï¼‹æŠ€æœ¯ï¼‰æˆç†Ÿï¼Œå†å» Review ä»–ä»¬çš„ä»£ç ï¼Œçœ‹ä¸€çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œè§ˆä¸€è§ˆå¤§ç‰›ä»¬çš„ â€œå¥‡æŠ€æ·«å·§â€ã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"ä»£ç ç‰‡æ®µ\"><a href=\"#ä»£ç ç‰‡æ®µ\" class=\"headerlink\" title=\"ä»£ç ç‰‡æ®µ\"></a>ä»£ç ç‰‡æ®µ</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[].forEach.call($$(<span class=\"string\">\"*\"</span>),<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a</span>)</span>&#123;</span><br><span class=\"line\">    a.style.outline=<span class=\"string\">\"1px solid #\"</span>+(~~(<span class=\"built_in\">Math</span>.random()*(<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">24</span>))).toString(<span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œæ­¤æ®µä»£ç ï¼Œä¼šç»™é¡µé¢é‡Œæ‰€æœ‰çš„ DOM å…ƒç´ æ·»åŠ ä¸€ä¸ª 1px çš„æè¾¹ï¼ˆoutlineï¼‰ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨è°ƒè¯• CSS è¿‡ç¨‹ä¸­åˆ†æã€æ’æŸ¥é—®é¢˜ã€‚<br><img src=\"http://ww1.sinaimg.cn/large/6057861cgy1fbzi0vggl6j21kw0vyq8s.jpg\" alt=\"\"></p>\n<h3 id=\"ä»£ç åˆ†æ\"><a href=\"#ä»£ç åˆ†æ\" class=\"headerlink\" title=\"ä»£ç åˆ†æ\"></a>ä»£ç åˆ†æ</h3><p>è¿™æ®µä»£ç æ˜¯ Github ä¸Šçš„ 140 Bytes æ´»åŠ¨ä¸­çš„ä»£ç ï¼Œç®€å•åˆ†æä¸‹è¿™æ®µ JS ä»£ç ï¼Œä½œè€…ä½¿ç”¨äº†ä¸å°‘æŠ€å·§ï¼š</p>\n<p>é¦–å…ˆæ˜¯éœ€è¦é€‰æ‹©é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œä½¿ç”¨äº†åªèƒ½åœ¨ Console è°ƒè¯•å·¥å…·ä¸­ä½¿ç”¨çš„ <code>$$</code> å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨ Console ä¸­è¾“å…¥ <code>$$(&#39;a&#39;)</code> è‡ªå·±è¯•ä¸€ä¸‹ã€‚å®ƒä¼šè¿”å›å½“å‰é¡µé¢çš„æ‰€æœ‰ anchorï¼ˆé“¾æ¥ï¼‰å…ƒç´ ã€‚<code>$$</code> ä¸ <code>document.querySelectorAll</code> æ˜¯ç­‰ä»·çš„ï¼Œæœ‰å…´è¶£å¯<a href=\"http://ourjs.com/detail/54ab768a5695544119000007\" target=\"_blank\" rel=\"noopener\">æŸ¥çœ‹</a> $$ å’Œ $ é€‰æ‹©å™¨çš„å†å²ã€‚</p>\n<p>å…¶æ¬¡éå†æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œç”¨çš„æ˜¯ <code>[].forEach.call(...)</code>ï¼Œä½¿ç”¨ forEach æ›¿ä»£ for ä¹‹ç±»å¾ªç¯èƒ½å‡å°‘ä¸å°‘ä»£ç é‡ï¼Œè€Œ forEach æ˜¯ Array å¯¹è±¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç”¨äº†ä¸ª <code>[]</code> ç©ºæ•°ç»„æ¥ä»£æ›¿ <code>Array.prototype</code> æ›´æ˜¾ç®€æ´ï¼Œå¾—åˆ°æ‰€æœ‰å…ƒç´ çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ˆNodeListï¼‰ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰å®ç° Array çš„æ‰€æœ‰æ¥å£ï¼Œå› æ­¤ä½¿ç”¨ <code>$$(&quot;*&quot;).forEach</code> ä¼šè¿”å›é”™è¯¯ï¼Œè¿™é‡Œä½¿ç”¨ <code>call</code> æ–¹æ³•æ¥æ›´æ”¹ forEach å†…éƒ¨ <code>this</code> æŒ‡å‘ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>apply</code>ã€‚</p>\n<p>ä¹‹åå°±æ˜¯è®©å…ƒç´ æœ‰ä¸€ä¸ªæ¼‚äº®çš„è¾¹æ¡†ï¼Œå¹¶æ‹¥æœ‰ä¸åŒçš„é¢œè‰²äº†ã€‚åœ¨ CSS æ¸²æŸ“çš„ç›’å­æ¨¡å‹ï¼ˆBox Modelï¼‰ä¸­ï¼Œ<code>outline</code> <strong><em>å¹¶ä¸ä¼šæ”¹å˜å…ƒç´ åŠå…¶å¸ƒå±€çš„ä½ç½®</em></strong>ã€‚è¿™é‡Œè¾ƒæœ‰æ„æ€çš„æ˜¯å®šä¹‰ä¸åŒçš„é¢œè‰²çš„è‰²å€¼ï¼š<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~~(<span class=\"built_in\">Math</span>.random()*(<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">24</span>))).toString(<span class=\"number\">16</span>)</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œæƒ³æ„é€ çš„å…¶å®æ˜¯ä¸€ä¸ª16è¿›åˆ¶çš„é¢œè‰²å€¼ï¼Œå³ <code>000000ï½ffffff</code>ï¼Œä¹Ÿå°±æ˜¯ <code>parseInt(&#39;0&#39;,16)</code> åˆ° <code>parseInt(&#39;ffffff&#39;,16)</code> ä¹‹é—´çš„ä¸€ä¸ªå€¼ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">parseInt</span>(<span class=\"string\">'ffffff'</span>,<span class=\"number\">16</span>) == <span class=\"number\">16777215</span> == (<span class=\"number\">2</span>^<span class=\"number\">24</span><span class=\"number\">-1</span>) == (<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">24</span> - <span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n<p>è€Œ <code>Math.random()</code>ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª 0~1 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œ<code>(Math.random()*(1&lt;&lt;24)</code>ï¼Œå³å¾—åˆ° 0~16777215 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œè€Œè‰²å€¼æ˜¯éœ€è¦æ•´æ•°çš„ï¼Œæ‰€ä»¥å°±éœ€è¦å°†æµ®ç‚¹æ•°è¿›è¡Œ int è½¬æ¢ã€‚è¿™é‡Œç”¨åˆ°äº† <code>~~</code>ï¼Œå¯<a href=\"http://www.jeffjade.com/2015/05/31/2015-05-31-javascript-operational%EF%BC%8Dsymbol/\" target=\"_blank\" rel=\"noopener\">å‚è§</a>ç†è§£ JavaScript éè¿ç®—ç¬¦(~/~~ )ã€‚å½“ç„¶å¯ä»¥å°† <code>~~</code> è§†ä¸º <code>parseInt</code> çš„ç®€å†™ã€‚å¹¶ä¸”ä½¿ç”¨æŒ‰ä½æˆ– <code>|</code> æ“ä½œç¬¦ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"number\">1.234567890</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> b = <span class=\"number\">0.000000001</span>;</span><br><span class=\"line\">~~a == <span class=\"number\">0</span>|a == <span class=\"built_in\">parseInt</span>(a, <span class=\"number\">10</span>) == <span class=\"number\">1</span></span><br><span class=\"line\">~~b == <span class=\"number\">0</span>|b == <span class=\"built_in\">parseInt</span>(b, <span class=\"number\">10</span>) == <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n<p><code>toString(16)</code> ä½¿ç”¨æ•°å­—ç±»å‹çš„ <code>toString</code> æ–¹æ³•è¿›è¡Œåè¿›åˆ¶åˆ°16è¿›åˆ¶çš„è½¬æ¢ã€‚è‡³æ­¤æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª 0 åˆ° 16777215ä¹‹é—´çš„éšæœºæ•°ï¼Œç„¶åä½¿ç”¨ <code>toString(16)</code> è½¬æ¢æˆ16è¿›åˆ¶ï¼Œå°†æ­¤å€¼èµ‹äºˆåˆ°é¡µé¢ä¸Šæ‰€æœ‰å…ƒç´ èŠ‚ç‚¹çš„ <code>outline</code> é™„åŠ å±æ€§ä¸Šã€‚å®ƒå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚ç²¾è‡´å·§å¦™è€Œä¸”éå¸¸å®ç”¨ï¼Œé¡¶ä¸€ä¸ªï¼</p>\n","site":{"data":{}},"excerpt":"<p>ç°åœ¨åˆ°å¤„éƒ½æ˜¯ JavaScriptï¼Œå€˜è‹¥èŠ±ç‚¹æ—¶é—´å»æ·±å…¥åˆ†æï¼Œæ¯æ¬¡éƒ½èƒ½å­¦åˆ°ç‚¹æ–°çš„ä¸œè¥¿ã€‚å½“æˆ‘å‘ç°äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼Œä¹ æƒ¯å…ˆæ”¶è—èµ·æ¥ã€‚ç­‰æ—¶æŠ€ï¼ˆæ—¶é—´ï¼‹æŠ€æœ¯ï¼‰æˆç†Ÿï¼Œå†å» Review ä»–ä»¬çš„ä»£ç ï¼Œçœ‹ä¸€çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œè§ˆä¸€è§ˆå¤§ç‰›ä»¬çš„ â€œå¥‡æŠ€æ·«å·§â€ã€‚<br>","more":"</p>\n<h3 id=\"ä»£ç ç‰‡æ®µ\"><a href=\"#ä»£ç ç‰‡æ®µ\" class=\"headerlink\" title=\"ä»£ç ç‰‡æ®µ\"></a>ä»£ç ç‰‡æ®µ</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[].forEach.call($$(<span class=\"string\">\"*\"</span>),<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a</span>)</span>&#123;</span><br><span class=\"line\">    a.style.outline=<span class=\"string\">\"1px solid #\"</span>+(~~(<span class=\"built_in\">Math</span>.random()*(<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">24</span>))).toString(<span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œæ­¤æ®µä»£ç ï¼Œä¼šç»™é¡µé¢é‡Œæ‰€æœ‰çš„ DOM å…ƒç´ æ·»åŠ ä¸€ä¸ª 1px çš„æè¾¹ï¼ˆoutlineï¼‰ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨è°ƒè¯• CSS è¿‡ç¨‹ä¸­åˆ†æã€æ’æŸ¥é—®é¢˜ã€‚<br><img src=\"http://ww1.sinaimg.cn/large/6057861cgy1fbzi0vggl6j21kw0vyq8s.jpg\" alt=\"\"></p>\n<h3 id=\"ä»£ç åˆ†æ\"><a href=\"#ä»£ç åˆ†æ\" class=\"headerlink\" title=\"ä»£ç åˆ†æ\"></a>ä»£ç åˆ†æ</h3><p>è¿™æ®µä»£ç æ˜¯ Github ä¸Šçš„ 140 Bytes æ´»åŠ¨ä¸­çš„ä»£ç ï¼Œç®€å•åˆ†æä¸‹è¿™æ®µ JS ä»£ç ï¼Œä½œè€…ä½¿ç”¨äº†ä¸å°‘æŠ€å·§ï¼š</p>\n<p>é¦–å…ˆæ˜¯éœ€è¦é€‰æ‹©é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œä½¿ç”¨äº†åªèƒ½åœ¨ Console è°ƒè¯•å·¥å…·ä¸­ä½¿ç”¨çš„ <code>$$</code> å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨ Console ä¸­è¾“å…¥ <code>$$(&#39;a&#39;)</code> è‡ªå·±è¯•ä¸€ä¸‹ã€‚å®ƒä¼šè¿”å›å½“å‰é¡µé¢çš„æ‰€æœ‰ anchorï¼ˆé“¾æ¥ï¼‰å…ƒç´ ã€‚<code>$$</code> ä¸ <code>document.querySelectorAll</code> æ˜¯ç­‰ä»·çš„ï¼Œæœ‰å…´è¶£å¯<a href=\"http://ourjs.com/detail/54ab768a5695544119000007\" target=\"_blank\" rel=\"noopener\">æŸ¥çœ‹</a> $$ å’Œ $ é€‰æ‹©å™¨çš„å†å²ã€‚</p>\n<p>å…¶æ¬¡éå†æ‰€æœ‰å…ƒç´ ï¼Œè¿™é‡Œç”¨çš„æ˜¯ <code>[].forEach.call(...)</code>ï¼Œä½¿ç”¨ forEach æ›¿ä»£ for ä¹‹ç±»å¾ªç¯èƒ½å‡å°‘ä¸å°‘ä»£ç é‡ï¼Œè€Œ forEach æ˜¯ Array å¯¹è±¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç”¨äº†ä¸ª <code>[]</code> ç©ºæ•°ç»„æ¥ä»£æ›¿ <code>Array.prototype</code> æ›´æ˜¾ç®€æ´ï¼Œå¾—åˆ°æ‰€æœ‰å…ƒç´ çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ˆNodeListï¼‰ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰å®ç° Array çš„æ‰€æœ‰æ¥å£ï¼Œå› æ­¤ä½¿ç”¨ <code>$$(&quot;*&quot;).forEach</code> ä¼šè¿”å›é”™è¯¯ï¼Œè¿™é‡Œä½¿ç”¨ <code>call</code> æ–¹æ³•æ¥æ›´æ”¹ forEach å†…éƒ¨ <code>this</code> æŒ‡å‘ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>apply</code>ã€‚</p>\n<p>ä¹‹åå°±æ˜¯è®©å…ƒç´ æœ‰ä¸€ä¸ªæ¼‚äº®çš„è¾¹æ¡†ï¼Œå¹¶æ‹¥æœ‰ä¸åŒçš„é¢œè‰²äº†ã€‚åœ¨ CSS æ¸²æŸ“çš„ç›’å­æ¨¡å‹ï¼ˆBox Modelï¼‰ä¸­ï¼Œ<code>outline</code> <strong><em>å¹¶ä¸ä¼šæ”¹å˜å…ƒç´ åŠå…¶å¸ƒå±€çš„ä½ç½®</em></strong>ã€‚è¿™é‡Œè¾ƒæœ‰æ„æ€çš„æ˜¯å®šä¹‰ä¸åŒçš„é¢œè‰²çš„è‰²å€¼ï¼š<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~~(<span class=\"built_in\">Math</span>.random()*(<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">24</span>))).toString(<span class=\"number\">16</span>)</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œæƒ³æ„é€ çš„å…¶å®æ˜¯ä¸€ä¸ª16è¿›åˆ¶çš„é¢œè‰²å€¼ï¼Œå³ <code>000000ï½ffffff</code>ï¼Œä¹Ÿå°±æ˜¯ <code>parseInt(&#39;0&#39;,16)</code> åˆ° <code>parseInt(&#39;ffffff&#39;,16)</code> ä¹‹é—´çš„ä¸€ä¸ªå€¼ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">parseInt</span>(<span class=\"string\">'ffffff'</span>,<span class=\"number\">16</span>) == <span class=\"number\">16777215</span> == (<span class=\"number\">2</span>^<span class=\"number\">24</span><span class=\"number\">-1</span>) == (<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">24</span> - <span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n<p>è€Œ <code>Math.random()</code>ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª 0~1 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œ<code>(Math.random()*(1&lt;&lt;24)</code>ï¼Œå³å¾—åˆ° 0~16777215 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œè€Œè‰²å€¼æ˜¯éœ€è¦æ•´æ•°çš„ï¼Œæ‰€ä»¥å°±éœ€è¦å°†æµ®ç‚¹æ•°è¿›è¡Œ int è½¬æ¢ã€‚è¿™é‡Œç”¨åˆ°äº† <code>~~</code>ï¼Œå¯<a href=\"http://www.jeffjade.com/2015/05/31/2015-05-31-javascript-operational%EF%BC%8Dsymbol/\" target=\"_blank\" rel=\"noopener\">å‚è§</a>ç†è§£ JavaScript éè¿ç®—ç¬¦(~/~~ )ã€‚å½“ç„¶å¯ä»¥å°† <code>~~</code> è§†ä¸º <code>parseInt</code> çš„ç®€å†™ã€‚å¹¶ä¸”ä½¿ç”¨æŒ‰ä½æˆ– <code>|</code> æ“ä½œç¬¦ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"number\">1.234567890</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> b = <span class=\"number\">0.000000001</span>;</span><br><span class=\"line\">~~a == <span class=\"number\">0</span>|a == <span class=\"built_in\">parseInt</span>(a, <span class=\"number\">10</span>) == <span class=\"number\">1</span></span><br><span class=\"line\">~~b == <span class=\"number\">0</span>|b == <span class=\"built_in\">parseInt</span>(b, <span class=\"number\">10</span>) == <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n<p><code>toString(16)</code> ä½¿ç”¨æ•°å­—ç±»å‹çš„ <code>toString</code> æ–¹æ³•è¿›è¡Œåè¿›åˆ¶åˆ°16è¿›åˆ¶çš„è½¬æ¢ã€‚è‡³æ­¤æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª 0 åˆ° 16777215ä¹‹é—´çš„éšæœºæ•°ï¼Œç„¶åä½¿ç”¨ <code>toString(16)</code> è½¬æ¢æˆ16è¿›åˆ¶ï¼Œå°†æ­¤å€¼èµ‹äºˆåˆ°é¡µé¢ä¸Šæ‰€æœ‰å…ƒç´ èŠ‚ç‚¹çš„ <code>outline</code> é™„åŠ å±æ€§ä¸Šã€‚å®ƒå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚ç²¾è‡´å·§å¦™è€Œä¸”éå¸¸å®ç”¨ï¼Œé¡¶ä¸€ä¸ªï¼</p>"},{"title":"callã€applyã€bind çš„åŒºåˆ«åŠåº”ç”¨","date":"2016-03-26T10:14:16.000Z","comments":0,"_content":"\nåœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå¤„ç† `this` çš„æŒ‡å‘é—®é¢˜ï¼Œæ”¹å˜ this çš„æŒ‡å‘å°±ä¸å¾—ä¸è°ˆè°ˆä»Šå¤©çš„ä¸»è§’â€”â€” `call`ã€`apply`ã€`bind`ã€‚ä¸ªäººæ„Ÿè§‰ `this` çš„é—®é¢˜åˆå­¦è€…ä¸åŒå®¹æ˜“ä¸€ä¸‹ç†è§£é€å½»ï¼Œä»Šå¤©å†æ¥å¥½å¥½æ‹ä¸€æ‹åŠ æ·±ç†è§£ã€‚\n<!-- more -->\n### ä½œç”¨\n`call`ã€`apply`ã€`bind` çš„ä½œç”¨å°±æ˜¯æ”¹å˜å‡½æ•°æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ï¼Œå³æ”¹å˜ `this` æŒ‡å‘ã€‚\n\n`this` çš„æŒ‡å‘å…¶å®ä¹Ÿå°±[ä¸å¤–ä¹è¿™å››ç§æƒ…å†µ](https://ifyour.github.io/2016/02/19/JavaScript-%E4%B8%AD%E7%9A%84-this-%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/)ï¼Œå…¶å®ç†è§£èµ·æ¥è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œç†è§£ä¸äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå…ˆè®°ä½ï¼Œåé¢åœ¨å·¥ä½œä¸­å¤§é‡ç¼–ç åº”ç”¨ï¼Œå†™å¤šäº†å°±çŸ¥é“ä¸ºå•¥è¦è¿™æ ·ç”¨äº†ã€‚å…ˆæ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\n// å®šä¹‰äººç±»æ„é€ å‡½æ•°ï¼Œå±æ€§æ˜¯å§“åï¼Œæ–¹æ³•æ˜¯è¾“å‡ºè‡ªå·±çš„å§“å\nfunction Person(name) {\n    this.name = name;\n}\n\nPerson.prototype = {\n    constructor: Person,\n    showName: function() {\n        console.log(this.name);\n    }\n};\n\nvar p1 = new Person('ifyour');\np1.showName(); // => ifyour\n\n// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©å¯¹è±¡ï¼Œå®ƒæœ‰ä¸ªä¸€å§“åå±æ€§\nvar animal = {\n    name: 'cat'\n};\n\n```\näººç±»å®ä¾‹ `p1` æƒ³è¦æ‰“å°è‡ªå·±çš„å§“åï¼Œåªè¦è°ƒç”¨è‡ªèº«çš„ `showName` æ–¹æ³•å³å¯ï¼Œä½†æ˜¯åŠ¨ç‰©å‘¢ï¼Ÿæˆ‘ä¹Ÿæƒ³è¦åŠ¨ç‰©å®ä¾‹ `animal` æ‰“å°è‡ªå·±çš„åå­—ï¼Œå¦‚ä½•åšå‘¢ï¼Ÿå½“ç„¶æ”¹å˜ this å’¯ï¼ŒæŠŠäººç±»çš„ `showName` æ–¹æ³•å€Ÿç»™åŠ¨ç‰©ç”¨ã€‚\n\n```js\n// å¯ä»¥ç›´æ¥å»åŸå‹ä¸Šå€Ÿç”¨\nPerson.prototype.showName.call(animal);//=>cat\n\n// ä¹Ÿå¯ä»¥ä»äººç±»ä¸Šç”Ÿæˆçš„å®ä¾‹ p1 å»å€Ÿç”¨\np1.showName.call(animal);//  => cat\np1.showName.apply(animal);// => cat\np1.showName.bind(animal)();//=> cat\n```\n\n### åŒºåˆ«\n#### callã€apply ä¸ bind\n- `call`ã€`apply` æ”¹å˜ `this` æŒ‡å‘åä¼š ***ç«‹å³æ‰§è¡Œ***\n- `bind` å¹¶ä¸ä¼šæ‰§è¡Œ\n\nåœ¨ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œ`bind` æ–¹æ³•æ”¹å˜ this æ—¶ï¼Œè¿˜éœ€è¦åŠ ä¸€ä¸ª `()` æ‰èƒ½æ‰§è¡Œè¾“å‡º `cat`ã€‚\n\n#### call ä¸ apply\n\n- `call` æŠŠå‚æ•°æŒ‰é¡ºåºä¼ å…¥ï¼Œå³ï¼š`fn.call(obj, arg1, arg2, arg3...);`\n- `apply` æŠŠå‚æ•°æ‰“åŒ…æˆ `Array` åä¼ å…¥ï¼Œå³ï¼š `fn.apply(obj, [arg1, arg2, arg3...]);`\n\n\nå®ƒä»¬ä¿©ä¹‹é—´çš„å·®åˆ«åœ¨äº ***å‚æ•°***ï¼Œ`call` å’Œ `aplly` çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯è¦æ”¹å˜ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œè€Œ `call` ä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹ä»¥å‚æ•°åˆ—è¡¨çš„å½¢å¼å±•ç°ï¼Œ`apply` åˆ™æ˜¯æŠŠé™¤äº†æ”¹å˜ä¸Šä¸‹æ–‡å¯¹è±¡çš„å‚æ•°æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ä½œä¸ºå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ã€‚\n\n### åº”ç”¨\nçŸ¥é“äº†æ€ä¹ˆä½¿ç”¨å’Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä½¿ç”¨ `call`ã€`apply`ã€`bind` çš„å¸¸è§åº”ç”¨åœºæ™¯ã€‚\n\n#### æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\n```js\nvar arr = [34,5,3,6,54,6,-67,5,7,6,-8,687];\n\nMath.max.call(Math, 34,5,3,6,54,6,-67,5,7,6,-8,687);\nMath.max.apply(Math, arr);\n\nMath.min.call(Math, 34,5,3,6,54,6,-67,5,7,6,-8,687);\nMath.min.apply(Math, arr);\n```\n#### å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\nJavaScript ä¸­çš„ä¼ªæ•°ç»„(ä¾‹å¦‚é€šè¿‡ `document.getElementsByTagName` è·å–çš„å…ƒç´ )å…·æœ‰ `length` å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ 0ã€1ã€2â€¦ä¸‹æ ‡æ¥è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œä½†æ˜¯æ²¡æœ‰ `Array` ä¸­çš„ `push`ã€`pop` ç­‰æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ `call`ã€`apply` æ¥å°†å…¶è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„è¿™æ ·ä¾¿å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨æ•°ç»„æ–¹æ³•äº†ã€‚\n\n```js\n// è¿™æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„\nvar arrayLike = {\n    0: 'aaaa',\n    1: 'bbbb',\n    2: 'cccc',\n    length: 3\n}\n// é€šè¿‡è¿™ä¸ªæ–¹æ³•è½¬æ¢\nvar arr = Array.prototype.slice.call(arrayLike);\n```\n<div class='tip'>ä¸Šé¢ `arr` ä¾¿æ˜¯ä¸€ä¸ªåŒ…å« `arrayLike` å…ƒç´ çš„çœŸæ­£çš„æ•°ç»„å•¦( æ³¨æ„æ•°æ®ç»“æ„å¿…é¡»æ˜¯ä»¥æ•°å­—ä¸ºä¸‹æ ‡è€Œä¸”ä¸€å®šè¦æœ‰ `length` å±æ€§ )\n</div>\n\n#### æ•°ç»„è¿½åŠ \n```js\nvar arr1 = [1,2,3];\nvar arr2 = [4,5,6];\n[].push.apply(arr1, arr2);\n\nconsole.log(arr1);// => [1, 2, 3, 4, 5, 6]\nconsole.log(arr2);// => [1, 2, 3]\n```\n\n#### å˜é‡ç±»å‹åˆ¤æ–­\n```js\nfunction isArray(obj){\n    return Object.prototype.toString.call(obj) == '[object Array]'\n}\nvar arr1 = [1,2,3];\nvar arr2 = '[1,2,3]';\n\nisArray(arr1);//   => true\nisArray(arr2);//   => false\n```\n\n#### ç»§æ‰¿\n```js\n// åŸºç¡€ç±»\nvar Person = function (name, age) {\n  this.name = name;\n  this.age = age;\n};\n\n// å¥³å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»\nvar Girl = function (name) {\n  Person.call(this, name);\n};\n// ç”·å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»\nvar Boy = function (name, age) {\n  Person.apply(this, arguments);\n};\n\nvar g1 = new Girl ('Jilly');\nvar b1 = new Boy('ifyour', 18);\n```\n","source":"_posts/callã€applyã€bind-çš„åŒºåˆ«åŠåº”ç”¨.md","raw":"---\ntitle: callã€applyã€bind çš„åŒºåˆ«åŠåº”ç”¨\ndate: 2016-03-26 18:14:16\ntags:\ncomments: false\n---\n\nåœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå¤„ç† `this` çš„æŒ‡å‘é—®é¢˜ï¼Œæ”¹å˜ this çš„æŒ‡å‘å°±ä¸å¾—ä¸è°ˆè°ˆä»Šå¤©çš„ä¸»è§’â€”â€” `call`ã€`apply`ã€`bind`ã€‚ä¸ªäººæ„Ÿè§‰ `this` çš„é—®é¢˜åˆå­¦è€…ä¸åŒå®¹æ˜“ä¸€ä¸‹ç†è§£é€å½»ï¼Œä»Šå¤©å†æ¥å¥½å¥½æ‹ä¸€æ‹åŠ æ·±ç†è§£ã€‚\n<!-- more -->\n### ä½œç”¨\n`call`ã€`apply`ã€`bind` çš„ä½œç”¨å°±æ˜¯æ”¹å˜å‡½æ•°æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ï¼Œå³æ”¹å˜ `this` æŒ‡å‘ã€‚\n\n`this` çš„æŒ‡å‘å…¶å®ä¹Ÿå°±[ä¸å¤–ä¹è¿™å››ç§æƒ…å†µ](https://ifyour.github.io/2016/02/19/JavaScript-%E4%B8%AD%E7%9A%84-this-%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/)ï¼Œå…¶å®ç†è§£èµ·æ¥è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œç†è§£ä¸äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå…ˆè®°ä½ï¼Œåé¢åœ¨å·¥ä½œä¸­å¤§é‡ç¼–ç åº”ç”¨ï¼Œå†™å¤šäº†å°±çŸ¥é“ä¸ºå•¥è¦è¿™æ ·ç”¨äº†ã€‚å…ˆæ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚\n```js\n// å®šä¹‰äººç±»æ„é€ å‡½æ•°ï¼Œå±æ€§æ˜¯å§“åï¼Œæ–¹æ³•æ˜¯è¾“å‡ºè‡ªå·±çš„å§“å\nfunction Person(name) {\n    this.name = name;\n}\n\nPerson.prototype = {\n    constructor: Person,\n    showName: function() {\n        console.log(this.name);\n    }\n};\n\nvar p1 = new Person('ifyour');\np1.showName(); // => ifyour\n\n// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©å¯¹è±¡ï¼Œå®ƒæœ‰ä¸ªä¸€å§“åå±æ€§\nvar animal = {\n    name: 'cat'\n};\n\n```\näººç±»å®ä¾‹ `p1` æƒ³è¦æ‰“å°è‡ªå·±çš„å§“åï¼Œåªè¦è°ƒç”¨è‡ªèº«çš„ `showName` æ–¹æ³•å³å¯ï¼Œä½†æ˜¯åŠ¨ç‰©å‘¢ï¼Ÿæˆ‘ä¹Ÿæƒ³è¦åŠ¨ç‰©å®ä¾‹ `animal` æ‰“å°è‡ªå·±çš„åå­—ï¼Œå¦‚ä½•åšå‘¢ï¼Ÿå½“ç„¶æ”¹å˜ this å’¯ï¼ŒæŠŠäººç±»çš„ `showName` æ–¹æ³•å€Ÿç»™åŠ¨ç‰©ç”¨ã€‚\n\n```js\n// å¯ä»¥ç›´æ¥å»åŸå‹ä¸Šå€Ÿç”¨\nPerson.prototype.showName.call(animal);//=>cat\n\n// ä¹Ÿå¯ä»¥ä»äººç±»ä¸Šç”Ÿæˆçš„å®ä¾‹ p1 å»å€Ÿç”¨\np1.showName.call(animal);//  => cat\np1.showName.apply(animal);// => cat\np1.showName.bind(animal)();//=> cat\n```\n\n### åŒºåˆ«\n#### callã€apply ä¸ bind\n- `call`ã€`apply` æ”¹å˜ `this` æŒ‡å‘åä¼š ***ç«‹å³æ‰§è¡Œ***\n- `bind` å¹¶ä¸ä¼šæ‰§è¡Œ\n\nåœ¨ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œ`bind` æ–¹æ³•æ”¹å˜ this æ—¶ï¼Œè¿˜éœ€è¦åŠ ä¸€ä¸ª `()` æ‰èƒ½æ‰§è¡Œè¾“å‡º `cat`ã€‚\n\n#### call ä¸ apply\n\n- `call` æŠŠå‚æ•°æŒ‰é¡ºåºä¼ å…¥ï¼Œå³ï¼š`fn.call(obj, arg1, arg2, arg3...);`\n- `apply` æŠŠå‚æ•°æ‰“åŒ…æˆ `Array` åä¼ å…¥ï¼Œå³ï¼š `fn.apply(obj, [arg1, arg2, arg3...]);`\n\n\nå®ƒä»¬ä¿©ä¹‹é—´çš„å·®åˆ«åœ¨äº ***å‚æ•°***ï¼Œ`call` å’Œ `aplly` çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯è¦æ”¹å˜ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œè€Œ `call` ä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹ä»¥å‚æ•°åˆ—è¡¨çš„å½¢å¼å±•ç°ï¼Œ`apply` åˆ™æ˜¯æŠŠé™¤äº†æ”¹å˜ä¸Šä¸‹æ–‡å¯¹è±¡çš„å‚æ•°æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ä½œä¸ºå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ã€‚\n\n### åº”ç”¨\nçŸ¥é“äº†æ€ä¹ˆä½¿ç”¨å’Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä½¿ç”¨ `call`ã€`apply`ã€`bind` çš„å¸¸è§åº”ç”¨åœºæ™¯ã€‚\n\n#### æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\n```js\nvar arr = [34,5,3,6,54,6,-67,5,7,6,-8,687];\n\nMath.max.call(Math, 34,5,3,6,54,6,-67,5,7,6,-8,687);\nMath.max.apply(Math, arr);\n\nMath.min.call(Math, 34,5,3,6,54,6,-67,5,7,6,-8,687);\nMath.min.apply(Math, arr);\n```\n#### å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\nJavaScript ä¸­çš„ä¼ªæ•°ç»„(ä¾‹å¦‚é€šè¿‡ `document.getElementsByTagName` è·å–çš„å…ƒç´ )å…·æœ‰ `length` å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ 0ã€1ã€2â€¦ä¸‹æ ‡æ¥è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œä½†æ˜¯æ²¡æœ‰ `Array` ä¸­çš„ `push`ã€`pop` ç­‰æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ `call`ã€`apply` æ¥å°†å…¶è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„è¿™æ ·ä¾¿å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨æ•°ç»„æ–¹æ³•äº†ã€‚\n\n```js\n// è¿™æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„\nvar arrayLike = {\n    0: 'aaaa',\n    1: 'bbbb',\n    2: 'cccc',\n    length: 3\n}\n// é€šè¿‡è¿™ä¸ªæ–¹æ³•è½¬æ¢\nvar arr = Array.prototype.slice.call(arrayLike);\n```\n<div class='tip'>ä¸Šé¢ `arr` ä¾¿æ˜¯ä¸€ä¸ªåŒ…å« `arrayLike` å…ƒç´ çš„çœŸæ­£çš„æ•°ç»„å•¦( æ³¨æ„æ•°æ®ç»“æ„å¿…é¡»æ˜¯ä»¥æ•°å­—ä¸ºä¸‹æ ‡è€Œä¸”ä¸€å®šè¦æœ‰ `length` å±æ€§ )\n</div>\n\n#### æ•°ç»„è¿½åŠ \n```js\nvar arr1 = [1,2,3];\nvar arr2 = [4,5,6];\n[].push.apply(arr1, arr2);\n\nconsole.log(arr1);// => [1, 2, 3, 4, 5, 6]\nconsole.log(arr2);// => [1, 2, 3]\n```\n\n#### å˜é‡ç±»å‹åˆ¤æ–­\n```js\nfunction isArray(obj){\n    return Object.prototype.toString.call(obj) == '[object Array]'\n}\nvar arr1 = [1,2,3];\nvar arr2 = '[1,2,3]';\n\nisArray(arr1);//   => true\nisArray(arr2);//   => false\n```\n\n#### ç»§æ‰¿\n```js\n// åŸºç¡€ç±»\nvar Person = function (name, age) {\n  this.name = name;\n  this.age = age;\n};\n\n// å¥³å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»\nvar Girl = function (name) {\n  Person.call(this, name);\n};\n// ç”·å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»\nvar Boy = function (name, age) {\n  Person.apply(this, arguments);\n};\n\nvar g1 = new Girl ('Jilly');\nvar b1 = new Boy('ifyour', 18);\n```\n","slug":"callã€applyã€bind-çš„åŒºåˆ«åŠåº”ç”¨","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidj9000ku4q9pmz93dxl","content":"<p>åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå¤„ç† <code>this</code> çš„æŒ‡å‘é—®é¢˜ï¼Œæ”¹å˜ this çš„æŒ‡å‘å°±ä¸å¾—ä¸è°ˆè°ˆä»Šå¤©çš„ä¸»è§’â€”â€” <code>call</code>ã€<code>apply</code>ã€<code>bind</code>ã€‚ä¸ªäººæ„Ÿè§‰ <code>this</code> çš„é—®é¢˜åˆå­¦è€…ä¸åŒå®¹æ˜“ä¸€ä¸‹ç†è§£é€å½»ï¼Œä»Šå¤©å†æ¥å¥½å¥½æ‹ä¸€æ‹åŠ æ·±ç†è§£ã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"ä½œç”¨\"><a href=\"#ä½œç”¨\" class=\"headerlink\" title=\"ä½œç”¨\"></a>ä½œç”¨</h3><p><code>call</code>ã€<code>apply</code>ã€<code>bind</code> çš„ä½œç”¨å°±æ˜¯æ”¹å˜å‡½æ•°æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ï¼Œå³æ”¹å˜ <code>this</code> æŒ‡å‘ã€‚</p>\n<p><code>this</code> çš„æŒ‡å‘å…¶å®ä¹Ÿå°±<a href=\"https://ifyour.github.io/2016/02/19/JavaScript-%E4%B8%AD%E7%9A%84-this-%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/\">ä¸å¤–ä¹è¿™å››ç§æƒ…å†µ</a>ï¼Œå…¶å®ç†è§£èµ·æ¥è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œç†è§£ä¸äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå…ˆè®°ä½ï¼Œåé¢åœ¨å·¥ä½œä¸­å¤§é‡ç¼–ç åº”ç”¨ï¼Œå†™å¤šäº†å°±çŸ¥é“ä¸ºå•¥è¦è¿™æ ·ç”¨äº†ã€‚å…ˆæ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å®šä¹‰äººç±»æ„é€ å‡½æ•°ï¼Œå±æ€§æ˜¯å§“åï¼Œæ–¹æ³•æ˜¯è¾“å‡ºè‡ªå·±çš„å§“å</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Person</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Person.prototype = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>: Person,</span><br><span class=\"line\">    showName: function() &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> p1 = <span class=\"keyword\">new</span> Person(<span class=\"string\">'ifyour'</span>);</span><br><span class=\"line\">p1.showName(); <span class=\"comment\">// =&gt; ifyour</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©å¯¹è±¡ï¼Œå®ƒæœ‰ä¸ªä¸€å§“åå±æ€§</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> animal = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cat'</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure></p>\n<p>äººç±»å®ä¾‹ <code>p1</code> æƒ³è¦æ‰“å°è‡ªå·±çš„å§“åï¼Œåªè¦è°ƒç”¨è‡ªèº«çš„ <code>showName</code> æ–¹æ³•å³å¯ï¼Œä½†æ˜¯åŠ¨ç‰©å‘¢ï¼Ÿæˆ‘ä¹Ÿæƒ³è¦åŠ¨ç‰©å®ä¾‹ <code>animal</code> æ‰“å°è‡ªå·±çš„åå­—ï¼Œå¦‚ä½•åšå‘¢ï¼Ÿå½“ç„¶æ”¹å˜ this å’¯ï¼ŒæŠŠäººç±»çš„ <code>showName</code> æ–¹æ³•å€Ÿç»™åŠ¨ç‰©ç”¨ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¯ä»¥ç›´æ¥å»åŸå‹ä¸Šå€Ÿç”¨</span></span><br><span class=\"line\">Person.prototype.showName.call(animal);<span class=\"comment\">//=&gt;cat</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¹Ÿå¯ä»¥ä»äººç±»ä¸Šç”Ÿæˆçš„å®ä¾‹ p1 å»å€Ÿç”¨</span></span><br><span class=\"line\">p1.showName.call(animal);<span class=\"comment\">//  =&gt; cat</span></span><br><span class=\"line\">p1.showName.apply(animal);<span class=\"comment\">// =&gt; cat</span></span><br><span class=\"line\">p1.showName.bind(animal)();<span class=\"comment\">//=&gt; cat</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"åŒºåˆ«\"><a href=\"#åŒºåˆ«\" class=\"headerlink\" title=\"åŒºåˆ«\"></a>åŒºåˆ«</h3><h4 id=\"callã€apply-ä¸-bind\"><a href=\"#callã€apply-ä¸-bind\" class=\"headerlink\" title=\"callã€apply ä¸ bind\"></a>callã€apply ä¸ bind</h4><ul>\n<li><code>call</code>ã€<code>apply</code> æ”¹å˜ <code>this</code> æŒ‡å‘åä¼š <strong><em>ç«‹å³æ‰§è¡Œ</em></strong></li>\n<li><code>bind</code> å¹¶ä¸ä¼šæ‰§è¡Œ</li>\n</ul>\n<p>åœ¨ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œ<code>bind</code> æ–¹æ³•æ”¹å˜ this æ—¶ï¼Œè¿˜éœ€è¦åŠ ä¸€ä¸ª <code>()</code> æ‰èƒ½æ‰§è¡Œè¾“å‡º <code>cat</code>ã€‚</p>\n<h4 id=\"call-ä¸-apply\"><a href=\"#call-ä¸-apply\" class=\"headerlink\" title=\"call ä¸ apply\"></a>call ä¸ apply</h4><ul>\n<li><code>call</code> æŠŠå‚æ•°æŒ‰é¡ºåºä¼ å…¥ï¼Œå³ï¼š<code>fn.call(obj, arg1, arg2, arg3...);</code></li>\n<li><code>apply</code> æŠŠå‚æ•°æ‰“åŒ…æˆ <code>Array</code> åä¼ å…¥ï¼Œå³ï¼š <code>fn.apply(obj, [arg1, arg2, arg3...]);</code></li>\n</ul>\n<p>å®ƒä»¬ä¿©ä¹‹é—´çš„å·®åˆ«åœ¨äº <strong><em>å‚æ•°</em></strong>ï¼Œ<code>call</code> å’Œ <code>aplly</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯è¦æ”¹å˜ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œè€Œ <code>call</code> ä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹ä»¥å‚æ•°åˆ—è¡¨çš„å½¢å¼å±•ç°ï¼Œ<code>apply</code> åˆ™æ˜¯æŠŠé™¤äº†æ”¹å˜ä¸Šä¸‹æ–‡å¯¹è±¡çš„å‚æ•°æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ä½œä¸ºå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ã€‚</p>\n<h3 id=\"åº”ç”¨\"><a href=\"#åº”ç”¨\" class=\"headerlink\" title=\"åº”ç”¨\"></a>åº”ç”¨</h3><p>çŸ¥é“äº†æ€ä¹ˆä½¿ç”¨å’Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä½¿ç”¨ <code>call</code>ã€<code>apply</code>ã€<code>bind</code> çš„å¸¸è§åº”ç”¨åœºæ™¯ã€‚</p>\n<h4 id=\"æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\"><a href=\"#æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\" class=\"headerlink\" title=\"æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\"></a>æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">34</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">54</span>,<span class=\"number\">6</span>,<span class=\"number\">-67</span>,<span class=\"number\">5</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">-8</span>,<span class=\"number\">687</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Math</span>.max.call(<span class=\"built_in\">Math</span>, <span class=\"number\">34</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">54</span>,<span class=\"number\">6</span>,<span class=\"number\">-67</span>,<span class=\"number\">5</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">-8</span>,<span class=\"number\">687</span>);</span><br><span class=\"line\"><span class=\"built_in\">Math</span>.max.apply(<span class=\"built_in\">Math</span>, arr);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Math</span>.min.call(<span class=\"built_in\">Math</span>, <span class=\"number\">34</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">54</span>,<span class=\"number\">6</span>,<span class=\"number\">-67</span>,<span class=\"number\">5</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">-8</span>,<span class=\"number\">687</span>);</span><br><span class=\"line\"><span class=\"built_in\">Math</span>.min.apply(<span class=\"built_in\">Math</span>, arr);</span><br></pre></td></tr></table></figure>\n<h4 id=\"å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\"><a href=\"#å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\" class=\"headerlink\" title=\"å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\"></a>å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„</h4><p>JavaScript ä¸­çš„ä¼ªæ•°ç»„(ä¾‹å¦‚é€šè¿‡ <code>document.getElementsByTagName</code> è·å–çš„å…ƒç´ )å…·æœ‰ <code>length</code> å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ 0ã€1ã€2â€¦ä¸‹æ ‡æ¥è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œä½†æ˜¯æ²¡æœ‰ <code>Array</code> ä¸­çš„ <code>push</code>ã€<code>pop</code> ç­‰æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>call</code>ã€<code>apply</code> æ¥å°†å…¶è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„è¿™æ ·ä¾¿å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨æ•°ç»„æ–¹æ³•äº†ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿™æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> arrayLike = &#123;</span><br><span class=\"line\">    <span class=\"number\">0</span>: <span class=\"string\">'aaaa'</span>,</span><br><span class=\"line\">    <span class=\"number\">1</span>: <span class=\"string\">'bbbb'</span>,</span><br><span class=\"line\">    <span class=\"number\">2</span>: <span class=\"string\">'cccc'</span>,</span><br><span class=\"line\">    length: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// é€šè¿‡è¿™ä¸ªæ–¹æ³•è½¬æ¢</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> arr = <span class=\"built_in\">Array</span>.prototype.slice.call(arrayLike);</span><br></pre></td></tr></table></figure>\n<div class=\"tip\">ä¸Šé¢ <code>arr</code> ä¾¿æ˜¯ä¸€ä¸ªåŒ…å« <code>arrayLike</code> å…ƒç´ çš„çœŸæ­£çš„æ•°ç»„å•¦( æ³¨æ„æ•°æ®ç»“æ„å¿…é¡»æ˜¯ä»¥æ•°å­—ä¸ºä¸‹æ ‡è€Œä¸”ä¸€å®šè¦æœ‰ <code>length</code> å±æ€§ )<br></div>\n\n<h4 id=\"æ•°ç»„è¿½åŠ \"><a href=\"#æ•°ç»„è¿½åŠ \" class=\"headerlink\" title=\"æ•°ç»„è¿½åŠ \"></a>æ•°ç»„è¿½åŠ </h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr1 = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr2 = [<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>];</span><br><span class=\"line\">[].push.apply(arr1, arr2);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr1);<span class=\"comment\">// =&gt; [1, 2, 3, 4, 5, 6]</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr2);<span class=\"comment\">// =&gt; [1, 2, 3]</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"å˜é‡ç±»å‹åˆ¤æ–­\"><a href=\"#å˜é‡ç±»å‹åˆ¤æ–­\" class=\"headerlink\" title=\"å˜é‡ç±»å‹åˆ¤æ–­\"></a>å˜é‡ç±»å‹åˆ¤æ–­</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isArray</span>(<span class=\"params\">obj</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.prototype.toString.call(obj) == <span class=\"string\">'[object Array]'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr1 = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr2 = <span class=\"string\">'[1,2,3]'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">isArray(arr1);<span class=\"comment\">//   =&gt; true</span></span><br><span class=\"line\">isArray(arr2);<span class=\"comment\">//   =&gt; false</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ç»§æ‰¿\"><a href=\"#ç»§æ‰¿\" class=\"headerlink\" title=\"ç»§æ‰¿\"></a>ç»§æ‰¿</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åŸºç¡€ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Person = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¥³å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Girl = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  Person.call(<span class=\"keyword\">this</span>, name);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// ç”·å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Boy = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">  Person.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> g1 = <span class=\"keyword\">new</span> Girl (<span class=\"string\">'Jilly'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> b1 = <span class=\"keyword\">new</span> Boy(<span class=\"string\">'ifyour'</span>, <span class=\"number\">18</span>);</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå¤„ç† <code>this</code> çš„æŒ‡å‘é—®é¢˜ï¼Œæ”¹å˜ this çš„æŒ‡å‘å°±ä¸å¾—ä¸è°ˆè°ˆä»Šå¤©çš„ä¸»è§’â€”â€” <code>call</code>ã€<code>apply</code>ã€<code>bind</code>ã€‚ä¸ªäººæ„Ÿè§‰ <code>this</code> çš„é—®é¢˜åˆå­¦è€…ä¸åŒå®¹æ˜“ä¸€ä¸‹ç†è§£é€å½»ï¼Œä»Šå¤©å†æ¥å¥½å¥½æ‹ä¸€æ‹åŠ æ·±ç†è§£ã€‚<br>","more":"</p>\n<h3 id=\"ä½œç”¨\"><a href=\"#ä½œç”¨\" class=\"headerlink\" title=\"ä½œç”¨\"></a>ä½œç”¨</h3><p><code>call</code>ã€<code>apply</code>ã€<code>bind</code> çš„ä½œç”¨å°±æ˜¯æ”¹å˜å‡½æ•°æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ï¼Œå³æ”¹å˜ <code>this</code> æŒ‡å‘ã€‚</p>\n<p><code>this</code> çš„æŒ‡å‘å…¶å®ä¹Ÿå°±<a href=\"https://ifyour.github.io/2016/02/19/JavaScript-%E4%B8%AD%E7%9A%84-this-%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/\">ä¸å¤–ä¹è¿™å››ç§æƒ…å†µ</a>ï¼Œå…¶å®ç†è§£èµ·æ¥è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œç†è§£ä¸äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå…ˆè®°ä½ï¼Œåé¢åœ¨å·¥ä½œä¸­å¤§é‡ç¼–ç åº”ç”¨ï¼Œå†™å¤šäº†å°±çŸ¥é“ä¸ºå•¥è¦è¿™æ ·ç”¨äº†ã€‚å…ˆæ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å®šä¹‰äººç±»æ„é€ å‡½æ•°ï¼Œå±æ€§æ˜¯å§“åï¼Œæ–¹æ³•æ˜¯è¾“å‡ºè‡ªå·±çš„å§“å</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Person</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Person.prototype = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>: Person,</span><br><span class=\"line\">    showName: function() &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> p1 = <span class=\"keyword\">new</span> Person(<span class=\"string\">'ifyour'</span>);</span><br><span class=\"line\">p1.showName(); <span class=\"comment\">// =&gt; ifyour</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©å¯¹è±¡ï¼Œå®ƒæœ‰ä¸ªä¸€å§“åå±æ€§</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> animal = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'cat'</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure></p>\n<p>äººç±»å®ä¾‹ <code>p1</code> æƒ³è¦æ‰“å°è‡ªå·±çš„å§“åï¼Œåªè¦è°ƒç”¨è‡ªèº«çš„ <code>showName</code> æ–¹æ³•å³å¯ï¼Œä½†æ˜¯åŠ¨ç‰©å‘¢ï¼Ÿæˆ‘ä¹Ÿæƒ³è¦åŠ¨ç‰©å®ä¾‹ <code>animal</code> æ‰“å°è‡ªå·±çš„åå­—ï¼Œå¦‚ä½•åšå‘¢ï¼Ÿå½“ç„¶æ”¹å˜ this å’¯ï¼ŒæŠŠäººç±»çš„ <code>showName</code> æ–¹æ³•å€Ÿç»™åŠ¨ç‰©ç”¨ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¯ä»¥ç›´æ¥å»åŸå‹ä¸Šå€Ÿç”¨</span></span><br><span class=\"line\">Person.prototype.showName.call(animal);<span class=\"comment\">//=&gt;cat</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ä¹Ÿå¯ä»¥ä»äººç±»ä¸Šç”Ÿæˆçš„å®ä¾‹ p1 å»å€Ÿç”¨</span></span><br><span class=\"line\">p1.showName.call(animal);<span class=\"comment\">//  =&gt; cat</span></span><br><span class=\"line\">p1.showName.apply(animal);<span class=\"comment\">// =&gt; cat</span></span><br><span class=\"line\">p1.showName.bind(animal)();<span class=\"comment\">//=&gt; cat</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"åŒºåˆ«\"><a href=\"#åŒºåˆ«\" class=\"headerlink\" title=\"åŒºåˆ«\"></a>åŒºåˆ«</h3><h4 id=\"callã€apply-ä¸-bind\"><a href=\"#callã€apply-ä¸-bind\" class=\"headerlink\" title=\"callã€apply ä¸ bind\"></a>callã€apply ä¸ bind</h4><ul>\n<li><code>call</code>ã€<code>apply</code> æ”¹å˜ <code>this</code> æŒ‡å‘åä¼š <strong><em>ç«‹å³æ‰§è¡Œ</em></strong></li>\n<li><code>bind</code> å¹¶ä¸ä¼šæ‰§è¡Œ</li>\n</ul>\n<p>åœ¨ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œ<code>bind</code> æ–¹æ³•æ”¹å˜ this æ—¶ï¼Œè¿˜éœ€è¦åŠ ä¸€ä¸ª <code>()</code> æ‰èƒ½æ‰§è¡Œè¾“å‡º <code>cat</code>ã€‚</p>\n<h4 id=\"call-ä¸-apply\"><a href=\"#call-ä¸-apply\" class=\"headerlink\" title=\"call ä¸ apply\"></a>call ä¸ apply</h4><ul>\n<li><code>call</code> æŠŠå‚æ•°æŒ‰é¡ºåºä¼ å…¥ï¼Œå³ï¼š<code>fn.call(obj, arg1, arg2, arg3...);</code></li>\n<li><code>apply</code> æŠŠå‚æ•°æ‰“åŒ…æˆ <code>Array</code> åä¼ å…¥ï¼Œå³ï¼š <code>fn.apply(obj, [arg1, arg2, arg3...]);</code></li>\n</ul>\n<p>å®ƒä»¬ä¿©ä¹‹é—´çš„å·®åˆ«åœ¨äº <strong><em>å‚æ•°</em></strong>ï¼Œ<code>call</code> å’Œ <code>aplly</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯è¦æ”¹å˜ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œè€Œ <code>call</code> ä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹ä»¥å‚æ•°åˆ—è¡¨çš„å½¢å¼å±•ç°ï¼Œ<code>apply</code> åˆ™æ˜¯æŠŠé™¤äº†æ”¹å˜ä¸Šä¸‹æ–‡å¯¹è±¡çš„å‚æ•°æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ä½œä¸ºå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ã€‚</p>\n<h3 id=\"åº”ç”¨\"><a href=\"#åº”ç”¨\" class=\"headerlink\" title=\"åº”ç”¨\"></a>åº”ç”¨</h3><p>çŸ¥é“äº†æ€ä¹ˆä½¿ç”¨å’Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä½¿ç”¨ <code>call</code>ã€<code>apply</code>ã€<code>bind</code> çš„å¸¸è§åº”ç”¨åœºæ™¯ã€‚</p>\n<h4 id=\"æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\"><a href=\"#æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\" class=\"headerlink\" title=\"æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼\"></a>æ±‚æ•°ç»„ä¸­çš„æœ€å¤§ã€æœ€å°å€¼</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">34</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">54</span>,<span class=\"number\">6</span>,<span class=\"number\">-67</span>,<span class=\"number\">5</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">-8</span>,<span class=\"number\">687</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Math</span>.max.call(<span class=\"built_in\">Math</span>, <span class=\"number\">34</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">54</span>,<span class=\"number\">6</span>,<span class=\"number\">-67</span>,<span class=\"number\">5</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">-8</span>,<span class=\"number\">687</span>);</span><br><span class=\"line\"><span class=\"built_in\">Math</span>.max.apply(<span class=\"built_in\">Math</span>, arr);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Math</span>.min.call(<span class=\"built_in\">Math</span>, <span class=\"number\">34</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">54</span>,<span class=\"number\">6</span>,<span class=\"number\">-67</span>,<span class=\"number\">5</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">-8</span>,<span class=\"number\">687</span>);</span><br><span class=\"line\"><span class=\"built_in\">Math</span>.min.apply(<span class=\"built_in\">Math</span>, arr);</span><br></pre></td></tr></table></figure>\n<h4 id=\"å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\"><a href=\"#å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\" class=\"headerlink\" title=\"å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„\"></a>å°†ä¼ªæ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„</h4><p>JavaScript ä¸­çš„ä¼ªæ•°ç»„(ä¾‹å¦‚é€šè¿‡ <code>document.getElementsByTagName</code> è·å–çš„å…ƒç´ )å…·æœ‰ <code>length</code> å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ 0ã€1ã€2â€¦ä¸‹æ ‡æ¥è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œä½†æ˜¯æ²¡æœ‰ <code>Array</code> ä¸­çš„ <code>push</code>ã€<code>pop</code> ç­‰æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>call</code>ã€<code>apply</code> æ¥å°†å…¶è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„è¿™æ ·ä¾¿å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨æ•°ç»„æ–¹æ³•äº†ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è¿™æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> arrayLike = &#123;</span><br><span class=\"line\">    <span class=\"number\">0</span>: <span class=\"string\">'aaaa'</span>,</span><br><span class=\"line\">    <span class=\"number\">1</span>: <span class=\"string\">'bbbb'</span>,</span><br><span class=\"line\">    <span class=\"number\">2</span>: <span class=\"string\">'cccc'</span>,</span><br><span class=\"line\">    length: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// é€šè¿‡è¿™ä¸ªæ–¹æ³•è½¬æ¢</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> arr = <span class=\"built_in\">Array</span>.prototype.slice.call(arrayLike);</span><br></pre></td></tr></table></figure>\n<div class=\"tip\">ä¸Šé¢ <code>arr</code> ä¾¿æ˜¯ä¸€ä¸ªåŒ…å« <code>arrayLike</code> å…ƒç´ çš„çœŸæ­£çš„æ•°ç»„å•¦( æ³¨æ„æ•°æ®ç»“æ„å¿…é¡»æ˜¯ä»¥æ•°å­—ä¸ºä¸‹æ ‡è€Œä¸”ä¸€å®šè¦æœ‰ <code>length</code> å±æ€§ )<br></div>\n\n<h4 id=\"æ•°ç»„è¿½åŠ \"><a href=\"#æ•°ç»„è¿½åŠ \" class=\"headerlink\" title=\"æ•°ç»„è¿½åŠ \"></a>æ•°ç»„è¿½åŠ </h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr1 = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr2 = [<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>];</span><br><span class=\"line\">[].push.apply(arr1, arr2);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr1);<span class=\"comment\">// =&gt; [1, 2, 3, 4, 5, 6]</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(arr2);<span class=\"comment\">// =&gt; [1, 2, 3]</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"å˜é‡ç±»å‹åˆ¤æ–­\"><a href=\"#å˜é‡ç±»å‹åˆ¤æ–­\" class=\"headerlink\" title=\"å˜é‡ç±»å‹åˆ¤æ–­\"></a>å˜é‡ç±»å‹åˆ¤æ–­</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isArray</span>(<span class=\"params\">obj</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.prototype.toString.call(obj) == <span class=\"string\">'[object Array]'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr1 = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> arr2 = <span class=\"string\">'[1,2,3]'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">isArray(arr1);<span class=\"comment\">//   =&gt; true</span></span><br><span class=\"line\">isArray(arr2);<span class=\"comment\">//   =&gt; false</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"ç»§æ‰¿\"><a href=\"#ç»§æ‰¿\" class=\"headerlink\" title=\"ç»§æ‰¿\"></a>ç»§æ‰¿</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åŸºç¡€ç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Person = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¥³å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Girl = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  Person.call(<span class=\"keyword\">this</span>, name);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// ç”·å­©ç±»ç»§æ‰¿åŸºç¡€äººç±»</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Boy = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">  Person.apply(<span class=\"keyword\">this</span>, <span class=\"built_in\">arguments</span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> g1 = <span class=\"keyword\">new</span> Girl (<span class=\"string\">'Jilly'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> b1 = <span class=\"keyword\">new</span> Boy(<span class=\"string\">'ifyour'</span>, <span class=\"number\">18</span>);</span><br></pre></td></tr></table></figure>"},{"title":"æŒç»­é›†æˆ (CI) åŠç®€å•å®è·µ","date":"2018-04-30T01:00:00.000Z","comments":1,"_content":"\nåœ¨è½¯ä»¶å¼€å‘é¢†åŸŸ, ä¸€ç›´æœ‰å¾ˆå¤šæ¯”è¾ƒä¸“ä¸šçš„æœ¯è¯­, æœ¬ç€ç§‘æ™®çš„ç²¾ç¥, æ¥å¡«ä¸€ä¸‹è‡ªå·±çš„ ~~çŸ¥è¯†ç›²åŒº~~ ğŸ˜‚, ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ? å¦‚ä½•åšæŒç»­é›†æˆ? ä¸ºä»€ä¹ˆè¦åšæŒç»­é›†æˆ? å¸¦ç€è¿™äº›é—®é¢˜, æœ¬ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ.\n\n<!-- more -->\n\n## What\n\n> æŒç»­é›†æˆï¼ˆè‹±è¯­ï¼šContinuous integrationï¼Œç¼©å†™ CIï¼‰æ˜¯ä¸€ç§è½¯ä»¶å·¥ç¨‹æµç¨‹ï¼Œæ˜¯å°†æ‰€æœ‰è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹äºè½¯ä»¶çš„å·¥ä½œå‰¯æœ¬æŒç»­æäº¤åˆ°å…±ç”¨ä¸»çº¿ï¼ˆmainlineï¼‰çš„ä¸€ç§æªæ–½ã€‚\n\n## Why\n\næŒç»­é›†æˆçš„ç›®çš„ï¼Œå°±æ˜¯è®©äº§å“å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶è¿˜èƒ½ä¿æŒé«˜è´¨é‡ã€‚\n\n![image](https://user-images.githubusercontent.com/15377484/39465580-acb719cc-4d56-11e8-9915-2964d5e523c5.png)\n\n## How\n\nå®ƒçš„æ ¸å¿ƒæªæ–½æ˜¯ï¼Œä»£ç é›†æˆåˆ°ä¸»å¹²ä¹‹å‰ï¼Œå¿…é¡»é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚åªè¦æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥ï¼Œå°±ä¸èƒ½é›†æˆã€‚ä»¥æœ¬æ¬¡ç»™åšå®¢åšæŒç»­é›†æˆä¸ºä¾‹ï¼Œå®ƒçš„æµç¨‹æ˜¯è¿™æ ·å­çš„ï¼š\n\n1. å†™å®Œåšå®¢åï¼Œç›´æ¥ push åˆ° GitHub çš„ `src` åˆ†æ”¯(æˆ‘çš„ `master` åˆ†æ”¯æ˜¯ pages)\n2. CI æœåŠ¡é€šè¿‡é…ç½®æ–‡ä»¶ `.travis.yml` ç›‘å¬å½“å‰ `src` åˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘ webhook\n3. CI æœåŠ¡å°†å½“å‰é¡¹ç›® clone è¿‡å»ï¼Œæ ¹æ® `.travis.yml` çš„é…ç½®æ‰§è¡Œæµ‹è¯•å’Œæ„å»º\n4. å°†æœ€ç»ˆå¯ä»¥ä½œä¸ºç”Ÿäº§ç¯å¢ƒçš„ä»£ç æ¨é€åˆ°çº¿ä¸Šç¯å¢ƒï¼Œå¹¶ä¸” push å›  `src` åˆ†æ”¯\n\nè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼š\n\n- å‘å¸ƒæ–°æ–‡ç« ï¼Œåªéœ€ push ä¸€æ¬¡åˆ°ä»“åº“ï¼Œå‰©ä¸‹çš„æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒç­‰ï¼ŒCI å¸®æˆ‘è‡ªåŠ¨å®Œæˆã€‚\n- å¿«é€Ÿå‘ç°é”™è¯¯ã€‚æ¯å®Œæˆä¸€ç‚¹æ›´æ–°ï¼Œå°±é›†æˆåˆ°ä¸»å¹²ï¼Œå®šä½é”™è¯¯ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚\n- é˜²æ­¢åˆ†æ”¯å¤§å¹…åç¦»ä¸»å¹²ã€‚å¦‚æœä¸æ˜¯ç»å¸¸é›†æˆï¼Œä¸»å¹²åˆåœ¨ä¸æ–­æ›´æ–°ï¼Œä¼šå¯¼è‡´ä»¥åé›†æˆçš„éš¾åº¦å˜å¤§ã€‚\n\n## More\n\n- [æŒç»­é›†æˆæ˜¯ä»€ä¹ˆ](http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html)\n- [ä½¿ç”¨ Travis è‡ªåŠ¨éƒ¨ç½² Hexo](https://segmentfault.com/a/1190000009054888)\n","source":"_posts/æŒç»­é›†æˆ-CI-åŠç®€å•å®è·µ.md","raw":"---\ntitle: 'æŒç»­é›†æˆ (CI) åŠç®€å•å®è·µ'\ndate: 2018-04-30 9:00:00\ntags:\ncomments: true\n---\n\nåœ¨è½¯ä»¶å¼€å‘é¢†åŸŸ, ä¸€ç›´æœ‰å¾ˆå¤šæ¯”è¾ƒä¸“ä¸šçš„æœ¯è¯­, æœ¬ç€ç§‘æ™®çš„ç²¾ç¥, æ¥å¡«ä¸€ä¸‹è‡ªå·±çš„ ~~çŸ¥è¯†ç›²åŒº~~ ğŸ˜‚, ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ? å¦‚ä½•åšæŒç»­é›†æˆ? ä¸ºä»€ä¹ˆè¦åšæŒç»­é›†æˆ? å¸¦ç€è¿™äº›é—®é¢˜, æœ¬ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ.\n\n<!-- more -->\n\n## What\n\n> æŒç»­é›†æˆï¼ˆè‹±è¯­ï¼šContinuous integrationï¼Œç¼©å†™ CIï¼‰æ˜¯ä¸€ç§è½¯ä»¶å·¥ç¨‹æµç¨‹ï¼Œæ˜¯å°†æ‰€æœ‰è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹äºè½¯ä»¶çš„å·¥ä½œå‰¯æœ¬æŒç»­æäº¤åˆ°å…±ç”¨ä¸»çº¿ï¼ˆmainlineï¼‰çš„ä¸€ç§æªæ–½ã€‚\n\n## Why\n\næŒç»­é›†æˆçš„ç›®çš„ï¼Œå°±æ˜¯è®©äº§å“å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶è¿˜èƒ½ä¿æŒé«˜è´¨é‡ã€‚\n\n![image](https://user-images.githubusercontent.com/15377484/39465580-acb719cc-4d56-11e8-9915-2964d5e523c5.png)\n\n## How\n\nå®ƒçš„æ ¸å¿ƒæªæ–½æ˜¯ï¼Œä»£ç é›†æˆåˆ°ä¸»å¹²ä¹‹å‰ï¼Œå¿…é¡»é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚åªè¦æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥ï¼Œå°±ä¸èƒ½é›†æˆã€‚ä»¥æœ¬æ¬¡ç»™åšå®¢åšæŒç»­é›†æˆä¸ºä¾‹ï¼Œå®ƒçš„æµç¨‹æ˜¯è¿™æ ·å­çš„ï¼š\n\n1. å†™å®Œåšå®¢åï¼Œç›´æ¥ push åˆ° GitHub çš„ `src` åˆ†æ”¯(æˆ‘çš„ `master` åˆ†æ”¯æ˜¯ pages)\n2. CI æœåŠ¡é€šè¿‡é…ç½®æ–‡ä»¶ `.travis.yml` ç›‘å¬å½“å‰ `src` åˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘ webhook\n3. CI æœåŠ¡å°†å½“å‰é¡¹ç›® clone è¿‡å»ï¼Œæ ¹æ® `.travis.yml` çš„é…ç½®æ‰§è¡Œæµ‹è¯•å’Œæ„å»º\n4. å°†æœ€ç»ˆå¯ä»¥ä½œä¸ºç”Ÿäº§ç¯å¢ƒçš„ä»£ç æ¨é€åˆ°çº¿ä¸Šç¯å¢ƒï¼Œå¹¶ä¸” push å›  `src` åˆ†æ”¯\n\nè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼š\n\n- å‘å¸ƒæ–°æ–‡ç« ï¼Œåªéœ€ push ä¸€æ¬¡åˆ°ä»“åº“ï¼Œå‰©ä¸‹çš„æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒç­‰ï¼ŒCI å¸®æˆ‘è‡ªåŠ¨å®Œæˆã€‚\n- å¿«é€Ÿå‘ç°é”™è¯¯ã€‚æ¯å®Œæˆä¸€ç‚¹æ›´æ–°ï¼Œå°±é›†æˆåˆ°ä¸»å¹²ï¼Œå®šä½é”™è¯¯ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚\n- é˜²æ­¢åˆ†æ”¯å¤§å¹…åç¦»ä¸»å¹²ã€‚å¦‚æœä¸æ˜¯ç»å¸¸é›†æˆï¼Œä¸»å¹²åˆåœ¨ä¸æ–­æ›´æ–°ï¼Œä¼šå¯¼è‡´ä»¥åé›†æˆçš„éš¾åº¦å˜å¤§ã€‚\n\n## More\n\n- [æŒç»­é›†æˆæ˜¯ä»€ä¹ˆ](http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html)\n- [ä½¿ç”¨ Travis è‡ªåŠ¨éƒ¨ç½² Hexo](https://segmentfault.com/a/1190000009054888)\n","slug":"æŒç»­é›†æˆ-CI-åŠç®€å•å®è·µ","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidja000lu4q9nerikxz8","content":"<p>åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸ, ä¸€ç›´æœ‰å¾ˆå¤šæ¯”è¾ƒä¸“ä¸šçš„æœ¯è¯­, æœ¬ç€ç§‘æ™®çš„ç²¾ç¥, æ¥å¡«ä¸€ä¸‹è‡ªå·±çš„ <del>çŸ¥è¯†ç›²åŒº</del> ğŸ˜‚, ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ? å¦‚ä½•åšæŒç»­é›†æˆ? ä¸ºä»€ä¹ˆè¦åšæŒç»­é›†æˆ? å¸¦ç€è¿™äº›é—®é¢˜, æœ¬ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ.</p>\n<a id=\"more\"></a>\n<h2 id=\"What\"><a href=\"#What\" class=\"headerlink\" title=\"What\"></a>What</h2><blockquote>\n<p>æŒç»­é›†æˆï¼ˆè‹±è¯­ï¼šContinuous integrationï¼Œç¼©å†™ CIï¼‰æ˜¯ä¸€ç§è½¯ä»¶å·¥ç¨‹æµç¨‹ï¼Œæ˜¯å°†æ‰€æœ‰è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹äºè½¯ä»¶çš„å·¥ä½œå‰¯æœ¬æŒç»­æäº¤åˆ°å…±ç”¨ä¸»çº¿ï¼ˆmainlineï¼‰çš„ä¸€ç§æªæ–½ã€‚</p>\n</blockquote>\n<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why\"></a>Why</h2><p>æŒç»­é›†æˆçš„ç›®çš„ï¼Œå°±æ˜¯è®©äº§å“å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶è¿˜èƒ½ä¿æŒé«˜è´¨é‡ã€‚</p>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39465580-acb719cc-4d56-11e8-9915-2964d5e523c5.png\" alt=\"image\"></p>\n<h2 id=\"How\"><a href=\"#How\" class=\"headerlink\" title=\"How\"></a>How</h2><p>å®ƒçš„æ ¸å¿ƒæªæ–½æ˜¯ï¼Œä»£ç é›†æˆåˆ°ä¸»å¹²ä¹‹å‰ï¼Œå¿…é¡»é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚åªè¦æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥ï¼Œå°±ä¸èƒ½é›†æˆã€‚ä»¥æœ¬æ¬¡ç»™åšå®¢åšæŒç»­é›†æˆä¸ºä¾‹ï¼Œå®ƒçš„æµç¨‹æ˜¯è¿™æ ·å­çš„ï¼š</p>\n<ol>\n<li>å†™å®Œåšå®¢åï¼Œç›´æ¥ push åˆ° GitHub çš„ <code>src</code> åˆ†æ”¯(æˆ‘çš„ <code>master</code> åˆ†æ”¯æ˜¯ pages)</li>\n<li>CI æœåŠ¡é€šè¿‡é…ç½®æ–‡ä»¶ <code>.travis.yml</code> ç›‘å¬å½“å‰ <code>src</code> åˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘ webhook</li>\n<li>CI æœåŠ¡å°†å½“å‰é¡¹ç›® clone è¿‡å»ï¼Œæ ¹æ® <code>.travis.yml</code> çš„é…ç½®æ‰§è¡Œæµ‹è¯•å’Œæ„å»º</li>\n<li>å°†æœ€ç»ˆå¯ä»¥ä½œä¸ºç”Ÿäº§ç¯å¢ƒçš„ä»£ç æ¨é€åˆ°çº¿ä¸Šç¯å¢ƒï¼Œå¹¶ä¸” push å›  <code>src</code> åˆ†æ”¯</li>\n</ol>\n<p>è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼š</p>\n<ul>\n<li>å‘å¸ƒæ–°æ–‡ç« ï¼Œåªéœ€ push ä¸€æ¬¡åˆ°ä»“åº“ï¼Œå‰©ä¸‹çš„æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒç­‰ï¼ŒCI å¸®æˆ‘è‡ªåŠ¨å®Œæˆã€‚</li>\n<li>å¿«é€Ÿå‘ç°é”™è¯¯ã€‚æ¯å®Œæˆä¸€ç‚¹æ›´æ–°ï¼Œå°±é›†æˆåˆ°ä¸»å¹²ï¼Œå®šä½é”™è¯¯ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚</li>\n<li>é˜²æ­¢åˆ†æ”¯å¤§å¹…åç¦»ä¸»å¹²ã€‚å¦‚æœä¸æ˜¯ç»å¸¸é›†æˆï¼Œä¸»å¹²åˆåœ¨ä¸æ–­æ›´æ–°ï¼Œä¼šå¯¼è‡´ä»¥åé›†æˆçš„éš¾åº¦å˜å¤§ã€‚</li>\n</ul>\n<h2 id=\"More\"><a href=\"#More\" class=\"headerlink\" title=\"More\"></a>More</h2><ul>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html\" target=\"_blank\" rel=\"noopener\">æŒç»­é›†æˆæ˜¯ä»€ä¹ˆ</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000009054888\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨ Travis è‡ªåŠ¨éƒ¨ç½² Hexo</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸ, ä¸€ç›´æœ‰å¾ˆå¤šæ¯”è¾ƒä¸“ä¸šçš„æœ¯è¯­, æœ¬ç€ç§‘æ™®çš„ç²¾ç¥, æ¥å¡«ä¸€ä¸‹è‡ªå·±çš„ <del>çŸ¥è¯†ç›²åŒº</del> ğŸ˜‚, ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ? å¦‚ä½•åšæŒç»­é›†æˆ? ä¸ºä»€ä¹ˆè¦åšæŒç»­é›†æˆ? å¸¦ç€è¿™äº›é—®é¢˜, æœ¬ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ.</p>","more":"<h2 id=\"What\"><a href=\"#What\" class=\"headerlink\" title=\"What\"></a>What</h2><blockquote>\n<p>æŒç»­é›†æˆï¼ˆè‹±è¯­ï¼šContinuous integrationï¼Œç¼©å†™ CIï¼‰æ˜¯ä¸€ç§è½¯ä»¶å·¥ç¨‹æµç¨‹ï¼Œæ˜¯å°†æ‰€æœ‰è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹äºè½¯ä»¶çš„å·¥ä½œå‰¯æœ¬æŒç»­æäº¤åˆ°å…±ç”¨ä¸»çº¿ï¼ˆmainlineï¼‰çš„ä¸€ç§æªæ–½ã€‚</p>\n</blockquote>\n<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why\"></a>Why</h2><p>æŒç»­é›†æˆçš„ç›®çš„ï¼Œå°±æ˜¯è®©äº§å“å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶è¿˜èƒ½ä¿æŒé«˜è´¨é‡ã€‚</p>\n<p><img src=\"https://user-images.githubusercontent.com/15377484/39465580-acb719cc-4d56-11e8-9915-2964d5e523c5.png\" alt=\"image\"></p>\n<h2 id=\"How\"><a href=\"#How\" class=\"headerlink\" title=\"How\"></a>How</h2><p>å®ƒçš„æ ¸å¿ƒæªæ–½æ˜¯ï¼Œä»£ç é›†æˆåˆ°ä¸»å¹²ä¹‹å‰ï¼Œå¿…é¡»é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚åªè¦æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥ï¼Œå°±ä¸èƒ½é›†æˆã€‚ä»¥æœ¬æ¬¡ç»™åšå®¢åšæŒç»­é›†æˆä¸ºä¾‹ï¼Œå®ƒçš„æµç¨‹æ˜¯è¿™æ ·å­çš„ï¼š</p>\n<ol>\n<li>å†™å®Œåšå®¢åï¼Œç›´æ¥ push åˆ° GitHub çš„ <code>src</code> åˆ†æ”¯(æˆ‘çš„ <code>master</code> åˆ†æ”¯æ˜¯ pages)</li>\n<li>CI æœåŠ¡é€šè¿‡é…ç½®æ–‡ä»¶ <code>.travis.yml</code> ç›‘å¬å½“å‰ <code>src</code> åˆ†æ”¯å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘ webhook</li>\n<li>CI æœåŠ¡å°†å½“å‰é¡¹ç›® clone è¿‡å»ï¼Œæ ¹æ® <code>.travis.yml</code> çš„é…ç½®æ‰§è¡Œæµ‹è¯•å’Œæ„å»º</li>\n<li>å°†æœ€ç»ˆå¯ä»¥ä½œä¸ºç”Ÿäº§ç¯å¢ƒçš„ä»£ç æ¨é€åˆ°çº¿ä¸Šç¯å¢ƒï¼Œå¹¶ä¸” push å›  <code>src</code> åˆ†æ”¯</li>\n</ol>\n<p>è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼š</p>\n<ul>\n<li>å‘å¸ƒæ–°æ–‡ç« ï¼Œåªéœ€ push ä¸€æ¬¡åˆ°ä»“åº“ï¼Œå‰©ä¸‹çš„æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒç­‰ï¼ŒCI å¸®æˆ‘è‡ªåŠ¨å®Œæˆã€‚</li>\n<li>å¿«é€Ÿå‘ç°é”™è¯¯ã€‚æ¯å®Œæˆä¸€ç‚¹æ›´æ–°ï¼Œå°±é›†æˆåˆ°ä¸»å¹²ï¼Œå®šä½é”™è¯¯ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚</li>\n<li>é˜²æ­¢åˆ†æ”¯å¤§å¹…åç¦»ä¸»å¹²ã€‚å¦‚æœä¸æ˜¯ç»å¸¸é›†æˆï¼Œä¸»å¹²åˆåœ¨ä¸æ–­æ›´æ–°ï¼Œä¼šå¯¼è‡´ä»¥åé›†æˆçš„éš¾åº¦å˜å¤§ã€‚</li>\n</ul>\n<h2 id=\"More\"><a href=\"#More\" class=\"headerlink\" title=\"More\"></a>More</h2><ul>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html\" target=\"_blank\" rel=\"noopener\">æŒç»­é›†æˆæ˜¯ä»€ä¹ˆ</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000009054888\" target=\"_blank\" rel=\"noopener\">ä½¿ç”¨ Travis è‡ªåŠ¨éƒ¨ç½² Hexo</a></li>\n</ul>"},{"title":"å¦‚ä½•é¿å… async/await åœ°ç‹±","comments":1,"date":"2018-05-20T14:11:35.000Z","from":"https://medium.freecodecamp.org/avoiding-the-async-await-hell-c77a0fb71c4c","_content":"\næœ€è¿‘é˜…è¯»äº† Aditya Agarwal çš„ä¸€ç¯‡æ–‡ç« ï¼šHow to escape async/await hellã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦è®¨è®ºäº†è¿‡åº¦ä½¿ç”¨ async/await å¯¼è‡´çš„æ–°çš„ã€Œåœ°ç‹±ã€é—®é¢˜ï¼Œå…¶å·²ç»åœ¨ Medium ä¸Šè·å¾—äº† 19k+ çš„ Applauseã€‚\n\n<!-- more -->\n\n<div class=\"tip\">\n  async/await æ˜¯ ES7 çš„æ–°è¯­æ³•ã€‚åœ¨ async/await æ ‡å‡†å‡ºæ¥ä¹‹å‰ï¼ŒJavaScript çš„å¼‚æ­¥ç¼–ç¨‹ç»å†äº† callback --> promise --> generator çš„æ¼”å˜è¿‡ç¨‹ã€‚\n</div>\n\nåœ¨ callback çš„æ—¶ä»£ï¼Œæœ€è®©äººå¤´ç–¼çš„é—®é¢˜å°±æ˜¯å›è°ƒåœ°ç‹± (callback hell)ã€‚æ‰€ä»¥ï¼Œåœ¨ async/await ä¸€ç»æ¨å‡ºï¼Œç¤¾åŒºå°±æœ‰äººè®¤ä¸ºã€Œè¿™æ˜¯ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆã€ã€‚ä½† async/await ä¹Ÿå¯èƒ½å¸¦æ¥æ–°çš„é—®é¢˜ã€‚\n\n> å¥½ä¸å®¹æ˜“é€ƒç¦»äº†ä¸€ä¸ªã€Œåœ°ç‹±ã€ï¼Œåˆé©¬ä¸Šé™·å…¥å¦ä¸€ä¸ªã€Œåœ°ç‹±ã€äº†ã€‚\n\n### ä½•ä¸º async/await åœ°ç‹±\n\nåœ¨ç¼–å†™å¼‚æ­¥ä»£ç æ—¶ï¼Œäººä»¬æ€»æ˜¯å–œæ¬¢ä¸€æ¬¡å†™å¤šä¸ªè¯­å¥ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¹‹å‰ä½¿ç”¨ await å…³é”®å­—ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™ä¸€ä¸ªè¯­å¥å¹¶ä¸ä¾èµ–äºå‰ä¸€ä¸ªè¯­å¥â€”â€”ä½†ä½¿ç”¨ await å…³é”®å­—åï¼Œä½ å°±éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªè¯­å¥å®Œæˆã€‚\n\n#### ç¤ºä¾‹\n\nå‡è®¾ä½ è¦å†™ä¸€ä¸ªè®¢è´­ pizza å’Œ drink çš„è„šæœ¬ï¼Œä»£ç å¯èƒ½æ˜¯å¦‚ä¸‹è¿™æ ·çš„ï¼š\n\n```js\n(async () => {\n  const pizzaData = await getPizzaData(); // async call\n  const drinkData = await getDrinkData(); // async call\n  const chosenPizza = choosePizza(); // sync call\n  const chosenDrink = chooseDrink(); // sync call\n  await addPizzaToCart(chosenPizza); // async call\n  await addDrinkToCart(chosenDrink); // async call\n  orderItems(); // async call\n})();\n```\n\nè¿™æ®µä»£ç å¼€èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿèƒ½æ­£å¸¸çš„è¿è¡Œã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„å®ç°ï¼Œå› ä¸ºè¿™æŠŠæœ¬èº«å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡å˜æˆäº†ä¸²è¡Œæ‰§è¡Œã€‚\n\né€‰æ‹©ä¸€ä¸ª drink æ·»åŠ åˆ°è´­ç‰©è½¦å’Œé€‰æ‹©ä¸€ä¸ª pizza æ·»åŠ åˆ°è´­ç‰©è½¦å¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªä»»åŠ¡ï¼Œè€Œè¿™ä¸¤ä¸ªä»»åŠ¡ä¹‹é—´å¹¶æ²¡æœ‰ç›¸äº’ä¾èµ–çš„å…³ç³»ï¼Œä¹Ÿæ²¡æœ‰ç‰¹å®šçš„é¡ºåºæ‰§è¡Œå…³ç³»ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªä»»åŠ¡æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè¿™æ ·èƒ½æé«˜æ€§èƒ½ã€‚è€Œä¸Šè¿°ä»£ç å°†äºŒè€…å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œæ˜¾ç„¶æ˜¯é™ä½äº†ç¨‹åºæ€§èƒ½çš„ã€‚\n\n### æ›´ç³Ÿç³•çš„ä¾‹å­\n\nå‡è®¾è¦å†™ä¸€ä¸ªç¨‹åºï¼Œæ ¹æ® followers æ•°ç”¨æ¥æ˜¾ç¤º GitHub ä¸­å›½åŒºç”¨æˆ·çš„æ’åæƒ…å†µã€‚\n\nå¦‚æœåªæ˜¯è·å–æ’åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ Github å®˜æ–¹çš„ [Search users](https://developer.github.com/v3/search/#search-users) æ¥å£ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š\n\n```js\nasync function getUserRank() {\n  const data = await fetch(search_url);\n  return data;\n}\n\ngetUserRank();\n```\n\nè°ƒç”¨ getUserRank å‡½æ•°å°±èƒ½è·å–åˆ°æƒ³è¦çš„ç»“æœã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½è¿˜è¦æƒ³è¦è·å–æ¯ä¸ªç”¨æˆ·çš„ follower æ•°ã€emailã€åœ°åŒºå’Œä»“åº“ç­‰æ•°æ®ï¼Œè€Œ Search users æ¥å£å¹¶æ²¡æœ‰è¿”å›è¿™äº›æ•°æ®ï¼Œä½ å¯èƒ½éœ€è¦å†å»è°ƒç”¨ [Single user](https://developer.github.com/v3/users/#get-a-single-user) æ¥å£ã€‚\n\nç„¶åä¸Šè¿°ä»£ç å¯èƒ½è¢«æ”¹å†™ä¸ºï¼š\n\n```js\nasync function getUserRank() {\n  const data = await fetch(search_url);\n  const res = [];\n\n  for (let i = 0; i < data.length; i++) {\n    const item = data[i];\n    const user = await fetch(user_url);\n    res.push({...item, ...user});\n  }\n\n  return res;\n}\n\ngetUserRank();\n```\n\nè¿è¡ŒæŸ¥çœ‹ç»“æœï¼Œè‡ªå·±æƒ³è¦çš„æ•°æ®éƒ½æ‹¿åˆ°äº†ã€‚ä½†æ˜¯ï¼Œä½ å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œç¨‹åºè¿è¡Œæ—¶é—´æœ‰ç‚¹é•¿ï¼Œè¯¥æ€ä¹ˆä¼˜åŒ–ä¸‹å‘¢ï¼Ÿ\n\nå…¶å®ï¼Œé“ºå«äº†è¿™ä¹ˆé•¿ï¼Œå°±æ˜¯æƒ³è¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼šä½ é™·å…¥äº† async/await çš„åœ°ç‹±ã€‚\n\nä¸Šè¿°ä»£ç çš„é—®é¢˜åœ¨äºï¼Œè·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œå°±ç±»ä¼¼ä¸Šæ–‡ä¸­çš„é€‰æ‹© pizza å’Œ drink ä¸€æ ·ï¼Œè¿™æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„è¯·æ±‚ã€‚è€Œæ ¹æ®ä¸Šè¿°ä»£ç ï¼Œè¯·æ±‚éƒ½å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œè¿™å½“ç„¶ä¼šæŸè€—ç¨‹åºçš„æ€§èƒ½ã€‚\n\næŒ‰ç…§ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š\n\n![image](https://user-images.githubusercontent.com/7871813/40270076-c08ec820-5bb9-11e8-8470-5e716e87dc76.gif)\n\nå¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦ç­‰åˆ°ä¸Šä¸€ä¸ªè¯·æ±‚å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼ŒWaterfall å¤„äºä¸€ä¸ªä¸²è¡Œçš„çŠ¶æ€ã€‚é‚£è¦æ€ä¹ˆæ”¹è¿›è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ\n\næ—¢ç„¶è·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆè§¦å‘å¼‚æ­¥è¯·æ±‚ï¼Œç„¶åå»¶è¿Ÿå¤„ç†å¼‚æ­¥è¯·æ±‚çš„ç»“æœï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰è¯¥è¯·æ±‚å®Œæˆã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œé‚£å¯èƒ½æ”¹è¿›çš„ä»£ç å¦‚ä¸‹ï¼š\n\n```js\nasync function getUserDetails (username) {\n  const user = await fetch(user_url);\n  return user;\n}\n\nasync function getUserRank () {\n  const data = await fetch(search_url);\n  const promises = data.map((item) => getUserDetails(item.username));\n  await Promise.all(promises).then(handleYourData);\n}\n\ngetUserRank();\n```\n\nå¯ä»¥çœ‹ä¸€ä¸‹å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š\n\n![image](https://user-images.githubusercontent.com/7871813/40270077-c2536602-5bb9-11e8-9438-a15ac05b41e0.gif)\n\nå¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„å¼‚æ­¥è¯·æ±‚å¤„ç†ä¸å†æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œè€Œæ˜¯å¹¶è¡Œæ‰§è¡Œäº†ï¼Œè¿™å°†å¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡å’Œæ€§èƒ½ã€‚\n\n### æ€»ç»“\n\nAditya Agarwal åœ¨å…¶æ–‡ç« ä¸­ä¹Ÿç»™å‡ºäº†æ€ä¹ˆé¿å…é™·å…¥ async/await åœ°ç‹±çš„å»ºè®®ï¼š\n\n1. é¦–å…ˆæ‰¾å‡ºä¾èµ–äºå…¶ä»–è¯­å¥çš„æ‰§è¡Œçš„è¯­å¥\n2. ç„¶åå°†æœ‰ä¾èµ–å…³ç³»çš„ä¸€ç³»åˆ—è¯­å¥è¿›è¡Œç»„åˆï¼Œåˆå¹¶æˆä¸€ä¸ªå¼‚æ­¥å‡½æ•°\n3. æœ€åç”¨æ­£ç¡®çš„æ–¹å¼æ‰§è¡Œè¿™äº›å‡½æ•°\n\n### å‚è€ƒ\n\n* [ç²¾è¯»ã€Šasync/await æ˜¯æŠŠåŒåˆƒå‰‘ã€‹](https://github.com/dt-fe/weekly/blob/master/55.%E7%B2%BE%E8%AF%BB%E3%80%8Aasync%20await%20%E6%98%AF%E6%8A%8A%E5%8F%8C%E5%88%83%E5%89%91%E3%80%8B.md)\n* [async å‡½æ•°çš„å«ä¹‰å’Œç”¨æ³•](http://www.ruanyifeng.com/blog/2015/05/async.html)\n* [ä½“éªŒå¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ - ES7 çš„ Async/Await](https://cnodejs.org/topic/5640b80d3a6aa72c5e0030b6)\n* [How to escape async/await hell](https://github.com/dwqs/blog/issues/65)\n","source":"_posts/å¦‚ä½•é¿å…-async-await-åœ°ç‹±.md","raw":"---\ntitle: å¦‚ä½•é¿å… async/await åœ°ç‹±\ncomments: true\ndate: 2018-05-20 22:11:35\ntags:\nfrom: https://medium.freecodecamp.org/avoiding-the-async-await-hell-c77a0fb71c4c\n---\n\næœ€è¿‘é˜…è¯»äº† Aditya Agarwal çš„ä¸€ç¯‡æ–‡ç« ï¼šHow to escape async/await hellã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦è®¨è®ºäº†è¿‡åº¦ä½¿ç”¨ async/await å¯¼è‡´çš„æ–°çš„ã€Œåœ°ç‹±ã€é—®é¢˜ï¼Œå…¶å·²ç»åœ¨ Medium ä¸Šè·å¾—äº† 19k+ çš„ Applauseã€‚\n\n<!-- more -->\n\n<div class=\"tip\">\n  async/await æ˜¯ ES7 çš„æ–°è¯­æ³•ã€‚åœ¨ async/await æ ‡å‡†å‡ºæ¥ä¹‹å‰ï¼ŒJavaScript çš„å¼‚æ­¥ç¼–ç¨‹ç»å†äº† callback --> promise --> generator çš„æ¼”å˜è¿‡ç¨‹ã€‚\n</div>\n\nåœ¨ callback çš„æ—¶ä»£ï¼Œæœ€è®©äººå¤´ç–¼çš„é—®é¢˜å°±æ˜¯å›è°ƒåœ°ç‹± (callback hell)ã€‚æ‰€ä»¥ï¼Œåœ¨ async/await ä¸€ç»æ¨å‡ºï¼Œç¤¾åŒºå°±æœ‰äººè®¤ä¸ºã€Œè¿™æ˜¯ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆã€ã€‚ä½† async/await ä¹Ÿå¯èƒ½å¸¦æ¥æ–°çš„é—®é¢˜ã€‚\n\n> å¥½ä¸å®¹æ˜“é€ƒç¦»äº†ä¸€ä¸ªã€Œåœ°ç‹±ã€ï¼Œåˆé©¬ä¸Šé™·å…¥å¦ä¸€ä¸ªã€Œåœ°ç‹±ã€äº†ã€‚\n\n### ä½•ä¸º async/await åœ°ç‹±\n\nåœ¨ç¼–å†™å¼‚æ­¥ä»£ç æ—¶ï¼Œäººä»¬æ€»æ˜¯å–œæ¬¢ä¸€æ¬¡å†™å¤šä¸ªè¯­å¥ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¹‹å‰ä½¿ç”¨ await å…³é”®å­—ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™ä¸€ä¸ªè¯­å¥å¹¶ä¸ä¾èµ–äºå‰ä¸€ä¸ªè¯­å¥â€”â€”ä½†ä½¿ç”¨ await å…³é”®å­—åï¼Œä½ å°±éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªè¯­å¥å®Œæˆã€‚\n\n#### ç¤ºä¾‹\n\nå‡è®¾ä½ è¦å†™ä¸€ä¸ªè®¢è´­ pizza å’Œ drink çš„è„šæœ¬ï¼Œä»£ç å¯èƒ½æ˜¯å¦‚ä¸‹è¿™æ ·çš„ï¼š\n\n```js\n(async () => {\n  const pizzaData = await getPizzaData(); // async call\n  const drinkData = await getDrinkData(); // async call\n  const chosenPizza = choosePizza(); // sync call\n  const chosenDrink = chooseDrink(); // sync call\n  await addPizzaToCart(chosenPizza); // async call\n  await addDrinkToCart(chosenDrink); // async call\n  orderItems(); // async call\n})();\n```\n\nè¿™æ®µä»£ç å¼€èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿèƒ½æ­£å¸¸çš„è¿è¡Œã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„å®ç°ï¼Œå› ä¸ºè¿™æŠŠæœ¬èº«å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡å˜æˆäº†ä¸²è¡Œæ‰§è¡Œã€‚\n\né€‰æ‹©ä¸€ä¸ª drink æ·»åŠ åˆ°è´­ç‰©è½¦å’Œé€‰æ‹©ä¸€ä¸ª pizza æ·»åŠ åˆ°è´­ç‰©è½¦å¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªä»»åŠ¡ï¼Œè€Œè¿™ä¸¤ä¸ªä»»åŠ¡ä¹‹é—´å¹¶æ²¡æœ‰ç›¸äº’ä¾èµ–çš„å…³ç³»ï¼Œä¹Ÿæ²¡æœ‰ç‰¹å®šçš„é¡ºåºæ‰§è¡Œå…³ç³»ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªä»»åŠ¡æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè¿™æ ·èƒ½æé«˜æ€§èƒ½ã€‚è€Œä¸Šè¿°ä»£ç å°†äºŒè€…å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œæ˜¾ç„¶æ˜¯é™ä½äº†ç¨‹åºæ€§èƒ½çš„ã€‚\n\n### æ›´ç³Ÿç³•çš„ä¾‹å­\n\nå‡è®¾è¦å†™ä¸€ä¸ªç¨‹åºï¼Œæ ¹æ® followers æ•°ç”¨æ¥æ˜¾ç¤º GitHub ä¸­å›½åŒºç”¨æˆ·çš„æ’åæƒ…å†µã€‚\n\nå¦‚æœåªæ˜¯è·å–æ’åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ Github å®˜æ–¹çš„ [Search users](https://developer.github.com/v3/search/#search-users) æ¥å£ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š\n\n```js\nasync function getUserRank() {\n  const data = await fetch(search_url);\n  return data;\n}\n\ngetUserRank();\n```\n\nè°ƒç”¨ getUserRank å‡½æ•°å°±èƒ½è·å–åˆ°æƒ³è¦çš„ç»“æœã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½è¿˜è¦æƒ³è¦è·å–æ¯ä¸ªç”¨æˆ·çš„ follower æ•°ã€emailã€åœ°åŒºå’Œä»“åº“ç­‰æ•°æ®ï¼Œè€Œ Search users æ¥å£å¹¶æ²¡æœ‰è¿”å›è¿™äº›æ•°æ®ï¼Œä½ å¯èƒ½éœ€è¦å†å»è°ƒç”¨ [Single user](https://developer.github.com/v3/users/#get-a-single-user) æ¥å£ã€‚\n\nç„¶åä¸Šè¿°ä»£ç å¯èƒ½è¢«æ”¹å†™ä¸ºï¼š\n\n```js\nasync function getUserRank() {\n  const data = await fetch(search_url);\n  const res = [];\n\n  for (let i = 0; i < data.length; i++) {\n    const item = data[i];\n    const user = await fetch(user_url);\n    res.push({...item, ...user});\n  }\n\n  return res;\n}\n\ngetUserRank();\n```\n\nè¿è¡ŒæŸ¥çœ‹ç»“æœï¼Œè‡ªå·±æƒ³è¦çš„æ•°æ®éƒ½æ‹¿åˆ°äº†ã€‚ä½†æ˜¯ï¼Œä½ å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œç¨‹åºè¿è¡Œæ—¶é—´æœ‰ç‚¹é•¿ï¼Œè¯¥æ€ä¹ˆä¼˜åŒ–ä¸‹å‘¢ï¼Ÿ\n\nå…¶å®ï¼Œé“ºå«äº†è¿™ä¹ˆé•¿ï¼Œå°±æ˜¯æƒ³è¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼šä½ é™·å…¥äº† async/await çš„åœ°ç‹±ã€‚\n\nä¸Šè¿°ä»£ç çš„é—®é¢˜åœ¨äºï¼Œè·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œå°±ç±»ä¼¼ä¸Šæ–‡ä¸­çš„é€‰æ‹© pizza å’Œ drink ä¸€æ ·ï¼Œè¿™æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„è¯·æ±‚ã€‚è€Œæ ¹æ®ä¸Šè¿°ä»£ç ï¼Œè¯·æ±‚éƒ½å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œè¿™å½“ç„¶ä¼šæŸè€—ç¨‹åºçš„æ€§èƒ½ã€‚\n\næŒ‰ç…§ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š\n\n![image](https://user-images.githubusercontent.com/7871813/40270076-c08ec820-5bb9-11e8-8470-5e716e87dc76.gif)\n\nå¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦ç­‰åˆ°ä¸Šä¸€ä¸ªè¯·æ±‚å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼ŒWaterfall å¤„äºä¸€ä¸ªä¸²è¡Œçš„çŠ¶æ€ã€‚é‚£è¦æ€ä¹ˆæ”¹è¿›è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ\n\næ—¢ç„¶è·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆè§¦å‘å¼‚æ­¥è¯·æ±‚ï¼Œç„¶åå»¶è¿Ÿå¤„ç†å¼‚æ­¥è¯·æ±‚çš„ç»“æœï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰è¯¥è¯·æ±‚å®Œæˆã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œé‚£å¯èƒ½æ”¹è¿›çš„ä»£ç å¦‚ä¸‹ï¼š\n\n```js\nasync function getUserDetails (username) {\n  const user = await fetch(user_url);\n  return user;\n}\n\nasync function getUserRank () {\n  const data = await fetch(search_url);\n  const promises = data.map((item) => getUserDetails(item.username));\n  await Promise.all(promises).then(handleYourData);\n}\n\ngetUserRank();\n```\n\nå¯ä»¥çœ‹ä¸€ä¸‹å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š\n\n![image](https://user-images.githubusercontent.com/7871813/40270077-c2536602-5bb9-11e8-9438-a15ac05b41e0.gif)\n\nå¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„å¼‚æ­¥è¯·æ±‚å¤„ç†ä¸å†æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œè€Œæ˜¯å¹¶è¡Œæ‰§è¡Œäº†ï¼Œè¿™å°†å¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡å’Œæ€§èƒ½ã€‚\n\n### æ€»ç»“\n\nAditya Agarwal åœ¨å…¶æ–‡ç« ä¸­ä¹Ÿç»™å‡ºäº†æ€ä¹ˆé¿å…é™·å…¥ async/await åœ°ç‹±çš„å»ºè®®ï¼š\n\n1. é¦–å…ˆæ‰¾å‡ºä¾èµ–äºå…¶ä»–è¯­å¥çš„æ‰§è¡Œçš„è¯­å¥\n2. ç„¶åå°†æœ‰ä¾èµ–å…³ç³»çš„ä¸€ç³»åˆ—è¯­å¥è¿›è¡Œç»„åˆï¼Œåˆå¹¶æˆä¸€ä¸ªå¼‚æ­¥å‡½æ•°\n3. æœ€åç”¨æ­£ç¡®çš„æ–¹å¼æ‰§è¡Œè¿™äº›å‡½æ•°\n\n### å‚è€ƒ\n\n* [ç²¾è¯»ã€Šasync/await æ˜¯æŠŠåŒåˆƒå‰‘ã€‹](https://github.com/dt-fe/weekly/blob/master/55.%E7%B2%BE%E8%AF%BB%E3%80%8Aasync%20await%20%E6%98%AF%E6%8A%8A%E5%8F%8C%E5%88%83%E5%89%91%E3%80%8B.md)\n* [async å‡½æ•°çš„å«ä¹‰å’Œç”¨æ³•](http://www.ruanyifeng.com/blog/2015/05/async.html)\n* [ä½“éªŒå¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ - ES7 çš„ Async/Await](https://cnodejs.org/topic/5640b80d3a6aa72c5e0030b6)\n* [How to escape async/await hell](https://github.com/dwqs/blog/issues/65)\n","slug":"å¦‚ä½•é¿å…-async-await-åœ°ç‹±","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidjb000mu4q9khczc8t9","content":"<p>æœ€è¿‘é˜…è¯»äº† Aditya Agarwal çš„ä¸€ç¯‡æ–‡ç« ï¼šHow to escape async/await hellã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦è®¨è®ºäº†è¿‡åº¦ä½¿ç”¨ async/await å¯¼è‡´çš„æ–°çš„ã€Œåœ°ç‹±ã€é—®é¢˜ï¼Œå…¶å·²ç»åœ¨ Medium ä¸Šè·å¾—äº† 19k+ çš„ Applauseã€‚</p>\n<a id=\"more\"></a>\n<div class=\"tip\"><br>  async/await æ˜¯ ES7 çš„æ–°è¯­æ³•ã€‚åœ¨ async/await æ ‡å‡†å‡ºæ¥ä¹‹å‰ï¼ŒJavaScript çš„å¼‚æ­¥ç¼–ç¨‹ç»å†äº† callback â€“&gt; promise â€“&gt; generator çš„æ¼”å˜è¿‡ç¨‹ã€‚<br></div>\n\n<p>åœ¨ callback çš„æ—¶ä»£ï¼Œæœ€è®©äººå¤´ç–¼çš„é—®é¢˜å°±æ˜¯å›è°ƒåœ°ç‹± (callback hell)ã€‚æ‰€ä»¥ï¼Œåœ¨ async/await ä¸€ç»æ¨å‡ºï¼Œç¤¾åŒºå°±æœ‰äººè®¤ä¸ºã€Œè¿™æ˜¯ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆã€ã€‚ä½† async/await ä¹Ÿå¯èƒ½å¸¦æ¥æ–°çš„é—®é¢˜ã€‚</p>\n<blockquote>\n<p>å¥½ä¸å®¹æ˜“é€ƒç¦»äº†ä¸€ä¸ªã€Œåœ°ç‹±ã€ï¼Œåˆé©¬ä¸Šé™·å…¥å¦ä¸€ä¸ªã€Œåœ°ç‹±ã€äº†ã€‚</p>\n</blockquote>\n<h3 id=\"ä½•ä¸º-async-await-åœ°ç‹±\"><a href=\"#ä½•ä¸º-async-await-åœ°ç‹±\" class=\"headerlink\" title=\"ä½•ä¸º async/await åœ°ç‹±\"></a>ä½•ä¸º async/await åœ°ç‹±</h3><p>åœ¨ç¼–å†™å¼‚æ­¥ä»£ç æ—¶ï¼Œäººä»¬æ€»æ˜¯å–œæ¬¢ä¸€æ¬¡å†™å¤šä¸ªè¯­å¥ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¹‹å‰ä½¿ç”¨ await å…³é”®å­—ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™ä¸€ä¸ªè¯­å¥å¹¶ä¸ä¾èµ–äºå‰ä¸€ä¸ªè¯­å¥â€”â€”ä½†ä½¿ç”¨ await å…³é”®å­—åï¼Œä½ å°±éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªè¯­å¥å®Œæˆã€‚</p>\n<h4 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h4><p>å‡è®¾ä½ è¦å†™ä¸€ä¸ªè®¢è´­ pizza å’Œ drink çš„è„šæœ¬ï¼Œä»£ç å¯èƒ½æ˜¯å¦‚ä¸‹è¿™æ ·çš„ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">async</span> () =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> pizzaData = <span class=\"keyword\">await</span> getPizzaData(); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> drinkData = <span class=\"keyword\">await</span> getDrinkData(); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> chosenPizza = choosePizza(); <span class=\"comment\">// sync call</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> chosenDrink = chooseDrink(); <span class=\"comment\">// sync call</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> addPizzaToCart(chosenPizza); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> addDrinkToCart(chosenDrink); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  orderItems(); <span class=\"comment\">// async call</span></span><br><span class=\"line\">&#125;)();</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µä»£ç å¼€èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿèƒ½æ­£å¸¸çš„è¿è¡Œã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„å®ç°ï¼Œå› ä¸ºè¿™æŠŠæœ¬èº«å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡å˜æˆäº†ä¸²è¡Œæ‰§è¡Œã€‚</p>\n<p>é€‰æ‹©ä¸€ä¸ª drink æ·»åŠ åˆ°è´­ç‰©è½¦å’Œé€‰æ‹©ä¸€ä¸ª pizza æ·»åŠ åˆ°è´­ç‰©è½¦å¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªä»»åŠ¡ï¼Œè€Œè¿™ä¸¤ä¸ªä»»åŠ¡ä¹‹é—´å¹¶æ²¡æœ‰ç›¸äº’ä¾èµ–çš„å…³ç³»ï¼Œä¹Ÿæ²¡æœ‰ç‰¹å®šçš„é¡ºåºæ‰§è¡Œå…³ç³»ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªä»»åŠ¡æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè¿™æ ·èƒ½æé«˜æ€§èƒ½ã€‚è€Œä¸Šè¿°ä»£ç å°†äºŒè€…å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œæ˜¾ç„¶æ˜¯é™ä½äº†ç¨‹åºæ€§èƒ½çš„ã€‚</p>\n<h3 id=\"æ›´ç³Ÿç³•çš„ä¾‹å­\"><a href=\"#æ›´ç³Ÿç³•çš„ä¾‹å­\" class=\"headerlink\" title=\"æ›´ç³Ÿç³•çš„ä¾‹å­\"></a>æ›´ç³Ÿç³•çš„ä¾‹å­</h3><p>å‡è®¾è¦å†™ä¸€ä¸ªç¨‹åºï¼Œæ ¹æ® followers æ•°ç”¨æ¥æ˜¾ç¤º GitHub ä¸­å›½åŒºç”¨æˆ·çš„æ’åæƒ…å†µã€‚</p>\n<p>å¦‚æœåªæ˜¯è·å–æ’åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ Github å®˜æ–¹çš„ <a href=\"https://developer.github.com/v3/search/#search-users\" target=\"_blank\" rel=\"noopener\">Search users</a> æ¥å£ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserRank</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> fetch(search_url);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> data;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserRank();</span><br></pre></td></tr></table></figure>\n<p>è°ƒç”¨ getUserRank å‡½æ•°å°±èƒ½è·å–åˆ°æƒ³è¦çš„ç»“æœã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½è¿˜è¦æƒ³è¦è·å–æ¯ä¸ªç”¨æˆ·çš„ follower æ•°ã€emailã€åœ°åŒºå’Œä»“åº“ç­‰æ•°æ®ï¼Œè€Œ Search users æ¥å£å¹¶æ²¡æœ‰è¿”å›è¿™äº›æ•°æ®ï¼Œä½ å¯èƒ½éœ€è¦å†å»è°ƒç”¨ <a href=\"https://developer.github.com/v3/users/#get-a-single-user\" target=\"_blank\" rel=\"noopener\">Single user</a> æ¥å£ã€‚</p>\n<p>ç„¶åä¸Šè¿°ä»£ç å¯èƒ½è¢«æ”¹å†™ä¸ºï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserRank</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> fetch(search_url);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> res = [];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; data.length; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> item = data[i];</span><br><span class=\"line\">    <span class=\"keyword\">const</span> user = <span class=\"keyword\">await</span> fetch(user_url);</span><br><span class=\"line\">    res.push(&#123;...item, ...user&#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserRank();</span><br></pre></td></tr></table></figure>\n<p>è¿è¡ŒæŸ¥çœ‹ç»“æœï¼Œè‡ªå·±æƒ³è¦çš„æ•°æ®éƒ½æ‹¿åˆ°äº†ã€‚ä½†æ˜¯ï¼Œä½ å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œç¨‹åºè¿è¡Œæ—¶é—´æœ‰ç‚¹é•¿ï¼Œè¯¥æ€ä¹ˆä¼˜åŒ–ä¸‹å‘¢ï¼Ÿ</p>\n<p>å…¶å®ï¼Œé“ºå«äº†è¿™ä¹ˆé•¿ï¼Œå°±æ˜¯æƒ³è¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼šä½ é™·å…¥äº† async/await çš„åœ°ç‹±ã€‚</p>\n<p>ä¸Šè¿°ä»£ç çš„é—®é¢˜åœ¨äºï¼Œè·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œå°±ç±»ä¼¼ä¸Šæ–‡ä¸­çš„é€‰æ‹© pizza å’Œ drink ä¸€æ ·ï¼Œè¿™æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„è¯·æ±‚ã€‚è€Œæ ¹æ®ä¸Šè¿°ä»£ç ï¼Œè¯·æ±‚éƒ½å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œè¿™å½“ç„¶ä¼šæŸè€—ç¨‹åºçš„æ€§èƒ½ã€‚</p>\n<p>æŒ‰ç…§ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/7871813/40270076-c08ec820-5bb9-11e8-8470-5e716e87dc76.gif\" alt=\"image\"></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦ç­‰åˆ°ä¸Šä¸€ä¸ªè¯·æ±‚å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼ŒWaterfall å¤„äºä¸€ä¸ªä¸²è¡Œçš„çŠ¶æ€ã€‚é‚£è¦æ€ä¹ˆæ”¹è¿›è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>\n<p>æ—¢ç„¶è·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆè§¦å‘å¼‚æ­¥è¯·æ±‚ï¼Œç„¶åå»¶è¿Ÿå¤„ç†å¼‚æ­¥è¯·æ±‚çš„ç»“æœï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰è¯¥è¯·æ±‚å®Œæˆã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œé‚£å¯èƒ½æ”¹è¿›çš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserDetails</span> (<span class=\"params\">username</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">await</span> fetch(user_url);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserRank</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> fetch(search_url);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> promises = data.map(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> getUserDetails(item.username));</span><br><span class=\"line\">  <span class=\"keyword\">await</span> <span class=\"built_in\">Promise</span>.all(promises).then(handleYourData);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserRank();</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹ä¸€ä¸‹å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/7871813/40270077-c2536602-5bb9-11e8-9438-a15ac05b41e0.gif\" alt=\"image\"></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„å¼‚æ­¥è¯·æ±‚å¤„ç†ä¸å†æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œè€Œæ˜¯å¹¶è¡Œæ‰§è¡Œäº†ï¼Œè¿™å°†å¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡å’Œæ€§èƒ½ã€‚</p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>Aditya Agarwal åœ¨å…¶æ–‡ç« ä¸­ä¹Ÿç»™å‡ºäº†æ€ä¹ˆé¿å…é™·å…¥ async/await åœ°ç‹±çš„å»ºè®®ï¼š</p>\n<ol>\n<li>é¦–å…ˆæ‰¾å‡ºä¾èµ–äºå…¶ä»–è¯­å¥çš„æ‰§è¡Œçš„è¯­å¥</li>\n<li>ç„¶åå°†æœ‰ä¾èµ–å…³ç³»çš„ä¸€ç³»åˆ—è¯­å¥è¿›è¡Œç»„åˆï¼Œåˆå¹¶æˆä¸€ä¸ªå¼‚æ­¥å‡½æ•°</li>\n<li>æœ€åç”¨æ­£ç¡®çš„æ–¹å¼æ‰§è¡Œè¿™äº›å‡½æ•°</li>\n</ol>\n<h3 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h3><ul>\n<li><a href=\"https://github.com/dt-fe/weekly/blob/master/55.%E7%B2%BE%E8%AF%BB%E3%80%8Aasync%20await%20%E6%98%AF%E6%8A%8A%E5%8F%8C%E5%88%83%E5%89%91%E3%80%8B.md\" target=\"_blank\" rel=\"noopener\">ç²¾è¯»ã€Šasync/await æ˜¯æŠŠåŒåˆƒå‰‘ã€‹</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/05/async.html\" target=\"_blank\" rel=\"noopener\">async å‡½æ•°çš„å«ä¹‰å’Œç”¨æ³•</a></li>\n<li><a href=\"https://cnodejs.org/topic/5640b80d3a6aa72c5e0030b6\" target=\"_blank\" rel=\"noopener\">ä½“éªŒå¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ - ES7 çš„ Async/Await</a></li>\n<li><a href=\"https://github.com/dwqs/blog/issues/65\" target=\"_blank\" rel=\"noopener\">How to escape async/await hell</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>æœ€è¿‘é˜…è¯»äº† Aditya Agarwal çš„ä¸€ç¯‡æ–‡ç« ï¼šHow to escape async/await hellã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦è®¨è®ºäº†è¿‡åº¦ä½¿ç”¨ async/await å¯¼è‡´çš„æ–°çš„ã€Œåœ°ç‹±ã€é—®é¢˜ï¼Œå…¶å·²ç»åœ¨ Medium ä¸Šè·å¾—äº† 19k+ çš„ Applauseã€‚</p>","more":"<div class=\"tip\"><br>  async/await æ˜¯ ES7 çš„æ–°è¯­æ³•ã€‚åœ¨ async/await æ ‡å‡†å‡ºæ¥ä¹‹å‰ï¼ŒJavaScript çš„å¼‚æ­¥ç¼–ç¨‹ç»å†äº† callback â€“&gt; promise â€“&gt; generator çš„æ¼”å˜è¿‡ç¨‹ã€‚<br></div>\n\n<p>åœ¨ callback çš„æ—¶ä»£ï¼Œæœ€è®©äººå¤´ç–¼çš„é—®é¢˜å°±æ˜¯å›è°ƒåœ°ç‹± (callback hell)ã€‚æ‰€ä»¥ï¼Œåœ¨ async/await ä¸€ç»æ¨å‡ºï¼Œç¤¾åŒºå°±æœ‰äººè®¤ä¸ºã€Œè¿™æ˜¯ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆã€ã€‚ä½† async/await ä¹Ÿå¯èƒ½å¸¦æ¥æ–°çš„é—®é¢˜ã€‚</p>\n<blockquote>\n<p>å¥½ä¸å®¹æ˜“é€ƒç¦»äº†ä¸€ä¸ªã€Œåœ°ç‹±ã€ï¼Œåˆé©¬ä¸Šé™·å…¥å¦ä¸€ä¸ªã€Œåœ°ç‹±ã€äº†ã€‚</p>\n</blockquote>\n<h3 id=\"ä½•ä¸º-async-await-åœ°ç‹±\"><a href=\"#ä½•ä¸º-async-await-åœ°ç‹±\" class=\"headerlink\" title=\"ä½•ä¸º async/await åœ°ç‹±\"></a>ä½•ä¸º async/await åœ°ç‹±</h3><p>åœ¨ç¼–å†™å¼‚æ­¥ä»£ç æ—¶ï¼Œäººä»¬æ€»æ˜¯å–œæ¬¢ä¸€æ¬¡å†™å¤šä¸ªè¯­å¥ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¹‹å‰ä½¿ç”¨ await å…³é”®å­—ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™ä¸€ä¸ªè¯­å¥å¹¶ä¸ä¾èµ–äºå‰ä¸€ä¸ªè¯­å¥â€”â€”ä½†ä½¿ç”¨ await å…³é”®å­—åï¼Œä½ å°±éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªè¯­å¥å®Œæˆã€‚</p>\n<h4 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h4><p>å‡è®¾ä½ è¦å†™ä¸€ä¸ªè®¢è´­ pizza å’Œ drink çš„è„šæœ¬ï¼Œä»£ç å¯èƒ½æ˜¯å¦‚ä¸‹è¿™æ ·çš„ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">async</span> () =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> pizzaData = <span class=\"keyword\">await</span> getPizzaData(); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> drinkData = <span class=\"keyword\">await</span> getDrinkData(); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> chosenPizza = choosePizza(); <span class=\"comment\">// sync call</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> chosenDrink = chooseDrink(); <span class=\"comment\">// sync call</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> addPizzaToCart(chosenPizza); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> addDrinkToCart(chosenDrink); <span class=\"comment\">// async call</span></span><br><span class=\"line\">  orderItems(); <span class=\"comment\">// async call</span></span><br><span class=\"line\">&#125;)();</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µä»£ç å¼€èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿèƒ½æ­£å¸¸çš„è¿è¡Œã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„å®ç°ï¼Œå› ä¸ºè¿™æŠŠæœ¬èº«å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡å˜æˆäº†ä¸²è¡Œæ‰§è¡Œã€‚</p>\n<p>é€‰æ‹©ä¸€ä¸ª drink æ·»åŠ åˆ°è´­ç‰©è½¦å’Œé€‰æ‹©ä¸€ä¸ª pizza æ·»åŠ åˆ°è´­ç‰©è½¦å¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªä»»åŠ¡ï¼Œè€Œè¿™ä¸¤ä¸ªä»»åŠ¡ä¹‹é—´å¹¶æ²¡æœ‰ç›¸äº’ä¾èµ–çš„å…³ç³»ï¼Œä¹Ÿæ²¡æœ‰ç‰¹å®šçš„é¡ºåºæ‰§è¡Œå…³ç³»ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªä»»åŠ¡æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè¿™æ ·èƒ½æé«˜æ€§èƒ½ã€‚è€Œä¸Šè¿°ä»£ç å°†äºŒè€…å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œæ˜¾ç„¶æ˜¯é™ä½äº†ç¨‹åºæ€§èƒ½çš„ã€‚</p>\n<h3 id=\"æ›´ç³Ÿç³•çš„ä¾‹å­\"><a href=\"#æ›´ç³Ÿç³•çš„ä¾‹å­\" class=\"headerlink\" title=\"æ›´ç³Ÿç³•çš„ä¾‹å­\"></a>æ›´ç³Ÿç³•çš„ä¾‹å­</h3><p>å‡è®¾è¦å†™ä¸€ä¸ªç¨‹åºï¼Œæ ¹æ® followers æ•°ç”¨æ¥æ˜¾ç¤º GitHub ä¸­å›½åŒºç”¨æˆ·çš„æ’åæƒ…å†µã€‚</p>\n<p>å¦‚æœåªæ˜¯è·å–æ’åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ Github å®˜æ–¹çš„ <a href=\"https://developer.github.com/v3/search/#search-users\" target=\"_blank\" rel=\"noopener\">Search users</a> æ¥å£ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserRank</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> fetch(search_url);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> data;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserRank();</span><br></pre></td></tr></table></figure>\n<p>è°ƒç”¨ getUserRank å‡½æ•°å°±èƒ½è·å–åˆ°æƒ³è¦çš„ç»“æœã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½è¿˜è¦æƒ³è¦è·å–æ¯ä¸ªç”¨æˆ·çš„ follower æ•°ã€emailã€åœ°åŒºå’Œä»“åº“ç­‰æ•°æ®ï¼Œè€Œ Search users æ¥å£å¹¶æ²¡æœ‰è¿”å›è¿™äº›æ•°æ®ï¼Œä½ å¯èƒ½éœ€è¦å†å»è°ƒç”¨ <a href=\"https://developer.github.com/v3/users/#get-a-single-user\" target=\"_blank\" rel=\"noopener\">Single user</a> æ¥å£ã€‚</p>\n<p>ç„¶åä¸Šè¿°ä»£ç å¯èƒ½è¢«æ”¹å†™ä¸ºï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserRank</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> fetch(search_url);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> res = [];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; data.length; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> item = data[i];</span><br><span class=\"line\">    <span class=\"keyword\">const</span> user = <span class=\"keyword\">await</span> fetch(user_url);</span><br><span class=\"line\">    res.push(&#123;...item, ...user&#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserRank();</span><br></pre></td></tr></table></figure>\n<p>è¿è¡ŒæŸ¥çœ‹ç»“æœï¼Œè‡ªå·±æƒ³è¦çš„æ•°æ®éƒ½æ‹¿åˆ°äº†ã€‚ä½†æ˜¯ï¼Œä½ å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œç¨‹åºè¿è¡Œæ—¶é—´æœ‰ç‚¹é•¿ï¼Œè¯¥æ€ä¹ˆä¼˜åŒ–ä¸‹å‘¢ï¼Ÿ</p>\n<p>å…¶å®ï¼Œé“ºå«äº†è¿™ä¹ˆé•¿ï¼Œå°±æ˜¯æƒ³è¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼šä½ é™·å…¥äº† async/await çš„åœ°ç‹±ã€‚</p>\n<p>ä¸Šè¿°ä»£ç çš„é—®é¢˜åœ¨äºï¼Œè·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œå°±ç±»ä¼¼ä¸Šæ–‡ä¸­çš„é€‰æ‹© pizza å’Œ drink ä¸€æ ·ï¼Œè¿™æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„è¯·æ±‚ã€‚è€Œæ ¹æ®ä¸Šè¿°ä»£ç ï¼Œè¯·æ±‚éƒ½å˜æˆäº†ä¸²è¡Œæ‰§è¡Œï¼Œè¿™å½“ç„¶ä¼šæŸè€—ç¨‹åºçš„æ€§èƒ½ã€‚</p>\n<p>æŒ‰ç…§ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…¶å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/7871813/40270076-c08ec820-5bb9-11e8-8470-5e716e87dc76.gif\" alt=\"image\"></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦ç­‰åˆ°ä¸Šä¸€ä¸ªè¯·æ±‚å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼ŒWaterfall å¤„äºä¸€ä¸ªä¸²è¡Œçš„çŠ¶æ€ã€‚é‚£è¦æ€ä¹ˆæ”¹è¿›è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>\n<p>æ—¢ç„¶è·å–æ¯ä¸ªç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¹¶ä¸å­˜åœ¨ä¾èµ–æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆè§¦å‘å¼‚æ­¥è¯·æ±‚ï¼Œç„¶åå»¶è¿Ÿå¤„ç†å¼‚æ­¥è¯·æ±‚çš„ç»“æœï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰è¯¥è¯·æ±‚å®Œæˆã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œé‚£å¯èƒ½æ”¹è¿›çš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserDetails</span> (<span class=\"params\">username</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">await</span> fetch(user_url);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUserRank</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = <span class=\"keyword\">await</span> fetch(search_url);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> promises = data.map(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> getUserDetails(item.username));</span><br><span class=\"line\">  <span class=\"keyword\">await</span> <span class=\"built_in\">Promise</span>.all(promises).then(handleYourData);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">getUserRank();</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹ä¸€ä¸‹å¼‚æ­¥è¯·æ±‚çš„åŠ¨æ€å›¾ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/7871813/40270077-c2536602-5bb9-11e8-9438-a15ac05b41e0.gif\" alt=\"image\"></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·å–ç”¨æˆ·èµ„æ–™çš„å¼‚æ­¥è¯·æ±‚å¤„ç†ä¸å†æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œè€Œæ˜¯å¹¶è¡Œæ‰§è¡Œäº†ï¼Œè¿™å°†å¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡å’Œæ€§èƒ½ã€‚</p>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>Aditya Agarwal åœ¨å…¶æ–‡ç« ä¸­ä¹Ÿç»™å‡ºäº†æ€ä¹ˆé¿å…é™·å…¥ async/await åœ°ç‹±çš„å»ºè®®ï¼š</p>\n<ol>\n<li>é¦–å…ˆæ‰¾å‡ºä¾èµ–äºå…¶ä»–è¯­å¥çš„æ‰§è¡Œçš„è¯­å¥</li>\n<li>ç„¶åå°†æœ‰ä¾èµ–å…³ç³»çš„ä¸€ç³»åˆ—è¯­å¥è¿›è¡Œç»„åˆï¼Œåˆå¹¶æˆä¸€ä¸ªå¼‚æ­¥å‡½æ•°</li>\n<li>æœ€åç”¨æ­£ç¡®çš„æ–¹å¼æ‰§è¡Œè¿™äº›å‡½æ•°</li>\n</ol>\n<h3 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h3><ul>\n<li><a href=\"https://github.com/dt-fe/weekly/blob/master/55.%E7%B2%BE%E8%AF%BB%E3%80%8Aasync%20await%20%E6%98%AF%E6%8A%8A%E5%8F%8C%E5%88%83%E5%89%91%E3%80%8B.md\" target=\"_blank\" rel=\"noopener\">ç²¾è¯»ã€Šasync/await æ˜¯æŠŠåŒåˆƒå‰‘ã€‹</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2015/05/async.html\" target=\"_blank\" rel=\"noopener\">async å‡½æ•°çš„å«ä¹‰å’Œç”¨æ³•</a></li>\n<li><a href=\"https://cnodejs.org/topic/5640b80d3a6aa72c5e0030b6\" target=\"_blank\" rel=\"noopener\">ä½“éªŒå¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ - ES7 çš„ Async/Await</a></li>\n<li><a href=\"https://github.com/dwqs/blog/issues/65\" target=\"_blank\" rel=\"noopener\">How to escape async/await hell</a></li>\n</ul>"},{"title":"æµè§ˆå™¨è·¨åŸŸè¯·æ±‚æ•°æ®æ€»ç»“","date":"2016-01-19T13:06:08.000Z","comments":0,"_content":"\né¦–å…ˆè¯´ä¸‹åŒæºï¼ŒåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨ç­–ç•¥ï¼Œæ‰€è°“åŒæºæ˜¯æŒ‡ï¼šåŸŸåã€åè®®ã€ç«¯å£å®Œå…¨ç›¸åŒã€‚è€Œè·¨åŸŸå°±æ˜¯ä¸åŒæºï¼ä¸€èˆ¬ `a`, `img`, `link`, `video`, `audio`, ç­‰ç­‰èƒ½å¤Ÿå‘å‡ºè¯·æ±‚çš„æ ‡ç­¾éƒ½å¯ä»¥å®ç°è·¨åŸŸè®¿é—®ã€‚ä½†æ˜¯è¿™äº›æ ‡ç­¾ä¸èƒ½å¾—åˆ°è¿”å›çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨ä»–ä»¬æ¥è¯·æ±‚èµ„æºã€‚\n<!-- more -->\n\n### è·¨åŸŸæ–¹æ³•\n#### åŸç”Ÿ JavaScript è·¨åŸŸ\n```html\n<script type=\"text/javascript\">\nfunction showuser(data) {\n    var data = JSON.parse(data);\n    console.log(data);// å¤„ç†å¾—åˆ°çš„ data\n};\n</script>\n\n<script src=\"http://x.cn/showalluser.html?callback=showuser\" charset=\"utf-8\"></script>\n```\n#### jQuery è·¨åŸŸ\n```js\n$.ajax({\n    type: \"post\",\n    url: \"http://127.0.0.1:8080/showalluser.html\",\n    dataType: \"jsonp\",\n    jsonp: \"callback\",\n    success: function(data) {\n        console.log(data);// å¤„ç†å¾—åˆ°çš„ data\n    }\n});\n```\n#### iframe è·¨åŸŸ\n```js\nfunction(URL, callBack) {\n    $iframe = $(\"<iframe style='display: none;'></iframe>\");\n    $iframe.prop(\"src\", URL);\n    $(\"body\").append($iframe);\n\n    $iframe.on('load', function() {\n        // è½¬æ¢æˆ jsonStr\n        // contentDocumentæ˜¯ iframe èŠ‚ç‚¹çš„æ–¹æ³•è·å–contentDocument\n        var ifrDocument = this.contentDocument;\n\n        var jsonStr = $(ifrDocument).find(\"body\").text();\n\n        // è½¬æ¢æˆ json å¯¹è±¡\n        var jsonObj = JSON.parse(jsonStr);\n\n        // æŠŠ json å¯¹è±¡ä¼ ç»™å›è°ƒå‡½æ•°\n        callBack(jsonObj);\n        // åˆ é™¤å½“å‰çš„ iframe\n        $(this).remove();\n    });\n}\n```\n#### åŸç”Ÿ JavaScript è·¨åŸŸå°è£…\n```html\n<script>\n// å°è£…æ•°æ®  è·¨åŸŸurl  params fn\nfunction crossDomain(url,params,fn){\n    var head = document.getElementsByTagName('head')[0];\n    // 1. å¤„ç†å›è°ƒå‡½æ•°\n    var cbName = 'jsonp'+\n    (Math.random() * Math.random()).toString().substr(2) +\n    new Date().getTime();\n    // å°†å›è°ƒå‡½æ•°æŒ‚è½½åˆ° window å¯¹è±¡ä¸Š\n    window[cbName] = function(data){\n        // æ‹¿åˆ°å¹¶å¤„ç†æ•°æ®ï¼Œäº¤ç»™å›è°ƒå‡½æ•°\n        fn(data);\n        // æ‹¿åˆ°æ•°æ®åremoveæ‰\n        //head.removeChild(scriptObj);\n    }\n    // 2. è§£æurlï¼Œå¤„ç†æŸ¥è¯¢å­—ç¬¦ä¸² è§£å†³è¿™æ ·çš„éœ€æ±‚ ?count=5\n    var qstring = '';\n    for(var key in params){\n        qstring += key + '=' + params[key] + '&';\n    }\n    qstring += 'callback=' + cbName;\n    url += '?' + qstring;\n    // 3. æ’å…¥script\n    var scriptObj = document.createElement('script');\n    scriptObj.src = url;\n    head.appendChild(scriptObj);\n}\n</script>\n\n<script>\n// ä½¿ç”¨\ncrossDomain('http://api.douban.com/v2/movie/in_theaters',{},function(data){\n    console.log(data);\n})\n</script>\n```\n```html\n<!-- è§£è¯»ï¼šæ³¨æ„ä¸Šé¢å°è£…çš„å‡½æ•°ä¼šåœ¨ head æ ‡ç­¾ç”Ÿæˆä¸‹é¢çš„å†…å®¹ï¼Œå¹¶éšæœºäº§ç”Ÿå‡½æ•°åé˜²æ­¢å†²çª -->\n<script src=\"jsonp412964552676679031484646377133(data)â€>// æŒ‚è½½åœ¨ window ä¸Šå¯ä»¥ç›´æ¥æ‰§è¡Œ\n      /*è¿œç¨‹è·å–çš„ data ä¼ å…¥ jsonp* å‡½æ•°å†…å®¹ï¼Œäº¤ç»™å›è°ƒå‡½æ•°fn(data) */\n</script>\n```\n","source":"_posts/æµè§ˆå™¨è·¨åŸŸè¯·æ±‚æ•°æ®æ€»ç»“.md","raw":"---\ntitle: æµè§ˆå™¨è·¨åŸŸè¯·æ±‚æ•°æ®æ€»ç»“\ndate: 2016-01-19 21:06:08\ntags:\ncomments: false\n---\n\né¦–å…ˆè¯´ä¸‹åŒæºï¼ŒåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨ç­–ç•¥ï¼Œæ‰€è°“åŒæºæ˜¯æŒ‡ï¼šåŸŸåã€åè®®ã€ç«¯å£å®Œå…¨ç›¸åŒã€‚è€Œè·¨åŸŸå°±æ˜¯ä¸åŒæºï¼ä¸€èˆ¬ `a`, `img`, `link`, `video`, `audio`, ç­‰ç­‰èƒ½å¤Ÿå‘å‡ºè¯·æ±‚çš„æ ‡ç­¾éƒ½å¯ä»¥å®ç°è·¨åŸŸè®¿é—®ã€‚ä½†æ˜¯è¿™äº›æ ‡ç­¾ä¸èƒ½å¾—åˆ°è¿”å›çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨ä»–ä»¬æ¥è¯·æ±‚èµ„æºã€‚\n<!-- more -->\n\n### è·¨åŸŸæ–¹æ³•\n#### åŸç”Ÿ JavaScript è·¨åŸŸ\n```html\n<script type=\"text/javascript\">\nfunction showuser(data) {\n    var data = JSON.parse(data);\n    console.log(data);// å¤„ç†å¾—åˆ°çš„ data\n};\n</script>\n\n<script src=\"http://x.cn/showalluser.html?callback=showuser\" charset=\"utf-8\"></script>\n```\n#### jQuery è·¨åŸŸ\n```js\n$.ajax({\n    type: \"post\",\n    url: \"http://127.0.0.1:8080/showalluser.html\",\n    dataType: \"jsonp\",\n    jsonp: \"callback\",\n    success: function(data) {\n        console.log(data);// å¤„ç†å¾—åˆ°çš„ data\n    }\n});\n```\n#### iframe è·¨åŸŸ\n```js\nfunction(URL, callBack) {\n    $iframe = $(\"<iframe style='display: none;'></iframe>\");\n    $iframe.prop(\"src\", URL);\n    $(\"body\").append($iframe);\n\n    $iframe.on('load', function() {\n        // è½¬æ¢æˆ jsonStr\n        // contentDocumentæ˜¯ iframe èŠ‚ç‚¹çš„æ–¹æ³•è·å–contentDocument\n        var ifrDocument = this.contentDocument;\n\n        var jsonStr = $(ifrDocument).find(\"body\").text();\n\n        // è½¬æ¢æˆ json å¯¹è±¡\n        var jsonObj = JSON.parse(jsonStr);\n\n        // æŠŠ json å¯¹è±¡ä¼ ç»™å›è°ƒå‡½æ•°\n        callBack(jsonObj);\n        // åˆ é™¤å½“å‰çš„ iframe\n        $(this).remove();\n    });\n}\n```\n#### åŸç”Ÿ JavaScript è·¨åŸŸå°è£…\n```html\n<script>\n// å°è£…æ•°æ®  è·¨åŸŸurl  params fn\nfunction crossDomain(url,params,fn){\n    var head = document.getElementsByTagName('head')[0];\n    // 1. å¤„ç†å›è°ƒå‡½æ•°\n    var cbName = 'jsonp'+\n    (Math.random() * Math.random()).toString().substr(2) +\n    new Date().getTime();\n    // å°†å›è°ƒå‡½æ•°æŒ‚è½½åˆ° window å¯¹è±¡ä¸Š\n    window[cbName] = function(data){\n        // æ‹¿åˆ°å¹¶å¤„ç†æ•°æ®ï¼Œäº¤ç»™å›è°ƒå‡½æ•°\n        fn(data);\n        // æ‹¿åˆ°æ•°æ®åremoveæ‰\n        //head.removeChild(scriptObj);\n    }\n    // 2. è§£æurlï¼Œå¤„ç†æŸ¥è¯¢å­—ç¬¦ä¸² è§£å†³è¿™æ ·çš„éœ€æ±‚ ?count=5\n    var qstring = '';\n    for(var key in params){\n        qstring += key + '=' + params[key] + '&';\n    }\n    qstring += 'callback=' + cbName;\n    url += '?' + qstring;\n    // 3. æ’å…¥script\n    var scriptObj = document.createElement('script');\n    scriptObj.src = url;\n    head.appendChild(scriptObj);\n}\n</script>\n\n<script>\n// ä½¿ç”¨\ncrossDomain('http://api.douban.com/v2/movie/in_theaters',{},function(data){\n    console.log(data);\n})\n</script>\n```\n```html\n<!-- è§£è¯»ï¼šæ³¨æ„ä¸Šé¢å°è£…çš„å‡½æ•°ä¼šåœ¨ head æ ‡ç­¾ç”Ÿæˆä¸‹é¢çš„å†…å®¹ï¼Œå¹¶éšæœºäº§ç”Ÿå‡½æ•°åé˜²æ­¢å†²çª -->\n<script src=\"jsonp412964552676679031484646377133(data)â€>// æŒ‚è½½åœ¨ window ä¸Šå¯ä»¥ç›´æ¥æ‰§è¡Œ\n      /*è¿œç¨‹è·å–çš„ data ä¼ å…¥ jsonp* å‡½æ•°å†…å®¹ï¼Œäº¤ç»™å›è°ƒå‡½æ•°fn(data) */\n</script>\n```\n","slug":"æµè§ˆå™¨è·¨åŸŸè¯·æ±‚æ•°æ®æ€»ç»“","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidjc000nu4q9tltqnd7s","content":"<p>é¦–å…ˆè¯´ä¸‹åŒæºï¼ŒåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨ç­–ç•¥ï¼Œæ‰€è°“åŒæºæ˜¯æŒ‡ï¼šåŸŸåã€åè®®ã€ç«¯å£å®Œå…¨ç›¸åŒã€‚è€Œè·¨åŸŸå°±æ˜¯ä¸åŒæºï¼ä¸€èˆ¬ <code>a</code>, <code>img</code>, <code>link</code>, <code>video</code>, <code>audio</code>, ç­‰ç­‰èƒ½å¤Ÿå‘å‡ºè¯·æ±‚çš„æ ‡ç­¾éƒ½å¯ä»¥å®ç°è·¨åŸŸè®¿é—®ã€‚ä½†æ˜¯è¿™äº›æ ‡ç­¾ä¸èƒ½å¾—åˆ°è¿”å›çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨ä»–ä»¬æ¥è¯·æ±‚èµ„æºã€‚<br><a id=\"more\"></a></p>\n<h3 id=\"è·¨åŸŸæ–¹æ³•\"><a href=\"#è·¨åŸŸæ–¹æ³•\" class=\"headerlink\" title=\"è·¨åŸŸæ–¹æ³•\"></a>è·¨åŸŸæ–¹æ³•</h3><h4 id=\"åŸç”Ÿ-JavaScript-è·¨åŸŸ\"><a href=\"#åŸç”Ÿ-JavaScript-è·¨åŸŸ\" class=\"headerlink\" title=\"åŸç”Ÿ JavaScript è·¨åŸŸ\"></a>åŸç”Ÿ JavaScript è·¨åŸŸ</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">showuser</span>(<span class=\"params\">data</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> data = <span class=\"built_in\">JSON</span>.parse(data);</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">console</span>.log(data);<span class=\"comment\">// å¤„ç†å¾—åˆ°çš„ data</span></span></span><br><span class=\"line\"><span class=\"undefined\">&#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://x.cn/showalluser.html?callback=showuser\"</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"jQuery-è·¨åŸŸ\"><a href=\"#jQuery-è·¨åŸŸ\" class=\"headerlink\" title=\"jQuery è·¨åŸŸ\"></a>jQuery è·¨åŸŸ</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$.ajax(&#123;</span><br><span class=\"line\">    type: <span class=\"string\">\"post\"</span>,</span><br><span class=\"line\">    url: <span class=\"string\">\"http://127.0.0.1:8080/showalluser.html\"</span>,</span><br><span class=\"line\">    dataType: <span class=\"string\">\"jsonp\"</span>,</span><br><span class=\"line\">    jsonp: <span class=\"string\">\"callback\"</span>,</span><br><span class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(data);<span class=\"comment\">// å¤„ç†å¾—åˆ°çš„ data</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"iframe-è·¨åŸŸ\"><a href=\"#iframe-è·¨åŸŸ\" class=\"headerlink\" title=\"iframe è·¨åŸŸ\"></a>iframe è·¨åŸŸ</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">URL, callBack</span>) </span>&#123;</span><br><span class=\"line\">    $iframe = $(<span class=\"string\">\"&lt;iframe style='display: none;'&gt;&lt;/iframe&gt;\"</span>);</span><br><span class=\"line\">    $iframe.prop(<span class=\"string\">\"src\"</span>, URL);</span><br><span class=\"line\">    $(<span class=\"string\">\"body\"</span>).append($iframe);</span><br><span class=\"line\"></span><br><span class=\"line\">    $iframe.on(<span class=\"string\">'load'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// è½¬æ¢æˆ jsonStr</span></span><br><span class=\"line\">        <span class=\"comment\">// contentDocumentæ˜¯ iframe èŠ‚ç‚¹çš„æ–¹æ³•è·å–contentDocument</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> ifrDocument = <span class=\"keyword\">this</span>.contentDocument;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> jsonStr = $(ifrDocument).find(<span class=\"string\">\"body\"</span>).text();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// è½¬æ¢æˆ json å¯¹è±¡</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> jsonObj = <span class=\"built_in\">JSON</span>.parse(jsonStr);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// æŠŠ json å¯¹è±¡ä¼ ç»™å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">        callBack(jsonObj);</span><br><span class=\"line\">        <span class=\"comment\">// åˆ é™¤å½“å‰çš„ iframe</span></span><br><span class=\"line\">        $(<span class=\"keyword\">this</span>).remove();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"åŸç”Ÿ-JavaScript-è·¨åŸŸå°è£…\"><a href=\"#åŸç”Ÿ-JavaScript-è·¨åŸŸå°è£…\" class=\"headerlink\" title=\"åŸç”Ÿ JavaScript è·¨åŸŸå°è£…\"></a>åŸç”Ÿ JavaScript è·¨åŸŸå°è£…</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">// å°è£…æ•°æ®  è·¨åŸŸurl  params fn</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">crossDomain</span>(<span class=\"params\">url,params,fn</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> head = <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>];</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// 1. å¤„ç†å›è°ƒå‡½æ•°</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> cbName = <span class=\"string\">'jsonp'</span>+</span></span><br><span class=\"line\"><span class=\"javascript\">    (<span class=\"built_in\">Math</span>.random() * <span class=\"built_in\">Math</span>.random()).toString().substr(<span class=\"number\">2</span>) +</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime();</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// å°†å›è°ƒå‡½æ•°æŒ‚è½½åˆ° window å¯¹è±¡ä¸Š</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>[cbName] = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// æ‹¿åˆ°å¹¶å¤„ç†æ•°æ®ï¼Œäº¤ç»™å›è°ƒå‡½æ•°</span></span></span><br><span class=\"line\"><span class=\"undefined\">        fn(data);</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// æ‹¿åˆ°æ•°æ®åremoveæ‰</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">//head.removeChild(scriptObj);</span></span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// 2. è§£æurlï¼Œå¤„ç†æŸ¥è¯¢å­—ç¬¦ä¸² è§£å†³è¿™æ ·çš„éœ€æ±‚ ?count=5</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> qstring = <span class=\"string\">''</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> params)&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        qstring += key + <span class=\"string\">'='</span> + params[key] + <span class=\"string\">'&amp;'</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">    qstring += <span class=\"string\">'callback='</span> + cbName;</span></span><br><span class=\"line\"><span class=\"javascript\">    url += <span class=\"string\">'?'</span> + qstring;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// 3. æ’å…¥script</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> scriptObj = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">    scriptObj.src = url;</span></span><br><span class=\"line\"><span class=\"undefined\">    head.appendChild(scriptObj);</span></span><br><span class=\"line\"><span class=\"undefined\">&#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">// ä½¿ç”¨</span></span></span><br><span class=\"line\"><span class=\"javascript\">crossDomain(<span class=\"string\">'http://api.douban.com/v2/movie/in_theaters'</span>,&#123;&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">console</span>.log(data);</span></span><br><span class=\"line\"><span class=\"undefined\">&#125;)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- è§£è¯»ï¼šæ³¨æ„ä¸Šé¢å°è£…çš„å‡½æ•°ä¼šåœ¨ head æ ‡ç­¾ç”Ÿæˆä¸‹é¢çš„å†…å®¹ï¼Œå¹¶éšæœºäº§ç”Ÿå‡½æ•°åé˜²æ­¢å†²çª --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"jsonp412964552676679031484646377133(data)â€&gt;// æŒ‚è½½åœ¨ window ä¸Šå¯ä»¥ç›´æ¥æ‰§è¡Œ</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">      /*è¿œç¨‹è·å–çš„ data ä¼ å…¥ jsonp* å‡½æ•°å†…å®¹ï¼Œäº¤ç»™å›è°ƒå‡½æ•°fn(data) */</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">&lt;/script&gt;</span></span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>é¦–å…ˆè¯´ä¸‹åŒæºï¼ŒåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨ç­–ç•¥ï¼Œæ‰€è°“åŒæºæ˜¯æŒ‡ï¼šåŸŸåã€åè®®ã€ç«¯å£å®Œå…¨ç›¸åŒã€‚è€Œè·¨åŸŸå°±æ˜¯ä¸åŒæºï¼ä¸€èˆ¬ <code>a</code>, <code>img</code>, <code>link</code>, <code>video</code>, <code>audio</code>, ç­‰ç­‰èƒ½å¤Ÿå‘å‡ºè¯·æ±‚çš„æ ‡ç­¾éƒ½å¯ä»¥å®ç°è·¨åŸŸè®¿é—®ã€‚ä½†æ˜¯è¿™äº›æ ‡ç­¾ä¸èƒ½å¾—åˆ°è¿”å›çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨ä»–ä»¬æ¥è¯·æ±‚èµ„æºã€‚<br>","more":"</p>\n<h3 id=\"è·¨åŸŸæ–¹æ³•\"><a href=\"#è·¨åŸŸæ–¹æ³•\" class=\"headerlink\" title=\"è·¨åŸŸæ–¹æ³•\"></a>è·¨åŸŸæ–¹æ³•</h3><h4 id=\"åŸç”Ÿ-JavaScript-è·¨åŸŸ\"><a href=\"#åŸç”Ÿ-JavaScript-è·¨åŸŸ\" class=\"headerlink\" title=\"åŸç”Ÿ JavaScript è·¨åŸŸ\"></a>åŸç”Ÿ JavaScript è·¨åŸŸ</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">showuser</span>(<span class=\"params\">data</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> data = <span class=\"built_in\">JSON</span>.parse(data);</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">console</span>.log(data);<span class=\"comment\">// å¤„ç†å¾—åˆ°çš„ data</span></span></span><br><span class=\"line\"><span class=\"undefined\">&#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://x.cn/showalluser.html?callback=showuser\"</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"jQuery-è·¨åŸŸ\"><a href=\"#jQuery-è·¨åŸŸ\" class=\"headerlink\" title=\"jQuery è·¨åŸŸ\"></a>jQuery è·¨åŸŸ</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$.ajax(&#123;</span><br><span class=\"line\">    type: <span class=\"string\">\"post\"</span>,</span><br><span class=\"line\">    url: <span class=\"string\">\"http://127.0.0.1:8080/showalluser.html\"</span>,</span><br><span class=\"line\">    dataType: <span class=\"string\">\"jsonp\"</span>,</span><br><span class=\"line\">    jsonp: <span class=\"string\">\"callback\"</span>,</span><br><span class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(data);<span class=\"comment\">// å¤„ç†å¾—åˆ°çš„ data</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h4 id=\"iframe-è·¨åŸŸ\"><a href=\"#iframe-è·¨åŸŸ\" class=\"headerlink\" title=\"iframe è·¨åŸŸ\"></a>iframe è·¨åŸŸ</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">URL, callBack</span>) </span>&#123;</span><br><span class=\"line\">    $iframe = $(<span class=\"string\">\"&lt;iframe style='display: none;'&gt;&lt;/iframe&gt;\"</span>);</span><br><span class=\"line\">    $iframe.prop(<span class=\"string\">\"src\"</span>, URL);</span><br><span class=\"line\">    $(<span class=\"string\">\"body\"</span>).append($iframe);</span><br><span class=\"line\"></span><br><span class=\"line\">    $iframe.on(<span class=\"string\">'load'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// è½¬æ¢æˆ jsonStr</span></span><br><span class=\"line\">        <span class=\"comment\">// contentDocumentæ˜¯ iframe èŠ‚ç‚¹çš„æ–¹æ³•è·å–contentDocument</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> ifrDocument = <span class=\"keyword\">this</span>.contentDocument;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> jsonStr = $(ifrDocument).find(<span class=\"string\">\"body\"</span>).text();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// è½¬æ¢æˆ json å¯¹è±¡</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> jsonObj = <span class=\"built_in\">JSON</span>.parse(jsonStr);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// æŠŠ json å¯¹è±¡ä¼ ç»™å›è°ƒå‡½æ•°</span></span><br><span class=\"line\">        callBack(jsonObj);</span><br><span class=\"line\">        <span class=\"comment\">// åˆ é™¤å½“å‰çš„ iframe</span></span><br><span class=\"line\">        $(<span class=\"keyword\">this</span>).remove();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"åŸç”Ÿ-JavaScript-è·¨åŸŸå°è£…\"><a href=\"#åŸç”Ÿ-JavaScript-è·¨åŸŸå°è£…\" class=\"headerlink\" title=\"åŸç”Ÿ JavaScript è·¨åŸŸå°è£…\"></a>åŸç”Ÿ JavaScript è·¨åŸŸå°è£…</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">// å°è£…æ•°æ®  è·¨åŸŸurl  params fn</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">crossDomain</span>(<span class=\"params\">url,params,fn</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> head = <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>];</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// 1. å¤„ç†å›è°ƒå‡½æ•°</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> cbName = <span class=\"string\">'jsonp'</span>+</span></span><br><span class=\"line\"><span class=\"javascript\">    (<span class=\"built_in\">Math</span>.random() * <span class=\"built_in\">Math</span>.random()).toString().substr(<span class=\"number\">2</span>) +</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime();</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// å°†å›è°ƒå‡½æ•°æŒ‚è½½åˆ° window å¯¹è±¡ä¸Š</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>[cbName] = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// æ‹¿åˆ°å¹¶å¤„ç†æ•°æ®ï¼Œäº¤ç»™å›è°ƒå‡½æ•°</span></span></span><br><span class=\"line\"><span class=\"undefined\">        fn(data);</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// æ‹¿åˆ°æ•°æ®åremoveæ‰</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">//head.removeChild(scriptObj);</span></span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// 2. è§£æurlï¼Œå¤„ç†æŸ¥è¯¢å­—ç¬¦ä¸² è§£å†³è¿™æ ·çš„éœ€æ±‚ ?count=5</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> qstring = <span class=\"string\">''</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> params)&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        qstring += key + <span class=\"string\">'='</span> + params[key] + <span class=\"string\">'&amp;'</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">    qstring += <span class=\"string\">'callback='</span> + cbName;</span></span><br><span class=\"line\"><span class=\"javascript\">    url += <span class=\"string\">'?'</span> + qstring;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"comment\">// 3. æ’å…¥script</span></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> scriptObj = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">    scriptObj.src = url;</span></span><br><span class=\"line\"><span class=\"undefined\">    head.appendChild(scriptObj);</span></span><br><span class=\"line\"><span class=\"undefined\">&#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">// ä½¿ç”¨</span></span></span><br><span class=\"line\"><span class=\"javascript\">crossDomain(<span class=\"string\">'http://api.douban.com/v2/movie/in_theaters'</span>,&#123;&#125;,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">console</span>.log(data);</span></span><br><span class=\"line\"><span class=\"undefined\">&#125;)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- è§£è¯»ï¼šæ³¨æ„ä¸Šé¢å°è£…çš„å‡½æ•°ä¼šåœ¨ head æ ‡ç­¾ç”Ÿæˆä¸‹é¢çš„å†…å®¹ï¼Œå¹¶éšæœºäº§ç”Ÿå‡½æ•°åé˜²æ­¢å†²çª --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"jsonp412964552676679031484646377133(data)â€&gt;// æŒ‚è½½åœ¨ window ä¸Šå¯ä»¥ç›´æ¥æ‰§è¡Œ</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">      /*è¿œç¨‹è·å–çš„ data ä¼ å…¥ jsonp* å‡½æ•°å†…å®¹ï¼Œäº¤ç»™å›è°ƒå‡½æ•°fn(data) */</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">&lt;/script&gt;</span></span></span><br></pre></td></tr></table></figure>"},{"title":"ç»™å°ç™½è¯»çš„ WEB æ‰˜ç®¡æœåŠ¡è¿›åŒ–å²","comments":1,"date":"2018-06-09T10:29:12.000Z","from":null,"_content":"è¿™ç¯‡æ–‡ç« æ˜¯æ¥æ‹“å±•è‡ªå·±çŸ¥è¯†é¢çš„, åœ¨æˆ‘è¯»é«˜ä¸­é‚£ä¼š (08 å¹´), æˆ‘èº«è¾¹å°±æœ‰æ²‰è¿·ç”µè„‘æŠ€æœ¯çš„åŒå­¦, é‚£ä¸ªæ—¶å€™æˆ‘æƒ³ç€åšä¸€ä¸ªè‡ªå·±çš„ç½‘ç«™, è‚¯å®šæ˜¯éå¸¸ç‰›é€¼çš„äº‹äº†. ä»æœ€å¼€å§‹æ¥è§¦çš„æœåŠ¡, ä¾æ¬¡æ¥æ’ä¸ªåº. æ°¸ç¡• E ç›˜ -> å…è´¹ç©ºé—´å»ºç«™ (å›½å¤–å±…å¤š) -> è™šæ‹Ÿç©ºé—´ -> è™šæ‹ŸæœåŠ¡å™¨ (VPS) -> ç‹¬ç«‹æœåŠ¡å™¨. çœ‹å®Œè¿™ç¯‡æ–‡ç« å, æˆ‘æ€»ç®—å¯¹è¿™æ–¹é¢çŸ¥è¯†æœ‰äº†ä¸€ä¸ªæ¯”è¾ƒç³»ç»Ÿæ€§çš„è®¤è¯†äº†. ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹.\n\n<!-- more -->\n### å¼•å­\n\næ–‡ç« å¼€å§‹ä¹‹å‰, æˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦æŠŠè¿™äº›ä¸“æœ‰åè¯å…ˆç§‘æ™®ä¸€ä¸‹, ä¸è¦è§‰å¾—å¾ˆé«˜å¤§ä¸Š, ç®€ç§°è€Œå·².\n\n* IaaS - åŸºç¡€è®¾æ–½å³æœåŠ¡\n* PaaS - å¹³å°å³æœåŠ¡\n* CaaS - å®¹å™¨å³æœåŠ¡\n\næœ¬æ–‡ä»‹ç»äº† Web æ‰˜ç®¡æœåŠ¡è¿›åŒ–çš„å†å², ä»ä¸“ç”¨æœåŠ¡å™¨åˆ°è™šæ‹ŸåŒ–åˆ° IaaSã€PaaS å’Œæœ€æ–°çš„ CaaS; è¯´æ˜äº†æ¯ç§æ–¹å¼çš„ä¼˜ç‚¹å’Œç¼ºç‚¹. ç€é‡é˜è¿°äº†æ„å»º PaaS åº”ç”¨çš„å„ä¸ªç»„ä»¶, ä»¥åŠåœ¨é€‰æ‹© CaaS æä¾›å•†æ—¶åº”è¯¥è€ƒè™‘çš„é—®é¢˜. æœ€åä»æˆæœ¬å’ŒåŠŸèƒ½æ€§çš„è§’åº¦è®ºè¿°äº† PaaS ç”¨æˆ·åº”è¯¥è¿ç§»åˆ° CaaS å¹³å°.\n\nè¯»å®Œè¿™ç¯‡åšæ–‡, ä½ åº”è¯¥å¯ä»¥æ¸…æ¥šçš„ç†è§£:\n\n* è¿™äº›åè¯åˆ°åº•æŒ‡ä»€ä¹ˆ\n* è¿™ä¸ºä»€ä¹ˆå¯¹ä½ å¾ˆé‡è¦\n* å¯¹äºä½ çš„ä½¿ç”¨åœºæ™¯ï¼Œå“ªç§æ–¹å¼æœ€é€‚åˆ\n\nå½“ç„¶æ²¡æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿé€‚åˆæ‰€æœ‰çš„ Web åŸºç¡€è®¾æ–½çš„åœºæ™¯, ä½ çš„ç‰¹æ®Šåœºæ™¯æˆ–è®¸éœ€è¦ç‰¹æ®Šçš„è€ƒè™‘.\n\n### ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\n\nWeb æ‰˜ç®¡çš„æœ¬è´¨è¿˜æ˜¯åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒé‡Œå¸ƒæ»¡äº†æœåŠ¡å™¨ã€äº¤æ¢æœºã€è·¯ç”±å™¨ã€å­˜å‚¨é˜µåˆ—å’Œå…¶å®ƒç½‘ç»œç»„ä»¶. æˆ‘ä»¬æ‰€è®¨è®ºçš„æ¯ä¸€ä¸ªé€‰é¡¹ä¸ç®¡å®ƒæ˜¯ PaaSã€IaaS è¿˜æ˜¯ CaaS, å®ƒåº•å±‚ä½¿ç”¨çš„åŸºç¡€è®¾æ–½éƒ½æ˜¯ç›¸åŒçš„, å³åœ¨ä¸€ä¸ªå¤§å±‹å­é‡Œçš„å¾ˆå¤šç‹¬ç«‹æœåŠ¡å™¨. ä»–ä»¬åªæ˜¯ä¸Šé¢å¢åŠ äº†å¾ˆå¤šæŠ½è±¡å±‚ä½¿å¾—ç®¡ç†å˜å¾—æ›´ç®€å•, å’Œä½¿ç”¨è‡ªåŠ¨åŒ–çš„æ–¹å¼å¤„ç†ä»¥å‰å¾ˆæ…¢æˆ–è€…éœ€è¦æ‰‹åŠ¨æ­¥éª¤çš„ä»»åŠ¡.\n\nä¸“ç”¨æœåŠ¡å™¨, æˆ–è€…å«åš â€œè£¸æœºâ€ æœ‰å®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹.\n\n#### ä¼˜ç‚¹\n\n* æ€§èƒ½â€”â€”ä½ åœ¨ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœåŠ¡å™¨, æ²¡æœ‰ä»»ä½•æŠ½è±¡å±‚ä¾‹å¦‚è™šæ‹ŸåŒ–å¸¦æ¥çš„æ€§èƒ½å¼€é”€.\n* å¯é æ€§â€”â€”æ²¡æœ‰æŠ½è±¡å±‚å’Œè™šæ‹ŸåŒ–, å‡ºé”™çš„å¯èƒ½æ€§ä¼šé™ä½.\n* èµ„æºåˆ©ç”¨ç‡â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, ä½ çš„è¿›ç¨‹ä¸éœ€è¦è·Ÿå…¶å®ƒçš„è™šæ‹Ÿæœºæˆ–è€…è¿›ç¨‹ç«äº‰èµ„æºä¾‹å¦‚ CPUã€å†…å­˜å’Œå¸¦å®½.\n\n#### ç¼ºç‚¹\n\n* ç®¡ç†å¤æ‚æ€§â€”â€”ä½ æ— æ³•å®¹æ˜“åœ°å…‹éš†ä¸“ç”¨æœåŠ¡å™¨æ¥äº§ç”Ÿæ›´å¤šçš„å®ä¾‹, ä¸“ç”¨æœåŠ¡å™¨æ²¡æœ‰ AMIï¼ˆè¯‘è€…æ³¨: Amazon Machine Imageï¼‰æˆ–è€…é•œåƒçš„æ¦‚å¿µ. æƒ³æ‰©å±•ä½ çš„åŸºç¡€è®¾æ–½åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Ÿæˆ‘å¸Œæœ›ä½ ç”¨é…ç½®ç®¡ç†, æˆ–è€…ä½¿ç”¨å¯ä¿¡èµ–çš„è€æœ‹å‹ rsync.\n* æˆæœ¬â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½ éœ€è¦é¢„å…ˆæ”¯ä»˜æœåŠ¡å™¨çš„ç¡¬ä»¶ä»·æ ¼, ç„¶åå†ä»˜ç§Ÿç”¨åœºåœ°çš„æˆæœ¬, æˆ–è€…ä½ ä»ä¸€ä¸ªæœåŠ¡æä¾›å•†é‚£é‡Œç§Ÿèµå®ƒä»¬. æ— è®ºå“ªç§æ–¹å¼, ä½ éƒ½æ²¡æ³•åœ¨ä¸ä½¿ç”¨æ—¶ç»ˆæ­¢æœåŠ¡å™¨çš„ç§Ÿèµæ¥èŠ‚çœæˆæœ¬, å› æ­¤ä½ éœ€è¦æ›´åŠ è°¨æ…çš„å¯¹å¾…ä½ çš„è´¢åŠ¡è®¡åˆ’.\n* ä½ æ‰€æœ‰çš„è¿›ç¨‹å’Œåº”ç”¨éƒ½è¿è¡Œåœ¨ä¸“ç”¨æœåŠ¡å™¨ä¸Š, å› æ­¤è¿è¡Œåœ¨ç›¸åŒçš„æ“ä½œç³»ç»Ÿä¸Š. ä¸ºäº†å¯æ‰©å±•æ€§çš„ç›®çš„, ä½ å¾€å¾€å¸Œæœ›æœåŠ¡å™¨åªè¿è¡Œå•ä¸€çš„è¿›ç¨‹, ä¾‹å¦‚ Web æœåŠ¡æˆ–è€…æ•°æ®åº“æœåŠ¡. åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œæ‰€æœ‰çš„åº”ç”¨ä½¿å¾—æ“ä½œç³»ç»Ÿçš„è°ƒä¼˜å˜å¾—æ›´å›°éš¾.\n\n### ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\n\nå°½ç®¡ä¸“ç”¨æœåŠ¡å™¨æœ‰å¾ˆå¤šä¼˜ç‚¹, ä½†æ˜¯å®ƒçš„ç¼ºç‚¹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè¿œè¿œè¶…è¿‡å…¶ä¼˜ç‚¹. å…¬å¸ä¸ºäº†èƒ½å¤Ÿè¿…é€Ÿè¿›å…¥å¸‚åœºèµ¢å¾—ç«äº‰, å¯¹äºéƒ¨ç½²çš„é€Ÿåº¦æå‡ºäº†æ›´é«˜çš„è¦æ±‚, è™šæ‹ŸåŒ–å°±å¾ˆè‡ªç„¶çš„æˆä¸ºäº†æ•°æ®ä¸­å¿ƒè¿›åŒ–ä¸­çš„ä¸‹ä¸€ä¸ªæ­¥éª¤.\n\n#### ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\n\nç®€è€Œè¨€ä¹‹, è™šæ‹ŸåŒ–å°±æ˜¯å°†ç‰©ç†æœåŠ¡å™¨åˆ†æˆæ›´å°çš„è™šæ‹Ÿæœº, è¿™äº›è™šæ‹Ÿæœºåªèƒ½è®¿é—®ç‰©ç†æœºçš„éƒ¨åˆ†èµ„æº. ä¾‹å¦‚ä½ æœ‰ä¸€ä¸ª 8CPU æ ¸ä»¥åŠ 16GB å†…å­˜çš„ç‰©ç†æœåŠ¡å™¨, åˆ™å¯ä»¥å°†å®ƒåˆ†æˆ 8 ä¸ªè™šæ‹Ÿæœº, æ¯ä¸ªè™šæ‹Ÿæœºæœ‰ 1 ä¸ª CPU å’Œ 2GB å†…å­˜. ä½ æˆ–è®¸å·²ç»å¬è¯´è¿‡ä¸€äº›è™šæ‹ŸåŒ–æŠ€æœ¯å¦‚ Xen, KVM, VMware å’Œ Hyper-V, å…¶å®å¾ˆæœ‰æ›´å¤š.\n\n#### ä¼˜ç‚¹\n\n* ä½ å¯ä»¥åœ¨éœ€è¦æ›´å¤šè™šæ‹Ÿæœºå®ä¾‹æˆ–è€…æƒ³è¦è™šæ‹Ÿæœºå…±äº«æ—¶è¿›è¡Œè™šæ‹Ÿæœºçš„å…‹éš†.\n* ä½ å¯ä»¥å¤‡ä»½è™šæ‹Ÿæœºé•œåƒä½œä¸ºå®‰å…¨ä¿æŠ¤æˆ–è€…ç¾å¤‡.\n\n#### ç¼ºç‚¹\n\n* ä½¿ç”¨è™šæ‹ŸåŒ–æ„å‘³ç€é¢å¤–çš„æ€§èƒ½å¼€é”€, å¯èƒ½é€ æˆæ€§èƒ½ä¸‹é™.\n* è™šæ‹Ÿæœºé•œåƒåœ¨ä¸åŒçš„æœåŠ¡æä¾›å•†å’Œè™šæ‹ŸåŒ–æŠ€æœ¯ä¹‹é—´åŸºæœ¬ä¸Šæ˜¯ä¸å¯ç§»æ¤çš„.\n* ç®¡ç†è™šæ‹Ÿæœºä¾ç„¶æ˜¯æ‰‹å·¥æ­¥éª¤, éœ€è¦ç®¡ç†çš„æ—¶é—´å’Œä¸“ä¸šçŸ¥è¯†.\n\n### è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ (IaaS)\n\nä½ çŸ¥é“ [51% çš„äººè®¤ä¸º â€œäº‘â€ ä¼šè¢«å¤©æ°”å½±å“å—](http://www.businessinsider.com/people-think-stormy-weather-affects-cloud-computing-2012-8)ï¼Ÿä½ çŸ¥é“å½“äººä»¬è°ˆè®º â€œäº‘â€ æ—¶ä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºåŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS) å—ï¼Ÿ\n\n#### ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)\n\n* é€šè¿‡ API æ¥ç®¡ç†ç¡¬ä»¶çš„è™šæ‹ŸåŒ–.\n* é€šè¿‡ç¼–ç¨‹æ¥å£è®¿é—®è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºå’Œé…ç½®.\n* å½“ä½ éœ€è¦æ˜¯ç”³è¯·ä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœº, å½“ä½ å®Œæˆåç»ˆæ­¢è™šæ‹Ÿæœº, ä½ åªéœ€è¦ä¸ºä½ ä½¿ç”¨çš„èµ„æºä»˜è´¹.\n* å°†æ•°æ®ä¸­å¿ƒèµ„æºè§†ä¸ºå…¬å…±è®¾æ–½.\n\näºšé©¬é€Šåœ¨ 2006 å¹´å‘å¸ƒäº†å…¶ Amazon Web Servicesï¼ˆAWSï¼‰å’Œ EC2 äº§å“ï¼Œæˆä¸ºäº†è¿™ä¸ªé¢†åŸŸçš„å…ˆé©±ã€‚\n\n#### ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\n\nåœ¨è¿‡å»å½“ä½ éœ€è¦ä¸Šçº¿ä¸€ä¸ªåœ¨çº¿ä¸šåŠ¡æ—¶, ä½ ä¸å¾—ä¸è¿›è¡Œå¤æ‚çš„è®¡åˆ’æ¥ä¿è¯ä½ åœ¨æ•°æ®ä¸­å¿ƒå†…æœ‰è¶³å¤Ÿçš„æœºæ¶ç©ºé—´ã€è¶³å¤Ÿçš„æœåŠ¡å™¨å’Œå­˜å‚¨æ¥å¤„ç†ä¸šåŠ¡çš„å¢é•¿, è¶³å¤Ÿçš„ç½‘ç»œå¸¦å®½æ¥å¤„ç†æ‰€æœ‰çš„ç”¨æˆ·æµé‡. è¿™ç§è®¡åˆ’å¹¶ä¸å®¹æ˜“, å°¤å…¶æ˜¯å¯¹æ—©æœŸçš„ä¸šåŠ¡æ¥è®², ä½ æ— æ³•é¢„æµ‹ä¸šåŠ¡çš„æœªæ¥å’Œå¢é•¿è½¨è¿¹.\n\n1. å®ƒç»™äº†å¼€å‘è€…è¶…èƒ½é‡:\n    * æ„æ€ä¸€ä¸ªæƒ³æ³•ç«‹å³ä¸Šçº¿.\n    * å¦‚æœæˆåŠŸäº†, å¯ä»¥å®¹æ˜“çš„æ‰©å±•è§„æ¨¡.\n    * å¦‚æœå¤±è´¥äº†, å…³é—­è™šæ‹Ÿæœºä»¥èŠ‚çº¦æˆæœ¬.\n2. å®ƒä½¿å¾—æ•°æ®ä¸­å¿ƒè‡ªåŠ¨åŒ–å˜å¾—æ›´å¼ºå¤§:\n    * å…¨è‡ªåŠ¨åŸºç¡€è®¾æ–½ç®¡ç†æˆä¸ºå¯èƒ½, å‡ºç°äº† â€œåŸºç¡€è®¾æ–½å³ä»£ç â€ çš„æ¦‚å¿µ.\n    * å¼¹æ€§ä¼¸ç¼©åœ¨è¿‡å»æ˜¯ä¸å¯èƒ½å®ç°çš„, ä½†æ˜¯ç°åœ¨ web åŸºç¡€è®¾æ–½å¯ä»¥å½“ä¸šåŠ¡å˜åŒ–æ—¶è‡ªåŠ¨çš„æ‰©å±•æˆ–è€…æ”¶ç¼©.\n    * åœ¨æœåŠ¡å™¨çš„è‡ªåŠ¨åŒ–ç®¡ç†ä¹‹å, æ•°æ®ä¸­å¿ƒçš„è‡ªåŠ¨åŒ–ä¹Ÿæ‰©å±•åˆ°äº†å­˜å‚¨ã€ç½‘ç»œä»¥åŠå…¶å®ƒå¤§é‡çš„éœ€è¦ä¸“ä¸šçŸ¥è¯†çš„ç³»ç»Ÿ, åœ¨ä»£ç å’Œ API èƒ½å¤Ÿå¤„ç†è¿™äº›è‡ªåŠ¨åŒ–ä¹‹å, è¿™ç»™å…¨çƒçš„å¼€å‘è€…ç¤¾åŒºå¸¦æ¥äº†æ–°çš„æœºé‡.\n\n### è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡ (PaaS)\n\nå¹³å°å³æœåŠ¡ (PaaS) ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“çš„éƒ¨ç½²å’Œç®¡ç†åº”ç”¨è€Œéšè—æ‰æ‰€æœ‰çš„å®ç°ç»†èŠ‚ä¾‹å¦‚æœåŠ¡å™¨ã€è´Ÿè½½å‡è¡¡å™¨ã€DNS ç­‰ç­‰. ä»–ä»¬æˆ–å¤šæˆ–å°‘çš„å»é™¤äº†å¯¹è¿ç»´å›¢é˜Ÿçš„éœ€æ±‚, è€Œæ˜¯è®©å¼€å‘äººå‘˜å»å…³æ³¨åº”ç”¨éƒ¨ç½². æœ‰å¾ˆå¤š PaaS æä¾›å•†, å…¶ä¸­ä¸€ä¸ªæœ€æµè¡Œçš„æ˜¯ Heroku. å…³äº Heroku çš„ä¸€ä¸ªæœ‰è¶£çš„äº‹æƒ…æ˜¯ Heroku å®Œå…¨æ˜¯è¿è¡Œåœ¨ AWS ä¹‹ä¸Šå¹¶ä¾èµ– AWS çš„. å¦‚æœä½ ä¸æ„¿æ„ä½ çš„åº”ç”¨è¿è¡Œåœ¨ç¾å›½ä¸œéƒ¨æˆ–è€…æ¬§æ´²è¥¿éƒ¨çš„ AWS ä¸Šçš„è¯, è¿™æˆ–è®¸æ˜¯ä¸€ä¸ªé—®é¢˜. æ²¡æœ‰ IaaS, åƒ Heroku è¿™æ ·çš„å¹³å°å¯èƒ½å°±ä¸ä¼šå­˜åœ¨äº†. PaaS æä¾›å•†åˆ©ç”¨ IaaS ä½œä¸ºä¸€ä¸ªéå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†æ¥äº¤ä»˜å®ƒä»¬çš„æœåŠ¡. åœ¨å‡å°‘ä»æƒ³æ³•åˆ°éƒ¨ç½²çš„æ—¶é—´ã€è‡ªåŠ¨åŒ–æµç¨‹ä»¥åŠå‡å°‘ç‰¹æ®Šçš„ç³»ç»ŸçŸ¥è¯†éœ€æ±‚çš„è¶‹åŠ¿ä¸­, PaaS æ˜¯åˆç†çš„ä¸‹ä¸€æ­¥, å°±åƒæ˜¯ä»ä¸“ç”¨æœåŠ¡å™¨åˆ° IaaS ä¸€æ ·.\n\n#### æ„å»º PaaS æ˜¯å›°éš¾çš„\n\nèƒ½å¤Ÿé€šè¿‡æŠ½è±¡è€Œé¿å…å¤„ç†æœåŠ¡å™¨ç›¸å…³çš„é—®é¢˜æ˜¯ä¸å®¹æ˜“çš„, éœ€è¦å¼•å…¥å¾ˆå¤šä¸œè¥¿æ‰èƒ½åšåˆ°.\n\nåœ¨ PaaS çš„æ¦‚å¿µä¹‹ä¸‹æœ‰å‡ ä¸ªä¸»è¦çš„æ¨¡å—ï¼š\n\n* ç¼–è¯‘ç³»ç»Ÿâ€”â€”æŠŠä½ çš„ä»£ç ç¼–è¯‘æˆå¯ä»¥è¿è¡Œçš„åº”ç”¨, å¹¶ä¸”æŠŠå®ƒå­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ä½œä¸ºåç»­ä½¿ç”¨.\n* åº”ç”¨ç®¡ç†æ•°æ®åº“â€”â€”ç®¡ç† Git ç‰ˆæœ¬ã€build ç‰ˆæœ¬å’Œåº”ç”¨å…ƒæ•°æ®.\n* é›†ç¾¤è°ƒåº¦å™¨â€”â€”å°†ä¸€ç»„æœåŠ¡å™¨ä½œä¸ºä¸€å°å¤§çš„æœåŠ¡å™¨æ¥ç®¡ç†, åœ¨æœåŠ¡å™¨èµ„æºæ± çš„æŸä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œä½ çš„ç¨‹åº, å¹¶æ£€æŸ¥å’Œæ›¿æ¢å¤±æ•ˆçš„ä½œä¸š.\n* è´Ÿè½½å‡è¡¡â€”â€”å…è®¸ä» Internet å’Œå†…éƒ¨ç¨‹åºæ¥çš„ä¸šåŠ¡è´Ÿè½½è¢«æ­£ç¡®çš„è·¯ç”±åˆ°åˆé€‚çš„ä½ç½®.\n* DNSâ€”â€”åœ¨ä½ äº§ç”Ÿå’Œä¿®æ”¹åº”ç”¨æ—¶è‡ªåŠ¨é…ç½® DNS æ¡ç›®.\n* æˆ–è®¸æ˜¯æœ€é‡è¦çš„â€”â€”æŸä¸ªå½¢å¼çš„å®¹å™¨åŒ–ä¾‹å¦‚â€Š freebsd jailsã€solaris zonesã€æˆ–è€… linux containers, å®¹å™¨åŒ–ä½¿å¾—æŸä¸ªçš„åº”ç”¨ä¸ä¼šè¿›å…¥å’Œå½±å“åˆ°å…¶å®ƒçš„åº”ç”¨.\n\nç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç‚¹æ˜¯ Docker è¿…é€Ÿå‘å±•çš„éå¸¸é‡è¦çš„åŸå› . Linux å®¹å™¨æŠ€æœ¯å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´äº†, ä½†æ˜¯åªæœ‰æŸäº›å¤§çš„å…¬å¸æˆ–è€… PaaS æä¾›å•†è‡ªåŠ¨åŒ–äº†å®¹å™¨çš„ä½¿ç”¨, Docker ä½¿ Linux å®¹å™¨çš„ä½¿ç”¨å˜å¾—éå¸¸ç®€å•, ä¹Ÿæä¾›äº†æ ‡å‡†åŒ–çš„é•œåƒæ ¼å¼, å®ƒæˆä¸ºäº† PaaS ä¸­é‡è¦çš„ç»„æˆéƒ¨åˆ†.\n\nè¿™éå¸¸å¼ºå¤§, å› ä¸ºå¾ˆå¤šå…¬å¸åœ¨å¤„ç†çˆ†å‘å¼çš„ç”¨æˆ·å¢é•¿, æ¥è‡ªäºç§»åŠ¨ã€ç¤¾äº¤å’Œ IoT çš„æ–°çš„ä¸šåŠ¡æ¨¡å¼, ä»¥åŠæœŸæœ›ä»ä¼ ç»Ÿçš„é•¿çš„ç‰ˆæœ¬å‘å¸ƒå‘¨æœŸè½¬å˜åˆ°æŒç»­äº¤ä»˜. ä»–ä»¬åˆ©ç”¨åŸºäºè½¯ä»¶çš„æ¶æ„æˆ–è€…å¾®æœåŠ¡. ä»–ä»¬éœ€è¦èƒ½å¤Ÿè‡ªåŠ¨éƒ¨ç½²å’Œæµ‹è¯•æ–°çš„ä»£ç , å¹¶æ ¹æ®ä¸šåŠ¡çš„å˜åŒ–å¼¹æ€§ä¼¸ç¼©. ä½†é—®é¢˜æ˜¯ä»–ä»¬æ²¡æœ‰è¶³å¤Ÿçš„èµ„æºå’Œç»éªŒæ¥äº¤ä»˜åˆ°ä»–ä»¬çš„å¼€å‘å›¢é˜Ÿ, æ‰€ä»¥ä»–ä»¬ä¸å¾—ä¸å°†å…¶å¤–åŒ…ç»™ PaaS æä¾›å•†. ä¸å¹¸çš„æ˜¯, å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™, ä½ å°±æ”¾å¼ƒäº†å¯¹äºè¿™ä¸ªé»‘ç›’å­çš„å¾ˆå¤šæ§åˆ¶, è€Œæ˜¯èŠ±å¾ˆå¤šé’±å¹¶ä½¿å¾—è‡ªå·±å®Œå…¨ä¾èµ–äºå®ƒ. å¦å¤–ä¸€ä¸ªé€‰é¡¹æ˜¯, å¾ˆå¤šå…¬å¸åå¤çš„é‡æ–°å‘æ˜è½®å­æˆ–è€…ä½¿ç”¨é‚£äº›éš¾äºç»´æŠ¤çš„ã€è¿è¡Œç¼“æ…¢çš„å’Œæ˜“äºå‡ºé”™çš„å·¥å…·.\n\næœ€å¥½çš„æƒ…å½¢æ˜¯åœ¨è‡ªå·±çš„æ•°æ®ä¸­å¿ƒæˆ–è€… Cloud å¸å·ä¸­è¿è¡Œä¸€ä¸ª PaaS å¹³å°, ä½ å¯ä»¥å…¨æƒæ§åˆ¶, ä½ çš„å›¢é˜Ÿå¯ä»¥ç›´æ¥å‚ä¸åº”ç”¨çš„éƒ¨ç½², å› æ­¤å¯ä»¥å½¢æˆä¸€ç§çœŸæ­£çš„ DevOps æ–‡åŒ–. Docker åŠå…¶æ ‡å‡†åŒ–çš„ç”Ÿæ€ç³»ç»Ÿæ˜¯è¿™ç§æ„¿æ™¯æˆä¸ºç°å®çš„é‡è¦ä¸€æ­¥.\n\n### æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å° (CaaS)\n\nä»€ä¹ˆæ˜¯å®¹å™¨æ‰˜ç®¡å¹³å°, æˆ–è€…å«å®¹å™¨å³æœåŠ¡å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘åœ¨ä¸Šé¢çš„ç« èŠ‚ä¸­æåˆ°çš„å¦å¤–ä¸€ç§æ„å»ºåœ¨ Docker åŸºç¡€ä¸Šçš„ Web æ‰˜ç®¡æ–¹å¼. å®ƒæ˜¯ä½ ç”¨å®¹å™¨æ¥éƒ¨ç½²å¤æ‚çš„å¤šå±‚æ¬¡çš„åº”ç”¨æ‰€éœ€è¦çš„è‡ªåŠ¨åŒ–çš„ç¼–è¯‘ç³»ç»Ÿ, é›†ç¾¤è°ƒåº¦å™¨, è´Ÿè½½å‡è¡¡, DNS è‡ªåŠ¨åŒ–ä»¥åŠæœåŠ¡å‘ç°. è¿™æ˜¯ PaaS çš„å¦å¤–ä¸€éƒ¨åˆ†å†…å®¹, ä½†æ˜¯ä½ ä¸æ˜¯ç”¨ä¸€ä¸ªå¤æ‚çš„ç¼–è¯‘ç³»ç»Ÿæ¥ç¼–è¯‘ä½ çš„åº”ç”¨, è€Œæ˜¯ç”¨ Docker é•œåƒ. é•œåƒå¯ä»¥éå¸¸å®¹æ˜“çš„è¿›è¡Œç¼–è¯‘å’Œæœ¬åœ°æµ‹è¯•, å› æ­¤ä½ åœ¨éƒ¨ç½²åº”ç”¨ä¹‹å‰å°±ç¡®è®¤åº”ç”¨å¯ä»¥æ­£å¸¸å·¥ä½œ. ç°åœ¨ PaaS ç”¨æˆ·ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ä½“éªŒ, ä½†æ˜¯ä¸éœ€è¦æ‹¥æœ‰è‡ªå·±çš„ç¡¬ä»¶æˆ–è€…äº‘å¸å·çš„å‰æä¸‹èŠ‚çº¦å¤§é‡çš„æˆæœ¬. ä»–ä»¬ä¸å†å—é™äºå…¶æœåŠ¡æä¾›å•†æ‰€æ”¯æŒçš„ç¯å¢ƒ, å¯ä»¥é€šè¿‡å°†åº”ç”¨æ‰“åŒ…æˆ Docker é•œåƒçš„æ–¹å¼åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œ.\n\nåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, åˆ©ç”¨è¯¸å¦‚ ContainerShip Cloud, ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹, åœ¨ä»»ä½•äº‘å¹³å°ä¸Šç”šè‡³æ˜¯è£¸æœºä¸Šç”¨ç›¸åŒçš„æ–¹å¼è¿è¡Œä½ çš„åº”ç”¨. ä½ ä¸å†è¢«å¡åœ¨æ„å»ºå¤æ‚çš„åº”ç”¨æ¥è§£å†³éå¸¸å›°éš¾çš„é—®é¢˜, æˆ–è€…å¡åœ¨ä½¿ç”¨æŸä¸ªæä¾›å•†çš„ç‰¹æ®Šçš„è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·ä¸Š.\n\n* ä½†æ˜¯é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„ Docker å®¹å™¨æ‰˜ç®¡å¹³å°å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…, æœ‰å¾ˆå¤šçš„é—®é¢˜éœ€è¦ä½ å»æ€è€ƒå’Œæ³¨æ„.\n* æœ‰å¤§é‡çš„é€‰é¡¹, å› æ­¤é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›è¡Œç ”ç©¶å°±å˜å¾—å›°éš¾. å¥½æ¶ˆæ¯æ˜¯å¦‚æœä½ çš„åº”ç”¨å·²ç»å®¹å™¨åŒ–, ä½ å°±å¯ä»¥è½»æ¾çš„æµ‹è¯•å…¶ä¸­çš„æ¯ä¸€ä¸ª.\n* ä½ æ­£åœ¨ä½¿ç”¨çš„æœåŠ¡æä¾›å•†ä¾‹å¦‚ Triton æˆ–è€… ECS çš„æŸä¸ªè§£å†³æ–¹æ¡ˆæˆ–è®¸ä½¿å¾—ä½ æ— æ³•è„±ç¦»è¿™ä¸ªæä¾›å•†, è¿™ä¹Ÿä½¿å¾— Docker çš„æœ€ä»¤äººå…´å¥‹çš„å¯ç§»æ¤æ€§å˜å¾—ä¸é‚£ä¹ˆé‡è¦äº†.\n* è®¸å¤š CaaS æ–¹æ¡ˆåœ¨ä»–ä»¬è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ‰€æœ‰çš„ç®¡ç†ç³»ç»Ÿ, ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šåªæ˜¯è¿è¡ŒæŸä¸ªä»£ç†ç¨‹åºæ¥è¿æ¥ä»–ä»¬çš„ API, å› æ­¤å¦‚æœä»–ä»¬çš„ç³»ç»Ÿå®•æœºåä½ çš„é›†ç¾¤å°†æ— æ³•å·¥ä½œ.\n* å…è®¸ä½ åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆæ˜¯éå¸¸å¤æ‚çš„, éœ€è¦ä¸€ä¸ªå›¢é˜Ÿå»ç®¡ç†å’Œå‡çº§.\n* èƒ½å¤Ÿå®¹æ˜“çš„åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆä¼šä½¿å¾—é«˜å¯ç”¨æˆä¸ºä½ä¼˜å…ˆçº§çš„äº‹æƒ….\n* å½“ä½ é€‰æ‹©äº†ä¸€ä¸ª CaaS æä¾›å•†æ—¶, ä½ å°±å¯ä»¥æ‘†è„±äº†ä½ çš„æœåŠ¡æ‰˜ç®¡æä¾›å•†çš„é”å®š, ä½†æ˜¯ä½ å°†é™·å…¥åˆ° CaaS æä¾›å•†çš„é”å®š. ä½ æ— æ³•ä¸ä½¿ç”¨ä»–ä»¬çš„ SaaS ç®¡ç†æ¥å£è€Œåœ¨ä½ è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ•´ä¸ªç³»ç»ŸåŒ…æ‹¬ç®¡ç†ç³»ç»Ÿ, API å’Œ UI. ä½ ä¸€æ—¦å†³å®šä»˜é’±, ä½ æœ€å¥½å¯ä»¥ä¸€ç›´ä»˜é’±.\n\n### æ€»ç»“\n\nç»ˆäºçœ‹å®Œäº†, çœŸçš„æ˜¯åˆè‡­åˆé•¿å•Š. å›é¡¾ä¸€ä¸‹è¿™ç¯‡æ–‡ç« , æ€»ä½“æ¥è¯´æ˜¯ç»å†äº†è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹:\n\n1. ä¸“æœ‰æœåŠ¡å™¨\n2. è™šæ‹ŸåŒ–æŠ€æœ¯\n3. åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)\n4. å¹³å°å³æœåŠ¡ (PaaS)\n5. å®¹å™¨å³æœåŠ¡ (CaaS)\n\næ€»ç»“ä¸€ä¸‹, æˆ‘è§‰å¾—å¼€å‘äººå‘˜è¿˜æ˜¯æœ‰å¿…è¦äº†è§£ä¸€ä¸‹å…³äºäº§å“éƒ¨ç½²ç›¸å…³çš„æŠ€æœ¯å‘å±•. ç„¶åæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥é€‰æ‹©åˆé€‚çš„æœåŠ¡æä¾›å•†.\n","source":"_posts/ç»™å°ç™½è¯»çš„-WEB-æ‰˜ç®¡æœåŠ¡è¿›åŒ–å².md","raw":"---\ntitle: ç»™å°ç™½è¯»çš„ WEB æ‰˜ç®¡æœåŠ¡è¿›åŒ–å²\ncomments: true\ndate: 2018-06-09 18:29:12\ntags:\nfrom:\n---\nè¿™ç¯‡æ–‡ç« æ˜¯æ¥æ‹“å±•è‡ªå·±çŸ¥è¯†é¢çš„, åœ¨æˆ‘è¯»é«˜ä¸­é‚£ä¼š (08 å¹´), æˆ‘èº«è¾¹å°±æœ‰æ²‰è¿·ç”µè„‘æŠ€æœ¯çš„åŒå­¦, é‚£ä¸ªæ—¶å€™æˆ‘æƒ³ç€åšä¸€ä¸ªè‡ªå·±çš„ç½‘ç«™, è‚¯å®šæ˜¯éå¸¸ç‰›é€¼çš„äº‹äº†. ä»æœ€å¼€å§‹æ¥è§¦çš„æœåŠ¡, ä¾æ¬¡æ¥æ’ä¸ªåº. æ°¸ç¡• E ç›˜ -> å…è´¹ç©ºé—´å»ºç«™ (å›½å¤–å±…å¤š) -> è™šæ‹Ÿç©ºé—´ -> è™šæ‹ŸæœåŠ¡å™¨ (VPS) -> ç‹¬ç«‹æœåŠ¡å™¨. çœ‹å®Œè¿™ç¯‡æ–‡ç« å, æˆ‘æ€»ç®—å¯¹è¿™æ–¹é¢çŸ¥è¯†æœ‰äº†ä¸€ä¸ªæ¯”è¾ƒç³»ç»Ÿæ€§çš„è®¤è¯†äº†. ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹.\n\n<!-- more -->\n### å¼•å­\n\næ–‡ç« å¼€å§‹ä¹‹å‰, æˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦æŠŠè¿™äº›ä¸“æœ‰åè¯å…ˆç§‘æ™®ä¸€ä¸‹, ä¸è¦è§‰å¾—å¾ˆé«˜å¤§ä¸Š, ç®€ç§°è€Œå·².\n\n* IaaS - åŸºç¡€è®¾æ–½å³æœåŠ¡\n* PaaS - å¹³å°å³æœåŠ¡\n* CaaS - å®¹å™¨å³æœåŠ¡\n\næœ¬æ–‡ä»‹ç»äº† Web æ‰˜ç®¡æœåŠ¡è¿›åŒ–çš„å†å², ä»ä¸“ç”¨æœåŠ¡å™¨åˆ°è™šæ‹ŸåŒ–åˆ° IaaSã€PaaS å’Œæœ€æ–°çš„ CaaS; è¯´æ˜äº†æ¯ç§æ–¹å¼çš„ä¼˜ç‚¹å’Œç¼ºç‚¹. ç€é‡é˜è¿°äº†æ„å»º PaaS åº”ç”¨çš„å„ä¸ªç»„ä»¶, ä»¥åŠåœ¨é€‰æ‹© CaaS æä¾›å•†æ—¶åº”è¯¥è€ƒè™‘çš„é—®é¢˜. æœ€åä»æˆæœ¬å’ŒåŠŸèƒ½æ€§çš„è§’åº¦è®ºè¿°äº† PaaS ç”¨æˆ·åº”è¯¥è¿ç§»åˆ° CaaS å¹³å°.\n\nè¯»å®Œè¿™ç¯‡åšæ–‡, ä½ åº”è¯¥å¯ä»¥æ¸…æ¥šçš„ç†è§£:\n\n* è¿™äº›åè¯åˆ°åº•æŒ‡ä»€ä¹ˆ\n* è¿™ä¸ºä»€ä¹ˆå¯¹ä½ å¾ˆé‡è¦\n* å¯¹äºä½ çš„ä½¿ç”¨åœºæ™¯ï¼Œå“ªç§æ–¹å¼æœ€é€‚åˆ\n\nå½“ç„¶æ²¡æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿé€‚åˆæ‰€æœ‰çš„ Web åŸºç¡€è®¾æ–½çš„åœºæ™¯, ä½ çš„ç‰¹æ®Šåœºæ™¯æˆ–è®¸éœ€è¦ç‰¹æ®Šçš„è€ƒè™‘.\n\n### ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\n\nWeb æ‰˜ç®¡çš„æœ¬è´¨è¿˜æ˜¯åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒé‡Œå¸ƒæ»¡äº†æœåŠ¡å™¨ã€äº¤æ¢æœºã€è·¯ç”±å™¨ã€å­˜å‚¨é˜µåˆ—å’Œå…¶å®ƒç½‘ç»œç»„ä»¶. æˆ‘ä»¬æ‰€è®¨è®ºçš„æ¯ä¸€ä¸ªé€‰é¡¹ä¸ç®¡å®ƒæ˜¯ PaaSã€IaaS è¿˜æ˜¯ CaaS, å®ƒåº•å±‚ä½¿ç”¨çš„åŸºç¡€è®¾æ–½éƒ½æ˜¯ç›¸åŒçš„, å³åœ¨ä¸€ä¸ªå¤§å±‹å­é‡Œçš„å¾ˆå¤šç‹¬ç«‹æœåŠ¡å™¨. ä»–ä»¬åªæ˜¯ä¸Šé¢å¢åŠ äº†å¾ˆå¤šæŠ½è±¡å±‚ä½¿å¾—ç®¡ç†å˜å¾—æ›´ç®€å•, å’Œä½¿ç”¨è‡ªåŠ¨åŒ–çš„æ–¹å¼å¤„ç†ä»¥å‰å¾ˆæ…¢æˆ–è€…éœ€è¦æ‰‹åŠ¨æ­¥éª¤çš„ä»»åŠ¡.\n\nä¸“ç”¨æœåŠ¡å™¨, æˆ–è€…å«åš â€œè£¸æœºâ€ æœ‰å®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹.\n\n#### ä¼˜ç‚¹\n\n* æ€§èƒ½â€”â€”ä½ åœ¨ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœåŠ¡å™¨, æ²¡æœ‰ä»»ä½•æŠ½è±¡å±‚ä¾‹å¦‚è™šæ‹ŸåŒ–å¸¦æ¥çš„æ€§èƒ½å¼€é”€.\n* å¯é æ€§â€”â€”æ²¡æœ‰æŠ½è±¡å±‚å’Œè™šæ‹ŸåŒ–, å‡ºé”™çš„å¯èƒ½æ€§ä¼šé™ä½.\n* èµ„æºåˆ©ç”¨ç‡â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, ä½ çš„è¿›ç¨‹ä¸éœ€è¦è·Ÿå…¶å®ƒçš„è™šæ‹Ÿæœºæˆ–è€…è¿›ç¨‹ç«äº‰èµ„æºä¾‹å¦‚ CPUã€å†…å­˜å’Œå¸¦å®½.\n\n#### ç¼ºç‚¹\n\n* ç®¡ç†å¤æ‚æ€§â€”â€”ä½ æ— æ³•å®¹æ˜“åœ°å…‹éš†ä¸“ç”¨æœåŠ¡å™¨æ¥äº§ç”Ÿæ›´å¤šçš„å®ä¾‹, ä¸“ç”¨æœåŠ¡å™¨æ²¡æœ‰ AMIï¼ˆè¯‘è€…æ³¨: Amazon Machine Imageï¼‰æˆ–è€…é•œåƒçš„æ¦‚å¿µ. æƒ³æ‰©å±•ä½ çš„åŸºç¡€è®¾æ–½åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Ÿæˆ‘å¸Œæœ›ä½ ç”¨é…ç½®ç®¡ç†, æˆ–è€…ä½¿ç”¨å¯ä¿¡èµ–çš„è€æœ‹å‹ rsync.\n* æˆæœ¬â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½ éœ€è¦é¢„å…ˆæ”¯ä»˜æœåŠ¡å™¨çš„ç¡¬ä»¶ä»·æ ¼, ç„¶åå†ä»˜ç§Ÿç”¨åœºåœ°çš„æˆæœ¬, æˆ–è€…ä½ ä»ä¸€ä¸ªæœåŠ¡æä¾›å•†é‚£é‡Œç§Ÿèµå®ƒä»¬. æ— è®ºå“ªç§æ–¹å¼, ä½ éƒ½æ²¡æ³•åœ¨ä¸ä½¿ç”¨æ—¶ç»ˆæ­¢æœåŠ¡å™¨çš„ç§Ÿèµæ¥èŠ‚çœæˆæœ¬, å› æ­¤ä½ éœ€è¦æ›´åŠ è°¨æ…çš„å¯¹å¾…ä½ çš„è´¢åŠ¡è®¡åˆ’.\n* ä½ æ‰€æœ‰çš„è¿›ç¨‹å’Œåº”ç”¨éƒ½è¿è¡Œåœ¨ä¸“ç”¨æœåŠ¡å™¨ä¸Š, å› æ­¤è¿è¡Œåœ¨ç›¸åŒçš„æ“ä½œç³»ç»Ÿä¸Š. ä¸ºäº†å¯æ‰©å±•æ€§çš„ç›®çš„, ä½ å¾€å¾€å¸Œæœ›æœåŠ¡å™¨åªè¿è¡Œå•ä¸€çš„è¿›ç¨‹, ä¾‹å¦‚ Web æœåŠ¡æˆ–è€…æ•°æ®åº“æœåŠ¡. åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œæ‰€æœ‰çš„åº”ç”¨ä½¿å¾—æ“ä½œç³»ç»Ÿçš„è°ƒä¼˜å˜å¾—æ›´å›°éš¾.\n\n### ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\n\nå°½ç®¡ä¸“ç”¨æœåŠ¡å™¨æœ‰å¾ˆå¤šä¼˜ç‚¹, ä½†æ˜¯å®ƒçš„ç¼ºç‚¹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè¿œè¿œè¶…è¿‡å…¶ä¼˜ç‚¹. å…¬å¸ä¸ºäº†èƒ½å¤Ÿè¿…é€Ÿè¿›å…¥å¸‚åœºèµ¢å¾—ç«äº‰, å¯¹äºéƒ¨ç½²çš„é€Ÿåº¦æå‡ºäº†æ›´é«˜çš„è¦æ±‚, è™šæ‹ŸåŒ–å°±å¾ˆè‡ªç„¶çš„æˆä¸ºäº†æ•°æ®ä¸­å¿ƒè¿›åŒ–ä¸­çš„ä¸‹ä¸€ä¸ªæ­¥éª¤.\n\n#### ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\n\nç®€è€Œè¨€ä¹‹, è™šæ‹ŸåŒ–å°±æ˜¯å°†ç‰©ç†æœåŠ¡å™¨åˆ†æˆæ›´å°çš„è™šæ‹Ÿæœº, è¿™äº›è™šæ‹Ÿæœºåªèƒ½è®¿é—®ç‰©ç†æœºçš„éƒ¨åˆ†èµ„æº. ä¾‹å¦‚ä½ æœ‰ä¸€ä¸ª 8CPU æ ¸ä»¥åŠ 16GB å†…å­˜çš„ç‰©ç†æœåŠ¡å™¨, åˆ™å¯ä»¥å°†å®ƒåˆ†æˆ 8 ä¸ªè™šæ‹Ÿæœº, æ¯ä¸ªè™šæ‹Ÿæœºæœ‰ 1 ä¸ª CPU å’Œ 2GB å†…å­˜. ä½ æˆ–è®¸å·²ç»å¬è¯´è¿‡ä¸€äº›è™šæ‹ŸåŒ–æŠ€æœ¯å¦‚ Xen, KVM, VMware å’Œ Hyper-V, å…¶å®å¾ˆæœ‰æ›´å¤š.\n\n#### ä¼˜ç‚¹\n\n* ä½ å¯ä»¥åœ¨éœ€è¦æ›´å¤šè™šæ‹Ÿæœºå®ä¾‹æˆ–è€…æƒ³è¦è™šæ‹Ÿæœºå…±äº«æ—¶è¿›è¡Œè™šæ‹Ÿæœºçš„å…‹éš†.\n* ä½ å¯ä»¥å¤‡ä»½è™šæ‹Ÿæœºé•œåƒä½œä¸ºå®‰å…¨ä¿æŠ¤æˆ–è€…ç¾å¤‡.\n\n#### ç¼ºç‚¹\n\n* ä½¿ç”¨è™šæ‹ŸåŒ–æ„å‘³ç€é¢å¤–çš„æ€§èƒ½å¼€é”€, å¯èƒ½é€ æˆæ€§èƒ½ä¸‹é™.\n* è™šæ‹Ÿæœºé•œåƒåœ¨ä¸åŒçš„æœåŠ¡æä¾›å•†å’Œè™šæ‹ŸåŒ–æŠ€æœ¯ä¹‹é—´åŸºæœ¬ä¸Šæ˜¯ä¸å¯ç§»æ¤çš„.\n* ç®¡ç†è™šæ‹Ÿæœºä¾ç„¶æ˜¯æ‰‹å·¥æ­¥éª¤, éœ€è¦ç®¡ç†çš„æ—¶é—´å’Œä¸“ä¸šçŸ¥è¯†.\n\n### è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ (IaaS)\n\nä½ çŸ¥é“ [51% çš„äººè®¤ä¸º â€œäº‘â€ ä¼šè¢«å¤©æ°”å½±å“å—](http://www.businessinsider.com/people-think-stormy-weather-affects-cloud-computing-2012-8)ï¼Ÿä½ çŸ¥é“å½“äººä»¬è°ˆè®º â€œäº‘â€ æ—¶ä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºåŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS) å—ï¼Ÿ\n\n#### ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)\n\n* é€šè¿‡ API æ¥ç®¡ç†ç¡¬ä»¶çš„è™šæ‹ŸåŒ–.\n* é€šè¿‡ç¼–ç¨‹æ¥å£è®¿é—®è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºå’Œé…ç½®.\n* å½“ä½ éœ€è¦æ˜¯ç”³è¯·ä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœº, å½“ä½ å®Œæˆåç»ˆæ­¢è™šæ‹Ÿæœº, ä½ åªéœ€è¦ä¸ºä½ ä½¿ç”¨çš„èµ„æºä»˜è´¹.\n* å°†æ•°æ®ä¸­å¿ƒèµ„æºè§†ä¸ºå…¬å…±è®¾æ–½.\n\näºšé©¬é€Šåœ¨ 2006 å¹´å‘å¸ƒäº†å…¶ Amazon Web Servicesï¼ˆAWSï¼‰å’Œ EC2 äº§å“ï¼Œæˆä¸ºäº†è¿™ä¸ªé¢†åŸŸçš„å…ˆé©±ã€‚\n\n#### ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\n\nåœ¨è¿‡å»å½“ä½ éœ€è¦ä¸Šçº¿ä¸€ä¸ªåœ¨çº¿ä¸šåŠ¡æ—¶, ä½ ä¸å¾—ä¸è¿›è¡Œå¤æ‚çš„è®¡åˆ’æ¥ä¿è¯ä½ åœ¨æ•°æ®ä¸­å¿ƒå†…æœ‰è¶³å¤Ÿçš„æœºæ¶ç©ºé—´ã€è¶³å¤Ÿçš„æœåŠ¡å™¨å’Œå­˜å‚¨æ¥å¤„ç†ä¸šåŠ¡çš„å¢é•¿, è¶³å¤Ÿçš„ç½‘ç»œå¸¦å®½æ¥å¤„ç†æ‰€æœ‰çš„ç”¨æˆ·æµé‡. è¿™ç§è®¡åˆ’å¹¶ä¸å®¹æ˜“, å°¤å…¶æ˜¯å¯¹æ—©æœŸçš„ä¸šåŠ¡æ¥è®², ä½ æ— æ³•é¢„æµ‹ä¸šåŠ¡çš„æœªæ¥å’Œå¢é•¿è½¨è¿¹.\n\n1. å®ƒç»™äº†å¼€å‘è€…è¶…èƒ½é‡:\n    * æ„æ€ä¸€ä¸ªæƒ³æ³•ç«‹å³ä¸Šçº¿.\n    * å¦‚æœæˆåŠŸäº†, å¯ä»¥å®¹æ˜“çš„æ‰©å±•è§„æ¨¡.\n    * å¦‚æœå¤±è´¥äº†, å…³é—­è™šæ‹Ÿæœºä»¥èŠ‚çº¦æˆæœ¬.\n2. å®ƒä½¿å¾—æ•°æ®ä¸­å¿ƒè‡ªåŠ¨åŒ–å˜å¾—æ›´å¼ºå¤§:\n    * å…¨è‡ªåŠ¨åŸºç¡€è®¾æ–½ç®¡ç†æˆä¸ºå¯èƒ½, å‡ºç°äº† â€œåŸºç¡€è®¾æ–½å³ä»£ç â€ çš„æ¦‚å¿µ.\n    * å¼¹æ€§ä¼¸ç¼©åœ¨è¿‡å»æ˜¯ä¸å¯èƒ½å®ç°çš„, ä½†æ˜¯ç°åœ¨ web åŸºç¡€è®¾æ–½å¯ä»¥å½“ä¸šåŠ¡å˜åŒ–æ—¶è‡ªåŠ¨çš„æ‰©å±•æˆ–è€…æ”¶ç¼©.\n    * åœ¨æœåŠ¡å™¨çš„è‡ªåŠ¨åŒ–ç®¡ç†ä¹‹å, æ•°æ®ä¸­å¿ƒçš„è‡ªåŠ¨åŒ–ä¹Ÿæ‰©å±•åˆ°äº†å­˜å‚¨ã€ç½‘ç»œä»¥åŠå…¶å®ƒå¤§é‡çš„éœ€è¦ä¸“ä¸šçŸ¥è¯†çš„ç³»ç»Ÿ, åœ¨ä»£ç å’Œ API èƒ½å¤Ÿå¤„ç†è¿™äº›è‡ªåŠ¨åŒ–ä¹‹å, è¿™ç»™å…¨çƒçš„å¼€å‘è€…ç¤¾åŒºå¸¦æ¥äº†æ–°çš„æœºé‡.\n\n### è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡ (PaaS)\n\nå¹³å°å³æœåŠ¡ (PaaS) ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“çš„éƒ¨ç½²å’Œç®¡ç†åº”ç”¨è€Œéšè—æ‰æ‰€æœ‰çš„å®ç°ç»†èŠ‚ä¾‹å¦‚æœåŠ¡å™¨ã€è´Ÿè½½å‡è¡¡å™¨ã€DNS ç­‰ç­‰. ä»–ä»¬æˆ–å¤šæˆ–å°‘çš„å»é™¤äº†å¯¹è¿ç»´å›¢é˜Ÿçš„éœ€æ±‚, è€Œæ˜¯è®©å¼€å‘äººå‘˜å»å…³æ³¨åº”ç”¨éƒ¨ç½². æœ‰å¾ˆå¤š PaaS æä¾›å•†, å…¶ä¸­ä¸€ä¸ªæœ€æµè¡Œçš„æ˜¯ Heroku. å…³äº Heroku çš„ä¸€ä¸ªæœ‰è¶£çš„äº‹æƒ…æ˜¯ Heroku å®Œå…¨æ˜¯è¿è¡Œåœ¨ AWS ä¹‹ä¸Šå¹¶ä¾èµ– AWS çš„. å¦‚æœä½ ä¸æ„¿æ„ä½ çš„åº”ç”¨è¿è¡Œåœ¨ç¾å›½ä¸œéƒ¨æˆ–è€…æ¬§æ´²è¥¿éƒ¨çš„ AWS ä¸Šçš„è¯, è¿™æˆ–è®¸æ˜¯ä¸€ä¸ªé—®é¢˜. æ²¡æœ‰ IaaS, åƒ Heroku è¿™æ ·çš„å¹³å°å¯èƒ½å°±ä¸ä¼šå­˜åœ¨äº†. PaaS æä¾›å•†åˆ©ç”¨ IaaS ä½œä¸ºä¸€ä¸ªéå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†æ¥äº¤ä»˜å®ƒä»¬çš„æœåŠ¡. åœ¨å‡å°‘ä»æƒ³æ³•åˆ°éƒ¨ç½²çš„æ—¶é—´ã€è‡ªåŠ¨åŒ–æµç¨‹ä»¥åŠå‡å°‘ç‰¹æ®Šçš„ç³»ç»ŸçŸ¥è¯†éœ€æ±‚çš„è¶‹åŠ¿ä¸­, PaaS æ˜¯åˆç†çš„ä¸‹ä¸€æ­¥, å°±åƒæ˜¯ä»ä¸“ç”¨æœåŠ¡å™¨åˆ° IaaS ä¸€æ ·.\n\n#### æ„å»º PaaS æ˜¯å›°éš¾çš„\n\nèƒ½å¤Ÿé€šè¿‡æŠ½è±¡è€Œé¿å…å¤„ç†æœåŠ¡å™¨ç›¸å…³çš„é—®é¢˜æ˜¯ä¸å®¹æ˜“çš„, éœ€è¦å¼•å…¥å¾ˆå¤šä¸œè¥¿æ‰èƒ½åšåˆ°.\n\nåœ¨ PaaS çš„æ¦‚å¿µä¹‹ä¸‹æœ‰å‡ ä¸ªä¸»è¦çš„æ¨¡å—ï¼š\n\n* ç¼–è¯‘ç³»ç»Ÿâ€”â€”æŠŠä½ çš„ä»£ç ç¼–è¯‘æˆå¯ä»¥è¿è¡Œçš„åº”ç”¨, å¹¶ä¸”æŠŠå®ƒå­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ä½œä¸ºåç»­ä½¿ç”¨.\n* åº”ç”¨ç®¡ç†æ•°æ®åº“â€”â€”ç®¡ç† Git ç‰ˆæœ¬ã€build ç‰ˆæœ¬å’Œåº”ç”¨å…ƒæ•°æ®.\n* é›†ç¾¤è°ƒåº¦å™¨â€”â€”å°†ä¸€ç»„æœåŠ¡å™¨ä½œä¸ºä¸€å°å¤§çš„æœåŠ¡å™¨æ¥ç®¡ç†, åœ¨æœåŠ¡å™¨èµ„æºæ± çš„æŸä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œä½ çš„ç¨‹åº, å¹¶æ£€æŸ¥å’Œæ›¿æ¢å¤±æ•ˆçš„ä½œä¸š.\n* è´Ÿè½½å‡è¡¡â€”â€”å…è®¸ä» Internet å’Œå†…éƒ¨ç¨‹åºæ¥çš„ä¸šåŠ¡è´Ÿè½½è¢«æ­£ç¡®çš„è·¯ç”±åˆ°åˆé€‚çš„ä½ç½®.\n* DNSâ€”â€”åœ¨ä½ äº§ç”Ÿå’Œä¿®æ”¹åº”ç”¨æ—¶è‡ªåŠ¨é…ç½® DNS æ¡ç›®.\n* æˆ–è®¸æ˜¯æœ€é‡è¦çš„â€”â€”æŸä¸ªå½¢å¼çš„å®¹å™¨åŒ–ä¾‹å¦‚â€Š freebsd jailsã€solaris zonesã€æˆ–è€… linux containers, å®¹å™¨åŒ–ä½¿å¾—æŸä¸ªçš„åº”ç”¨ä¸ä¼šè¿›å…¥å’Œå½±å“åˆ°å…¶å®ƒçš„åº”ç”¨.\n\nç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç‚¹æ˜¯ Docker è¿…é€Ÿå‘å±•çš„éå¸¸é‡è¦çš„åŸå› . Linux å®¹å™¨æŠ€æœ¯å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´äº†, ä½†æ˜¯åªæœ‰æŸäº›å¤§çš„å…¬å¸æˆ–è€… PaaS æä¾›å•†è‡ªåŠ¨åŒ–äº†å®¹å™¨çš„ä½¿ç”¨, Docker ä½¿ Linux å®¹å™¨çš„ä½¿ç”¨å˜å¾—éå¸¸ç®€å•, ä¹Ÿæä¾›äº†æ ‡å‡†åŒ–çš„é•œåƒæ ¼å¼, å®ƒæˆä¸ºäº† PaaS ä¸­é‡è¦çš„ç»„æˆéƒ¨åˆ†.\n\nè¿™éå¸¸å¼ºå¤§, å› ä¸ºå¾ˆå¤šå…¬å¸åœ¨å¤„ç†çˆ†å‘å¼çš„ç”¨æˆ·å¢é•¿, æ¥è‡ªäºç§»åŠ¨ã€ç¤¾äº¤å’Œ IoT çš„æ–°çš„ä¸šåŠ¡æ¨¡å¼, ä»¥åŠæœŸæœ›ä»ä¼ ç»Ÿçš„é•¿çš„ç‰ˆæœ¬å‘å¸ƒå‘¨æœŸè½¬å˜åˆ°æŒç»­äº¤ä»˜. ä»–ä»¬åˆ©ç”¨åŸºäºè½¯ä»¶çš„æ¶æ„æˆ–è€…å¾®æœåŠ¡. ä»–ä»¬éœ€è¦èƒ½å¤Ÿè‡ªåŠ¨éƒ¨ç½²å’Œæµ‹è¯•æ–°çš„ä»£ç , å¹¶æ ¹æ®ä¸šåŠ¡çš„å˜åŒ–å¼¹æ€§ä¼¸ç¼©. ä½†é—®é¢˜æ˜¯ä»–ä»¬æ²¡æœ‰è¶³å¤Ÿçš„èµ„æºå’Œç»éªŒæ¥äº¤ä»˜åˆ°ä»–ä»¬çš„å¼€å‘å›¢é˜Ÿ, æ‰€ä»¥ä»–ä»¬ä¸å¾—ä¸å°†å…¶å¤–åŒ…ç»™ PaaS æä¾›å•†. ä¸å¹¸çš„æ˜¯, å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™, ä½ å°±æ”¾å¼ƒäº†å¯¹äºè¿™ä¸ªé»‘ç›’å­çš„å¾ˆå¤šæ§åˆ¶, è€Œæ˜¯èŠ±å¾ˆå¤šé’±å¹¶ä½¿å¾—è‡ªå·±å®Œå…¨ä¾èµ–äºå®ƒ. å¦å¤–ä¸€ä¸ªé€‰é¡¹æ˜¯, å¾ˆå¤šå…¬å¸åå¤çš„é‡æ–°å‘æ˜è½®å­æˆ–è€…ä½¿ç”¨é‚£äº›éš¾äºç»´æŠ¤çš„ã€è¿è¡Œç¼“æ…¢çš„å’Œæ˜“äºå‡ºé”™çš„å·¥å…·.\n\næœ€å¥½çš„æƒ…å½¢æ˜¯åœ¨è‡ªå·±çš„æ•°æ®ä¸­å¿ƒæˆ–è€… Cloud å¸å·ä¸­è¿è¡Œä¸€ä¸ª PaaS å¹³å°, ä½ å¯ä»¥å…¨æƒæ§åˆ¶, ä½ çš„å›¢é˜Ÿå¯ä»¥ç›´æ¥å‚ä¸åº”ç”¨çš„éƒ¨ç½², å› æ­¤å¯ä»¥å½¢æˆä¸€ç§çœŸæ­£çš„ DevOps æ–‡åŒ–. Docker åŠå…¶æ ‡å‡†åŒ–çš„ç”Ÿæ€ç³»ç»Ÿæ˜¯è¿™ç§æ„¿æ™¯æˆä¸ºç°å®çš„é‡è¦ä¸€æ­¥.\n\n### æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å° (CaaS)\n\nä»€ä¹ˆæ˜¯å®¹å™¨æ‰˜ç®¡å¹³å°, æˆ–è€…å«å®¹å™¨å³æœåŠ¡å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘åœ¨ä¸Šé¢çš„ç« èŠ‚ä¸­æåˆ°çš„å¦å¤–ä¸€ç§æ„å»ºåœ¨ Docker åŸºç¡€ä¸Šçš„ Web æ‰˜ç®¡æ–¹å¼. å®ƒæ˜¯ä½ ç”¨å®¹å™¨æ¥éƒ¨ç½²å¤æ‚çš„å¤šå±‚æ¬¡çš„åº”ç”¨æ‰€éœ€è¦çš„è‡ªåŠ¨åŒ–çš„ç¼–è¯‘ç³»ç»Ÿ, é›†ç¾¤è°ƒåº¦å™¨, è´Ÿè½½å‡è¡¡, DNS è‡ªåŠ¨åŒ–ä»¥åŠæœåŠ¡å‘ç°. è¿™æ˜¯ PaaS çš„å¦å¤–ä¸€éƒ¨åˆ†å†…å®¹, ä½†æ˜¯ä½ ä¸æ˜¯ç”¨ä¸€ä¸ªå¤æ‚çš„ç¼–è¯‘ç³»ç»Ÿæ¥ç¼–è¯‘ä½ çš„åº”ç”¨, è€Œæ˜¯ç”¨ Docker é•œåƒ. é•œåƒå¯ä»¥éå¸¸å®¹æ˜“çš„è¿›è¡Œç¼–è¯‘å’Œæœ¬åœ°æµ‹è¯•, å› æ­¤ä½ åœ¨éƒ¨ç½²åº”ç”¨ä¹‹å‰å°±ç¡®è®¤åº”ç”¨å¯ä»¥æ­£å¸¸å·¥ä½œ. ç°åœ¨ PaaS ç”¨æˆ·ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ä½“éªŒ, ä½†æ˜¯ä¸éœ€è¦æ‹¥æœ‰è‡ªå·±çš„ç¡¬ä»¶æˆ–è€…äº‘å¸å·çš„å‰æä¸‹èŠ‚çº¦å¤§é‡çš„æˆæœ¬. ä»–ä»¬ä¸å†å—é™äºå…¶æœåŠ¡æä¾›å•†æ‰€æ”¯æŒçš„ç¯å¢ƒ, å¯ä»¥é€šè¿‡å°†åº”ç”¨æ‰“åŒ…æˆ Docker é•œåƒçš„æ–¹å¼åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œ.\n\nåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, åˆ©ç”¨è¯¸å¦‚ ContainerShip Cloud, ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹, åœ¨ä»»ä½•äº‘å¹³å°ä¸Šç”šè‡³æ˜¯è£¸æœºä¸Šç”¨ç›¸åŒçš„æ–¹å¼è¿è¡Œä½ çš„åº”ç”¨. ä½ ä¸å†è¢«å¡åœ¨æ„å»ºå¤æ‚çš„åº”ç”¨æ¥è§£å†³éå¸¸å›°éš¾çš„é—®é¢˜, æˆ–è€…å¡åœ¨ä½¿ç”¨æŸä¸ªæä¾›å•†çš„ç‰¹æ®Šçš„è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·ä¸Š.\n\n* ä½†æ˜¯é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„ Docker å®¹å™¨æ‰˜ç®¡å¹³å°å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…, æœ‰å¾ˆå¤šçš„é—®é¢˜éœ€è¦ä½ å»æ€è€ƒå’Œæ³¨æ„.\n* æœ‰å¤§é‡çš„é€‰é¡¹, å› æ­¤é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›è¡Œç ”ç©¶å°±å˜å¾—å›°éš¾. å¥½æ¶ˆæ¯æ˜¯å¦‚æœä½ çš„åº”ç”¨å·²ç»å®¹å™¨åŒ–, ä½ å°±å¯ä»¥è½»æ¾çš„æµ‹è¯•å…¶ä¸­çš„æ¯ä¸€ä¸ª.\n* ä½ æ­£åœ¨ä½¿ç”¨çš„æœåŠ¡æä¾›å•†ä¾‹å¦‚ Triton æˆ–è€… ECS çš„æŸä¸ªè§£å†³æ–¹æ¡ˆæˆ–è®¸ä½¿å¾—ä½ æ— æ³•è„±ç¦»è¿™ä¸ªæä¾›å•†, è¿™ä¹Ÿä½¿å¾— Docker çš„æœ€ä»¤äººå…´å¥‹çš„å¯ç§»æ¤æ€§å˜å¾—ä¸é‚£ä¹ˆé‡è¦äº†.\n* è®¸å¤š CaaS æ–¹æ¡ˆåœ¨ä»–ä»¬è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ‰€æœ‰çš„ç®¡ç†ç³»ç»Ÿ, ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šåªæ˜¯è¿è¡ŒæŸä¸ªä»£ç†ç¨‹åºæ¥è¿æ¥ä»–ä»¬çš„ API, å› æ­¤å¦‚æœä»–ä»¬çš„ç³»ç»Ÿå®•æœºåä½ çš„é›†ç¾¤å°†æ— æ³•å·¥ä½œ.\n* å…è®¸ä½ åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆæ˜¯éå¸¸å¤æ‚çš„, éœ€è¦ä¸€ä¸ªå›¢é˜Ÿå»ç®¡ç†å’Œå‡çº§.\n* èƒ½å¤Ÿå®¹æ˜“çš„åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆä¼šä½¿å¾—é«˜å¯ç”¨æˆä¸ºä½ä¼˜å…ˆçº§çš„äº‹æƒ….\n* å½“ä½ é€‰æ‹©äº†ä¸€ä¸ª CaaS æä¾›å•†æ—¶, ä½ å°±å¯ä»¥æ‘†è„±äº†ä½ çš„æœåŠ¡æ‰˜ç®¡æä¾›å•†çš„é”å®š, ä½†æ˜¯ä½ å°†é™·å…¥åˆ° CaaS æä¾›å•†çš„é”å®š. ä½ æ— æ³•ä¸ä½¿ç”¨ä»–ä»¬çš„ SaaS ç®¡ç†æ¥å£è€Œåœ¨ä½ è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ•´ä¸ªç³»ç»ŸåŒ…æ‹¬ç®¡ç†ç³»ç»Ÿ, API å’Œ UI. ä½ ä¸€æ—¦å†³å®šä»˜é’±, ä½ æœ€å¥½å¯ä»¥ä¸€ç›´ä»˜é’±.\n\n### æ€»ç»“\n\nç»ˆäºçœ‹å®Œäº†, çœŸçš„æ˜¯åˆè‡­åˆé•¿å•Š. å›é¡¾ä¸€ä¸‹è¿™ç¯‡æ–‡ç« , æ€»ä½“æ¥è¯´æ˜¯ç»å†äº†è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹:\n\n1. ä¸“æœ‰æœåŠ¡å™¨\n2. è™šæ‹ŸåŒ–æŠ€æœ¯\n3. åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)\n4. å¹³å°å³æœåŠ¡ (PaaS)\n5. å®¹å™¨å³æœåŠ¡ (CaaS)\n\næ€»ç»“ä¸€ä¸‹, æˆ‘è§‰å¾—å¼€å‘äººå‘˜è¿˜æ˜¯æœ‰å¿…è¦äº†è§£ä¸€ä¸‹å…³äºäº§å“éƒ¨ç½²ç›¸å…³çš„æŠ€æœ¯å‘å±•. ç„¶åæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥é€‰æ‹©åˆé€‚çš„æœåŠ¡æä¾›å•†.\n","slug":"ç»™å°ç™½è¯»çš„-WEB-æ‰˜ç®¡æœåŠ¡è¿›åŒ–å²","published":1,"updated":"2018-06-17T09:49:30.000Z","layout":"post","photos":[],"link":"","_id":"cjiitidjd000ou4q9ymolvx3x","content":"<p>è¿™ç¯‡æ–‡ç« æ˜¯æ¥æ‹“å±•è‡ªå·±çŸ¥è¯†é¢çš„, åœ¨æˆ‘è¯»é«˜ä¸­é‚£ä¼š (08 å¹´), æˆ‘èº«è¾¹å°±æœ‰æ²‰è¿·ç”µè„‘æŠ€æœ¯çš„åŒå­¦, é‚£ä¸ªæ—¶å€™æˆ‘æƒ³ç€åšä¸€ä¸ªè‡ªå·±çš„ç½‘ç«™, è‚¯å®šæ˜¯éå¸¸ç‰›é€¼çš„äº‹äº†. ä»æœ€å¼€å§‹æ¥è§¦çš„æœåŠ¡, ä¾æ¬¡æ¥æ’ä¸ªåº. æ°¸ç¡• E ç›˜ -&gt; å…è´¹ç©ºé—´å»ºç«™ (å›½å¤–å±…å¤š) -&gt; è™šæ‹Ÿç©ºé—´ -&gt; è™šæ‹ŸæœåŠ¡å™¨ (VPS) -&gt; ç‹¬ç«‹æœåŠ¡å™¨. çœ‹å®Œè¿™ç¯‡æ–‡ç« å, æˆ‘æ€»ç®—å¯¹è¿™æ–¹é¢çŸ¥è¯†æœ‰äº†ä¸€ä¸ªæ¯”è¾ƒç³»ç»Ÿæ€§çš„è®¤è¯†äº†. ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹.</p>\n<a id=\"more\"></a>\n<h3 id=\"å¼•å­\"><a href=\"#å¼•å­\" class=\"headerlink\" title=\"å¼•å­\"></a>å¼•å­</h3><p>æ–‡ç« å¼€å§‹ä¹‹å‰, æˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦æŠŠè¿™äº›ä¸“æœ‰åè¯å…ˆç§‘æ™®ä¸€ä¸‹, ä¸è¦è§‰å¾—å¾ˆé«˜å¤§ä¸Š, ç®€ç§°è€Œå·².</p>\n<ul>\n<li>IaaS - åŸºç¡€è®¾æ–½å³æœåŠ¡</li>\n<li>PaaS - å¹³å°å³æœåŠ¡</li>\n<li>CaaS - å®¹å™¨å³æœåŠ¡</li>\n</ul>\n<p>æœ¬æ–‡ä»‹ç»äº† Web æ‰˜ç®¡æœåŠ¡è¿›åŒ–çš„å†å², ä»ä¸“ç”¨æœåŠ¡å™¨åˆ°è™šæ‹ŸåŒ–åˆ° IaaSã€PaaS å’Œæœ€æ–°çš„ CaaS; è¯´æ˜äº†æ¯ç§æ–¹å¼çš„ä¼˜ç‚¹å’Œç¼ºç‚¹. ç€é‡é˜è¿°äº†æ„å»º PaaS åº”ç”¨çš„å„ä¸ªç»„ä»¶, ä»¥åŠåœ¨é€‰æ‹© CaaS æä¾›å•†æ—¶åº”è¯¥è€ƒè™‘çš„é—®é¢˜. æœ€åä»æˆæœ¬å’ŒåŠŸèƒ½æ€§çš„è§’åº¦è®ºè¿°äº† PaaS ç”¨æˆ·åº”è¯¥è¿ç§»åˆ° CaaS å¹³å°.</p>\n<p>è¯»å®Œè¿™ç¯‡åšæ–‡, ä½ åº”è¯¥å¯ä»¥æ¸…æ¥šçš„ç†è§£:</p>\n<ul>\n<li>è¿™äº›åè¯åˆ°åº•æŒ‡ä»€ä¹ˆ</li>\n<li>è¿™ä¸ºä»€ä¹ˆå¯¹ä½ å¾ˆé‡è¦</li>\n<li>å¯¹äºä½ çš„ä½¿ç”¨åœºæ™¯ï¼Œå“ªç§æ–¹å¼æœ€é€‚åˆ</li>\n</ul>\n<p>å½“ç„¶æ²¡æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿé€‚åˆæ‰€æœ‰çš„ Web åŸºç¡€è®¾æ–½çš„åœºæ™¯, ä½ çš„ç‰¹æ®Šåœºæ™¯æˆ–è®¸éœ€è¦ç‰¹æ®Šçš„è€ƒè™‘.</p>\n<h3 id=\"ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\"><a href=\"#ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\" class=\"headerlink\" title=\"ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\"></a>ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨</h3><p>Web æ‰˜ç®¡çš„æœ¬è´¨è¿˜æ˜¯åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒé‡Œå¸ƒæ»¡äº†æœåŠ¡å™¨ã€äº¤æ¢æœºã€è·¯ç”±å™¨ã€å­˜å‚¨é˜µåˆ—å’Œå…¶å®ƒç½‘ç»œç»„ä»¶. æˆ‘ä»¬æ‰€è®¨è®ºçš„æ¯ä¸€ä¸ªé€‰é¡¹ä¸ç®¡å®ƒæ˜¯ PaaSã€IaaS è¿˜æ˜¯ CaaS, å®ƒåº•å±‚ä½¿ç”¨çš„åŸºç¡€è®¾æ–½éƒ½æ˜¯ç›¸åŒçš„, å³åœ¨ä¸€ä¸ªå¤§å±‹å­é‡Œçš„å¾ˆå¤šç‹¬ç«‹æœåŠ¡å™¨. ä»–ä»¬åªæ˜¯ä¸Šé¢å¢åŠ äº†å¾ˆå¤šæŠ½è±¡å±‚ä½¿å¾—ç®¡ç†å˜å¾—æ›´ç®€å•, å’Œä½¿ç”¨è‡ªåŠ¨åŒ–çš„æ–¹å¼å¤„ç†ä»¥å‰å¾ˆæ…¢æˆ–è€…éœ€è¦æ‰‹åŠ¨æ­¥éª¤çš„ä»»åŠ¡.</p>\n<p>ä¸“ç”¨æœåŠ¡å™¨, æˆ–è€…å«åš â€œè£¸æœºâ€ æœ‰å®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹.</p>\n<h4 id=\"ä¼˜ç‚¹\"><a href=\"#ä¼˜ç‚¹\" class=\"headerlink\" title=\"ä¼˜ç‚¹\"></a>ä¼˜ç‚¹</h4><ul>\n<li>æ€§èƒ½â€”â€”ä½ åœ¨ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœåŠ¡å™¨, æ²¡æœ‰ä»»ä½•æŠ½è±¡å±‚ä¾‹å¦‚è™šæ‹ŸåŒ–å¸¦æ¥çš„æ€§èƒ½å¼€é”€.</li>\n<li>å¯é æ€§â€”â€”æ²¡æœ‰æŠ½è±¡å±‚å’Œè™šæ‹ŸåŒ–, å‡ºé”™çš„å¯èƒ½æ€§ä¼šé™ä½.</li>\n<li>èµ„æºåˆ©ç”¨ç‡â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, ä½ çš„è¿›ç¨‹ä¸éœ€è¦è·Ÿå…¶å®ƒçš„è™šæ‹Ÿæœºæˆ–è€…è¿›ç¨‹ç«äº‰èµ„æºä¾‹å¦‚ CPUã€å†…å­˜å’Œå¸¦å®½.</li>\n</ul>\n<h4 id=\"ç¼ºç‚¹\"><a href=\"#ç¼ºç‚¹\" class=\"headerlink\" title=\"ç¼ºç‚¹\"></a>ç¼ºç‚¹</h4><ul>\n<li>ç®¡ç†å¤æ‚æ€§â€”â€”ä½ æ— æ³•å®¹æ˜“åœ°å…‹éš†ä¸“ç”¨æœåŠ¡å™¨æ¥äº§ç”Ÿæ›´å¤šçš„å®ä¾‹, ä¸“ç”¨æœåŠ¡å™¨æ²¡æœ‰ AMIï¼ˆè¯‘è€…æ³¨: Amazon Machine Imageï¼‰æˆ–è€…é•œåƒçš„æ¦‚å¿µ. æƒ³æ‰©å±•ä½ çš„åŸºç¡€è®¾æ–½åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Ÿæˆ‘å¸Œæœ›ä½ ç”¨é…ç½®ç®¡ç†, æˆ–è€…ä½¿ç”¨å¯ä¿¡èµ–çš„è€æœ‹å‹ rsync.</li>\n<li>æˆæœ¬â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½ éœ€è¦é¢„å…ˆæ”¯ä»˜æœåŠ¡å™¨çš„ç¡¬ä»¶ä»·æ ¼, ç„¶åå†ä»˜ç§Ÿç”¨åœºåœ°çš„æˆæœ¬, æˆ–è€…ä½ ä»ä¸€ä¸ªæœåŠ¡æä¾›å•†é‚£é‡Œç§Ÿèµå®ƒä»¬. æ— è®ºå“ªç§æ–¹å¼, ä½ éƒ½æ²¡æ³•åœ¨ä¸ä½¿ç”¨æ—¶ç»ˆæ­¢æœåŠ¡å™¨çš„ç§Ÿèµæ¥èŠ‚çœæˆæœ¬, å› æ­¤ä½ éœ€è¦æ›´åŠ è°¨æ…çš„å¯¹å¾…ä½ çš„è´¢åŠ¡è®¡åˆ’.</li>\n<li>ä½ æ‰€æœ‰çš„è¿›ç¨‹å’Œåº”ç”¨éƒ½è¿è¡Œåœ¨ä¸“ç”¨æœåŠ¡å™¨ä¸Š, å› æ­¤è¿è¡Œåœ¨ç›¸åŒçš„æ“ä½œç³»ç»Ÿä¸Š. ä¸ºäº†å¯æ‰©å±•æ€§çš„ç›®çš„, ä½ å¾€å¾€å¸Œæœ›æœåŠ¡å™¨åªè¿è¡Œå•ä¸€çš„è¿›ç¨‹, ä¾‹å¦‚ Web æœåŠ¡æˆ–è€…æ•°æ®åº“æœåŠ¡. åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œæ‰€æœ‰çš„åº”ç”¨ä½¿å¾—æ“ä½œç³»ç»Ÿçš„è°ƒä¼˜å˜å¾—æ›´å›°éš¾.</li>\n</ul>\n<h3 id=\"ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\"><a href=\"#ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\" class=\"headerlink\" title=\"ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\"></a>ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–</h3><p>å°½ç®¡ä¸“ç”¨æœåŠ¡å™¨æœ‰å¾ˆå¤šä¼˜ç‚¹, ä½†æ˜¯å®ƒçš„ç¼ºç‚¹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè¿œè¿œè¶…è¿‡å…¶ä¼˜ç‚¹. å…¬å¸ä¸ºäº†èƒ½å¤Ÿè¿…é€Ÿè¿›å…¥å¸‚åœºèµ¢å¾—ç«äº‰, å¯¹äºéƒ¨ç½²çš„é€Ÿåº¦æå‡ºäº†æ›´é«˜çš„è¦æ±‚, è™šæ‹ŸåŒ–å°±å¾ˆè‡ªç„¶çš„æˆä¸ºäº†æ•°æ®ä¸­å¿ƒè¿›åŒ–ä¸­çš„ä¸‹ä¸€ä¸ªæ­¥éª¤.</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\"><a href=\"#ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\"></a>ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–</h4><p>ç®€è€Œè¨€ä¹‹, è™šæ‹ŸåŒ–å°±æ˜¯å°†ç‰©ç†æœåŠ¡å™¨åˆ†æˆæ›´å°çš„è™šæ‹Ÿæœº, è¿™äº›è™šæ‹Ÿæœºåªèƒ½è®¿é—®ç‰©ç†æœºçš„éƒ¨åˆ†èµ„æº. ä¾‹å¦‚ä½ æœ‰ä¸€ä¸ª 8CPU æ ¸ä»¥åŠ 16GB å†…å­˜çš„ç‰©ç†æœåŠ¡å™¨, åˆ™å¯ä»¥å°†å®ƒåˆ†æˆ 8 ä¸ªè™šæ‹Ÿæœº, æ¯ä¸ªè™šæ‹Ÿæœºæœ‰ 1 ä¸ª CPU å’Œ 2GB å†…å­˜. ä½ æˆ–è®¸å·²ç»å¬è¯´è¿‡ä¸€äº›è™šæ‹ŸåŒ–æŠ€æœ¯å¦‚ Xen, KVM, VMware å’Œ Hyper-V, å…¶å®å¾ˆæœ‰æ›´å¤š.</p>\n<h4 id=\"ä¼˜ç‚¹-1\"><a href=\"#ä¼˜ç‚¹-1\" class=\"headerlink\" title=\"ä¼˜ç‚¹\"></a>ä¼˜ç‚¹</h4><ul>\n<li>ä½ å¯ä»¥åœ¨éœ€è¦æ›´å¤šè™šæ‹Ÿæœºå®ä¾‹æˆ–è€…æƒ³è¦è™šæ‹Ÿæœºå…±äº«æ—¶è¿›è¡Œè™šæ‹Ÿæœºçš„å…‹éš†.</li>\n<li>ä½ å¯ä»¥å¤‡ä»½è™šæ‹Ÿæœºé•œåƒä½œä¸ºå®‰å…¨ä¿æŠ¤æˆ–è€…ç¾å¤‡.</li>\n</ul>\n<h4 id=\"ç¼ºç‚¹-1\"><a href=\"#ç¼ºç‚¹-1\" class=\"headerlink\" title=\"ç¼ºç‚¹\"></a>ç¼ºç‚¹</h4><ul>\n<li>ä½¿ç”¨è™šæ‹ŸåŒ–æ„å‘³ç€é¢å¤–çš„æ€§èƒ½å¼€é”€, å¯èƒ½é€ æˆæ€§èƒ½ä¸‹é™.</li>\n<li>è™šæ‹Ÿæœºé•œåƒåœ¨ä¸åŒçš„æœåŠ¡æä¾›å•†å’Œè™šæ‹ŸåŒ–æŠ€æœ¯ä¹‹é—´åŸºæœ¬ä¸Šæ˜¯ä¸å¯ç§»æ¤çš„.</li>\n<li>ç®¡ç†è™šæ‹Ÿæœºä¾ç„¶æ˜¯æ‰‹å·¥æ­¥éª¤, éœ€è¦ç®¡ç†çš„æ—¶é—´å’Œä¸“ä¸šçŸ¥è¯†.</li>\n</ul>\n<h3 id=\"è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ-IaaS\"><a href=\"#è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ-IaaS\" class=\"headerlink\" title=\"è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ (IaaS)\"></a>è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ (IaaS)</h3><p>ä½ çŸ¥é“ <a href=\"http://www.businessinsider.com/people-think-stormy-weather-affects-cloud-computing-2012-8\" target=\"_blank\" rel=\"noopener\">51% çš„äººè®¤ä¸º â€œäº‘â€ ä¼šè¢«å¤©æ°”å½±å“å—</a>ï¼Ÿä½ çŸ¥é“å½“äººä»¬è°ˆè®º â€œäº‘â€ æ—¶ä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºåŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS) å—ï¼Ÿ</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡-IaaS\"><a href=\"#ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡-IaaS\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)\"></a>ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)</h4><ul>\n<li>é€šè¿‡ API æ¥ç®¡ç†ç¡¬ä»¶çš„è™šæ‹ŸåŒ–.</li>\n<li>é€šè¿‡ç¼–ç¨‹æ¥å£è®¿é—®è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºå’Œé…ç½®.</li>\n<li>å½“ä½ éœ€è¦æ˜¯ç”³è¯·ä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœº, å½“ä½ å®Œæˆåç»ˆæ­¢è™šæ‹Ÿæœº, ä½ åªéœ€è¦ä¸ºä½ ä½¿ç”¨çš„èµ„æºä»˜è´¹.</li>\n<li>å°†æ•°æ®ä¸­å¿ƒèµ„æºè§†ä¸ºå…¬å…±è®¾æ–½.</li>\n</ul>\n<p>äºšé©¬é€Šåœ¨ 2006 å¹´å‘å¸ƒäº†å…¶ Amazon Web Servicesï¼ˆAWSï¼‰å’Œ EC2 äº§å“ï¼Œæˆä¸ºäº†è¿™ä¸ªé¢†åŸŸçš„å…ˆé©±ã€‚</p>\n<h4 id=\"ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\"><a href=\"#ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\"></a>ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦</h4><p>åœ¨è¿‡å»å½“ä½ éœ€è¦ä¸Šçº¿ä¸€ä¸ªåœ¨çº¿ä¸šåŠ¡æ—¶, ä½ ä¸å¾—ä¸è¿›è¡Œå¤æ‚çš„è®¡åˆ’æ¥ä¿è¯ä½ åœ¨æ•°æ®ä¸­å¿ƒå†…æœ‰è¶³å¤Ÿçš„æœºæ¶ç©ºé—´ã€è¶³å¤Ÿçš„æœåŠ¡å™¨å’Œå­˜å‚¨æ¥å¤„ç†ä¸šåŠ¡çš„å¢é•¿, è¶³å¤Ÿçš„ç½‘ç»œå¸¦å®½æ¥å¤„ç†æ‰€æœ‰çš„ç”¨æˆ·æµé‡. è¿™ç§è®¡åˆ’å¹¶ä¸å®¹æ˜“, å°¤å…¶æ˜¯å¯¹æ—©æœŸçš„ä¸šåŠ¡æ¥è®², ä½ æ— æ³•é¢„æµ‹ä¸šåŠ¡çš„æœªæ¥å’Œå¢é•¿è½¨è¿¹.</p>\n<ol>\n<li>å®ƒç»™äº†å¼€å‘è€…è¶…èƒ½é‡:<ul>\n<li>æ„æ€ä¸€ä¸ªæƒ³æ³•ç«‹å³ä¸Šçº¿.</li>\n<li>å¦‚æœæˆåŠŸäº†, å¯ä»¥å®¹æ˜“çš„æ‰©å±•è§„æ¨¡.</li>\n<li>å¦‚æœå¤±è´¥äº†, å…³é—­è™šæ‹Ÿæœºä»¥èŠ‚çº¦æˆæœ¬.</li>\n</ul>\n</li>\n<li>å®ƒä½¿å¾—æ•°æ®ä¸­å¿ƒè‡ªåŠ¨åŒ–å˜å¾—æ›´å¼ºå¤§:<ul>\n<li>å…¨è‡ªåŠ¨åŸºç¡€è®¾æ–½ç®¡ç†æˆä¸ºå¯èƒ½, å‡ºç°äº† â€œåŸºç¡€è®¾æ–½å³ä»£ç â€ çš„æ¦‚å¿µ.</li>\n<li>å¼¹æ€§ä¼¸ç¼©åœ¨è¿‡å»æ˜¯ä¸å¯èƒ½å®ç°çš„, ä½†æ˜¯ç°åœ¨ web åŸºç¡€è®¾æ–½å¯ä»¥å½“ä¸šåŠ¡å˜åŒ–æ—¶è‡ªåŠ¨çš„æ‰©å±•æˆ–è€…æ”¶ç¼©.</li>\n<li>åœ¨æœåŠ¡å™¨çš„è‡ªåŠ¨åŒ–ç®¡ç†ä¹‹å, æ•°æ®ä¸­å¿ƒçš„è‡ªåŠ¨åŒ–ä¹Ÿæ‰©å±•åˆ°äº†å­˜å‚¨ã€ç½‘ç»œä»¥åŠå…¶å®ƒå¤§é‡çš„éœ€è¦ä¸“ä¸šçŸ¥è¯†çš„ç³»ç»Ÿ, åœ¨ä»£ç å’Œ API èƒ½å¤Ÿå¤„ç†è¿™äº›è‡ªåŠ¨åŒ–ä¹‹å, è¿™ç»™å…¨çƒçš„å¼€å‘è€…ç¤¾åŒºå¸¦æ¥äº†æ–°çš„æœºé‡.</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡-PaaS\"><a href=\"#è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡-PaaS\" class=\"headerlink\" title=\"è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡ (PaaS)\"></a>è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡ (PaaS)</h3><p>å¹³å°å³æœåŠ¡ (PaaS) ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“çš„éƒ¨ç½²å’Œç®¡ç†åº”ç”¨è€Œéšè—æ‰æ‰€æœ‰çš„å®ç°ç»†èŠ‚ä¾‹å¦‚æœåŠ¡å™¨ã€è´Ÿè½½å‡è¡¡å™¨ã€DNS ç­‰ç­‰. ä»–ä»¬æˆ–å¤šæˆ–å°‘çš„å»é™¤äº†å¯¹è¿ç»´å›¢é˜Ÿçš„éœ€æ±‚, è€Œæ˜¯è®©å¼€å‘äººå‘˜å»å…³æ³¨åº”ç”¨éƒ¨ç½². æœ‰å¾ˆå¤š PaaS æä¾›å•†, å…¶ä¸­ä¸€ä¸ªæœ€æµè¡Œçš„æ˜¯ Heroku. å…³äº Heroku çš„ä¸€ä¸ªæœ‰è¶£çš„äº‹æƒ…æ˜¯ Heroku å®Œå…¨æ˜¯è¿è¡Œåœ¨ AWS ä¹‹ä¸Šå¹¶ä¾èµ– AWS çš„. å¦‚æœä½ ä¸æ„¿æ„ä½ çš„åº”ç”¨è¿è¡Œåœ¨ç¾å›½ä¸œéƒ¨æˆ–è€…æ¬§æ´²è¥¿éƒ¨çš„ AWS ä¸Šçš„è¯, è¿™æˆ–è®¸æ˜¯ä¸€ä¸ªé—®é¢˜. æ²¡æœ‰ IaaS, åƒ Heroku è¿™æ ·çš„å¹³å°å¯èƒ½å°±ä¸ä¼šå­˜åœ¨äº†. PaaS æä¾›å•†åˆ©ç”¨ IaaS ä½œä¸ºä¸€ä¸ªéå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†æ¥äº¤ä»˜å®ƒä»¬çš„æœåŠ¡. åœ¨å‡å°‘ä»æƒ³æ³•åˆ°éƒ¨ç½²çš„æ—¶é—´ã€è‡ªåŠ¨åŒ–æµç¨‹ä»¥åŠå‡å°‘ç‰¹æ®Šçš„ç³»ç»ŸçŸ¥è¯†éœ€æ±‚çš„è¶‹åŠ¿ä¸­, PaaS æ˜¯åˆç†çš„ä¸‹ä¸€æ­¥, å°±åƒæ˜¯ä»ä¸“ç”¨æœåŠ¡å™¨åˆ° IaaS ä¸€æ ·.</p>\n<h4 id=\"æ„å»º-PaaS-æ˜¯å›°éš¾çš„\"><a href=\"#æ„å»º-PaaS-æ˜¯å›°éš¾çš„\" class=\"headerlink\" title=\"æ„å»º PaaS æ˜¯å›°éš¾çš„\"></a>æ„å»º PaaS æ˜¯å›°éš¾çš„</h4><p>èƒ½å¤Ÿé€šè¿‡æŠ½è±¡è€Œé¿å…å¤„ç†æœåŠ¡å™¨ç›¸å…³çš„é—®é¢˜æ˜¯ä¸å®¹æ˜“çš„, éœ€è¦å¼•å…¥å¾ˆå¤šä¸œè¥¿æ‰èƒ½åšåˆ°.</p>\n<p>åœ¨ PaaS çš„æ¦‚å¿µä¹‹ä¸‹æœ‰å‡ ä¸ªä¸»è¦çš„æ¨¡å—ï¼š</p>\n<ul>\n<li>ç¼–è¯‘ç³»ç»Ÿâ€”â€”æŠŠä½ çš„ä»£ç ç¼–è¯‘æˆå¯ä»¥è¿è¡Œçš„åº”ç”¨, å¹¶ä¸”æŠŠå®ƒå­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ä½œä¸ºåç»­ä½¿ç”¨.</li>\n<li>åº”ç”¨ç®¡ç†æ•°æ®åº“â€”â€”ç®¡ç† Git ç‰ˆæœ¬ã€build ç‰ˆæœ¬å’Œåº”ç”¨å…ƒæ•°æ®.</li>\n<li>é›†ç¾¤è°ƒåº¦å™¨â€”â€”å°†ä¸€ç»„æœåŠ¡å™¨ä½œä¸ºä¸€å°å¤§çš„æœåŠ¡å™¨æ¥ç®¡ç†, åœ¨æœåŠ¡å™¨èµ„æºæ± çš„æŸä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œä½ çš„ç¨‹åº, å¹¶æ£€æŸ¥å’Œæ›¿æ¢å¤±æ•ˆçš„ä½œä¸š.</li>\n<li>è´Ÿè½½å‡è¡¡â€”â€”å…è®¸ä» Internet å’Œå†…éƒ¨ç¨‹åºæ¥çš„ä¸šåŠ¡è´Ÿè½½è¢«æ­£ç¡®çš„è·¯ç”±åˆ°åˆé€‚çš„ä½ç½®.</li>\n<li>DNSâ€”â€”åœ¨ä½ äº§ç”Ÿå’Œä¿®æ”¹åº”ç”¨æ—¶è‡ªåŠ¨é…ç½® DNS æ¡ç›®.</li>\n<li>æˆ–è®¸æ˜¯æœ€é‡è¦çš„â€”â€”æŸä¸ªå½¢å¼çš„å®¹å™¨åŒ–ä¾‹å¦‚â€Š freebsd jailsã€solaris zonesã€æˆ–è€… linux containers, å®¹å™¨åŒ–ä½¿å¾—æŸä¸ªçš„åº”ç”¨ä¸ä¼šè¿›å…¥å’Œå½±å“åˆ°å…¶å®ƒçš„åº”ç”¨.</li>\n</ul>\n<p>ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç‚¹æ˜¯ Docker è¿…é€Ÿå‘å±•çš„éå¸¸é‡è¦çš„åŸå› . Linux å®¹å™¨æŠ€æœ¯å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´äº†, ä½†æ˜¯åªæœ‰æŸäº›å¤§çš„å…¬å¸æˆ–è€… PaaS æä¾›å•†è‡ªåŠ¨åŒ–äº†å®¹å™¨çš„ä½¿ç”¨, Docker ä½¿ Linux å®¹å™¨çš„ä½¿ç”¨å˜å¾—éå¸¸ç®€å•, ä¹Ÿæä¾›äº†æ ‡å‡†åŒ–çš„é•œåƒæ ¼å¼, å®ƒæˆä¸ºäº† PaaS ä¸­é‡è¦çš„ç»„æˆéƒ¨åˆ†.</p>\n<p>è¿™éå¸¸å¼ºå¤§, å› ä¸ºå¾ˆå¤šå…¬å¸åœ¨å¤„ç†çˆ†å‘å¼çš„ç”¨æˆ·å¢é•¿, æ¥è‡ªäºç§»åŠ¨ã€ç¤¾äº¤å’Œ IoT çš„æ–°çš„ä¸šåŠ¡æ¨¡å¼, ä»¥åŠæœŸæœ›ä»ä¼ ç»Ÿçš„é•¿çš„ç‰ˆæœ¬å‘å¸ƒå‘¨æœŸè½¬å˜åˆ°æŒç»­äº¤ä»˜. ä»–ä»¬åˆ©ç”¨åŸºäºè½¯ä»¶çš„æ¶æ„æˆ–è€…å¾®æœåŠ¡. ä»–ä»¬éœ€è¦èƒ½å¤Ÿè‡ªåŠ¨éƒ¨ç½²å’Œæµ‹è¯•æ–°çš„ä»£ç , å¹¶æ ¹æ®ä¸šåŠ¡çš„å˜åŒ–å¼¹æ€§ä¼¸ç¼©. ä½†é—®é¢˜æ˜¯ä»–ä»¬æ²¡æœ‰è¶³å¤Ÿçš„èµ„æºå’Œç»éªŒæ¥äº¤ä»˜åˆ°ä»–ä»¬çš„å¼€å‘å›¢é˜Ÿ, æ‰€ä»¥ä»–ä»¬ä¸å¾—ä¸å°†å…¶å¤–åŒ…ç»™ PaaS æä¾›å•†. ä¸å¹¸çš„æ˜¯, å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™, ä½ å°±æ”¾å¼ƒäº†å¯¹äºè¿™ä¸ªé»‘ç›’å­çš„å¾ˆå¤šæ§åˆ¶, è€Œæ˜¯èŠ±å¾ˆå¤šé’±å¹¶ä½¿å¾—è‡ªå·±å®Œå…¨ä¾èµ–äºå®ƒ. å¦å¤–ä¸€ä¸ªé€‰é¡¹æ˜¯, å¾ˆå¤šå…¬å¸åå¤çš„é‡æ–°å‘æ˜è½®å­æˆ–è€…ä½¿ç”¨é‚£äº›éš¾äºç»´æŠ¤çš„ã€è¿è¡Œç¼“æ…¢çš„å’Œæ˜“äºå‡ºé”™çš„å·¥å…·.</p>\n<p>æœ€å¥½çš„æƒ…å½¢æ˜¯åœ¨è‡ªå·±çš„æ•°æ®ä¸­å¿ƒæˆ–è€… Cloud å¸å·ä¸­è¿è¡Œä¸€ä¸ª PaaS å¹³å°, ä½ å¯ä»¥å…¨æƒæ§åˆ¶, ä½ çš„å›¢é˜Ÿå¯ä»¥ç›´æ¥å‚ä¸åº”ç”¨çš„éƒ¨ç½², å› æ­¤å¯ä»¥å½¢æˆä¸€ç§çœŸæ­£çš„ DevOps æ–‡åŒ–. Docker åŠå…¶æ ‡å‡†åŒ–çš„ç”Ÿæ€ç³»ç»Ÿæ˜¯è¿™ç§æ„¿æ™¯æˆä¸ºç°å®çš„é‡è¦ä¸€æ­¥.</p>\n<h3 id=\"æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å°-CaaS\"><a href=\"#æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å°-CaaS\" class=\"headerlink\" title=\"æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å° (CaaS)\"></a>æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å° (CaaS)</h3><p>ä»€ä¹ˆæ˜¯å®¹å™¨æ‰˜ç®¡å¹³å°, æˆ–è€…å«å®¹å™¨å³æœåŠ¡å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘åœ¨ä¸Šé¢çš„ç« èŠ‚ä¸­æåˆ°çš„å¦å¤–ä¸€ç§æ„å»ºåœ¨ Docker åŸºç¡€ä¸Šçš„ Web æ‰˜ç®¡æ–¹å¼. å®ƒæ˜¯ä½ ç”¨å®¹å™¨æ¥éƒ¨ç½²å¤æ‚çš„å¤šå±‚æ¬¡çš„åº”ç”¨æ‰€éœ€è¦çš„è‡ªåŠ¨åŒ–çš„ç¼–è¯‘ç³»ç»Ÿ, é›†ç¾¤è°ƒåº¦å™¨, è´Ÿè½½å‡è¡¡, DNS è‡ªåŠ¨åŒ–ä»¥åŠæœåŠ¡å‘ç°. è¿™æ˜¯ PaaS çš„å¦å¤–ä¸€éƒ¨åˆ†å†…å®¹, ä½†æ˜¯ä½ ä¸æ˜¯ç”¨ä¸€ä¸ªå¤æ‚çš„ç¼–è¯‘ç³»ç»Ÿæ¥ç¼–è¯‘ä½ çš„åº”ç”¨, è€Œæ˜¯ç”¨ Docker é•œåƒ. é•œåƒå¯ä»¥éå¸¸å®¹æ˜“çš„è¿›è¡Œç¼–è¯‘å’Œæœ¬åœ°æµ‹è¯•, å› æ­¤ä½ åœ¨éƒ¨ç½²åº”ç”¨ä¹‹å‰å°±ç¡®è®¤åº”ç”¨å¯ä»¥æ­£å¸¸å·¥ä½œ. ç°åœ¨ PaaS ç”¨æˆ·ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ä½“éªŒ, ä½†æ˜¯ä¸éœ€è¦æ‹¥æœ‰è‡ªå·±çš„ç¡¬ä»¶æˆ–è€…äº‘å¸å·çš„å‰æä¸‹èŠ‚çº¦å¤§é‡çš„æˆæœ¬. ä»–ä»¬ä¸å†å—é™äºå…¶æœåŠ¡æä¾›å•†æ‰€æ”¯æŒçš„ç¯å¢ƒ, å¯ä»¥é€šè¿‡å°†åº”ç”¨æ‰“åŒ…æˆ Docker é•œåƒçš„æ–¹å¼åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œ.</p>\n<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, åˆ©ç”¨è¯¸å¦‚ ContainerShip Cloud, ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹, åœ¨ä»»ä½•äº‘å¹³å°ä¸Šç”šè‡³æ˜¯è£¸æœºä¸Šç”¨ç›¸åŒçš„æ–¹å¼è¿è¡Œä½ çš„åº”ç”¨. ä½ ä¸å†è¢«å¡åœ¨æ„å»ºå¤æ‚çš„åº”ç”¨æ¥è§£å†³éå¸¸å›°éš¾çš„é—®é¢˜, æˆ–è€…å¡åœ¨ä½¿ç”¨æŸä¸ªæä¾›å•†çš„ç‰¹æ®Šçš„è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·ä¸Š.</p>\n<ul>\n<li>ä½†æ˜¯é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„ Docker å®¹å™¨æ‰˜ç®¡å¹³å°å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…, æœ‰å¾ˆå¤šçš„é—®é¢˜éœ€è¦ä½ å»æ€è€ƒå’Œæ³¨æ„.</li>\n<li>æœ‰å¤§é‡çš„é€‰é¡¹, å› æ­¤é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›è¡Œç ”ç©¶å°±å˜å¾—å›°éš¾. å¥½æ¶ˆæ¯æ˜¯å¦‚æœä½ çš„åº”ç”¨å·²ç»å®¹å™¨åŒ–, ä½ å°±å¯ä»¥è½»æ¾çš„æµ‹è¯•å…¶ä¸­çš„æ¯ä¸€ä¸ª.</li>\n<li>ä½ æ­£åœ¨ä½¿ç”¨çš„æœåŠ¡æä¾›å•†ä¾‹å¦‚ Triton æˆ–è€… ECS çš„æŸä¸ªè§£å†³æ–¹æ¡ˆæˆ–è®¸ä½¿å¾—ä½ æ— æ³•è„±ç¦»è¿™ä¸ªæä¾›å•†, è¿™ä¹Ÿä½¿å¾— Docker çš„æœ€ä»¤äººå…´å¥‹çš„å¯ç§»æ¤æ€§å˜å¾—ä¸é‚£ä¹ˆé‡è¦äº†.</li>\n<li>è®¸å¤š CaaS æ–¹æ¡ˆåœ¨ä»–ä»¬è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ‰€æœ‰çš„ç®¡ç†ç³»ç»Ÿ, ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šåªæ˜¯è¿è¡ŒæŸä¸ªä»£ç†ç¨‹åºæ¥è¿æ¥ä»–ä»¬çš„ API, å› æ­¤å¦‚æœä»–ä»¬çš„ç³»ç»Ÿå®•æœºåä½ çš„é›†ç¾¤å°†æ— æ³•å·¥ä½œ.</li>\n<li>å…è®¸ä½ åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆæ˜¯éå¸¸å¤æ‚çš„, éœ€è¦ä¸€ä¸ªå›¢é˜Ÿå»ç®¡ç†å’Œå‡çº§.</li>\n<li>èƒ½å¤Ÿå®¹æ˜“çš„åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆä¼šä½¿å¾—é«˜å¯ç”¨æˆä¸ºä½ä¼˜å…ˆçº§çš„äº‹æƒ….</li>\n<li>å½“ä½ é€‰æ‹©äº†ä¸€ä¸ª CaaS æä¾›å•†æ—¶, ä½ å°±å¯ä»¥æ‘†è„±äº†ä½ çš„æœåŠ¡æ‰˜ç®¡æä¾›å•†çš„é”å®š, ä½†æ˜¯ä½ å°†é™·å…¥åˆ° CaaS æä¾›å•†çš„é”å®š. ä½ æ— æ³•ä¸ä½¿ç”¨ä»–ä»¬çš„ SaaS ç®¡ç†æ¥å£è€Œåœ¨ä½ è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ•´ä¸ªç³»ç»ŸåŒ…æ‹¬ç®¡ç†ç³»ç»Ÿ, API å’Œ UI. ä½ ä¸€æ—¦å†³å®šä»˜é’±, ä½ æœ€å¥½å¯ä»¥ä¸€ç›´ä»˜é’±.</li>\n</ul>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>ç»ˆäºçœ‹å®Œäº†, çœŸçš„æ˜¯åˆè‡­åˆé•¿å•Š. å›é¡¾ä¸€ä¸‹è¿™ç¯‡æ–‡ç« , æ€»ä½“æ¥è¯´æ˜¯ç»å†äº†è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹:</p>\n<ol>\n<li>ä¸“æœ‰æœåŠ¡å™¨</li>\n<li>è™šæ‹ŸåŒ–æŠ€æœ¯</li>\n<li>åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)</li>\n<li>å¹³å°å³æœåŠ¡ (PaaS)</li>\n<li>å®¹å™¨å³æœåŠ¡ (CaaS)</li>\n</ol>\n<p>æ€»ç»“ä¸€ä¸‹, æˆ‘è§‰å¾—å¼€å‘äººå‘˜è¿˜æ˜¯æœ‰å¿…è¦äº†è§£ä¸€ä¸‹å…³äºäº§å“éƒ¨ç½²ç›¸å…³çš„æŠ€æœ¯å‘å±•. ç„¶åæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥é€‰æ‹©åˆé€‚çš„æœåŠ¡æä¾›å•†.</p>\n","site":{"data":{}},"excerpt":"<p>è¿™ç¯‡æ–‡ç« æ˜¯æ¥æ‹“å±•è‡ªå·±çŸ¥è¯†é¢çš„, åœ¨æˆ‘è¯»é«˜ä¸­é‚£ä¼š (08 å¹´), æˆ‘èº«è¾¹å°±æœ‰æ²‰è¿·ç”µè„‘æŠ€æœ¯çš„åŒå­¦, é‚£ä¸ªæ—¶å€™æˆ‘æƒ³ç€åšä¸€ä¸ªè‡ªå·±çš„ç½‘ç«™, è‚¯å®šæ˜¯éå¸¸ç‰›é€¼çš„äº‹äº†. ä»æœ€å¼€å§‹æ¥è§¦çš„æœåŠ¡, ä¾æ¬¡æ¥æ’ä¸ªåº. æ°¸ç¡• E ç›˜ -&gt; å…è´¹ç©ºé—´å»ºç«™ (å›½å¤–å±…å¤š) -&gt; è™šæ‹Ÿç©ºé—´ -&gt; è™šæ‹ŸæœåŠ¡å™¨ (VPS) -&gt; ç‹¬ç«‹æœåŠ¡å™¨. çœ‹å®Œè¿™ç¯‡æ–‡ç« å, æˆ‘æ€»ç®—å¯¹è¿™æ–¹é¢çŸ¥è¯†æœ‰äº†ä¸€ä¸ªæ¯”è¾ƒç³»ç»Ÿæ€§çš„è®¤è¯†äº†. ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹.</p>","more":"<h3 id=\"å¼•å­\"><a href=\"#å¼•å­\" class=\"headerlink\" title=\"å¼•å­\"></a>å¼•å­</h3><p>æ–‡ç« å¼€å§‹ä¹‹å‰, æˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦æŠŠè¿™äº›ä¸“æœ‰åè¯å…ˆç§‘æ™®ä¸€ä¸‹, ä¸è¦è§‰å¾—å¾ˆé«˜å¤§ä¸Š, ç®€ç§°è€Œå·².</p>\n<ul>\n<li>IaaS - åŸºç¡€è®¾æ–½å³æœåŠ¡</li>\n<li>PaaS - å¹³å°å³æœåŠ¡</li>\n<li>CaaS - å®¹å™¨å³æœåŠ¡</li>\n</ul>\n<p>æœ¬æ–‡ä»‹ç»äº† Web æ‰˜ç®¡æœåŠ¡è¿›åŒ–çš„å†å², ä»ä¸“ç”¨æœåŠ¡å™¨åˆ°è™šæ‹ŸåŒ–åˆ° IaaSã€PaaS å’Œæœ€æ–°çš„ CaaS; è¯´æ˜äº†æ¯ç§æ–¹å¼çš„ä¼˜ç‚¹å’Œç¼ºç‚¹. ç€é‡é˜è¿°äº†æ„å»º PaaS åº”ç”¨çš„å„ä¸ªç»„ä»¶, ä»¥åŠåœ¨é€‰æ‹© CaaS æä¾›å•†æ—¶åº”è¯¥è€ƒè™‘çš„é—®é¢˜. æœ€åä»æˆæœ¬å’ŒåŠŸèƒ½æ€§çš„è§’åº¦è®ºè¿°äº† PaaS ç”¨æˆ·åº”è¯¥è¿ç§»åˆ° CaaS å¹³å°.</p>\n<p>è¯»å®Œè¿™ç¯‡åšæ–‡, ä½ åº”è¯¥å¯ä»¥æ¸…æ¥šçš„ç†è§£:</p>\n<ul>\n<li>è¿™äº›åè¯åˆ°åº•æŒ‡ä»€ä¹ˆ</li>\n<li>è¿™ä¸ºä»€ä¹ˆå¯¹ä½ å¾ˆé‡è¦</li>\n<li>å¯¹äºä½ çš„ä½¿ç”¨åœºæ™¯ï¼Œå“ªç§æ–¹å¼æœ€é€‚åˆ</li>\n</ul>\n<p>å½“ç„¶æ²¡æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿé€‚åˆæ‰€æœ‰çš„ Web åŸºç¡€è®¾æ–½çš„åœºæ™¯, ä½ çš„ç‰¹æ®Šåœºæ™¯æˆ–è®¸éœ€è¦ç‰¹æ®Šçš„è€ƒè™‘.</p>\n<h3 id=\"ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\"><a href=\"#ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\" class=\"headerlink\" title=\"ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨\"></a>ä»å¤´å¼€å§‹â€”â€”ä¸“ç”¨æœåŠ¡å™¨</h3><p>Web æ‰˜ç®¡çš„æœ¬è´¨è¿˜æ˜¯åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒé‡Œå¸ƒæ»¡äº†æœåŠ¡å™¨ã€äº¤æ¢æœºã€è·¯ç”±å™¨ã€å­˜å‚¨é˜µåˆ—å’Œå…¶å®ƒç½‘ç»œç»„ä»¶. æˆ‘ä»¬æ‰€è®¨è®ºçš„æ¯ä¸€ä¸ªé€‰é¡¹ä¸ç®¡å®ƒæ˜¯ PaaSã€IaaS è¿˜æ˜¯ CaaS, å®ƒåº•å±‚ä½¿ç”¨çš„åŸºç¡€è®¾æ–½éƒ½æ˜¯ç›¸åŒçš„, å³åœ¨ä¸€ä¸ªå¤§å±‹å­é‡Œçš„å¾ˆå¤šç‹¬ç«‹æœåŠ¡å™¨. ä»–ä»¬åªæ˜¯ä¸Šé¢å¢åŠ äº†å¾ˆå¤šæŠ½è±¡å±‚ä½¿å¾—ç®¡ç†å˜å¾—æ›´ç®€å•, å’Œä½¿ç”¨è‡ªåŠ¨åŒ–çš„æ–¹å¼å¤„ç†ä»¥å‰å¾ˆæ…¢æˆ–è€…éœ€è¦æ‰‹åŠ¨æ­¥éª¤çš„ä»»åŠ¡.</p>\n<p>ä¸“ç”¨æœåŠ¡å™¨, æˆ–è€…å«åš â€œè£¸æœºâ€ æœ‰å®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹.</p>\n<h4 id=\"ä¼˜ç‚¹\"><a href=\"#ä¼˜ç‚¹\" class=\"headerlink\" title=\"ä¼˜ç‚¹\"></a>ä¼˜ç‚¹</h4><ul>\n<li>æ€§èƒ½â€”â€”ä½ åœ¨ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœåŠ¡å™¨, æ²¡æœ‰ä»»ä½•æŠ½è±¡å±‚ä¾‹å¦‚è™šæ‹ŸåŒ–å¸¦æ¥çš„æ€§èƒ½å¼€é”€.</li>\n<li>å¯é æ€§â€”â€”æ²¡æœ‰æŠ½è±¡å±‚å’Œè™šæ‹ŸåŒ–, å‡ºé”™çš„å¯èƒ½æ€§ä¼šé™ä½.</li>\n<li>èµ„æºåˆ©ç”¨ç‡â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, ä½ çš„è¿›ç¨‹ä¸éœ€è¦è·Ÿå…¶å®ƒçš„è™šæ‹Ÿæœºæˆ–è€…è¿›ç¨‹ç«äº‰èµ„æºä¾‹å¦‚ CPUã€å†…å­˜å’Œå¸¦å®½.</li>\n</ul>\n<h4 id=\"ç¼ºç‚¹\"><a href=\"#ç¼ºç‚¹\" class=\"headerlink\" title=\"ç¼ºç‚¹\"></a>ç¼ºç‚¹</h4><ul>\n<li>ç®¡ç†å¤æ‚æ€§â€”â€”ä½ æ— æ³•å®¹æ˜“åœ°å…‹éš†ä¸“ç”¨æœåŠ¡å™¨æ¥äº§ç”Ÿæ›´å¤šçš„å®ä¾‹, ä¸“ç”¨æœåŠ¡å™¨æ²¡æœ‰ AMIï¼ˆè¯‘è€…æ³¨: Amazon Machine Imageï¼‰æˆ–è€…é•œåƒçš„æ¦‚å¿µ. æƒ³æ‰©å±•ä½ çš„åŸºç¡€è®¾æ–½åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Ÿæˆ‘å¸Œæœ›ä½ ç”¨é…ç½®ç®¡ç†, æˆ–è€…ä½¿ç”¨å¯ä¿¡èµ–çš„è€æœ‹å‹ rsync.</li>\n<li>æˆæœ¬â€”â€”ä½¿ç”¨ä¸“ç”¨æœåŠ¡å™¨, åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½ éœ€è¦é¢„å…ˆæ”¯ä»˜æœåŠ¡å™¨çš„ç¡¬ä»¶ä»·æ ¼, ç„¶åå†ä»˜ç§Ÿç”¨åœºåœ°çš„æˆæœ¬, æˆ–è€…ä½ ä»ä¸€ä¸ªæœåŠ¡æä¾›å•†é‚£é‡Œç§Ÿèµå®ƒä»¬. æ— è®ºå“ªç§æ–¹å¼, ä½ éƒ½æ²¡æ³•åœ¨ä¸ä½¿ç”¨æ—¶ç»ˆæ­¢æœåŠ¡å™¨çš„ç§Ÿèµæ¥èŠ‚çœæˆæœ¬, å› æ­¤ä½ éœ€è¦æ›´åŠ è°¨æ…çš„å¯¹å¾…ä½ çš„è´¢åŠ¡è®¡åˆ’.</li>\n<li>ä½ æ‰€æœ‰çš„è¿›ç¨‹å’Œåº”ç”¨éƒ½è¿è¡Œåœ¨ä¸“ç”¨æœåŠ¡å™¨ä¸Š, å› æ­¤è¿è¡Œåœ¨ç›¸åŒçš„æ“ä½œç³»ç»Ÿä¸Š. ä¸ºäº†å¯æ‰©å±•æ€§çš„ç›®çš„, ä½ å¾€å¾€å¸Œæœ›æœåŠ¡å™¨åªè¿è¡Œå•ä¸€çš„è¿›ç¨‹, ä¾‹å¦‚ Web æœåŠ¡æˆ–è€…æ•°æ®åº“æœåŠ¡. åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œæ‰€æœ‰çš„åº”ç”¨ä½¿å¾—æ“ä½œç³»ç»Ÿçš„è°ƒä¼˜å˜å¾—æ›´å›°éš¾.</li>\n</ul>\n<h3 id=\"ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\"><a href=\"#ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\" class=\"headerlink\" title=\"ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–\"></a>ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“â€”â€”è™šæ‹ŸåŒ–</h3><p>å°½ç®¡ä¸“ç”¨æœåŠ¡å™¨æœ‰å¾ˆå¤šä¼˜ç‚¹, ä½†æ˜¯å®ƒçš„ç¼ºç‚¹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè¿œè¿œè¶…è¿‡å…¶ä¼˜ç‚¹. å…¬å¸ä¸ºäº†èƒ½å¤Ÿè¿…é€Ÿè¿›å…¥å¸‚åœºèµ¢å¾—ç«äº‰, å¯¹äºéƒ¨ç½²çš„é€Ÿåº¦æå‡ºäº†æ›´é«˜çš„è¦æ±‚, è™šæ‹ŸåŒ–å°±å¾ˆè‡ªç„¶çš„æˆä¸ºäº†æ•°æ®ä¸­å¿ƒè¿›åŒ–ä¸­çš„ä¸‹ä¸€ä¸ªæ­¥éª¤.</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\"><a href=\"#ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–\"></a>ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–</h4><p>ç®€è€Œè¨€ä¹‹, è™šæ‹ŸåŒ–å°±æ˜¯å°†ç‰©ç†æœåŠ¡å™¨åˆ†æˆæ›´å°çš„è™šæ‹Ÿæœº, è¿™äº›è™šæ‹Ÿæœºåªèƒ½è®¿é—®ç‰©ç†æœºçš„éƒ¨åˆ†èµ„æº. ä¾‹å¦‚ä½ æœ‰ä¸€ä¸ª 8CPU æ ¸ä»¥åŠ 16GB å†…å­˜çš„ç‰©ç†æœåŠ¡å™¨, åˆ™å¯ä»¥å°†å®ƒåˆ†æˆ 8 ä¸ªè™šæ‹Ÿæœº, æ¯ä¸ªè™šæ‹Ÿæœºæœ‰ 1 ä¸ª CPU å’Œ 2GB å†…å­˜. ä½ æˆ–è®¸å·²ç»å¬è¯´è¿‡ä¸€äº›è™šæ‹ŸåŒ–æŠ€æœ¯å¦‚ Xen, KVM, VMware å’Œ Hyper-V, å…¶å®å¾ˆæœ‰æ›´å¤š.</p>\n<h4 id=\"ä¼˜ç‚¹-1\"><a href=\"#ä¼˜ç‚¹-1\" class=\"headerlink\" title=\"ä¼˜ç‚¹\"></a>ä¼˜ç‚¹</h4><ul>\n<li>ä½ å¯ä»¥åœ¨éœ€è¦æ›´å¤šè™šæ‹Ÿæœºå®ä¾‹æˆ–è€…æƒ³è¦è™šæ‹Ÿæœºå…±äº«æ—¶è¿›è¡Œè™šæ‹Ÿæœºçš„å…‹éš†.</li>\n<li>ä½ å¯ä»¥å¤‡ä»½è™šæ‹Ÿæœºé•œåƒä½œä¸ºå®‰å…¨ä¿æŠ¤æˆ–è€…ç¾å¤‡.</li>\n</ul>\n<h4 id=\"ç¼ºç‚¹-1\"><a href=\"#ç¼ºç‚¹-1\" class=\"headerlink\" title=\"ç¼ºç‚¹\"></a>ç¼ºç‚¹</h4><ul>\n<li>ä½¿ç”¨è™šæ‹ŸåŒ–æ„å‘³ç€é¢å¤–çš„æ€§èƒ½å¼€é”€, å¯èƒ½é€ æˆæ€§èƒ½ä¸‹é™.</li>\n<li>è™šæ‹Ÿæœºé•œåƒåœ¨ä¸åŒçš„æœåŠ¡æä¾›å•†å’Œè™šæ‹ŸåŒ–æŠ€æœ¯ä¹‹é—´åŸºæœ¬ä¸Šæ˜¯ä¸å¯ç§»æ¤çš„.</li>\n<li>ç®¡ç†è™šæ‹Ÿæœºä¾ç„¶æ˜¯æ‰‹å·¥æ­¥éª¤, éœ€è¦ç®¡ç†çš„æ—¶é—´å’Œä¸“ä¸šçŸ¥è¯†.</li>\n</ul>\n<h3 id=\"è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ-IaaS\"><a href=\"#è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ-IaaS\" class=\"headerlink\" title=\"è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ (IaaS)\"></a>è¿›åŒ–â€”â€”è™šæ‹ŸåŒ–å˜æˆ (IaaS)</h3><p>ä½ çŸ¥é“ <a href=\"http://www.businessinsider.com/people-think-stormy-weather-affects-cloud-computing-2012-8\" target=\"_blank\" rel=\"noopener\">51% çš„äººè®¤ä¸º â€œäº‘â€ ä¼šè¢«å¤©æ°”å½±å“å—</a>ï¼Ÿä½ çŸ¥é“å½“äººä»¬è°ˆè®º â€œäº‘â€ æ—¶ä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºåŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS) å—ï¼Ÿ</p>\n<h4 id=\"ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡-IaaS\"><a href=\"#ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡-IaaS\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)\"></a>ä»€ä¹ˆæ˜¯åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)</h4><ul>\n<li>é€šè¿‡ API æ¥ç®¡ç†ç¡¬ä»¶çš„è™šæ‹ŸåŒ–.</li>\n<li>é€šè¿‡ç¼–ç¨‹æ¥å£è®¿é—®è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºå’Œé…ç½®.</li>\n<li>å½“ä½ éœ€è¦æ˜¯ç”³è¯·ä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœº, å½“ä½ å®Œæˆåç»ˆæ­¢è™šæ‹Ÿæœº, ä½ åªéœ€è¦ä¸ºä½ ä½¿ç”¨çš„èµ„æºä»˜è´¹.</li>\n<li>å°†æ•°æ®ä¸­å¿ƒèµ„æºè§†ä¸ºå…¬å…±è®¾æ–½.</li>\n</ul>\n<p>äºšé©¬é€Šåœ¨ 2006 å¹´å‘å¸ƒäº†å…¶ Amazon Web Servicesï¼ˆAWSï¼‰å’Œ EC2 äº§å“ï¼Œæˆä¸ºäº†è¿™ä¸ªé¢†åŸŸçš„å…ˆé©±ã€‚</p>\n<h4 id=\"ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\"><a href=\"#ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦\"></a>ä¸ºä»€ä¹ˆè¿™ä¸ªè¿›åŒ–å¦‚æ­¤é‡è¦</h4><p>åœ¨è¿‡å»å½“ä½ éœ€è¦ä¸Šçº¿ä¸€ä¸ªåœ¨çº¿ä¸šåŠ¡æ—¶, ä½ ä¸å¾—ä¸è¿›è¡Œå¤æ‚çš„è®¡åˆ’æ¥ä¿è¯ä½ åœ¨æ•°æ®ä¸­å¿ƒå†…æœ‰è¶³å¤Ÿçš„æœºæ¶ç©ºé—´ã€è¶³å¤Ÿçš„æœåŠ¡å™¨å’Œå­˜å‚¨æ¥å¤„ç†ä¸šåŠ¡çš„å¢é•¿, è¶³å¤Ÿçš„ç½‘ç»œå¸¦å®½æ¥å¤„ç†æ‰€æœ‰çš„ç”¨æˆ·æµé‡. è¿™ç§è®¡åˆ’å¹¶ä¸å®¹æ˜“, å°¤å…¶æ˜¯å¯¹æ—©æœŸçš„ä¸šåŠ¡æ¥è®², ä½ æ— æ³•é¢„æµ‹ä¸šåŠ¡çš„æœªæ¥å’Œå¢é•¿è½¨è¿¹.</p>\n<ol>\n<li>å®ƒç»™äº†å¼€å‘è€…è¶…èƒ½é‡:<ul>\n<li>æ„æ€ä¸€ä¸ªæƒ³æ³•ç«‹å³ä¸Šçº¿.</li>\n<li>å¦‚æœæˆåŠŸäº†, å¯ä»¥å®¹æ˜“çš„æ‰©å±•è§„æ¨¡.</li>\n<li>å¦‚æœå¤±è´¥äº†, å…³é—­è™šæ‹Ÿæœºä»¥èŠ‚çº¦æˆæœ¬.</li>\n</ul>\n</li>\n<li>å®ƒä½¿å¾—æ•°æ®ä¸­å¿ƒè‡ªåŠ¨åŒ–å˜å¾—æ›´å¼ºå¤§:<ul>\n<li>å…¨è‡ªåŠ¨åŸºç¡€è®¾æ–½ç®¡ç†æˆä¸ºå¯èƒ½, å‡ºç°äº† â€œåŸºç¡€è®¾æ–½å³ä»£ç â€ çš„æ¦‚å¿µ.</li>\n<li>å¼¹æ€§ä¼¸ç¼©åœ¨è¿‡å»æ˜¯ä¸å¯èƒ½å®ç°çš„, ä½†æ˜¯ç°åœ¨ web åŸºç¡€è®¾æ–½å¯ä»¥å½“ä¸šåŠ¡å˜åŒ–æ—¶è‡ªåŠ¨çš„æ‰©å±•æˆ–è€…æ”¶ç¼©.</li>\n<li>åœ¨æœåŠ¡å™¨çš„è‡ªåŠ¨åŒ–ç®¡ç†ä¹‹å, æ•°æ®ä¸­å¿ƒçš„è‡ªåŠ¨åŒ–ä¹Ÿæ‰©å±•åˆ°äº†å­˜å‚¨ã€ç½‘ç»œä»¥åŠå…¶å®ƒå¤§é‡çš„éœ€è¦ä¸“ä¸šçŸ¥è¯†çš„ç³»ç»Ÿ, åœ¨ä»£ç å’Œ API èƒ½å¤Ÿå¤„ç†è¿™äº›è‡ªåŠ¨åŒ–ä¹‹å, è¿™ç»™å…¨çƒçš„å¼€å‘è€…ç¤¾åŒºå¸¦æ¥äº†æ–°çš„æœºé‡.</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡-PaaS\"><a href=\"#è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡-PaaS\" class=\"headerlink\" title=\"è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡ (PaaS)\"></a>è¿›ä¸€æ­¥æ¼”åŒ–â€”â€”å¹³å°å³æœåŠ¡ (PaaS)</h3><p>å¹³å°å³æœåŠ¡ (PaaS) ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“çš„éƒ¨ç½²å’Œç®¡ç†åº”ç”¨è€Œéšè—æ‰æ‰€æœ‰çš„å®ç°ç»†èŠ‚ä¾‹å¦‚æœåŠ¡å™¨ã€è´Ÿè½½å‡è¡¡å™¨ã€DNS ç­‰ç­‰. ä»–ä»¬æˆ–å¤šæˆ–å°‘çš„å»é™¤äº†å¯¹è¿ç»´å›¢é˜Ÿçš„éœ€æ±‚, è€Œæ˜¯è®©å¼€å‘äººå‘˜å»å…³æ³¨åº”ç”¨éƒ¨ç½². æœ‰å¾ˆå¤š PaaS æä¾›å•†, å…¶ä¸­ä¸€ä¸ªæœ€æµè¡Œçš„æ˜¯ Heroku. å…³äº Heroku çš„ä¸€ä¸ªæœ‰è¶£çš„äº‹æƒ…æ˜¯ Heroku å®Œå…¨æ˜¯è¿è¡Œåœ¨ AWS ä¹‹ä¸Šå¹¶ä¾èµ– AWS çš„. å¦‚æœä½ ä¸æ„¿æ„ä½ çš„åº”ç”¨è¿è¡Œåœ¨ç¾å›½ä¸œéƒ¨æˆ–è€…æ¬§æ´²è¥¿éƒ¨çš„ AWS ä¸Šçš„è¯, è¿™æˆ–è®¸æ˜¯ä¸€ä¸ªé—®é¢˜. æ²¡æœ‰ IaaS, åƒ Heroku è¿™æ ·çš„å¹³å°å¯èƒ½å°±ä¸ä¼šå­˜åœ¨äº†. PaaS æä¾›å•†åˆ©ç”¨ IaaS ä½œä¸ºä¸€ä¸ªéå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†æ¥äº¤ä»˜å®ƒä»¬çš„æœåŠ¡. åœ¨å‡å°‘ä»æƒ³æ³•åˆ°éƒ¨ç½²çš„æ—¶é—´ã€è‡ªåŠ¨åŒ–æµç¨‹ä»¥åŠå‡å°‘ç‰¹æ®Šçš„ç³»ç»ŸçŸ¥è¯†éœ€æ±‚çš„è¶‹åŠ¿ä¸­, PaaS æ˜¯åˆç†çš„ä¸‹ä¸€æ­¥, å°±åƒæ˜¯ä»ä¸“ç”¨æœåŠ¡å™¨åˆ° IaaS ä¸€æ ·.</p>\n<h4 id=\"æ„å»º-PaaS-æ˜¯å›°éš¾çš„\"><a href=\"#æ„å»º-PaaS-æ˜¯å›°éš¾çš„\" class=\"headerlink\" title=\"æ„å»º PaaS æ˜¯å›°éš¾çš„\"></a>æ„å»º PaaS æ˜¯å›°éš¾çš„</h4><p>èƒ½å¤Ÿé€šè¿‡æŠ½è±¡è€Œé¿å…å¤„ç†æœåŠ¡å™¨ç›¸å…³çš„é—®é¢˜æ˜¯ä¸å®¹æ˜“çš„, éœ€è¦å¼•å…¥å¾ˆå¤šä¸œè¥¿æ‰èƒ½åšåˆ°.</p>\n<p>åœ¨ PaaS çš„æ¦‚å¿µä¹‹ä¸‹æœ‰å‡ ä¸ªä¸»è¦çš„æ¨¡å—ï¼š</p>\n<ul>\n<li>ç¼–è¯‘ç³»ç»Ÿâ€”â€”æŠŠä½ çš„ä»£ç ç¼–è¯‘æˆå¯ä»¥è¿è¡Œçš„åº”ç”¨, å¹¶ä¸”æŠŠå®ƒå­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ä½œä¸ºåç»­ä½¿ç”¨.</li>\n<li>åº”ç”¨ç®¡ç†æ•°æ®åº“â€”â€”ç®¡ç† Git ç‰ˆæœ¬ã€build ç‰ˆæœ¬å’Œåº”ç”¨å…ƒæ•°æ®.</li>\n<li>é›†ç¾¤è°ƒåº¦å™¨â€”â€”å°†ä¸€ç»„æœåŠ¡å™¨ä½œä¸ºä¸€å°å¤§çš„æœåŠ¡å™¨æ¥ç®¡ç†, åœ¨æœåŠ¡å™¨èµ„æºæ± çš„æŸä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œä½ çš„ç¨‹åº, å¹¶æ£€æŸ¥å’Œæ›¿æ¢å¤±æ•ˆçš„ä½œä¸š.</li>\n<li>è´Ÿè½½å‡è¡¡â€”â€”å…è®¸ä» Internet å’Œå†…éƒ¨ç¨‹åºæ¥çš„ä¸šåŠ¡è´Ÿè½½è¢«æ­£ç¡®çš„è·¯ç”±åˆ°åˆé€‚çš„ä½ç½®.</li>\n<li>DNSâ€”â€”åœ¨ä½ äº§ç”Ÿå’Œä¿®æ”¹åº”ç”¨æ—¶è‡ªåŠ¨é…ç½® DNS æ¡ç›®.</li>\n<li>æˆ–è®¸æ˜¯æœ€é‡è¦çš„â€”â€”æŸä¸ªå½¢å¼çš„å®¹å™¨åŒ–ä¾‹å¦‚â€Š freebsd jailsã€solaris zonesã€æˆ–è€… linux containers, å®¹å™¨åŒ–ä½¿å¾—æŸä¸ªçš„åº”ç”¨ä¸ä¼šè¿›å…¥å’Œå½±å“åˆ°å…¶å®ƒçš„åº”ç”¨.</li>\n</ul>\n<p>ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç‚¹æ˜¯ Docker è¿…é€Ÿå‘å±•çš„éå¸¸é‡è¦çš„åŸå› . Linux å®¹å™¨æŠ€æœ¯å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´äº†, ä½†æ˜¯åªæœ‰æŸäº›å¤§çš„å…¬å¸æˆ–è€… PaaS æä¾›å•†è‡ªåŠ¨åŒ–äº†å®¹å™¨çš„ä½¿ç”¨, Docker ä½¿ Linux å®¹å™¨çš„ä½¿ç”¨å˜å¾—éå¸¸ç®€å•, ä¹Ÿæä¾›äº†æ ‡å‡†åŒ–çš„é•œåƒæ ¼å¼, å®ƒæˆä¸ºäº† PaaS ä¸­é‡è¦çš„ç»„æˆéƒ¨åˆ†.</p>\n<p>è¿™éå¸¸å¼ºå¤§, å› ä¸ºå¾ˆå¤šå…¬å¸åœ¨å¤„ç†çˆ†å‘å¼çš„ç”¨æˆ·å¢é•¿, æ¥è‡ªäºç§»åŠ¨ã€ç¤¾äº¤å’Œ IoT çš„æ–°çš„ä¸šåŠ¡æ¨¡å¼, ä»¥åŠæœŸæœ›ä»ä¼ ç»Ÿçš„é•¿çš„ç‰ˆæœ¬å‘å¸ƒå‘¨æœŸè½¬å˜åˆ°æŒç»­äº¤ä»˜. ä»–ä»¬åˆ©ç”¨åŸºäºè½¯ä»¶çš„æ¶æ„æˆ–è€…å¾®æœåŠ¡. ä»–ä»¬éœ€è¦èƒ½å¤Ÿè‡ªåŠ¨éƒ¨ç½²å’Œæµ‹è¯•æ–°çš„ä»£ç , å¹¶æ ¹æ®ä¸šåŠ¡çš„å˜åŒ–å¼¹æ€§ä¼¸ç¼©. ä½†é—®é¢˜æ˜¯ä»–ä»¬æ²¡æœ‰è¶³å¤Ÿçš„èµ„æºå’Œç»éªŒæ¥äº¤ä»˜åˆ°ä»–ä»¬çš„å¼€å‘å›¢é˜Ÿ, æ‰€ä»¥ä»–ä»¬ä¸å¾—ä¸å°†å…¶å¤–åŒ…ç»™ PaaS æä¾›å•†. ä¸å¹¸çš„æ˜¯, å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™, ä½ å°±æ”¾å¼ƒäº†å¯¹äºè¿™ä¸ªé»‘ç›’å­çš„å¾ˆå¤šæ§åˆ¶, è€Œæ˜¯èŠ±å¾ˆå¤šé’±å¹¶ä½¿å¾—è‡ªå·±å®Œå…¨ä¾èµ–äºå®ƒ. å¦å¤–ä¸€ä¸ªé€‰é¡¹æ˜¯, å¾ˆå¤šå…¬å¸åå¤çš„é‡æ–°å‘æ˜è½®å­æˆ–è€…ä½¿ç”¨é‚£äº›éš¾äºç»´æŠ¤çš„ã€è¿è¡Œç¼“æ…¢çš„å’Œæ˜“äºå‡ºé”™çš„å·¥å…·.</p>\n<p>æœ€å¥½çš„æƒ…å½¢æ˜¯åœ¨è‡ªå·±çš„æ•°æ®ä¸­å¿ƒæˆ–è€… Cloud å¸å·ä¸­è¿è¡Œä¸€ä¸ª PaaS å¹³å°, ä½ å¯ä»¥å…¨æƒæ§åˆ¶, ä½ çš„å›¢é˜Ÿå¯ä»¥ç›´æ¥å‚ä¸åº”ç”¨çš„éƒ¨ç½², å› æ­¤å¯ä»¥å½¢æˆä¸€ç§çœŸæ­£çš„ DevOps æ–‡åŒ–. Docker åŠå…¶æ ‡å‡†åŒ–çš„ç”Ÿæ€ç³»ç»Ÿæ˜¯è¿™ç§æ„¿æ™¯æˆä¸ºç°å®çš„é‡è¦ä¸€æ­¥.</p>\n<h3 id=\"æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å°-CaaS\"><a href=\"#æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å°-CaaS\" class=\"headerlink\" title=\"æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å° (CaaS)\"></a>æœ€åâ€”â€”å®¹å™¨æ‰˜ç®¡å¹³å° (CaaS)</h3><p>ä»€ä¹ˆæ˜¯å®¹å™¨æ‰˜ç®¡å¹³å°, æˆ–è€…å«å®¹å™¨å³æœåŠ¡å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘åœ¨ä¸Šé¢çš„ç« èŠ‚ä¸­æåˆ°çš„å¦å¤–ä¸€ç§æ„å»ºåœ¨ Docker åŸºç¡€ä¸Šçš„ Web æ‰˜ç®¡æ–¹å¼. å®ƒæ˜¯ä½ ç”¨å®¹å™¨æ¥éƒ¨ç½²å¤æ‚çš„å¤šå±‚æ¬¡çš„åº”ç”¨æ‰€éœ€è¦çš„è‡ªåŠ¨åŒ–çš„ç¼–è¯‘ç³»ç»Ÿ, é›†ç¾¤è°ƒåº¦å™¨, è´Ÿè½½å‡è¡¡, DNS è‡ªåŠ¨åŒ–ä»¥åŠæœåŠ¡å‘ç°. è¿™æ˜¯ PaaS çš„å¦å¤–ä¸€éƒ¨åˆ†å†…å®¹, ä½†æ˜¯ä½ ä¸æ˜¯ç”¨ä¸€ä¸ªå¤æ‚çš„ç¼–è¯‘ç³»ç»Ÿæ¥ç¼–è¯‘ä½ çš„åº”ç”¨, è€Œæ˜¯ç”¨ Docker é•œåƒ. é•œåƒå¯ä»¥éå¸¸å®¹æ˜“çš„è¿›è¡Œç¼–è¯‘å’Œæœ¬åœ°æµ‹è¯•, å› æ­¤ä½ åœ¨éƒ¨ç½²åº”ç”¨ä¹‹å‰å°±ç¡®è®¤åº”ç”¨å¯ä»¥æ­£å¸¸å·¥ä½œ. ç°åœ¨ PaaS ç”¨æˆ·ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ä½“éªŒ, ä½†æ˜¯ä¸éœ€è¦æ‹¥æœ‰è‡ªå·±çš„ç¡¬ä»¶æˆ–è€…äº‘å¸å·çš„å‰æä¸‹èŠ‚çº¦å¤§é‡çš„æˆæœ¬. ä»–ä»¬ä¸å†å—é™äºå…¶æœåŠ¡æä¾›å•†æ‰€æ”¯æŒçš„ç¯å¢ƒ, å¯ä»¥é€šè¿‡å°†åº”ç”¨æ‰“åŒ…æˆ Docker é•œåƒçš„æ–¹å¼åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œ.</p>\n<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, åˆ©ç”¨è¯¸å¦‚ ContainerShip Cloud, ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹, åœ¨ä»»ä½•äº‘å¹³å°ä¸Šç”šè‡³æ˜¯è£¸æœºä¸Šç”¨ç›¸åŒçš„æ–¹å¼è¿è¡Œä½ çš„åº”ç”¨. ä½ ä¸å†è¢«å¡åœ¨æ„å»ºå¤æ‚çš„åº”ç”¨æ¥è§£å†³éå¸¸å›°éš¾çš„é—®é¢˜, æˆ–è€…å¡åœ¨ä½¿ç”¨æŸä¸ªæä¾›å•†çš„ç‰¹æ®Šçš„è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·ä¸Š.</p>\n<ul>\n<li>ä½†æ˜¯é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„ Docker å®¹å™¨æ‰˜ç®¡å¹³å°å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…, æœ‰å¾ˆå¤šçš„é—®é¢˜éœ€è¦ä½ å»æ€è€ƒå’Œæ³¨æ„.</li>\n<li>æœ‰å¤§é‡çš„é€‰é¡¹, å› æ­¤é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›è¡Œç ”ç©¶å°±å˜å¾—å›°éš¾. å¥½æ¶ˆæ¯æ˜¯å¦‚æœä½ çš„åº”ç”¨å·²ç»å®¹å™¨åŒ–, ä½ å°±å¯ä»¥è½»æ¾çš„æµ‹è¯•å…¶ä¸­çš„æ¯ä¸€ä¸ª.</li>\n<li>ä½ æ­£åœ¨ä½¿ç”¨çš„æœåŠ¡æä¾›å•†ä¾‹å¦‚ Triton æˆ–è€… ECS çš„æŸä¸ªè§£å†³æ–¹æ¡ˆæˆ–è®¸ä½¿å¾—ä½ æ— æ³•è„±ç¦»è¿™ä¸ªæä¾›å•†, è¿™ä¹Ÿä½¿å¾— Docker çš„æœ€ä»¤äººå…´å¥‹çš„å¯ç§»æ¤æ€§å˜å¾—ä¸é‚£ä¹ˆé‡è¦äº†.</li>\n<li>è®¸å¤š CaaS æ–¹æ¡ˆåœ¨ä»–ä»¬è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ‰€æœ‰çš„ç®¡ç†ç³»ç»Ÿ, ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šåªæ˜¯è¿è¡ŒæŸä¸ªä»£ç†ç¨‹åºæ¥è¿æ¥ä»–ä»¬çš„ API, å› æ­¤å¦‚æœä»–ä»¬çš„ç³»ç»Ÿå®•æœºåä½ çš„é›†ç¾¤å°†æ— æ³•å·¥ä½œ.</li>\n<li>å…è®¸ä½ åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆæ˜¯éå¸¸å¤æ‚çš„, éœ€è¦ä¸€ä¸ªå›¢é˜Ÿå»ç®¡ç†å’Œå‡çº§.</li>\n<li>èƒ½å¤Ÿå®¹æ˜“çš„åœ¨é˜²ç«å¢™åè¿è¡Œæ•´ä¸ªç³»ç»Ÿçš„æ–¹æ¡ˆä¼šä½¿å¾—é«˜å¯ç”¨æˆä¸ºä½ä¼˜å…ˆçº§çš„äº‹æƒ….</li>\n<li>å½“ä½ é€‰æ‹©äº†ä¸€ä¸ª CaaS æä¾›å•†æ—¶, ä½ å°±å¯ä»¥æ‘†è„±äº†ä½ çš„æœåŠ¡æ‰˜ç®¡æä¾›å•†çš„é”å®š, ä½†æ˜¯ä½ å°†é™·å…¥åˆ° CaaS æä¾›å•†çš„é”å®š. ä½ æ— æ³•ä¸ä½¿ç”¨ä»–ä»¬çš„ SaaS ç®¡ç†æ¥å£è€Œåœ¨ä½ è‡ªå·±çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ•´ä¸ªç³»ç»ŸåŒ…æ‹¬ç®¡ç†ç³»ç»Ÿ, API å’Œ UI. ä½ ä¸€æ—¦å†³å®šä»˜é’±, ä½ æœ€å¥½å¯ä»¥ä¸€ç›´ä»˜é’±.</li>\n</ul>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>ç»ˆäºçœ‹å®Œäº†, çœŸçš„æ˜¯åˆè‡­åˆé•¿å•Š. å›é¡¾ä¸€ä¸‹è¿™ç¯‡æ–‡ç« , æ€»ä½“æ¥è¯´æ˜¯ç»å†äº†è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹:</p>\n<ol>\n<li>ä¸“æœ‰æœåŠ¡å™¨</li>\n<li>è™šæ‹ŸåŒ–æŠ€æœ¯</li>\n<li>åŸºç¡€è®¾æ–½å³æœåŠ¡ (IaaS)</li>\n<li>å¹³å°å³æœåŠ¡ (PaaS)</li>\n<li>å®¹å™¨å³æœåŠ¡ (CaaS)</li>\n</ol>\n<p>æ€»ç»“ä¸€ä¸‹, æˆ‘è§‰å¾—å¼€å‘äººå‘˜è¿˜æ˜¯æœ‰å¿…è¦äº†è§£ä¸€ä¸‹å…³äºäº§å“éƒ¨ç½²ç›¸å…³çš„æŠ€æœ¯å‘å±•. ç„¶åæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥é€‰æ‹©åˆé€‚çš„æœåŠ¡æä¾›å•†.</p>"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}